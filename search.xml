<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[python standard library difflib]]></title>
    <url>%2F2020%2F01%2F21%2Fpython-standard-library-difflib%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“å­¦ä¹  difflibæ¯æ—¥ä¸€è¯: wink US[wÉªÅ‹k] UK[wÉªÅ‹k] n.çœ¼è‰²ï¼›çœ¨ä¸€åªçœ¼ï¼›çœ¨çœ¼ç¤ºæ„ v.é—ªçƒï¼›çœ¨çœ¼ç¤ºæ„ï¼ˆå°¤æŒ‡ä½¿çœ¼è‰²æˆ–è¡¨ç¤ºå¼€çŽ©ç¬‘ï¼‰ï¼›æ˜Žç­ ç½‘ç»œçž¬é—´ï¼›çœ¨çœ¼ç›ï¼›ä½ çœ¨äº†çœ¨çœ¼ æŽ¨èä¸€ä¸ªç”µå½±ï¼š è®°å¿†ç¢Žç‰‡ðŸ‘´ åˆæ˜¯è¯ºå…°çš„å¤§ä½œ,å¼ºçƒˆæŽ¨è æŽ¨èæŒ‡æ•°ï¼š ðŸŒŸðŸŒŸðŸŒŸðŸŒŸðŸŒŸ é©¬ä¸Šå°±è¦è¿‡å¹´äº†,å°½é‡å°‘åŽ»äººæµå¯†é›†åœºæ‰€å§ã€‚ æºä»£ç æºä»£ç : Lib/difflib.py æ­¤æ¨¡å—æä¾›ç”¨äºŽæ¯”è¾ƒåºåˆ—çš„ç±»å’Œå‡½æ•°ã€‚ ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥ç”¨äºŽæ¯”è¾ƒæ–‡ä»¶ï¼Œå¹¶å¯ä»¥äº§ç”Ÿå„ç§æ ¼å¼çš„ä¸åŒä¿¡æ¯ï¼ŒåŒ…æ‹¬ HTML å’Œä¸Šä¸‹æ–‡ä»¥åŠç»Ÿä¸€æ ¼å¼çš„å·®å¼‚ç‚¹ã€‚ æœ‰å…³ç›®å½•å’Œæ–‡ä»¶çš„æ¯”è¾ƒï¼Œè¯·å‚è§ filecmp æ¨¡å—ã€‚ ç±»class difflib.SequenceMatcher è¿™æ˜¯ä¸€ä¸ªçµæ´»çš„ç±»ï¼Œå¯ç”¨äºŽæ¯”è¾ƒä»»ä½•ç±»åž‹çš„åºåˆ—å¯¹ï¼Œåªè¦åºåˆ—å…ƒç´ ä¸º hashable å¯¹è±¡ã€‚ å…¶åŸºæœ¬ç®—æ³•è¦æ—©äºŽç”± Ratcliff å’Œ Obershelp äºŽ 1980 å¹´ä»£æœ«æœŸå‘è¡¨å¹¶ä»¥â€œæ ¼å¼å¡”æ¨¡å¼åŒ¹é…â€çš„å¤¸å¼ åç§°å‘½åçš„ç®—æ³•ï¼Œå¹¶ä¸”æ›´åŠ æœ‰è¶£ä¸€äº›ã€‚ å…¶æ€è·¯æ˜¯æ‰¾åˆ°ä¸åŒ…å«â€œåžƒåœ¾â€å…ƒç´ çš„æœ€é•¿è¿žç»­åŒ¹é…å­åºåˆ—ï¼›æ‰€è°“â€œåžƒåœ¾â€å…ƒç´ æ˜¯æŒ‡å…¶åœ¨æŸç§æ„ä¹‰ä¸Šæ²¡æœ‰ä»·å€¼ï¼Œä¾‹å¦‚ç©ºç™½è¡Œæˆ–ç©ºç™½ç¬¦ã€‚ ï¼ˆå¤„ç†åžƒåœ¾å…ƒç´ æ˜¯å¯¹ Ratcliff å’Œ Obershelp ç®—æ³•çš„ä¸€ä¸ªæ‰©å±•ã€‚ï¼‰ ç„¶åŽåŒæ ·çš„æ€è·¯å°†é€’å½’åœ°åº”ç”¨äºŽåŒ¹é…åºåˆ—çš„å·¦å³åºåˆ—ç‰‡æ®µã€‚ è¿™å¹¶ä¸èƒ½äº§ç”Ÿæœ€å°ç¼–è¾‘åºåˆ—ï¼Œä½†ç¡®å®žèƒ½äº§ç”Ÿåœ¨äººä»¬çœ‹æ¥â€œæ­£ç¡®â€çš„åŒ¹é…ã€‚ è€—æ—¶: åŸºæœ¬ Ratcliff-Obershelp ç®—æ³•åœ¨æœ€åæƒ…å†µä¸‹ä¸ºç«‹æ–¹æ—¶é—´è€Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ä¸ºå¹³æ–¹æ—¶é—´ã€‚ SequenceMatcher åœ¨æœ€åæƒ…å†µä¸‹ä¸ºå¹³æ–¹æ—¶é—´è€Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹çš„è¡Œä¸ºå—åˆ°åºåˆ—ä¸­æœ‰å¤šå°‘ç›¸åŒå…ƒç´ è¿™ä¸€å› ç´ çš„å¾®å¦™å½±å“ï¼›åœ¨æœ€ä½³æƒ…å†µä¸‹åˆ™ä¸ºçº¿æ€§æ—¶é—´ã€‚ è‡ªåŠ¨åžƒåœ¾å¯å‘å¼è®¡ç®—: SequenceMatcher æ”¯æŒä½¿ç”¨å¯å‘å¼è®¡ç®—æ¥è‡ªåŠ¨å°†ç‰¹å®šåºåˆ—é¡¹è§†ä¸ºåžƒåœ¾ã€‚ è¿™ç§å¯å‘å¼è®¡ç®—ä¼šç»Ÿè®¡æ¯ä¸ªå•ç‹¬é¡¹åœ¨åºåˆ—ä¸­å‡ºçŽ°çš„æ¬¡æ•°ã€‚ å¦‚æžœæŸä¸€é¡¹ï¼ˆåœ¨ç¬¬ä¸€é¡¹ä¹‹åŽï¼‰çš„é‡å¤æ¬¡æ•°è¶…è¿‡åºåˆ—é•¿åº¦çš„ 1% å¹¶ä¸”åºåˆ—é•¿åº¦è‡³å°‘æœ‰ 200 é¡¹ï¼Œè¯¥é¡¹ä¼šè¢«æ ‡è®°ä¸ºâ€œçƒ­é—¨â€å¹¶è¢«è§†ä¸ºåºåˆ—åŒ¹é…ä¸­çš„åžƒåœ¾ã€‚ è¿™ç§å¯å‘å¼è®¡ç®—å¯ä»¥é€šè¿‡åœ¨åˆ›å»º SequenceMatcher æ—¶å°† autojunk å‚æ•°è®¾ä¸º False æ¥å…³é—­ã€‚ class difflib.Differ è¿™ä¸ªç±»çš„ä½œç”¨æ˜¯æ¯”è¾ƒç”±æ–‡æœ¬è¡Œç»„æˆçš„åºåˆ—ï¼Œå¹¶äº§ç”Ÿå¯ä¾›äººé˜…è¯»çš„å·®å¼‚æˆ–å¢žé‡ä¿¡æ¯ã€‚ Differ ç»Ÿä¸€ä½¿ç”¨ SequenceMatcher æ¥å®Œæˆè¡Œåºåˆ—çš„æ¯”è¾ƒä»¥åŠç›¸ä¼¼ï¼ˆæŽ¥è¿‘åŒ¹é…ï¼‰è¡Œå†…éƒ¨å­—ç¬¦åºåˆ—çš„æ¯”è¾ƒã€‚ Differ å¢žé‡çš„æ¯ä¸€è¡Œå‡ä»¥åŒå­—æ¯ä»£ç æ‰“å¤´ï¼š åŒå­—æ¯ä»£ç  æ„ä¹‰ &#39;- &#39; è¡Œä¸ºåºåˆ— 1 æ‰€ç‹¬æœ‰ &#39;+ &#39; è¡Œä¸ºåºåˆ— 2 æ‰€ç‹¬æœ‰ &#39; &#39; è¡Œåœ¨ä¸¤åºåˆ—ä¸­ç›¸åŒ &#39;? &#39; è¡Œä¸å­˜åœ¨äºŽä»»ä¸€è¾“å…¥åºåˆ— ä»¥ â€˜?â€˜ æ‰“å¤´çš„è¡Œå°è¯•å°†è§†çº¿å¼•è‡³è¡Œä»¥å¤–è€Œä¸å­˜åœ¨äºŽä»»ä¸€è¾“å…¥åºåˆ—çš„å·®å¼‚ã€‚ å¦‚æžœåºåˆ—åŒ…å«åˆ¶è¡¨ç¬¦åˆ™è¿™äº›è¡Œå¯èƒ½ä¼šä»¤äººæ„Ÿåˆ°è¿·æƒ‘ã€‚ class difflib.HtmlDiff è¿™ä¸ªç±»å¯ç”¨äºŽåˆ›å»º HTML è¡¨æ ¼ï¼ˆæˆ–åŒ…å«è¡¨æ ¼çš„å®Œæ•´ HTML æ–‡ä»¶ï¼‰ä»¥å¹¶æŽ’åœ°é€è¡Œæ˜¾ç¤ºæ–‡æœ¬æ¯”è¾ƒï¼Œè¡Œé—´ä¸Žè¡Œå¤–çš„æ›´æ”¹å°†çªå‡ºæ˜¾ç¤ºã€‚ æ­¤è¡¨æ ¼å¯ä»¥åŸºäºŽå®Œå…¨æˆ–ä¸Šä¸‹æ–‡å·®å¼‚æ¨¡å¼æ¥ç”Ÿæˆã€‚ è¿™ä¸ªç±»çš„æž„é€ å‡½æ•°ï¼š __init__(tabsize=8, wrapcolumn=None, linejunk=None, charjunk=IS_CHARACTER_JUNK) åˆå§‹åŒ– HtmlDiff çš„å®žä¾‹ã€‚ tabsize æ˜¯ä¸€ä¸ªå¯é€‰å…³é”®å­—å‚æ•°ï¼ŒæŒ‡å®šåˆ¶è¡¨ä½çš„é—´éš”ï¼Œé»˜è®¤å€¼ä¸º 8ã€‚ wrapcolumn æ˜¯ä¸€ä¸ªå¯é€‰å…³é”®å­—å‚æ•°ï¼ŒæŒ‡å®šè¡Œæ–‡æœ¬è‡ªåŠ¨æ‰“æ–­å¹¶æ¢è¡Œçš„åˆ—ä½ç½®ï¼Œé»˜è®¤å€¼ä¸º None è¡¨ç¤ºä¸è‡ªåŠ¨æ¢è¡Œã€‚ linejunk å’Œ charjunk å‡æ˜¯å¯é€‰å…³é”®å­—å‚æ•°ï¼Œä¼šä¼ å…¥ ndiff() (è¢« HtmlDiff ç”¨æ¥ç”Ÿæˆå¹¶æŽ’æ˜¾ç¤ºçš„ HTML å·®å¼‚)ã€‚ è¯·å‚é˜… ndiff() æ–‡æ¡£äº†è§£å‚æ•°é»˜è®¤å€¼åŠå…¶è¯´æ˜Žã€‚ make_file(fromlines, tolines, fromdesc=â€™â€™, todesc=â€™â€™, context=False, numlines=5, **, charset=â€™utf-8â€™*) æ¯”è¾ƒ fromlines å’Œ tolines (å­—ç¬¦ä¸²åˆ—è¡¨) å¹¶è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä¸€ä¸ªå®Œæ•´ HTML æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å„è¡Œå·®å¼‚çš„è¡¨æ ¼ï¼Œè¡Œé—´ä¸Žè¡Œå¤–çš„æ›´æ”¹å°†çªå‡ºæ˜¾ç¤ºã€‚ fromdesc å’Œ todesc å‡æ˜¯å¯é€‰å…³é”®å­—å‚æ•°ï¼ŒæŒ‡å®šæ¥æº/ç›®æ ‡æ–‡ä»¶çš„åˆ—æ ‡é¢˜å­—ç¬¦ä¸²ï¼ˆé»˜è®¤å‡ä¸ºç©ºç™½å­—ç¬¦ä¸²ï¼‰ã€‚ context å’Œ numlines å‡æ˜¯å¯é€‰å…³é”®å­—å‚æ•°ã€‚ å½“åªè¦æ˜¾ç¤ºä¸Šä¸‹æ–‡å·®å¼‚æ—¶å°±å°† context è®¾ä¸º Trueï¼Œå¦åˆ™é»˜è®¤å€¼ False ä¸ºæ˜¾ç¤ºå®Œæ•´æ–‡ä»¶ã€‚ numlines é»˜è®¤ä¸º 5ã€‚ å½“ context ä¸º True æ—¶ numlines å°†æŽ§åˆ¶å›´ç»•çªå‡ºæ˜¾ç¤ºå·®å¼‚éƒ¨åˆ†çš„ä¸Šä¸‹æ–‡è¡Œæ•°ã€‚ å½“ context ä¸º False æ—¶ numlines å°†æŽ§åˆ¶åœ¨ä½¿ç”¨ â€œnextâ€ è¶…é“¾æŽ¥æ—¶çªå‡ºæ˜¾ç¤ºå·®å¼‚éƒ¨åˆ†ä¹‹å‰æ‰€æ˜¾ç¤ºçš„è¡Œæ•°ï¼ˆè®¾ä¸ºé›¶åˆ™ä¼šå¯¼è‡´ â€œnextâ€ è¶…é“¾æŽ¥å°†ä¸‹ä¸€ä¸ªçªå‡ºæ˜¾ç¤ºå·®å¼‚éƒ¨åˆ†æ”¾åœ¨æµè§ˆå™¨é¡¶ç«¯ï¼Œä¸æ·»åŠ ä»»ä½•å‰å¯¼ä¸Šä¸‹æ–‡ï¼‰ã€‚ fromdesc å’Œ todesc ä¼šè¢«å½“ä½œæœªè½¬ä¹‰çš„ HTML æ¥è§£è¯»ï¼Œå½“æŽ¥æ”¶ä¸å¯ä¿¡æ¥æºçš„è¾“å…¥æ—¶åº”è¯¥é€‚å½“åœ°è¿›è¡Œè½¬ä¹‰ã€‚ make_table(fromlines, tolines, fromdesc=â€™â€™, todesc=â€™â€™, context=False, numlines=5) æ¯”è¾ƒ fromlines å’Œ tolines (å­—ç¬¦ä¸²åˆ—è¡¨) å¹¶è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºä¸€ä¸ªåŒ…å«å„è¡Œå·®å¼‚çš„å®Œæ•´ HTML è¡¨æ ¼ï¼Œè¡Œé—´ä¸Žè¡Œå¤–çš„æ›´æ”¹å°†çªå‡ºæ˜¾ç¤ºã€‚ æ­¤æ–¹æ³•çš„å‚æ•°ä¸Ž make_file() æ–¹æ³•çš„ç›¸åŒã€‚ Tools/scripts/diff.py æ˜¯è¿™ä¸ªç±»çš„å‘½ä»¤è¡Œå‰ç«¯ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå¾ˆå¥½çš„ä½¿ç”¨ç¤ºä¾‹ã€‚ å‡½æ•°difflib.context_diff(a, b, fromfile=â€™â€™, tofile=â€™â€™, fromfiledate=â€™â€™, tofiledate=â€™â€™, n=3, lineterm=â€™\nâ€™) æ¯”è¾ƒ a å’Œ b (å­—ç¬¦ä¸²åˆ—è¡¨)ï¼›è¿”å›žä¸Šä¸‹æ–‡å·®å¼‚æ ¼å¼çš„å¢žé‡ä¿¡æ¯ (ä¸€ä¸ªäº§ç”Ÿå¢žé‡è¡Œçš„ generator)ã€‚ æ‰€è°“ä¸Šä¸‹æ–‡å·®å¼‚æ˜¯ä¸€ç§åªæ˜¾ç¤ºæœ‰æ›´æ”¹çš„è¡Œå†åŠ å‡ ä¸ªä¸Šä¸‹æ–‡è¡Œçš„ç´§å‡‘å½¢å¼ã€‚ æ›´æ”¹è¢«æ˜¾ç¤ºä¸ºä¹‹å‰/ä¹‹åŽçš„æ ·å¼ã€‚ ä¸Šä¸‹æ–‡è¡Œæ•°ç”± n è®¾å®šï¼Œé»˜è®¤ä¸ºä¸‰è¡Œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå·®å¼‚æŽ§åˆ¶è¡Œï¼ˆä»¥ *** or --- è¡¨ç¤ºï¼‰æ˜¯é€šè¿‡æœ«å°¾æ¢è¡Œç¬¦æ¥åˆ›å»ºçš„ã€‚ è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»Ž io.IOBase.readlines() åˆ›å»ºçš„è¾“å…¥å°†å¾—åˆ°é€‚ç”¨äºŽ io.IOBase.writelines() çš„å·®å¼‚ä¿¡æ¯ï¼Œå› ä¸ºè¾“å…¥å’Œè¾“å‡ºéƒ½å¸¦æœ‰æœ«å°¾æ¢è¡Œç¬¦ã€‚ å¯¹äºŽæ²¡æœ‰æœ«å°¾æ¢è¡Œç¬¦çš„è¾“å…¥ï¼Œåº”å°† lineterm å‚æ•°è®¾ä¸º &quot;&quot;ï¼Œè¿™æ ·è¾“å‡ºå†…å®¹å°†ç»Ÿä¸€ä¸å¸¦æ¢è¡Œç¬¦ã€‚ ä¸Šä¸‹æ–‡å·®å¼‚æ ¼å¼é€šå¸¸å¸¦æœ‰ä¸€ä¸ªè®°å½•æ–‡ä»¶åå’Œä¿®æ”¹æ—¶é—´çš„æ ‡å¤´ã€‚ è¿™äº›ä¿¡æ¯çš„éƒ¨åˆ†æˆ–å…¨éƒ¨å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸² fromfile, tofile, fromfiledate å’Œ tofiledate æ¥æŒ‡å®šã€‚ ä¿®æ”¹æ—¶é—´é€šå¸¸ä»¥ ISO 8601 æ ¼å¼è¡¨ç¤ºã€‚ å¦‚æžœæœªæŒ‡å®šï¼Œè¿™äº›å­—ç¬¦ä¸²é»˜è®¤ä¸ºç©ºã€‚ 12345678910111213141516&gt;&gt;&gt; s1 = ['bacon\n', 'eggs\n', 'ham\n', 'guido\n']&gt;&gt;&gt; s2 = ['python\n', 'eggy\n', 'hamster\n', 'guido\n']&gt;&gt;&gt; sys.stdout.writelines(context_diff(s1, s2, fromfile='before.py',tofile='after.py'))*** before.py--- after.py****************** 1,4 ****! bacon! eggs! ham guido--- 1,4 ----! python! eggy! hamster guido difflib.get_close_matches(word, possibilities, n=3, cutoff=0.6) è¿”å›žç”±æœ€ä½³â€œè¿‘ä¼¼â€åŒ¹é…æž„æˆçš„åˆ—è¡¨ã€‚ word ä¸ºä¸€ä¸ªæŒ‡å®šç›®æ ‡è¿‘ä¼¼åŒ¹é…çš„åºåˆ—ï¼ˆé€šå¸¸ä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œpossibilities ä¸ºä¸€ä¸ªç”±ç”¨äºŽåŒ¹é… word çš„åºåˆ—æž„æˆçš„åˆ—è¡¨ï¼ˆé€šå¸¸ä¸ºå­—ç¬¦ä¸²åˆ—è¡¨ï¼‰ã€‚ å¯é€‰å‚æ•° n (é»˜è®¤ä¸º 3) æŒ‡å®šæœ€å¤šè¿”å›žå¤šå°‘ä¸ªè¿‘ä¼¼åŒ¹é…ï¼› n å¿…é¡»å¤§äºŽ 0. å¯é€‰å‚æ•° cutoff (é»˜è®¤ä¸º 0.6) æ˜¯ä¸€ä¸ª [0, 1] èŒƒå›´å†…çš„æµ®ç‚¹æ•°ã€‚ ä¸Ž word ç›¸ä¼¼åº¦å¾—åˆ†æœªè¾¾åˆ°è¯¥å€¼çš„å€™é€‰åŒ¹é…å°†è¢«å¿½ç•¥ã€‚ å€™é€‰åŒ¹é…ä¸­ï¼ˆä¸è¶…è¿‡ n ä¸ªï¼‰çš„æœ€ä½³åŒ¹é…å°†ä»¥åˆ—è¡¨å½¢å¼è¿”å›žï¼ŒæŒ‰ç›¸ä¼¼åº¦å¾—åˆ†æŽ’åºï¼Œæœ€ç›¸ä¼¼çš„æŽ’åœ¨æœ€å‰é¢ã€‚ 123456789&gt;&gt;&gt; get_close_matches('appel', ['ape', 'apple', 'peach', 'puppy'])['apple', 'ape']&gt;&gt;&gt;import keyword&gt;&gt;&gt; get_close_matches('wheel', keyword.kwlist)['while']&gt;&gt;&gt; get_close_matches('pineapple', keyword.kwlist)[]&gt;&gt;&gt; get_close_matches('accept', keyword.kwlist)['except'] difflib.ndiff(a, b, linejunk=None, charjunk=IS_CHARACTER_JUNK) æ¯”è¾ƒ a å’Œ b (å­—ç¬¦ä¸²åˆ—è¡¨)ï¼›è¿”å›ž Differ å½¢å¼çš„å¢žé‡ä¿¡æ¯ (ä¸€ä¸ªäº§ç”Ÿå¢žé‡è¡Œçš„ generator)ã€‚ å¯é€‰å…³é”®å­—å½¢å‚ linejunk å’Œ charjunk å‡ä¸ºè¿‡æ»¤å‡½æ•° (æˆ–ä¸º None)ï¼š linejunk: æ­¤å‡½æ•°æŽ¥å—å•ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œå¦‚æžœå…¶ä¸ºåžƒåœ¾å­—ç¬¦ä¸²åˆ™è¿”å›žçœŸå€¼ï¼Œå¦åˆ™è¿”å›žå‡å€¼ã€‚ é»˜è®¤ä¸º Noneã€‚ æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ¨¡å—å±‚çº§çš„å‡½æ•° IS_LINE_JUNK()ï¼Œå®ƒä¼šè¿‡æ»¤æŽ‰æ²¡æœ‰å¯è§å­—ç¬¦çš„è¡Œï¼Œé™¤éžè¯¥è¡Œæ·»åŠ äº†è‡³å¤šä¸€ä¸ªäº•å·ç¬¦ (&#39;#&#39;) â€“ ä½†æ˜¯ä¸‹å±‚çš„ SequenceMatcher ç±»ä¼šåŠ¨æ€åˆ†æžå“ªäº›è¡Œçš„é‡å¤é¢‘ç¹åˆ°è¶³ä»¥å½¢æˆå™ªéŸ³ï¼Œè¿™é€šå¸¸ä¼šæ¯”ä½¿ç”¨æ­¤å‡½æ•°çš„æ•ˆæžœæ›´å¥½ã€‚ charjunk: æ­¤å‡½æ•°æŽ¥å—ä¸€ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ä¸º 1 çš„å­—ç¬¦ä¸²)ï¼Œå¦‚æžœå…¶ä¸ºåžƒåœ¾å­—ç¬¦åˆ™è¿”å›žçœŸå€¼ï¼Œå¦åˆ™è¿”å›žå‡å€¼ã€‚ é»˜è®¤ä¸ºæ¨¡å—å±‚çº§çš„å‡½æ•° IS_CHARACTER_JUNK()ï¼Œå®ƒä¼šè¿‡æ»¤æŽ‰ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ç¬¦æˆ–åˆ¶è¡¨ç¬¦ï¼›ä½†åŒ…å«æ¢è¡Œç¬¦å¯ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼ï¼‰ã€‚ Tools/scripts/ndiff.py æ˜¯è¿™ä¸ªå‡½æ•°çš„å‘½ä»¤è¡Œå‰ç«¯ã€‚ 123456789101112&gt;&gt;&gt; diff = ndiff('one\ntwo\nthree\n'.splitlines(keepends=True),... 'ore\ntree\nemu\n'.splitlines(keepends=True))&gt;&gt;&gt; print(''.join(diff), end="")- one? ^+ ore? ^- two- three? -+ tree+ emu difflib.restore(sequence, which) è¿”å›žä¸¤ä¸ªåºåˆ—ä¸­äº§ç”Ÿå¢žé‡çš„é‚£ä¸€ä¸ªã€‚ ç»™å‡ºä¸€ä¸ªç”± Differ.compare() æˆ– ndiff() äº§ç”Ÿçš„ åºåˆ—ï¼Œæå–å‡ºæ¥è‡ªæ–‡ä»¶ 1 æˆ– 2 (which å½¢å‚) çš„è¡Œï¼ŒåŽ»é™¤è¡Œå‰ç¼€ã€‚ ç¤ºä¾‹: 1234567891011&gt;&gt;&gt; diff = ndiff('one\ntwo\nthree\n'.splitlines(keepends=True),... 'ore\ntree\nemu\n'.splitlines(keepends=True))&gt;&gt;&gt; diff = list(diff) # materialize the generated delta into a list&gt;&gt;&gt; print(''.join(restore(diff, 1)), end="")onetwothree&gt;&gt;&gt; print(''.join(restore(diff, 2)), end="")oretreeemu difflib.unified_diff(a, b, fromfile=â€™â€™, tofile=â€™â€™, fromfiledate=â€™â€™, tofiledate=â€™â€™, n=3, lineterm=â€™\nâ€™) æ¯”è¾ƒ a å’Œ b (å­—ç¬¦ä¸²åˆ—è¡¨)ï¼›è¿”å›žç»Ÿä¸€å·®å¼‚æ ¼å¼çš„å¢žé‡ä¿¡æ¯ (ä¸€ä¸ªäº§ç”Ÿå¢žé‡è¡Œçš„ generator)ã€‚ æ‰€ä»¥ç»Ÿä¸€å·®å¼‚æ˜¯ä¸€ç§åªæ˜¾ç¤ºæœ‰æ›´æ”¹çš„è¡Œå†åŠ å‡ ä¸ªä¸Šä¸‹æ–‡è¡Œçš„ç´§å‡‘å½¢å¼ã€‚ æ›´æ”¹è¢«æ˜¾ç¤ºä¸ºå†…è”çš„æ ·å¼ï¼ˆè€Œä¸æ˜¯åˆ†å¼€çš„ä¹‹å‰/ä¹‹åŽæ–‡æœ¬å—ï¼‰ã€‚ ä¸Šä¸‹æ–‡è¡Œæ•°ç”± n è®¾å®šï¼Œé»˜è®¤ä¸ºä¸‰è¡Œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå·®å¼‚æŽ§åˆ¶è¡Œ (ä»¥ ---, +++ æˆ– @@ è¡¨ç¤º) æ˜¯é€šè¿‡æœ«å°¾æ¢è¡Œç¬¦æ¥åˆ›å»ºçš„ã€‚ è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»Ž io.IOBase.readlines() åˆ›å»ºçš„è¾“å…¥å°†å¾—åˆ°é€‚ç”¨äºŽ io.IOBase.writelines() çš„å·®å¼‚ä¿¡æ¯ï¼Œå› ä¸ºè¾“å…¥å’Œè¾“å‡ºéƒ½å¸¦æœ‰æœ«å°¾æ¢è¡Œç¬¦ã€‚ å¯¹äºŽæ²¡æœ‰æœ«å°¾æ¢è¡Œç¬¦çš„è¾“å…¥ï¼Œåº”å°† lineterm å‚æ•°è®¾ä¸º &quot;&quot;ï¼Œè¿™æ ·è¾“å‡ºå†…å®¹å°†ç»Ÿä¸€ä¸å¸¦æ¢è¡Œç¬¦ã€‚ ä¸Šä¸‹æ–‡å·®å¼‚æ ¼å¼é€šå¸¸å¸¦æœ‰ä¸€ä¸ªè®°å½•æ–‡ä»¶åå’Œä¿®æ”¹æ—¶é—´çš„æ ‡å¤´ã€‚ è¿™äº›ä¿¡æ¯çš„éƒ¨åˆ†æˆ–å…¨éƒ¨å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸² fromfile, tofile, fromfiledate å’Œ tofiledate æ¥æŒ‡å®šã€‚ ä¿®æ”¹æ—¶é—´é€šå¸¸ä»¥ ISO 8601 æ ¼å¼è¡¨ç¤ºã€‚ å¦‚æžœæœªæŒ‡å®šï¼Œè¿™äº›å­—ç¬¦ä¸²é»˜è®¤ä¸ºç©ºã€‚ 12345678910111213&gt;&gt;&gt; s1 = ['bacon\n', 'eggs\n', 'ham\n', 'guido\n']&gt;&gt;&gt; s2 = ['python\n', 'eggy\n', 'hamster\n', 'guido\n']&gt;&gt;&gt; sys.stdout.writelines(unified_diff(s1, s2, fromfile='before.py',tofile='after.py'))--- before.py+++ after.py@@ -1,4 +1,4 @@-bacon-eggs-ham+python+eggy+hamster guido difflib.diff_bytes(dfunc, a, b, fromfile=bâ€™â€™, tofile=bâ€™â€™, fromfiledate=bâ€™â€™, tofiledate=bâ€™â€™, n=3, lineterm=bâ€™\nâ€™) ä½¿ç”¨ dfunc æ¯”è¾ƒ a å’Œ b (å­—èŠ‚ä¸²å¯¹è±¡åˆ—è¡¨)ï¼›äº§ç”Ÿä»¥ dfunc æ‰€è¿”å›žæ ¼å¼è¡¨ç¤ºçš„å·®å¼‚è¡Œåˆ—è¡¨ï¼ˆä¹Ÿæ˜¯å­—èŠ‚ä¸²ï¼‰ã€‚ dfunc å¿…é¡»æ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼Œé€šå¸¸ä¸º unified_diff() æˆ– context_diff()ã€‚ å…è®¸ä½ æ¯”è¾ƒç¼–ç æœªçŸ¥æˆ–ä¸ä¸€è‡´çš„æ•°æ®ã€‚ é™¤ n ä¹‹å¤–çš„æ‰€æœ‰è¾“å…¥éƒ½å¿…é¡»ä¸ºå­—èŠ‚ä¸²å¯¹è±¡è€Œéžå­—ç¬¦ä¸²ã€‚ ä½œç”¨æ–¹å¼ä¸ºæ— æŸåœ°å°†æ‰€æœ‰è¾“å…¥ (é™¤ n ä¹‹å¤–) è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶è°ƒç”¨ dfunc(a, b, fromfile, tofile, fromfiledate, tofiledate, n, lineterm)ã€‚ dfunc çš„è¾“å‡ºä¼šè¢«éšå³è½¬æ¢å›žå­—èŠ‚ä¸²ï¼Œè¿™æ ·ä½ æ‰€å¾—åˆ°çš„å¢žé‡è¡Œå°†å…·æœ‰ä¸Ž a å’Œ b ç›¸åŒçš„æœªçŸ¥/ä¸ä¸€è‡´ç¼–ç ã€‚ difflib.IS_LINE_JUNK(line) å¯¹äºŽå¯å¿½ç•¥çš„è¡Œè¿”å›ž Trueã€‚ å¦‚æžœ line ä¸ºç©ºè¡Œæˆ–åªåŒ…å«å•ä¸ª &#39;#&#39; åˆ™ line è¡Œå°±æ˜¯å¯å¿½ç•¥çš„ï¼Œå¦åˆ™å°±æ˜¯ä¸å¯å¿½ç•¥çš„ã€‚ æ­¤å‡½æ•°è¢«ç”¨ä½œè¾ƒæ—§ç‰ˆæœ¬ ndiff() ä¸­ linejunk å½¢å‚çš„é»˜è®¤å€¼ã€‚ difflib.IS_CHARACTER_JUNK å¯¹äºŽå¯å¿½ç•¥çš„å­—ç¬¦è¿”å›ž Trueã€‚ å­—ç¬¦ ch å¦‚æžœä¸ºç©ºæ ¼ç¬¦æˆ–åˆ¶è¡¨ç¬¦åˆ™ ch å°±æ˜¯å¯å¿½ç•¥çš„ï¼Œå¦åˆ™å°±æ˜¯ä¸å¯å¿½ç•¥çš„ã€‚ æ­¤å‡½æ•°è¢«ç”¨ä½œ ndiff() ä¸­ charjunk å½¢å‚çš„é»˜è®¤å€¼ã€‚ SequenceMatcher å¯¹è±¡SequenceMatcher ç±»å…·æœ‰è¿™æ ·çš„æž„é€ å™¨ï¼š class difflib.SequenceMatcher(isjunk=None, a=â€™â€™, b=â€™â€™, autojunk=True) å¯é€‰å‚æ•° isjunk å¿…é¡»ä¸º None (é»˜è®¤å€¼) æˆ–ä¸ºæŽ¥å—ä¸€ä¸ªåºåˆ—å…ƒç´ å¹¶å½“ä¸”ä»…å½“å…¶ä¸ºåº”å¿½ç•¥çš„â€œåžƒåœ¾â€å…ƒç´ æ—¶è¿”å›žçœŸå€¼çš„å•å‚æ•°å‡½æ•°ã€‚ ä¼ å…¥ None ä½œä¸º isjunk çš„å€¼å°±ç›¸å½“äºŽä¼ å…¥ lambda x: Falseï¼›ä¹Ÿå°±æ˜¯è¯´ä¸å¿½ç•¥ä»»ä½•å€¼ã€‚ ä¾‹å¦‚ï¼Œä¼ å…¥: 1lambda x: x in " \t" å¦‚æžœä½ ä»¥å­—ç¬¦åºåˆ—çš„å½¢å¼å¯¹è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œå¹¶ä¸”ä¸å¸Œæœ›åŒºåˆ†ç©ºæ ¼ç¬¦æˆ–ç¡¬åˆ¶è¡¨ç¬¦ã€‚ å¯é€‰å‚æ•° a å’Œ b ä¸ºè¦æ¯”è¾ƒçš„åºåˆ—ï¼›ä¸¤è€…é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ ä¸¤ä¸ªåºåˆ—çš„å…ƒç´ éƒ½å¿…é¡»ä¸º hashableã€‚ å¯é€‰å‚æ•° autojunk å¯ç”¨äºŽå¯ç”¨è‡ªåŠ¨åžƒåœ¾å¯å‘å¼è®¡ç®—ã€‚ SequenceMatcher å¯¹è±¡æŽ¥å—ä¸‰ä¸ªæ•°æ®å±žæ€§: bjunk æ˜¯ b å½“ä¸­ isjunk ä¸º True çš„å…ƒç´ é›†åˆï¼›bpopular æ˜¯è¢«å¯å‘å¼è®¡ç®—ï¼ˆå¦‚æžœå…¶æœªè¢«ç¦ç”¨ï¼‰è§†ä¸ºçƒ­é—¨å€™é€‰çš„éžåžƒåœ¾å…ƒç´ é›†åˆï¼›b2j æ˜¯å°† b å½“ä¸­å‰©ä½™å…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªå®ƒä»¬å‡ºçŽ°ä½ç½®åˆ—è¡¨çš„å­—å…¸ã€‚ æ‰€æœ‰ä¸‰ä¸ªæ•°æ®å±žæ€§å°†åœ¨ b é€šè¿‡ set_seqs() æˆ– set_seq2() é‡ç½®æ—¶è¢«é‡ç½®ã€‚ æ–¹æ³• set_seqs(a, b) è®¾ç½®è¦æ¯”è¾ƒçš„ä¸¤ä¸ªåºåˆ—ã€‚ SequenceMatcher è®¡ç®—å¹¶ç¼“å­˜æœ‰å…³ç¬¬äºŒä¸ªåºåˆ—çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¿™æ ·å¦‚æžœä½ æƒ³è¦å°†ä¸€ä¸ªåºåˆ—ä¸Žå¤šä¸ªåºåˆ—è¿›è¡Œæ¯”è¾ƒï¼Œå¯ä½¿ç”¨ set_seq2() ä¸€æ¬¡æ€§åœ°è®¾ç½®è¯¥å¸¸ç”¨åºåˆ—å¹¶é‡å¤åœ°å¯¹æ¯ä¸ªå…¶ä»–åºåˆ—å„è°ƒç”¨ä¸€æ¬¡ set_seq1()ã€‚ set_seq1(a) è®¾ç½®è¦æ¯”è¾ƒçš„ç¬¬ä¸€ä¸ªåºåˆ—ã€‚ è¦æ¯”è¾ƒçš„ç¬¬äºŒä¸ªåºåˆ—ä¸ä¼šæ”¹å˜ã€‚ set_seq2(b) è®¾ç½®è¦æ¯”è¾ƒçš„ç¬¬äºŒä¸ªåºåˆ—ã€‚ è¦æ¯”è¾ƒçš„ç¬¬ä¸€ä¸ªåºåˆ—ä¸ä¼šæ”¹å˜ã€‚ find_longest_match(alo, ahi, blo, bhi) æ‰¾å‡º a[alo:ahi] å’Œ b[blo:bhi] ä¸­çš„æœ€é•¿åŒ¹é…å—ã€‚ å¦‚æžœ isjunk è¢«çœç•¥æˆ–ä¸º Noneï¼Œfind_longest_match() å°†è¿”å›ž (i, j, k) ä½¿å¾— a[i:i+k] ç­‰äºŽ b[j:j+k]ï¼Œå…¶ä¸­ alo &lt;= i &lt;= i+k &lt;= ahi å¹¶ä¸” blo &lt;= j &lt;= j+k &lt;= bhiã€‚ å¯¹äºŽæ‰€æœ‰æ»¡è¶³è¿™äº›æ¡ä»¶çš„ (i&#39;, j&#39;, k&#39;)ï¼Œå¦‚æžœ i == i&#39;, j &lt;= j&#39; ä¹Ÿè¢«æ»¡è¶³ï¼Œåˆ™é™„åŠ æ¡ä»¶ k &gt;= k&#39;, i &lt;= i&#39;ã€‚ æ¢å¥è¯è¯´ï¼Œå¯¹äºŽæ‰€æœ‰æœ€é•¿åŒ¹é…å—ï¼Œè¿”å›žåœ¨ a å½“ä¸­æœ€å…ˆå‡ºçŽ°çš„ä¸€ä¸ªï¼Œè€Œå¯¹äºŽåœ¨ a å½“ä¸­æœ€å…ˆå‡ºçŽ°çš„æ‰€æœ‰æœ€é•¿åŒ¹é…å—ï¼Œåˆ™è¿”å›žåœ¨ b å½“ä¸­æœ€å…ˆå‡ºçŽ°çš„ä¸€ä¸ªã€‚ 123&gt;&gt;&gt; s = SequenceMatcher(None, " abcd", "abcd abcd")&gt;&gt;&gt; s.find_longest_match(0, 5, 0, 9)Match(a=0, b=4, size=5) å¦‚æžœæä¾›äº† isjunkï¼Œå°†æŒ‰ä¸Šè¿°è§„åˆ™ç¡®å®šç¬¬ä¸€ä¸ªæœ€é•¿åŒ¹é…å—ï¼Œä½†é¢å¤–é™„åŠ ä¸å…è®¸å—å†…å‡ºçŽ°åžƒåœ¾å…ƒç´ çš„é™åˆ¶ã€‚ ç„¶åŽå°†é€šè¿‡ï¼ˆä»…ï¼‰åŒ¹é…ä¸¤è¾¹çš„åžƒåœ¾å…ƒç´ æ¥å°½å¯èƒ½åœ°æ‰©å±•è¯¥å—ã€‚ è¿™æ ·ç»“æžœå—ç»å¯¹ä¸ä¼šåŒ¹é…åžƒåœ¾å…ƒç´ ï¼Œé™¤éžåŒæ ·çš„åžƒåœ¾å…ƒç´ æ­£å¥½ä¸Žæœ‰æ„ä¹‰çš„åŒ¹é…ç›¸é‚»ã€‚ è¿™æ˜¯ä¸Žä¹‹å‰ç›¸åŒçš„ä¾‹å­ï¼Œä½†æ˜¯å°†ç©ºæ ¼ç¬¦è§†ä¸ºåžƒåœ¾ã€‚ è¿™å°†é˜²æ­¢ &#39; abcd&#39; ç›´æŽ¥ä¸Žç¬¬äºŒä¸ªåºåˆ—æœ«å°¾çš„ &#39; abcd&#39; ç›¸åŒ¹é…ã€‚ è€Œåªå¯ä»¥åŒ¹é… &#39;abcd&#39;ï¼Œå¹¶ä¸”æ˜¯åŒ¹é…ç¬¬äºŒä¸ªåºåˆ—æœ€å·¦è¾¹çš„ &#39;abcd&#39;ï¼š 123&gt;&gt;&gt; s = SequenceMatcher(lambda x: x==" ", " abcd", "abcd abcd")&gt;&gt;&gt; s.find_longest_match(0, 5, 0, 9)Match(a=1, b=0, size=4) å¦‚æžœæœªæ‰¾åˆ°åŒ¹é…å—ï¼Œæ­¤æ–¹æ³•å°†è¿”å›ž (alo, blo, 0)ã€‚ æ­¤æ–¹æ³•å°†è¿”å›žä¸€ä¸ª named tuple Match(a, b, size)ã€‚ get_matching_blocks() è¿”å›žæè¿°éžé‡å åŒ¹é…å­åºåˆ—çš„ä¸‰å…ƒç»„åˆ—è¡¨ã€‚ æ¯ä¸ªä¸‰å…ƒç»„çš„å½¢å¼ä¸º (i, j, n)ï¼Œå…¶å«ä¹‰ä¸º a[i:i+n] == b[j:j+n]ã€‚ è¿™äº›ä¸‰å…ƒç»„æŒ‰ i å’Œ j å•è°ƒé€’å¢žæŽ’åˆ—ã€‚ æœ€åŽä¸€ä¸ªä¸‰å…ƒç»„ç”¨äºŽå ä½ï¼Œå…¶å€¼ä¸º (len(a), len(b), 0)ã€‚ å®ƒæ˜¯å”¯ä¸€ n == 0 çš„ä¸‰å…ƒç»„ã€‚ å¦‚æžœ (i, j, n) å’Œ (i&#39;, j&#39;, n&#39;) æ˜¯åœ¨åˆ—è¡¨ä¸­ç›¸é‚»çš„ä¸‰å…ƒç»„ï¼Œä¸”åŽè€…ä¸æ˜¯åˆ—è¡¨ä¸­çš„æœ€åŽä¸€ä¸ªä¸‰å…ƒç»„ï¼Œåˆ™ i+n &lt; i&#39; æˆ– j+n &lt; j&#39;ï¼›æ¢å¥è¯è¯´ï¼Œç›¸é‚»çš„ä¸‰å…ƒç»„æ€»æ˜¯æè¿°éžç›¸é‚»çš„ç›¸ç­‰å—ã€‚ 123&gt;&gt;&gt; s = SequenceMatcher(None, "abxcd", "abcd")&gt;&gt;&gt; s.get_matching_blocks()[Match(a=0, b=0, size=2), Match(a=3, b=2, size=2), Match(a=5, b=4, size=0)] get_opcodes() è¿”å›žæè¿°å¦‚ä½•å°† a å˜ä¸º b çš„ 5 å…ƒç»„åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç»„çš„å½¢å¼ä¸º (tag, i1, i2, j1, j2)ã€‚ åœ¨ç¬¬ä¸€ä¸ªå…ƒç»„ä¸­ i1 == j1 == 0ï¼Œè€Œåœ¨å…¶ä½™çš„å…ƒç»„ä¸­ i1 ç­‰äºŽå‰ä¸€ä¸ªå…ƒç»„çš„ i2ï¼Œå¹¶ä¸” j1 ä¹Ÿç­‰äºŽå‰ä¸€ä¸ªå…ƒç»„çš„ j2ã€‚ tag å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå…¶å«ä¹‰å¦‚ä¸‹ï¼š å€¼ æ„ä¹‰ &#39;replace&#39; a[i1:i2] åº”ç”± b[j1:j2] æ›¿æ¢ã€‚ &#39;delete&#39; a[i1:i2] åº”è¢«åˆ é™¤ã€‚ è¯·æ³¨æ„åœ¨æ­¤æƒ…å†µä¸‹ j1 == j2ã€‚ &#39;insert&#39; b[j1:j2] åº”æ’å…¥åˆ° a[i1:i1]ã€‚ è¯·æ³¨æ„åœ¨æ­¤æƒ…å†µä¸‹ i1 == i2ã€‚ &#39;equal&#39; a[i1:i2] == b[j1:j2] (ä¸¤ä¸ªå­åºåˆ—ç›¸åŒ)ã€‚ ä¾‹å¦‚ï¼š 1234567891011&gt;&gt;&gt; a = "qabxcd"&gt;&gt;&gt; b = "abycdf"&gt;&gt;&gt; s = SequenceMatcher(None, a, b)&gt;&gt;&gt; for tag, i1, i2, j1, j2 in s.get_opcodes():... print('&#123;:7&#125; a[&#123;&#125;:&#123;&#125;] --&gt; b[&#123;&#125;:&#123;&#125;] &#123;!r:&gt;8&#125; --&gt; &#123;!r&#125;'.format(... tag, i1, i2, j1, j2, a[i1:i2], b[j1:j2]))delete a[0:1] --&gt; b[0:0] 'q' --&gt; ''equal a[1:3] --&gt; b[0:2] 'ab' --&gt; 'ab'replace a[3:4] --&gt; b[2:3] 'x' --&gt; 'y'equal a[4:6] --&gt; b[3:5] 'cd' --&gt; 'cd'insert a[6:6] --&gt; b[5:6] '' --&gt; 'f' get_grouped_opcodes(n=3) è¿”å›žä¸€ä¸ªå¸¦æœ‰æœ€å¤š n è¡Œä¸Šä¸‹æ–‡çš„åˆ†ç»„çš„ generatorã€‚ä»Ž get_opcodes() æ‰€è¿”å›žçš„ç»„å¼€å§‹ï¼Œæ­¤æ–¹æ³•ä¼šæ‹†åˆ†å‡ºè¾ƒå°çš„æ›´æ”¹ç°‡å¹¶æ¶ˆé™¤æ²¡æœ‰æ›´æ”¹çš„é—´éš”åŒºåŸŸã€‚è¿™äº›åˆ†ç»„ä»¥ä¸Ž get_opcodes() ç›¸åŒçš„æ ¼å¼è¿”å›žã€‚ ratio() è¿”å›žä¸€ä¸ªå–å€¼èŒƒå›´ [0, 1] çš„æµ®ç‚¹æ•°ä½œä¸ºåºåˆ—ç›¸ä¼¼æ€§åº¦é‡ã€‚å…¶ä¸­ T æ˜¯ä¸¤ä¸ªåºåˆ—ä¸­å…ƒç´ çš„æ€»æ•°é‡ï¼ŒM æ˜¯åŒ¹é…çš„æ•°é‡ï¼Œå³ 2.0*M / Tã€‚ è¯·æ³¨æ„å¦‚æžœä¸¤ä¸ªåºåˆ—å®Œå…¨ç›¸åŒåˆ™è¯¥å€¼ä¸º 1.0ï¼Œå¦‚æžœä¸¤è€…å®Œå…¨ä¸åŒåˆ™ä¸º 0.0ã€‚å¦‚æžœ get_matching_blocks() æˆ– get_opcodes() å°šæœªè¢«è°ƒç”¨åˆ™æ­¤æ–¹æ³•è¿ç®—æ¶ˆè€—è¾ƒå¤§ï¼Œåœ¨æ­¤æƒ…å†µä¸‹ä½ å¯èƒ½éœ€è¦å…ˆè°ƒç”¨ quick_ratio() æˆ– real_quick_ratio() æ¥èŽ·å–ä¸€ä¸ªä¸Šç•Œã€‚ æ³¨æ„: ratio() è°ƒç”¨çš„ç»“æžœå¯èƒ½ä¼šå–å†³äºŽå‚æ•°çš„é¡ºåºã€‚ ä¾‹å¦‚: 12345&gt; &gt;&gt;&gt; SequenceMatcher(None, 'tide', 'diet').ratio()&gt; 0.25&gt; &gt;&gt;&gt; SequenceMatcher(None, 'diet', 'tide').ratio()&gt; 0.5&gt; quick_ratio() ç›¸å¯¹å¿«é€Ÿåœ°è¿”å›žä¸€ä¸ª ratio() çš„ä¸Šç•Œã€‚ real_quick_ratio() éžå¸¸å¿«é€Ÿåœ°è¿”å›žä¸€ä¸ª ratio() çš„ä¸Šç•Œã€‚ è¿™ä¸‰ä¸ªè¿”å›žåŒ¹é…éƒ¨åˆ†å å­—ç¬¦æ€»æ•°çš„æ¯”çŽ‡çš„æ–¹æ³•å¯èƒ½ç”±äºŽä¸åŒçš„è¿‘ä¼¼çº§åˆ«è€Œç»™å‡ºä¸ä¸€æ ·çš„ç»“æžœï¼Œä½†æ˜¯ quick_ratio() å’Œ real_quick_ratio() æ€»æ˜¯ä¼šè‡³å°‘ä¸Ž ratio() ä¸€æ ·å¤§ï¼š 1234567&gt;&gt;&gt; s = SequenceMatcher(None, "abcd", "bcde")s.ratio()0.75&gt;&gt;&gt; s.quick_ratio()0.75&gt;&gt;&gt; s.real_quick_ratio()1.0 SequenceMatcher çš„ç¤ºä¾‹ä»¥ä¸‹ç¤ºä¾‹æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†ç©ºæ ¼è§†ä¸ºâ€œåžƒåœ¾â€ï¼š 123&gt;&gt;&gt; s = SequenceMatcher(lambda x: x == " ",... "private Thread currentThread;",... "private volatile Thread currentThread;") ratio() è¿”å›žä¸€ä¸ª [0, 1] èŒƒå›´å†…çš„æ•´æ•°ä½œä¸ºä¸¤ä¸ªåºåˆ—ç›¸ä¼¼æ€§çš„åº¦é‡ã€‚ æ ¹æ®ç»éªŒï¼Œratio() å€¼è¶…è¿‡ 0.6 å°±æ„å‘³ç€ä¸¤ä¸ªåºåˆ—æ˜¯è¿‘ä¼¼åŒ¹é…çš„ï¼š 12&gt;&gt;&gt; print(round(s.ratio(), 3))0.866 å¦‚æžœä½ åªå¯¹ä¸¤ä¸ªåºåˆ—ç›¸åŒ¹é…çš„ä½ç½®æ„Ÿå…´è¶£ï¼Œåˆ™ get_matching_blocks() å°±å¾ˆæ–¹ä¾¿ï¼š 12345&gt;&gt;&gt; for block in s.get_matching_blocks():... print("a[%d] and b[%d] match for %d elements" % block)a[0] and b[0] match for 8 elementsa[8] and b[17] match for 21 elementsa[29] and b[38] match for 0 elements è¯·æ³¨æ„ get_matching_blocks() è¿”å›žçš„æœ€åŽä¸€ä¸ªå…ƒç»„æ€»æ˜¯åªç”¨äºŽå ä½çš„ (len(a), len(b), 0)ï¼Œè¿™ä¹Ÿæ˜¯å…ƒç»„æœ«å°¾å…ƒç´ ï¼ˆåŒ¹é…çš„å…ƒç´ æ•°é‡ï¼‰ä¸º 0 çš„å”¯ä¸€æƒ…å†µã€‚ å¦‚æžœä½ æƒ³è¦çŸ¥é“å¦‚ä½•å°†ç¬¬ä¸€ä¸ªåºåˆ—è½¬æˆç¬¬äºŒä¸ªåºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨ get_opcodes(): 12345&gt;&gt;&gt;for opcode in s.get_opcodes():... print("%6s a[%d:%d] b[%d:%d]" % opcode) equal a[0:8] b[0:8]insert a[8:8] b[8:17] equal a[8:29] b[17:38] Differ å¯¹è±¡è¯·æ³¨æ„ Differ æ‰€ç”Ÿæˆçš„å¢žé‡å¹¶ä¸ä¿è¯æ˜¯ æœ€å° å·®å¼‚ã€‚ ç›¸åï¼Œæœ€å°å·®å¼‚å¾€å¾€æ˜¯è¿åç›´è§‰çš„ï¼Œå› ä¸ºå®ƒä»¬ä¼šåŒæ­¥ä»»ä½•å¯èƒ½çš„åœ°æ–¹ï¼Œæœ‰æ—¶ç”šè‡³æ„å¤–äº§ç”Ÿç›¸è· 100 é¡µçš„åŒ¹é…ã€‚ å°†åŒæ­¥ç‚¹é™åˆ¶ä¸ºè¿žç»­åŒ¹é…ä¿ç•™äº†ä¸€äº›å±€éƒ¨æ€§æ¦‚å¿µï¼Œè¿™å¶å°”ä¼šå¸¦æ¥äº§ç”Ÿæ›´é•¿å·®å¼‚çš„ä»£ä»·ã€‚ Differ ç±»å…·æœ‰è¿™æ ·çš„æž„é€ å™¨ï¼š class difflib.Differ(linejunk=None, charjunk=None) å¯é€‰å…³é”®å­—å½¢å‚ linejunk å’Œ charjunk å‡ä¸ºè¿‡æ»¤å‡½æ•° (æˆ–ä¸º None)ï¼š linejunk: æŽ¥å—å•ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå¦‚æžœå…¶ä¸ºåžƒåœ¾å­—ç¬¦ä¸²åˆ™è¿”å›žçœŸå€¼ã€‚ é»˜è®¤å€¼ä¸º Noneï¼Œæ„å‘³ç€æ²¡æœ‰ä»»ä½•è¡Œä¼šè¢«è§†ä¸ºåžƒåœ¾è¡Œã€‚ charjunk: æŽ¥å—å•ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ä¸º 1 çš„å­—ç¬¦ä¸²ï¼‰ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œå¦‚æžœå…¶ä¸ºåžƒåœ¾å­—ç¬¦åˆ™è¿”å›žçœŸå€¼ã€‚ é»˜è®¤å€¼ä¸º Noneï¼Œæ„å‘³ç€æ²¡æœ‰ä»»ä½•å­—ç¬¦ä¼šè¢«è§†ä¸ºåžƒåœ¾å­—ç¬¦ã€‚ è¿™äº›åžƒåœ¾è¿‡æ»¤å‡½æ•°å¯åŠ å¿«æŸ¥æ‰¾å·®å¼‚çš„åŒ¹é…é€Ÿåº¦ï¼Œå¹¶ä¸”ä¸ä¼šå¯¼è‡´ä»»ä½•å·®å¼‚è¡Œæˆ–å­—ç¬¦è¢«å¿½ç•¥ã€‚ è¯·é˜…è¯» find_longest_match() æ–¹æ³•çš„ isjunk å½¢å‚çš„æè¿°äº†è§£è¯¦æƒ…ã€‚ Differ å¯¹è±¡æ˜¯é€šè¿‡ä¸€ä¸ªå•ç‹¬æ–¹æ³•æ¥ä½¿ç”¨ï¼ˆç”Ÿæˆå¢žé‡ï¼‰çš„ï¼š compare(a, b) æ¯”è¾ƒä¸¤ä¸ªç”±è¡Œç»„æˆçš„åºåˆ—ï¼Œå¹¶ç”Ÿæˆå¢žé‡ï¼ˆä¸€ä¸ªç”±è¡Œç»„æˆçš„åºåˆ—ï¼‰ã€‚æ¯ä¸ªåºåˆ—å¿…é¡»åŒ…å«ä¸€ä¸ªä»¥æ¢è¡Œç¬¦ç»“å°¾çš„å•è¡Œå­—ç¬¦ä¸²ã€‚ è¿™æ ·çš„åºåˆ—å¯ä»¥é€šè¿‡æ–‡ä»¶ç±»å¯¹è±¡çš„ readlines() æ–¹æ³•æ¥èŽ·å–ã€‚ æ‰€ç”Ÿæˆçš„å¢žé‡åŒæ ·ç”±ä»¥æ¢è¡Œç¬¦ç»“å°¾çš„å­—ç¬¦ä¸²æž„æˆï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶ç±»å¯¹è±¡çš„ writelines() æ–¹æ³•åŽŸæ ·æ‰“å°å‡ºæ¥ã€‚ Differ ç¤ºä¾‹æ­¤ç¤ºä¾‹æ¯”è¾ƒä¸¤æ®µæ–‡æœ¬ã€‚ é¦–å…ˆæˆ‘ä»¬è®¾ç½®æ–‡æœ¬ä¸ºä»¥æ¢è¡Œç¬¦ç»“å°¾çš„å•è¡Œå­—ç¬¦ä¸²æž„æˆçš„åºåˆ—ï¼ˆè¿™æ ·çš„åºåˆ—ä¹Ÿå¯ä»¥é€šè¿‡æ–‡ä»¶ç±»å¯¹è±¡çš„ readlines() æ–¹æ³•æ¥èŽ·å–ï¼‰ï¼š 1234567891011121314&gt;&gt;&gt; text1 = ''' 1. Beautiful is better than ugly.... 2. Explicit is better than implicit.... 3. Simple is better than complex.... 4. Complex is better than complicated.... '''.splitlines(keepends=True)&gt;&gt;&gt; len(text1)4&gt;&gt;&gt; text1[0][-1]'\n'&gt;&gt;&gt; text2 = ''' 1. Beautiful is better than ugly.... 3. Simple is better than complex.... 4. Complicated is better than complex.... 5. Flat is better than nested.... '''.splitlines(keepends=True) æŽ¥ä¸‹æ¥æˆ‘ä»¬å®žä¾‹åŒ–ä¸€ä¸ª Differ å¯¹è±¡ï¼š 1&gt;&gt;&gt; d = Differ() è¯·æ³¨æ„åœ¨å®žä¾‹åŒ– Differ å¯¹è±¡æ—¶æˆ‘ä»¬å¯ä»¥ä¼ å…¥å‡½æ•°æ¥è¿‡æ»¤æŽ‰â€œåžƒåœ¾â€è¡Œå’Œå­—ç¬¦ã€‚ è¯¦æƒ…å‚è§ Differ() æž„é€ å™¨è¯´æ˜Žã€‚ æœ€åŽï¼Œæˆ‘ä»¬æ¯”è¾ƒä¸¤ä¸ªåºåˆ—ï¼š 1&gt;&gt;&gt; result = list(d.compare result æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè®©æˆ‘ä»¬å°†å…¶ç¾ŽåŒ–æ‰“å°å‡ºæ¥ï¼š 123456789101112&gt;&gt;&gt; from pprint import pprint&gt;&gt;&gt; pprint(result)[' 1. Beautiful is better than ugly.\n', '- 2. Explicit is better than implicit.\n', '- 3. Simple is better than complex.\n', '+ 3. Simple is better than complex.\n', '? ++\n', '- 4. Complex is better than complicated.\n', '? ^ ---- ^\n', '+ 4. Complicated is better than complex.\n', '? ++++ ^ ^\n', '+ 5. Flat is better than nested.\n'] ä½œä¸ºå•ç‹¬çš„å¤šè¡Œå­—ç¬¦ä¸²æ˜¾ç¤ºå‡ºæ¥åˆ™æ˜¯è¿™æ ·ï¼š 123456789101112&gt;&gt;&gt; import sys&gt;&gt;&gt; sys.stdout.writelines(result) 1. Beautiful is better than ugly.- 2. Explicit is better than implicit.- 3. Simple is better than complex.+ 3. Simple is better than complex.? ++- 4. Complex is better than complicated.? ^ ---- ^+ 4. Complicated is better than complex.? ++++ ^ ^+ 5. Flat is better than nested. difflib çš„å‘½ä»¤è¡ŒæŽ¥å£è¿™ä¸ªå®žä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ difflib æ¥åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºŽ diff çš„å·¥å…·ã€‚ å®ƒåŒæ ·åŒ…å«åœ¨ Python æºç å‘å¸ƒåŒ…ä¸­ï¼Œæ–‡ä»¶åä¸º Tools/scripts/diff.pyã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#!/usr/bin/env python3""" Command line interface to difflib.py providing diffs in four formats:* ndiff: lists every line and highlights interline changes.* context: highlights clusters of changes in a before/after format.* unified: highlights clusters of changes in an inline format.* html: generates side by side comparison with change highlights."""import sys, os, difflib, argparsefrom datetime import datetime, timezonedef file_mtime(path): t = datetime.fromtimestamp(os.stat(path).st_mtime, timezone.utc) return t.astimezone().isoformat()def main(): parser = argparse.ArgumentParser() parser.add_argument('-c', action='store_true', default=False, help='Produce a context format diff (default)') parser.add_argument('-u', action='store_true', default=False, help='Produce a unified format diff') parser.add_argument('-m', action='store_true', default=False, help='Produce HTML side by side diff ' '(can use -c and -l in conjunction)') parser.add_argument('-n', action='store_true', default=False, help='Produce a ndiff format diff') parser.add_argument('-l', '--lines', type=int, default=3, help='Set number of context lines (default 3)') parser.add_argument('fromfile') parser.add_argument('tofile') options = parser.parse_args() n = options.lines fromfile = options.fromfile tofile = options.tofile fromdate = file_mtime(fromfile) todate = file_mtime(tofile) with open(fromfile) as ff: fromlines = ff.readlines() with open(tofile) as tf: tolines = tf.readlines() if options.u: diff = difflib.unified_diff(fromlines, tolines, fromfile, tofile, fromdate, todate, n=n) elif options.n: diff = difflib.ndiff(fromlines, tolines) elif options.m: diff = difflib.HtmlDiff().make_file(fromlines,tolines,fromfile,tofile,context=options.c,numlines=n) else: diff = difflib.context_diff(fromlines, tolines, fromfile, tofile, fromdate, todate, n=n) sys.stdout.writelines(diff)if __name__ == '__main__': main() è¡¥å……å…³äºŽHtmlDiffç±»ç”¨æ³•ç»“åˆwebbrowseråˆ›å»ºå·®å¼‚æ¯”è¾ƒé¡µé¢ 123456789101112import difflibimport webbrowserdef check_diff(self, index, wrapcolumn): file1, file2 = self.differing[index] with open(file1, 'r') as f: content1 = f.read().splitlines() with open(file2, 'r') as f: content2 = f.read().splitlines() htmlDiff = HtmlDiff(tabsize=2,wrapcolumn=wrapcolumn) with open('tmp.html', 'w') as f: f.write(htmlDiff.make_file(content1, content2, fromdesc=self.dir1, todesc=self.dir2)) webbrowser.open('tmp.html') å¯¹æ¯”Nginxé…ç½®æ–‡ä»¶å·®å¼‚è„šæœ¬ 123456789101112131415161718192021222324252627282930313233#!/usr/bin/env python3# -*- coding:utf-8 -*- import difflibimport stringimport sys try: textfile1 = sys.argv[1] textfile2 = sys.argv[2]except Exception: print("Error:" + str(e)) print("Usage: xxxx.py filename1 filename2") sys.exit()def readfile(filename): try: fileHandle = open(filename,'r') text = fileHandle.read().splitlines() fileHandle.close() return text except IOError as error: print('Read file Error:' + str(error)) sys.exit() if textfile1 == "" or textfile2 == "": print("Usage:test.py filename1 filename2") sys.exit() text1_lines = readfile(textfile1)text2_lines = readfile(textfile2) d = difflib.HtmlDiff()print(d.make_file(text1_lines,text2_lines))]]></content>
      <categories>
        <category>python</category>
        <category>standard_library</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>difflib</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library sqlite3]]></title>
    <url>%2F2020%2F01%2F20%2Fpython-standard-library-sqlite3%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ sqlite3ä»Šå¤©æ˜¯äºŒåå››èŠ‚æ°”çš„å¤§å¯’ å¤§å¯’ï¼Œæ˜¯äºŒåå››èŠ‚æ°”ä¸­çš„æœ€åŽä¸€ä¸ªèŠ‚æ°”ã€‚æ–—æŒ‡ä¸‘ï¼›å¤ªé˜³é»„ç»ä¸º300Â°ï¼›å…¬åŽ†1æœˆ20ï¼21æ—¥äº¤èŠ‚ã€‚åŒå°å¯’ä¸€æ ·ï¼Œå¤§å¯’ä¹Ÿæ˜¯è¡¨ç¤ºå¤©æ°”å¯’å†·ç¨‹åº¦çš„èŠ‚æ°”ã€‚åœ¨æˆ‘å›½éƒ¨åˆ†åœ°åŒºï¼Œå¤§å¯’ä¸å¦‚å°å¯’å†·ï¼Œä½†åœ¨æŸäº›å¹´ä»½å’Œæ²¿æµ·å°‘æ•°åœ°æ–¹ï¼Œå…¨å¹´æœ€ä½Žæ°”æ¸©ä»ç„¶ä¼šå‡ºçŽ°åœ¨å¤§å¯’èŠ‚æ°”å†…ã€‚å°å¯’ã€å¤§å¯’æ˜¯ä¸€å¹´ä¸­é›¨æ°´æœ€å°‘çš„æ—¶æ®µã€‚ å…¹å¤§å¯’ä¸€è¿‡ï¼Œæ–°ä¸€å¹´çš„èŠ‚æ°”å°±åˆè½®å›žæ¥äº†ï¼Œæ­£æ‰€è°“å†¬åŽ»æ˜¥æ¥ã€‚å¤§å¯’è™½ç„¶å¯’å†·ï¼Œä½†å› ä¸ºå·²è¿‘æ˜¥å¤©ï¼Œæ‰€ä»¥ä¸ä¼šåƒå¤§é›ªåˆ°å†¬è‡³æœŸé—´é‚£æ ·é…·å¯’ã€‚è¿™æ—¶èŠ‚ï¼Œäººä»¬å¼€å§‹å¿™ç€é™¤æ—§é¥°æ–°ã€è…Œåˆ¶å¹´è‚´ã€å‡†å¤‡å¹´è´§å’Œå„ç§ç¥­ç¥€ä¾›å“ã€æ‰«å°˜æ´ç‰©ï¼Œå› ä¸ºä¸­å›½äººæœ€é‡è¦çš„èŠ‚æ—¥â€”â€”æ˜¥èŠ‚å°±è¦åˆ°äº†ã€‚ æ¯æ—¥ä¸€è¯ï¼š Cold adj å†·,å¯’å†· ä¾‹å¥ï¼š It is the last one in January 20th of each year twenty-four solar term solar term, before and after the sun reaches 300 degrees for itâ€. It is cold weather, meaning extreme. å¤§å¯’æ˜¯äºŒåå››èŠ‚æ°”ä¸­æœ€åŽä¸€ä¸ªèŠ‚æ°”ï¼Œæ¯å¹´1æœˆ20æ—¥å‰åŽå¤ªé˜³åˆ°è¾¾é»„ç»300Â°æ—¶ä¸ºâ€å¤§å¯’â€ã€‚å¤§å¯’ï¼Œæ˜¯å¤©æ°”å¯’å†·åˆ°æžç‚¹çš„æ„æ€ã€‚ æºç æºä»£ç ï¼š Lib/sqlite3/ SQLite æ˜¯ä¸€ä¸ªCè¯­è¨€åº“ï¼Œå®ƒå¯ä»¥æä¾›ä¸€ç§è½»é‡çº§çš„åŸºäºŽç£ç›˜çš„æ•°æ®åº“ï¼Œè¿™ç§æ•°æ®åº“ä¸éœ€è¦ç‹¬ç«‹çš„æœåŠ¡å™¨è¿›ç¨‹ï¼Œä¹Ÿå…è®¸éœ€è¦ä½¿ç”¨ä¸€ç§éžæ ‡å‡†çš„ SQL æŸ¥è¯¢è¯­è¨€æ¥è®¿é—®å®ƒã€‚ä¸€äº›åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ SQLite ä½œä¸ºå†…éƒ¨æ•°æ®å­˜å‚¨ã€‚å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºåŽŸåž‹ï¼Œç„¶åŽå†è¿ç§»åˆ°æ›´å¤§çš„æ•°æ®åº“ï¼Œæ¯”å¦‚ PostgreSQL æˆ– Oracleã€‚ sqlite3 æ¨¡å—ç”± Gerhard HÃ¤ring ç¼–å†™ã€‚å®ƒæä¾›äº†ç¬¦åˆ DB-API 2.0 è§„èŒƒçš„æŽ¥å£ï¼Œè¿™ä¸ªè§„èŒƒæ˜¯ PEP 249ã€‚ è¦ä½¿ç”¨è¿™ä¸ªæ¨¡å—ï¼Œå¿…é¡»å…ˆåˆ›å»ºä¸€ä¸ª Connection å¯¹è±¡ï¼Œå®ƒä»£è¡¨æ•°æ®åº“ã€‚ä¸‹é¢ä¾‹å­ä¸­ï¼Œæ•°æ®å°†å­˜å‚¨åœ¨ example.db æ–‡ä»¶ä¸­ï¼š 12import sqlite3conn = sqlite3.connect('example.db') ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ :memory: æ¥åˆ›å»ºä¸€ä¸ªå†…å­˜ä¸­çš„æ•°æ®åº“ å½“æœ‰äº† Connection å¯¹è±¡åŽï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª Cursor æ¸¸æ ‡å¯¹è±¡ï¼Œç„¶åŽè°ƒç”¨å®ƒçš„ execute() æ–¹æ³•æ¥æ‰§è¡Œ SQL è¯­å¥ï¼š 123456789101112131415c = conn.cursor()# Create tablec.execute(&apos;&apos;&apos;CREATE TABLE stocks (date text, trans text, symbol text, qty real, price real)&apos;&apos;&apos;)# Insert a row of datac.execute(&quot;INSERT INTO stocks VALUES (&apos;2006-01-05&apos;,&apos;BUY&apos;,&apos;RHAT&apos;,100,35.14)&quot;)# Save (commit) the changesconn.commit()# We can also close the connection if we are done with it.# Just be sure any changes have been committed or they will be lost.conn.close() è¿™äº›æ•°æ®è¢«æŒä¹…åŒ–ä¿å­˜äº†ï¼Œè€Œä¸”å¯ä»¥åœ¨ä¹‹åŽçš„ä¼šè¯ä¸­ä½¿ç”¨å®ƒä»¬ï¼š 123import sqlite3conn = sqlite3.connect('example.db')c = conn.cursor() é€šå¸¸ä½ çš„ SQL æ“ä½œéœ€è¦ä½¿ç”¨ä¸€äº› Python å˜é‡çš„å€¼ã€‚ä½ ä¸åº”è¯¥ä½¿ç”¨ Python çš„å­—ç¬¦ä¸²æ“ä½œæ¥åˆ›å»ºä½ çš„æŸ¥è¯¢è¯­å¥ï¼Œå› ä¸ºé‚£æ ·åšä¸å®‰å…¨ï¼›å®ƒä¼šä½¿ä½ çš„ç¨‹åºå®¹æ˜“å—åˆ° SQL æ³¨å…¥æ”»å‡»ï¼ˆåœ¨ https://xkcd.com/327/ ä¸Šæœ‰ä¸€ä¸ªæžç¬‘çš„ä¾‹å­ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆåŽæžœï¼‰ æŽ¨èå¦å¤–ä¸€ç§æ–¹æ³•ï¼šä½¿ç”¨ DB-API çš„å‚æ•°æ›¿æ¢ã€‚åœ¨ä½ çš„ SQL è¯­å¥ä¸­ï¼Œä½¿ç”¨ ? å ä½ç¬¦æ¥ä»£æ›¿å€¼ï¼Œç„¶åŽæŠŠå¯¹åº”çš„å€¼ç»„æˆçš„å…ƒç»„åšä¸º execute() æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ï¼ˆå…¶ä»–æ•°æ®åº“å¯èƒ½ä¼šä½¿ç”¨ä¸åŒçš„å ä½ç¬¦ï¼Œæ¯”å¦‚ %s æˆ–è€… :1ï¼‰ä¾‹å¦‚ï¼š 123456789101112131415# Never do this -- insecure!symbol = 'RHAT'c.execute("SELECT * FROM stocks WHERE symbol = '%s'" % symbol)# Do this insteadt = ('RHAT',)c.execute('SELECT * FROM stocks WHERE symbol=?', t)print(c.fetchone())# Larger example that inserts many records at a timepurchases = [('2006-03-28', 'BUY', 'IBM', 1000, 45.00), ('2006-04-05', 'BUY', 'MSFT', 1000, 72.00), ('2006-04-06', 'SELL', 'IBM', 500, 53.00), ]c.executemany('INSERT INTO stocks VALUES (?,?,?,?,?)', purchases) è¦åœ¨æ‰§è¡Œ SELECT è¯­å¥åŽèŽ·å–æ•°æ®ï¼Œä½ å¯ä»¥æŠŠæ¸¸æ ‡ä½œä¸º iteratorï¼Œç„¶åŽè°ƒç”¨å®ƒçš„ fetchone() æ–¹æ³•æ¥èŽ·å–ä¸€æ¡åŒ¹é…çš„è¡Œï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ fetchall() æ¥å¾—åˆ°åŒ…å«å¤šä¸ªåŒ¹é…è¡Œçš„åˆ—è¡¨ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨è¿­ä»£å™¨å½¢å¼çš„ä¾‹å­ï¼š 1234567&gt;&gt;&gt; for row in c.execute('SELECT * FROM stocks ORDER BY price'): print(row)('2006-01-05', 'BUY', 'RHAT', 100, 35.14)('2006-03-28', 'BUY', 'IBM', 1000, 45.0)('2006-04-06', 'SELL', 'IBM', 500, 53.0)('2006-04-05', 'BUY', 'MSFT', 1000, 72.0) æ¨¡å—å‡½æ•°å’Œå¸¸é‡ sqlite3.version â€‹ è¿™ä¸ªæ¨¡å—çš„ç‰ˆæœ¬å·ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä¸æ˜¯ SQLite åº“çš„ç‰ˆæœ¬å·ã€‚ sqlite3.version_info è¿™ä¸ªæ¨¡å—çš„ç‰ˆæœ¬å·ï¼Œæ˜¯ä¸€ä¸ªç”±æ•´æ•°ç»„æˆçš„å…ƒç»„ã€‚ä¸æ˜¯ SQLite åº“çš„ç‰ˆæœ¬å·ã€‚ sqlite3.sqlite_version ä½¿ç”¨ä¸­çš„ SQLite åº“çš„ç‰ˆæœ¬å·ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ sqlite3.sqlite_version_info ä½¿ç”¨ä¸­çš„ SQLite åº“çš„ç‰ˆæœ¬å·ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ç»„æˆçš„å…ƒç»„ã€‚ sqlite3.PARSE_DECLTYPES è¿™ä¸ªå¸¸é‡å¯ä»¥ä½œä¸º connect() å‡½æ•°çš„ detect_types å‚æ•°ã€‚ è®¾ç½®è¿™ä¸ªå‚æ•°åŽï¼Œsqlite3 æ¨¡å—å°†è§£æžå®ƒè¿”å›žçš„æ¯ä¸€åˆ—ç”³æ˜Žçš„ç±»åž‹ã€‚å®ƒä¼šç”³æ˜Žçš„ç±»åž‹çš„ç¬¬ä¸€ä¸ªå•è¯ï¼Œæ¯”å¦‚â€œinteger primary keyâ€ï¼Œå®ƒä¼šè§£æžå‡ºâ€œintegerâ€ï¼Œå†æ¯”å¦‚â€œnumber(10)â€ï¼Œå®ƒä¼šè§£æžå‡ºâ€œnumberâ€ã€‚ç„¶åŽï¼Œå®ƒä¼šåœ¨è½¬æ¢å™¨å­—å…¸é‡ŒæŸ¥æ‰¾é‚£ä¸ªç±»åž‹æ³¨å†Œçš„è½¬æ¢å™¨å‡½æ•°ï¼Œå¹¶è°ƒç”¨å®ƒã€‚ sqlite3.PARSE_COLNAMES sqlite3.connect(database[, timeout, detect_types, isolation_level, check_same_thread, factory, cached_statements, uri]) è¿žæŽ¥ SQLite æ•°æ®åº“ databaseã€‚é»˜è®¤è¿”å›ž Connection å¯¹è±¡ï¼Œé™¤éžä½¿ç”¨äº†è‡ªå®šä¹‰çš„ factory å‚æ•°ã€‚ database æ˜¯å‡†å¤‡æ‰“å¼€çš„æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹äºŽå½“å‰ç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼‰ï¼Œå®ƒæ˜¯ path-like objectã€‚ä½ ä¹Ÿå¯ä»¥ç”¨ &quot;:memory:&quot; åœ¨å†…å­˜ä¸­æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“ã€‚ å½“ä¸€ä¸ªæ•°æ®åº“è¢«å¤šä¸ªè¿žæŽ¥è®¿é—®çš„æ—¶å€™ï¼Œå¦‚æžœå…¶ä¸­ä¸€ä¸ªè¿›ç¨‹ä¿®æ”¹è¿™ä¸ªæ•°æ®åº“ï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡æäº¤ä¹‹å‰ï¼Œè¿™ä¸ª SQLite æ•°æ®åº“å°†ä¼šè¢«ä¸€ç›´é”å®šã€‚timeout å‚æ•°æŒ‡å®šäº†è¿™ä¸ªè¿žæŽ¥ç­‰å¾…é”é‡Šæ”¾çš„è¶…æ—¶æ—¶é—´ï¼Œè¶…æ—¶ä¹‹åŽä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ã€‚è¿™ä¸ªè¶…æ—¶æ—¶é—´é»˜è®¤æ˜¯ 5.0ï¼ˆ5ç§’ï¼‰ã€‚ isolation_level å‚æ•°ï¼Œè¯·æŸ¥çœ‹ Connection å¯¹è±¡çš„ isolation_level å±žæ€§ã€‚ SQLite åŽŸç”Ÿåªæ”¯æŒ5ç§ç±»åž‹ï¼šTEXTï¼ŒINTEGERï¼ŒREALï¼ŒBLOB å’Œ NULLã€‚å¦‚æžœä½ æƒ³ç”¨å…¶å®ƒç±»åž‹ï¼Œä½ å¿…é¡»è‡ªå·±æ·»åŠ ç›¸åº”çš„æ”¯æŒã€‚ä½¿ç”¨ detect_types å‚æ•°å’Œæ¨¡å—çº§åˆ«çš„ register_converter() å‡½æ•°æ³¨å†Œè½¬æ¢å™¨ å¯ä»¥ç®€å•çš„å®žçŽ°ã€‚ detect_types é»˜è®¤ä¸º0ï¼ˆå³å…³é—­ï¼Œæ²¡æœ‰ç±»åž‹æ£€æµ‹ï¼‰ã€‚ä½ ä¹Ÿå¯ä»¥ç»„åˆ PARSE_DECLTYPES å’Œ PARSE_COLNAMES æ¥å¼€å¯ç±»åž‹æ£€æµ‹ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œcheck_same_thread ä¸º Trueï¼Œåªæœ‰å½“å‰çš„çº¿ç¨‹å¯ä»¥ä½¿ç”¨è¯¥è¿žæŽ¥ã€‚ å¦‚æžœè®¾ç½®ä¸º Falseï¼Œåˆ™å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«è¿”å›žçš„è¿žæŽ¥ã€‚ å½“å¤šä¸ªçº¿ç¨‹ä½¿ç”¨åŒä¸€ä¸ªè¿žæŽ¥çš„æ—¶å€™ï¼Œç”¨æˆ·åº”è¯¥æŠŠå†™æ“ä½œè¿›è¡Œåºåˆ—åŒ–ï¼Œä»¥é¿å…æ•°æ®æŸåã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“è°ƒç”¨ connect æ–¹æ³•çš„æ—¶å€™ï¼Œsqlite3 æ¨¡å—ä½¿ç”¨äº†å®ƒçš„ Connection ç±»ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»º Connection ç±»çš„å­ç±»ï¼Œç„¶åŽåˆ›å»ºæä¾›äº† factory å‚æ•°çš„ connect() æ–¹æ³•ã€‚ è¯¦æƒ…è¯·æŸ¥é˜…å½“å‰æ‰‹å†Œçš„ SQLite ä¸Ž Python ç±»åž‹ éƒ¨åˆ†ã€‚ sqlite3 æ¨¡å—åœ¨å†…éƒ¨ä½¿ç”¨è¯­å¥ç¼“å­˜æ¥é¿å… SQL è§£æžå¼€é”€ã€‚ å¦‚æžœè¦æ˜¾å¼è®¾ç½®å½“å‰è¿žæŽ¥å¯ä»¥ç¼“å­˜çš„è¯­å¥æ•°ï¼Œå¯ä»¥è®¾ç½® cached_statements å‚æ•°ã€‚ å½“å‰å®žçŽ°çš„é»˜è®¤å€¼æ˜¯ç¼“å­˜100æ¡è¯­å¥ã€‚ å¦‚æžœ uri ä¸ºçœŸï¼Œåˆ™ database è¢«è§£é‡Šä¸º URIã€‚ å®ƒå…è®¸æ‚¨æŒ‡å®šé€‰é¡¹ã€‚ ä¾‹å¦‚ï¼Œä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ•°æ®åº“ï¼š 1db = sqlite3.connect('file:path/to/database?mode=ro', uri=True) æœ‰å…³æ­¤åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬å·²çŸ¥é€‰é¡¹çš„åˆ—è¡¨ï¼Œå¯ä»¥åœ¨ SQLite URI æ–‡æ¡£ &lt;&lt;https://www.sqlite.org/uri.html&gt;&gt;_ ä¸­æ‰¾åˆ°ã€‚ sqlite3.register_converter(typename, callable) æ³¨å†Œä¸€ä¸ªå›žè°ƒå¯¹è±¡ callable, ç”¨æ¥è½¬æ¢æ•°æ®åº“ä¸­çš„å­—èŠ‚ä¸²ä¸ºè‡ªå®šçš„ Python ç±»åž‹ã€‚æ‰€æœ‰ç±»åž‹ä¸º typename çš„æ•°æ®åº“çš„å€¼åœ¨è½¬æ¢æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨è¿™ä¸ªå›žè°ƒå¯¹è±¡ã€‚é€šè¿‡æŒ‡å®š connect() å‡½æ•°çš„ detect-types å‚æ•°æ¥è®¾ç½®ç±»åž‹æ£€æµ‹çš„æ–¹å¼ã€‚æ³¨æ„ï¼Œtypename ä¸ŽæŸ¥è¯¢è¯­å¥ä¸­çš„ç±»åž‹åè¿›è¡ŒåŒ¹é…æ—¶ä¸åŒºåˆ†å¤§å°å†™ã€‚ sqlite3.register_adapter(type, callable) æ³¨å†Œä¸€ä¸ªå›žè°ƒå¯¹è±¡ callableï¼Œç”¨æ¥è½¬æ¢è‡ªå®šä¹‰Pythonç±»åž‹ä¸ºä¸€ä¸ª SQLite æ”¯æŒçš„ç±»åž‹ã€‚ è¿™ä¸ªå›žè°ƒå¯¹è±¡ callable ä»…æŽ¥å—ä¸€ä¸ª Python å€¼ä½œä¸ºå‚æ•°ï¼Œè€Œä¸”å¿…é¡»è¿”å›žä»¥ä¸‹æŸä¸ªç±»åž‹çš„å€¼ï¼šintï¼Œfloatï¼Œstr æˆ– bytesã€‚ sqlite3.complete_statement(sql) å¦‚æžœå­—ç¬¦ä¸² sql åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®Œæ•´çš„ SQL è¯­å¥ï¼ˆä»¥åˆ†å·ç»“æŸï¼‰åˆ™è¿”å›ž Trueã€‚å®ƒä¸ä¼šéªŒè¯ SQL è¯­æ³•æ˜¯å¦æ­£ç¡®ï¼Œä»…ä¼šéªŒè¯å­—ç¬¦ä¸²å­—é¢ä¸Šæ˜¯å¦å®Œæ•´ï¼Œä»¥åŠæ˜¯å¦ä»¥åˆ†å·ç»“æŸã€‚ å®ƒå¯ä»¥ç”¨æ¥æž„å»ºä¸€ä¸ª SQLite shellï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930# A minimal SQLite shell for experimentsimport sqlite3con = sqlite3.connect(":memory:")con.isolation_level = Nonecur = con.cursor()buffer = ""print("Enter your SQL commands to execute in sqlite3.")print("Enter a blank line to exit.")while True: line = input() if line == "": break buffer += line if sqlite3.complete_statement(buffer): try: buffer = buffer.strip() cur.execute(buffer) if buffer.lstrip().upper().startswith("SELECT"): print(cur.fetchall()) except sqlite3.Error as e: print("An error occurred:", e.args[0]) buffer = ""con.close() sqlite3.enable_callback_tracebacks(flag) é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨ä¸ä¼šèŽ·å¾—ä»»ä½•ç”¨æˆ·å®šä¹‰å‡½æ•°ä¸­çš„å›žæº¯æ¶ˆæ¯ï¼Œæ¯”å¦‚èšåˆï¼Œè½¬æ¢å™¨ï¼ŒæŽˆæƒå™¨å›žè°ƒç­‰ã€‚å¦‚æžœè¦è°ƒè¯•å®ƒä»¬ï¼Œå¯ä»¥è®¾ç½® flag å‚æ•°ä¸º True å¹¶è°ƒç”¨æ­¤å‡½æ•°ã€‚ ä¹‹åŽï¼Œå›žè°ƒä¸­çš„å›žæº¯ä¿¡æ¯å°†ä¼šè¾“å‡ºåˆ° sys.stderrã€‚ å†æ¬¡ä½¿ç”¨ False æ¥ç¦ç”¨è¯¥åŠŸèƒ½ã€‚ è¿žæŽ¥å¯¹è±¡ï¼ˆConnectionï¼‰ class sqlite3.Connection SQLite æ•°æ®åº“è¿žæŽ¥å¯¹è±¡æœ‰å¦‚ä¸‹çš„å±žæ€§å’Œæ–¹æ³•ï¼š isolation_level èŽ·å–æˆ–è®¾ç½®å½“å‰é»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚ è¡¨ç¤ºè‡ªåŠ¨æäº¤æ¨¡å¼çš„ None ä»¥åŠ â€œDEFERREDâ€, â€œIMMEDIATEâ€ æˆ– â€œEXCLUSIVEâ€ å…¶ä¸­ä¹‹ä¸€ã€‚ è¯¦ç»†æè¿°è¯·å‚é˜… æŽ§åˆ¶äº‹åŠ¡ã€‚ in_transaction å¦‚æžœæ˜¯åœ¨æ´»åŠ¨äº‹åŠ¡ä¸­ï¼ˆè¿˜æ²¡æœ‰æäº¤æ”¹å˜ï¼‰ï¼Œè¿”å›ž Trueï¼Œå¦åˆ™ï¼Œè¿”å›ž Falseã€‚å®ƒæ˜¯ä¸€ä¸ªåªè¯»å±žæ€§ã€‚3.2 æ–°ç‰ˆåŠŸèƒ½. cursor(factory=Cursor) è¿™ä¸ªæ–¹æ³•æŽ¥å—ä¸€ä¸ªå¯é€‰å‚æ•° factoryï¼Œå¦‚æžœè¦æŒ‡å®šè¿™ä¸ªå‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œè€Œä¸”å¿…é¡»è¿”å›ž Cursor ç±»çš„ä¸€ä¸ªå®žä¾‹æˆ–è€…å­ç±»ã€‚ commit() è¿™ä¸ªæ–¹æ³•æäº¤å½“å‰äº‹åŠ¡ã€‚å¦‚æžœæ²¡æœ‰è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆä»Žä¸Šä¸€æ¬¡æäº¤ commit() ä»¥æ¥æ‰€æœ‰çš„å˜åŒ–åœ¨å…¶ä»–æ•°æ®åº“è¿žæŽ¥ä¸Šéƒ½æ˜¯ä¸å¯è§çš„ã€‚å¦‚æžœä½ å¾€æ•°æ®åº“é‡Œå†™äº†æ•°æ®ï¼Œä½†æ˜¯åˆæŸ¥è¯¢ä¸åˆ°ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å¿˜è®°äº†è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ rollback() è¿™ä¸ªæ–¹æ³•å›žæ»šä»Žä¸Šä¸€æ¬¡è°ƒç”¨ commit() ä»¥æ¥æ‰€æœ‰æ•°æ®åº“çš„æ”¹å˜ã€‚ close() å…³é—­æ•°æ®åº“è¿žæŽ¥ã€‚æ³¨æ„ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨è°ƒç”¨ commit() æ–¹æ³•ã€‚å¦‚æžœåœ¨å…³é—­æ•°æ®åº“è¿žæŽ¥ä¹‹å‰æ²¡æœ‰è°ƒç”¨ commit()ï¼Œé‚£ä¹ˆä½ çš„ä¿®æ”¹å°†ä¼šä¸¢å¤±ï¼ execute(sql[, parameters]) è¿™æ˜¯ä¸€ä¸ªéžæ ‡å‡†çš„å¿«æ·æ–¹æ³•ï¼Œå®ƒä¼šè°ƒç”¨ cursor() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ç»™å®šçš„ parameters å‚æ•°æ¥è°ƒç”¨æ¸¸æ ‡å¯¹è±¡çš„ execute() æ–¹æ³•ï¼Œæœ€åŽè¿”å›žè¿™ä¸ªæ¸¸æ ‡å¯¹è±¡ã€‚ executemany(sql[, parameters]) è¿™æ˜¯ä¸€ä¸ªéžæ ‡å‡†çš„å¿«æ·æ–¹æ³•ï¼Œå®ƒä¼šè°ƒç”¨ cursor() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ç»™å®šçš„ parameters å‚æ•°æ¥è°ƒç”¨æ¸¸æ ‡å¯¹è±¡çš„ executemany() æ–¹æ³•ï¼Œæœ€åŽè¿”å›žè¿™ä¸ªæ¸¸æ ‡å¯¹è±¡ã€‚ executescript(sql_script) è¿™æ˜¯ä¸€ä¸ªéžæ ‡å‡†çš„å¿«æ·æ–¹æ³•ï¼Œå®ƒä¼šè°ƒç”¨ cursor() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ç»™å®šçš„ sql_script å‚æ•°æ¥è°ƒç”¨æ¸¸æ ‡å¯¹è±¡çš„ executescript() æ–¹æ³•ï¼Œæœ€åŽè¿”å›žè¿™ä¸ªæ¸¸æ ‡å¯¹è±¡ã€‚ create_function(name, num_params, func, **, deterministic=False*) åˆ›å»ºä¸€ä¸ªå¯ä»¥åœ¨ SQL è¯­å¥ä¸­ä½¿ç”¨çš„ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œå‡½æ•°åä¸º nameã€‚ num_params ä¸ºè¯¥å‡½æ•°æ‰€æŽ¥å—çš„å½¢å‚ä¸ªæ•°ï¼ˆå¦‚æžœ num_params ä¸º -1ï¼Œåˆ™è¯¥å‡½æ•°å¯æŽ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ï¼‰ï¼Œ func æ˜¯ä¸€ä¸ª Python å¯è°ƒç”¨å¯¹è±¡ï¼Œå®ƒå°†ä½œä¸º SQL å‡½æ•°è¢«è°ƒç”¨ã€‚ å¦‚æžœ deterministic ä¸ºçœŸå€¼ï¼Œåˆ™æ‰€åˆ›å»ºçš„å‡½æ•°å°†è¢«æ ‡è®°ä¸º deterministicï¼Œè¿™å…è®¸ SQLite æ‰§è¡Œé¢å¤–çš„ä¼˜åŒ–ã€‚ æ­¤æ——æ ‡åœ¨ SQLite 3.8.3 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­å—åˆ°æ”¯æŒï¼Œå¦‚æžœåœ¨æ—§ç‰ˆæœ¬ä¸­ä½¿ç”¨å°†å¼•å‘ NotSupportedErrorã€‚æ­¤å‡½æ•°å¯è¿”å›žä»»ä½• SQLite æ‰€æ”¯æŒçš„ç±»åž‹: bytes, str, int, float å’Œ Noneã€‚åœ¨ 3.8 ç‰ˆæ›´æ”¹: å¢žåŠ äº† deterministic å½¢å‚ã€‚ç¤ºä¾‹: 12345678910111213import sqlite3import hashlibdef md5sum(t): return hashlib.md5(t).hexdigest()con = sqlite3.connect(":memory:")con.create_function("md5", 1, md5sum)cur = con.cursor()cur.execute("select md5(?)", (b"foo",))print(cur.fetchone()[0])con.close() create_aggregate(name, num_params, aggregate_class) åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„èšåˆå‡½æ•°ã€‚ å‚æ•°ä¸­ aggregate_class ç±»å¿…é¡»å®žçŽ°ä¸¤ä¸ªæ–¹æ³•ï¼šstep å’Œ finalizeã€‚step æ–¹æ³•æŽ¥å— num_params ä¸ªå‚æ•°ï¼ˆå¦‚æžœ num_params ä¸º -1ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å¯ä»¥æŽ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ï¼‰ï¼›finalize æ–¹æ³•è¿”å›žæœ€ç»ˆçš„èšåˆç»“æžœã€‚ finalize æ–¹æ³•å¯ä»¥è¿”å›žä»»ä½• SQLite æ”¯æŒçš„ç±»åž‹ï¼šbytesï¼Œstrï¼Œintï¼Œfloat å’Œ Noneã€‚ ç¤ºä¾‹: 12345678910111213141516171819202122import sqlite3class MySum: def __init__(self): self.count = 0 def step(self, value): self.count += value def finalize(self): return self.countcon = sqlite3.connect(":memory:")con.create_aggregate("mysum", 1, MySum)cur = con.cursor()cur.execute("create table test(i)")cur.execute("insert into test(i) values (1)")cur.execute("insert into test(i) values (2)")cur.execute("select mysum(i) from test")print(cur.fetchone()[0])con.close() create_collation(name, callable) ä½¿ç”¨ name å’Œ callable åˆ›å»ºæŽ’åºè§„åˆ™ã€‚è¿™ä¸ª callable æŽ¥å—ä¸¤ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå°äºŽç¬¬äºŒä¸ªåˆ™è¿”å›ž -1ï¼Œ å¦‚æžœä¸¤ä¸ªç›¸ç­‰åˆ™è¿”å›ž 0ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå¤§äºŽç¬¬äºŒä¸ªåˆ™è¿”å›ž 1ã€‚æ³¨æ„ï¼Œè¿™æ˜¯ç”¨æ¥æŽ§åˆ¶æŽ’åºçš„ï¼ˆSQL ä¸­çš„ ORDER BYï¼‰ï¼Œæ‰€ä»¥å®ƒä¸ä¼šå½±å“å…¶å®ƒçš„ SQL æ“ä½œã€‚ æ³¨æ„ï¼Œè¿™ä¸ª callable å¯è°ƒç”¨å¯¹è±¡ä¼šæŠŠå®ƒçš„å‚æ•°ä½œä¸º Python å­—èŠ‚ä¸²ï¼Œé€šå¸¸ä¼šä»¥ UTF-8 ç¼–ç æ ¼å¼å¯¹å®ƒè¿›è¡Œç¼–ç ã€‚ ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†ä½¿ç”¨â€œé”™è¯¯æ–¹å¼â€è¿›è¡ŒæŽ’åºçš„è‡ªå®šä¹‰æŽ’åºè§„åˆ™ï¼š 1234567891011121314151617181920import sqlite3def collate_reverse(string1, string2): if string1 == string2: return 0 elif string1 &lt; string2: return 1 else: return -1con = sqlite3.connect(":memory:")con.create_collation("reverse", collate_reverse)cur = con.cursor()cur.execute("create table test(x)")cur.executemany("insert into test(x) values (?)", [("a",), ("b",)])cur.execute("select x from test order by x collate reverse")for row in cur: print(row)con.close() è¦ç§»é™¤ä¸€ä¸ªæŽ’åºè§„åˆ™ï¼Œéœ€è¦è°ƒç”¨ create_collation å¹¶è®¾ç½® callable å‚æ•°ä¸º Noneã€‚ 1con.create_collation("reverse", None) interrupt() å¯ä»¥ä»Žä¸åŒçš„çº¿ç¨‹è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥ç»ˆæ­¢æ‰€æœ‰æŸ¥è¯¢æ“ä½œï¼Œè¿™äº›æŸ¥è¯¢æ“ä½œå¯èƒ½æ­£åœ¨è¿žæŽ¥ä¸Šæ‰§è¡Œã€‚æ­¤æ–¹æ³•è°ƒç”¨ä¹‹åŽï¼Œ æŸ¥è¯¢å°†ä¼šç»ˆæ­¢ï¼Œè€Œä¸”æŸ¥è¯¢çš„è°ƒç”¨è€…ä¼šèŽ·å¾—ä¸€ä¸ªå¼‚å¸¸ã€‚ set_authorizer(authorizer_callback) æ­¤æ–¹æ³•æ³¨å†Œä¸€ä¸ªæŽˆæƒå›žè°ƒå¯¹è±¡ã€‚æ¯æ¬¡åœ¨è®¿é—®æ•°æ®åº“ä¸­æŸä¸ªè¡¨çš„æŸä¸€åˆ—çš„æ—¶å€™ï¼Œè¿™ä¸ªå›žè°ƒå¯¹è±¡å°†ä¼šè¢«è°ƒç”¨ã€‚å¦‚æžœè¦å…è®¸è®¿é—®ï¼Œåˆ™è¿”å›ž SQLITE_OKï¼Œå¦‚æžœè¦ç»ˆæ­¢æ•´ä¸ª SQL è¯­å¥ï¼Œåˆ™è¿”å›ž SQLITE_DENYï¼Œå¦‚æžœè¿™ä¸€åˆ—éœ€è¦å½“åš NULL å€¼å¤„ç†ï¼Œåˆ™è¿”å›ž SQLITE_IGNOREã€‚è¿™äº›å¸¸é‡å¯ä»¥åœ¨ sqlite3 æ¨¡å—ä¸­æ‰¾åˆ°ã€‚å›žè°ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¦æŽˆæƒçš„æ“ä½œç±»åž‹ã€‚ ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°å°†æ˜¯å‚æ•°æˆ– Noneï¼Œå…·ä½“å–å†³äºŽç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ã€‚ ç¬¬ 4 ä¸ªå‚æ•°æ˜¯æ•°æ®åº“çš„åç§°ï¼ˆâ€œmainâ€ï¼Œâ€œtempâ€ç­‰ï¼‰ï¼Œå¦‚æžœéœ€è¦çš„è¯ã€‚ ç¬¬ 5 ä¸ªå‚æ•°æ˜¯è´Ÿè´£è®¿é—®å°è¯•çš„æœ€å†…å±‚è§¦å‘å™¨æˆ–è§†å›¾çš„åç§°ï¼Œæˆ–è€…å¦‚æžœæ­¤è®¿é—®å°è¯•ç›´æŽ¥æ¥è‡ªè¾“å…¥ SQL ä»£ç ï¼Œåˆ™ä¸º Noneã€‚è¯·å‚é˜… SQLite æ–‡æ¡£ï¼Œäº†è§£ç¬¬ä¸€ä¸ªå‚æ•°çš„å¯èƒ½å€¼ä»¥åŠç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°çš„å«ä¹‰ï¼Œå…·ä½“å–å†³äºŽç¬¬ä¸€ä¸ªå‚æ•°ã€‚ æ‰€æœ‰å¿…éœ€çš„å¸¸é‡éƒ½å¯ä»¥åœ¨ sqlite3 æ¨¡å—ä¸­æ‰¾åˆ°ã€‚ set_progress_handler(handler, n) æ­¤ä¾‹ç¨‹æ³¨å†Œå›žè°ƒã€‚ å¯¹SQLiteè™šæ‹Ÿæœºçš„æ¯ä¸ªå¤šæŒ‡ä»¤è°ƒç”¨å›žè°ƒã€‚ å¦‚æžœè¦åœ¨é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œæœŸé—´ä»ŽSQLiteè°ƒç”¨ï¼ˆä¾‹å¦‚æ›´æ–°ç”¨æˆ·ç•Œé¢ï¼‰ï¼Œè¿™éžå¸¸æœ‰ç”¨ã€‚å¦‚æžœè¦æ¸…é™¤ä»¥å‰å®‰è£…çš„ä»»ä½•è¿›åº¦å¤„ç†ç¨‹åºï¼Œè°ƒç”¨è¯¥æ–¹æ³•æ—¶è¯·å°† handler å‚æ•°è®¾ç½®ä¸º Noneã€‚ä»Žå¤„ç†å‡½æ•°è¿”å›žéžé›¶å€¼å°†ç»ˆæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„æŸ¥è¯¢å¹¶å¯¼è‡´å®ƒå¼•å‘ OperationalError å¼‚å¸¸ã€‚ set_trace_callback(trace_callback) ä¸ºæ¯ä¸ª SQLite åŽç«¯å®žé™…æ‰§è¡Œçš„ SQL è¯­å¥æ³¨å†Œè¦è°ƒç”¨çš„ trace_callbackã€‚ä¼ é€’ç»™å›žè°ƒçš„å”¯ä¸€å‚æ•°æ˜¯æ­£åœ¨æ‰§è¡Œçš„è¯­å¥ï¼ˆä½œä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚ å›žè°ƒçš„è¿”å›žå€¼å°†è¢«å¿½ç•¥ã€‚ è¯·æ³¨æ„ï¼ŒåŽç«¯ä¸ä»…è¿è¡Œä¼ é€’ç»™ Cursor.execute() æ–¹æ³•çš„è¯­å¥ã€‚ å…¶ä»–æ¥æºåŒ…æ‹¬ Python æ¨¡å—çš„äº‹åŠ¡ç®¡ç†å’Œå½“å‰æ•°æ®åº“ä¸­å®šä¹‰çš„è§¦å‘å™¨çš„æ‰§è¡Œã€‚å°†ä¼ å…¥çš„ trace_callback è®¾ä¸º None å°†ç¦ç”¨è·Ÿè¸ªå›žè°ƒã€‚ enable_load_extension(enabled) æ­¤ä¾‹ç¨‹å…è®¸/ç¦æ­¢SQLiteå¼•æ“Žä»Žå…±äº«åº“åŠ è½½SQLiteæ‰©å±•ã€‚ SQLiteæ‰©å±•å¯ä»¥å®šä¹‰æ–°åŠŸèƒ½ï¼Œèšåˆæˆ–å…¨æ–°çš„è™šæ‹Ÿè¡¨å®žçŽ°ã€‚ ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„æ‰©å±•æ˜¯ä¸ŽSQLiteä¸€èµ·åˆ†å‘çš„å…¨æ–‡æœç´¢æ‰©å±•ã€‚ é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨å¯åŠ è½½æ‰©å±•ã€‚ 12345678910111213141516171819202122232425262728import sqlite3con = sqlite3.connect(":memory:")# enable extension loadingcon.enable_load_extension(True)# Load the fulltext search extensioncon.execute("select load_extension('./fts3.so')")# alternatively you can load the extension using an API call:# con.load_extension("./fts3.so")# disable extension loading againcon.enable_load_extension(False)# example from SQLite wikicon.execute("create virtual table recipe using fts3(name, ingredients)")con.executescript(""" insert into recipe (name, ingredients) values ('broccoli stew', 'broccoli peppers cheese tomatoes'); insert into recipe (name, ingredients) values ('pumpkin stew', 'pumpkin onions garlic celery'); insert into recipe (name, ingredients) values ('broccoli pie', 'broccoli cheese onions flour'); insert into recipe (name, ingredients) values ('pumpkin pie', 'pumpkin sugar flour butter'); """)for row in con.execute("select rowid, name, ingredients from recipe where name match 'pie'"): print(row)con.close() load_extension(path) æ­¤ä¾‹ç¨‹ä»Žå…±äº«åº“åŠ è½½SQLiteæ‰©å±•ã€‚ åœ¨ä½¿ç”¨æ­¤ä¾‹ç¨‹ä¹‹å‰ï¼Œå¿…é¡»ä½¿ç”¨ enable_load_extension() å¯ç”¨æ‰©å±•åŠ è½½ã€‚ é»˜è®¤æƒ…å†µä¸‹ç¦ç”¨å¯åŠ è½½æ‰©å±•ã€‚ row_factoryæ‚¨å¯ä»¥å°†æ­¤å±žæ€§æ›´æ”¹ä¸ºå¯æŽ¥å—æ¸¸æ ‡å’ŒåŽŸå§‹è¡Œä½œä¸ºå…ƒç»„çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶å°†è¿”å›žå®žé™…ç»“æžœè¡Œã€‚ è¿™æ ·ï¼Œæ‚¨å¯ä»¥å®žçŽ°æ›´é«˜çº§çš„è¿”å›žç»“æžœçš„æ–¹æ³•ï¼Œä¾‹å¦‚è¿”å›žä¸€ä¸ªå¯ä»¥æŒ‰åç§°è®¿é—®åˆ—çš„å¯¹è±¡ã€‚ç¤ºä¾‹: 1234567891011121314def dict_factory(cursor, row): d = &#123;&#125; for idx, col in enumerate(cursor.description): d[col[0]] = row[idx] return dcon = sqlite3.connect(":memory:")con.row_factory = dict_factorycur = con.cursor()cur.execute("select 1 as a")print(cur.fetchone()["a"]) con.close() å¦‚æžœè¿”å›žä¸€ä¸ªå…ƒç»„æ˜¯ä¸å¤Ÿçš„ï¼Œå¹¶ä¸”ä½ æƒ³è¦å¯¹åˆ—è¿›è¡ŒåŸºäºŽåç§°çš„è®¿é—®ï¼Œä½ åº”è¯¥è€ƒè™‘å°† row_factory è®¾ç½®ä¸ºé«˜åº¦ä¼˜åŒ–çš„ sqlite3.Row ç±»åž‹ã€‚ Row æä¾›åŸºäºŽç´¢å¼•å’Œä¸åŒºåˆ†å¤§å°å†™çš„åŸºäºŽåç§°çš„è®¿é—®ï¼Œå‡ ä¹Žæ²¡æœ‰å†…å­˜å¼€é”€ã€‚ å®ƒå¯èƒ½æ¯”æ‚¨è‡ªå·±çš„åŸºäºŽå­—å…¸çš„è‡ªå®šä¹‰æ–¹æ³•ç”šè‡³åŸºäºŽ db_row çš„è§£å†³æ–¹æ¡ˆæ›´å¥½ã€‚ text_factory ä½¿ç”¨æ­¤å±žæ€§å¯ä»¥æŽ§åˆ¶ä¸º TEXT æ•°æ®ç±»åž‹è¿”å›žçš„å¯¹è±¡ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤å±žæ€§è®¾ç½®ä¸º str å’Œ sqlite3 æ¨¡å—å°†è¿”å›ž TEXT çš„ Unicode å¯¹è±¡ã€‚ å¦‚æžœè¦è¿”å›žå­—èŠ‚ä¸²ï¼Œå¯ä»¥å°†å…¶è®¾ç½®ä¸º bytesã€‚ æ‚¨è¿˜å¯ä»¥å°†å…¶è®¾ç½®ä¸ºæŽ¥å—å•ä¸ª bytestring å‚æ•°çš„ä»»ä½•å…¶ä»–å¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶è¿”å›žç»“æžœå¯¹è±¡ã€‚ è¯·å‚é˜…ä»¥ä¸‹ç¤ºä¾‹ä»£ç ä»¥è¿›è¡Œè¯´æ˜Žï¼š 1234567891011121314151617181920212223242526272829import sqlite3con = sqlite3.connect(":memory:")cur = con.cursor()AUSTRIA = "\xd6sterreich"# by default, rows are returned as Unicodecur.execute("select ?", (AUSTRIA,))row = cur.fetchone()assert row[0] == AUSTRIA# but we can make sqlite3 always return bytestrings ...con.text_factory = bytescur.execute("select ?", (AUSTRIA,))row = cur.fetchone()assert type(row[0]) is bytes# the bytestrings will be encoded in UTF-8, unless you stored garbage in the# database ...assert row[0] == AUSTRIA.encode("utf-8")# we can also implement a custom text_factory ...# here we implement one that appends "foo" to all stringscon.text_factory = lambda x: x.decode("utf-8") + "foo"cur.execute("select ?", ("bar",))row = cur.fetchone()assert row[0] == "barfoo"con.close() total_changes è¿”å›žè‡ªæ‰“å¼€æ•°æ®åº“è¿žæŽ¥ä»¥æ¥å·²ä¿®æ”¹ï¼Œæ’å…¥æˆ–åˆ é™¤çš„æ•°æ®åº“è¡Œçš„æ€»æ•°ã€‚ iterdump() è¿”å›žä»¥SQLæ–‡æœ¬æ ¼å¼è½¬å‚¨æ•°æ®åº“çš„è¿­ä»£å™¨ã€‚ ä¿å­˜å†…å­˜æ•°æ®åº“ä»¥ä¾¿ä»¥åŽæ¢å¤æ—¶å¾ˆæœ‰ç”¨ã€‚ æ­¤å‡½æ•°æä¾›ä¸Ž sqlite3 shell ä¸­çš„ .dump å‘½ä»¤ç›¸åŒçš„åŠŸèƒ½ã€‚ ç¤ºä¾‹: 12345678# Convert file existing_db.db to SQL dump file dump.sqlimport sqlite3con = sqlite3.connect('existing_db.db')with open('dump.sql', 'w') as f: for line in con.iterdump(): f.write('%s\n' % line)con.close() backup(target, **, pages=0, progress=None, name=â€mainâ€, sleep=0.250*) å³ä½¿åœ¨ SQLite æ•°æ®åº“è¢«å…¶ä»–å®¢æˆ·ç«¯è®¿é—®æ—¶ï¼Œæˆ–è€…åŒæ—¶ç”±åŒä¸€è¿žæŽ¥è®¿é—®ï¼Œè¯¥æ–¹æ³•ä¹Ÿä¼šå¯¹å…¶è¿›è¡Œå¤‡ä»½ã€‚ è¯¥å‰¯æœ¬å°†å†™å…¥å¼ºåˆ¶å‚æ•° targetï¼Œè¯¥å‚æ•°å¿…é¡»æ˜¯å¦ä¸€ä¸ª Connection å®žä¾‹ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ–è€…å½“ pages ä¸º 0 æˆ–è´Ÿæ•´æ•°æ—¶ï¼Œæ•´ä¸ªæ•°æ®åº“å°†åœ¨ä¸€ä¸ªæ­¥éª¤ä¸­å¤åˆ¶ï¼›å¦åˆ™è¯¥æ–¹æ³•ä¸€æ¬¡å¾ªçŽ¯å¤åˆ¶ pages è§„å®šæ•°é‡çš„é¡µé¢ã€‚ ç¤ºä¾‹ä¸€ï¼Œå°†çŽ°æœ‰æ•°æ®åº“å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°æ®åº“ä¸­ï¼š 1234567891011import sqlite3def progress(status, remaining, total): print(f'Copied &#123;total-remaining&#125; of &#123;total&#125; pages...')con = sqlite3.connect('existing_db.db')bck = sqlite3.connect('backup.db')with bck: con.backup(bck, pages=1, progress=progress)bck.close()con.close() ç¤ºä¾‹äºŒï¼Œå°†çŽ°æœ‰æ•°æ®åº“å¤åˆ¶åˆ°ä¸´æ—¶å‰¯æœ¬ä¸­ï¼š 12345import sqlite3source = sqlite3.connect('existing_db.db')dest = sqlite3.connect(':memory:')source.backup(dest) å¯ç”¨æ€§ï¼šSQLite 3.6.11 æˆ–ä»¥ä¸Šç‰ˆæœ¬ Cursor å¯¹è±¡ class sqlite3.Cursor Cursor æ¸¸æ ‡å®žä¾‹å…·æœ‰ä»¥ä¸‹å±žæ€§å’Œæ–¹æ³•ã€‚ execute(sql[, parameters]) æ‰§è¡ŒSQLè¯­å¥ã€‚ å¯ä»¥æ˜¯å‚æ•°åŒ– SQL è¯­å¥ï¼ˆå³ï¼Œåœ¨ SQL è¯­å¥ä¸­ä½¿ç”¨å ä½ç¬¦ï¼‰ã€‚sqlite3 æ¨¡å—æ”¯æŒä¸¤ç§å ä½ç¬¦ï¼šé—®å·ï¼ˆqmarké£Žæ ¼ï¼‰å’Œå‘½åå ä½ç¬¦ï¼ˆå‘½åé£Žæ ¼ï¼‰ã€‚ä»¥ä¸‹æ˜¯ä¸¤ç§é£Žæ ¼çš„ç¤ºä¾‹ï¼š 123456789101112131415161718import sqlite3con = sqlite3.connect(":memory:")cur = con.cursor()cur.execute("create table people (name_last, age)")who = "Yeltsin"age = 72# This is the qmark style:cur.execute("insert into people values (?, ?)", (who, age))# And this is the named style:cur.execute("select * from people where name_last=:who and age=:age", &#123;"who": who, "age": age&#125;)print(cur.fetchone())con.close() execute() will only execute a single SQL statement. If you try to execute more than one statement with it, it will raise a Warning. Use executescript() if you want to execute multiple SQL statements with one call. executemany(sql, seq_of_parameters) é€šè¿‡æ‰€æœ‰å‚æ•°åºåˆ—æˆ–è€…æ˜ å°„å‚æ•° æ‰§è¡ŒSQL å‘½ä»¤,åŒæ—¶æ”¯æŒä½¿ç”¨iterator(å¯è¿­ä»£å¯¹è±¡) yieldç±»åž‹ç”Ÿæˆå‚æ•°ä»£æ›¿åºåˆ—ã€‚ 1234567891011121314151617181920212223242526import sqlite3class IterChars: def __init__(self): self.count = ord('a') def __iter__(self): return self def __next__(self): if self.count &gt; ord('z'): raise StopIteration self.count += 1 return (chr(self.count - 1),) # this is a 1-tuplecon = sqlite3.connect(":memory:")cur = con.cursor()cur.execute("create table characters(c)")theIter = IterChars()cur.executemany("insert into characters(c) values (?)", theIter)cur.execute("select c from characters")print(cur.fetchall())con.close() è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ç”Ÿæˆå™¨ generator çš„ç®€çŸ­ç¤ºä¾‹ï¼š 1234567891011121314151617import sqlite3import stringdef char_generator(): for c in string.ascii_lowercase: yield (c,)con = sqlite3.connect(":memory:")cur = con.cursor()cur.execute("create table characters(c)")cur.executemany("insert into characters(c) values (?)", char_generator())cur.execute("select c from characters")print(cur.fetchall())con.close() executescript(sql_script) è¿™æ˜¯ä¸€ä¸ªéžæ ‡å‡†æ–¹å¼æ‰§è¡Œsqlè¯­å¥çš„æ–¹æ³•,å®ƒé¦–å…ˆæ‰§è¡ŒCOMMITè¯­å¥,ç„¶åŽæ‰§è¡Œä½œä¸ºå‚æ•°ä¼ é€’è€Œæ¥çš„SQLè¯­å¥ã€‚ 12345678910111213141516171819202122232425import sqlite3con = sqlite3.connect(":memory:")cur = con.cursor()cur.executescript(""" create table person( firstname, lastname, age ); create table book( title, author, published ); insert into book(title, author, published) values ( 'Dirk Gently''s Holistic Detective Agency', 'Douglas Adams', 1987 ); """)con.close() fetchone() èŽ·å–æŸ¥è¯¢è¯­å¥ç»“æžœä¸­çš„ä¸€æ¡è®°å½•é›†,è¿”å›žä¸€ä¸ªå•ç‹¬çš„åºåˆ—,å½“æ²¡æœ‰æ•°æ®æ—¶è¿”å›žNoneã€‚ fetchmany(size=cursor.arraysize) æå–æŸ¥è¯¢ç»“æžœçš„ä¸‹ä¸€ç»„è¡Œï¼Œè¿”å›žåˆ—è¡¨ã€‚å½“æ²¡æœ‰æ›´å¤šè¡Œå¯ç”¨æ—¶ï¼Œå°†è¿”å›žä¸€ä¸ªç©ºåˆ—è¡¨ã€‚æ¯ä¸ªè°ƒç”¨è¦æå–çš„è¡Œæ•°ç”± [size] å‚æ•°æŒ‡å®šã€‚å¦‚æžœæœªæä¾›ï¼Œåˆ™æ¸¸æ ‡çš„æ•°ç»„å¤§å°ç¡®å®šè¦æå–çš„è¡Œæ•°ã€‚è¯¥æ–¹æ³•åº”å°è¯•æå–å¤§å°å‚æ•°æŒ‡ç¤ºçš„è¡Œæ•°ã€‚å¦‚æžœç”±äºŽæŒ‡å®šçš„è¡Œæ•°ä¸å¯ç”¨è€Œæ— æ³•è¿™æ ·åšï¼Œåˆ™è¿”å›žçš„è¡Œæ•°å¯èƒ½æ›´å°‘ã€‚è¯·æ³¨æ„ï¼Œ[size] å‚æ•°æ¶‰åŠæ€§èƒ½æ³¨æ„äº‹é¡¹ã€‚ä¸ºäº†èŽ·å¾—æœ€ä½³æ€§èƒ½ï¼Œé€šå¸¸æœ€å¥½ä½¿ç”¨æ•°ç»„å¤§å°å±žæ€§ã€‚å¦‚æžœä½¿ç”¨ [size] å‚æ•°ï¼Œåˆ™æœ€å¥½å°†å…¶ä¿ç•™ä»Žfetchmany() æ–¹æ³•è°ƒç”¨åˆ°ä¸‹ä¸€ä¸ªç›¸åŒçš„å€¼ã€‚ â€‹ è¿”å›žlistç±»åž‹å­˜å‚¨çš„æ‰€æœ‰ç»“æžœçš„è¡Œã€‚å¦‚æžœæ²¡æœ‰è®°å½•è¿”å›ž,è¿”å›žä¸€ä¸ªç©ºçš„listã€‚ close() ç«‹å³å…³é—­æ¸¸æ ‡(æ— è®º__del__æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨)ã€‚å½“å‰æ¸¸æ ‡æ— æ³•å†èŽ·å–ä¸Šä¸‹æ–‡å¯¹è±¡,å¦‚æžœå°è¯•è®¿é—®è¯¥æ¸¸æ ‡,åˆ™ä¼šå¼•å‘ProgrammingError å¼‚å¸¸ã€‚ rowcount å¯¹äºŽ executemany() è¯­å¥ï¼Œä¿®æ”¹æ¬¡æ•°æ±‡æ€»ä¸º rowcount.æ ¹æ® Python DB API è§„èŒƒçš„è¦æ±‚ï¼Œrowcount å±žæ€§åœ¨æ¸¸æ ‡ä¸Šæœªæ‰§è¡ŒexecuteXX()æˆ–æœ€åŽä¸€ä¸ªæ“ä½œçš„è¡Œè®¡æ•°æ— æ³•ç”±æŽ¥å£å†³å®šçš„æƒ…å†µä¸‹ä¸º -1ã€‚è¿™åŒ…æ‹¬SELECTè¯­å¥ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•ç¡®å®šåœ¨æå–æ‰€æœ‰è¡Œä¹‹å‰ç”Ÿæˆçš„æŸ¥è¯¢çš„è¡Œæ•°ã€‚ lastrowid è¿™æ˜¯ä¸€ä¸ªåªè¯»å±žæ€§å–å¾—æœ€åŽä¸€æ¡ä¿®æ”¹è®°å½•çš„rowidã€‚ä»…å½“ä½¿ç”¨ execute() æ–¹æ³•æ‰§è¡ŒINSERT or a REPLACE è¯­å¥æ—¶è®¾ç½®è¯¥å±žæ€§ã€‚æˆ–è€… å½“æ‰§è¡Œexecutemany() æ–¹æ³•æ—¶,è¯¥å±žæ€§è®¾ç½®ä¸ºNoneã€‚å¦‚æžœINSERT æˆ– REPLACE è¯­å¥æ‰§è¡Œå¤±è´¥æ—¶,åˆ™è¿”å›žæœ€è¿‘ä¸€æ¬¡æˆåŠŸæ‰§è¡Œçš„rowidã€‚ arraysize è¯¥å±žæ€§å¯è¯»å†™,ä¸»è¦æŽ§åˆ¶ fetchmany()æ–¹æ³•è¿”å›žçš„è®°å½•æ•°é‡ã€‚é»˜è®¤å€¼æ˜¯1æ„å‘³ç€è¿”å›žä¸€è¡Œç»“æžœã€‚ description æ­¤åªè¯»å±žæ€§æä¾›æœ€åŽä¸€æ¬¡æŸ¥è¯¢çš„åˆ—åç§°ã€‚ä¸ºäº†ä¿æŒä¸Ž Python DB API çš„å…¼å®¹ï¼Œå®ƒä¸ºæ¯ä¸ªåˆ—è¿”å›žä¸€ä¸ª 7 å…ƒç»„ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç»„çš„æœ€åŽå…­ä¸ªé¡¹ä¸º None. connection æ­¤åªè¯»å±žæ€§æä¾›SQLiteæ•°æ®åº“çš„ Connection ä½¿ç”¨çš„æ¸¸æ ‡å¯¹è±¡ã€‚ è¡Œå¯¹è±¡class sqlite3.Row keys() è¯¥æ–¹æ³•è¿”å›žåˆ—åæž„æˆçš„åˆ—è¡¨ã€‚æŸ¥è¯¢åŽ,åœ¨ Cursor.description ä¸­å…ƒç»„æ•°æ®çš„ç¬¬ä¸€ä¸ªå…ƒç´ . æŽ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­åˆå§‹åŒ–ä¸€ä¸ªtableï¼š 123456789conn = sqlite3.connect(":memory:")c = conn.cursor()c.execute('''create table stocks(date text, trans text, symbol text, qty real, price real)''')c.execute("""insert into stocks values ('2006-01-05','BUY','RHAT',100,35.14)""")conn.commit()c.close() æˆ‘ä»¬ä½¿ç”¨Row 12345678910111213141516171819202122232425&gt;&gt;&gt; conn.row_factory = sqlite3.Row&gt;&gt;&gt; c = conn.cursor()&gt;&gt;&gt; c.execute('select * from stocks')&lt;sqlite3.Cursor object at 0x7f4e7dd8fa80&gt;&gt;&gt;&gt; r = c.fetchone()&gt;&gt;&gt; type(r)&lt;class 'sqlite3.Row'&gt;&gt;&gt;&gt; tuple(r)('2006-01-05', 'BUY', 'RHAT', 100.0, 35.14)&gt;&gt;&gt; len(r)5&gt;&gt;&gt; r[2]'RHAT'&gt;&gt;&gt; r.keys()['date', 'trans', 'symbol', 'qty', 'price']&gt;&gt;&gt; r['qty']100.0&gt;&gt;&gt; for member in r:... print(member)...2006-01-05BUYRHAT100.035.14 å¼‚å¸¸ exception sqlite3.Warning Exception çš„ä¸€ä¸ªå­ç±»ã€‚ exception sqlite3.Error æ­¤æ¨¡å—ä¸­å…¶ä»–å¼‚å¸¸çš„åŸºç±»ã€‚ å®ƒæ˜¯ Exception çš„ä¸€ä¸ªå­ç±»ã€‚ exception sqlite3.DatabaseError æŠ›å‡ºå’Œæ•°æ®åº“æœ‰å…³å¼‚å¸¸ã€‚ exception sqlite3.IntegrityError æŠ›å‡ºå’Œå…³è”æ ‡è¯†ç¬¦æœ‰å…³å¼‚å¸¸,ä¾‹å¦‚å¤–é”®æ£€æŸ¥å¤±è´¥,æ˜¯DatabaseErrorçš„ä¸€ä¸ªå­ç±»ã€‚ exception sqlite3.ProgrammingError æŠ›å‡ºå’Œç¨‹åºæœ‰å…³çš„å¼‚å¸¸,ä¾‹å¦‚ï¼štableæœªæ‰¾åˆ°,æˆ–å·²ç»å­˜åœ¨,SQL è¯­å¥å¼‚å¸¸,å‚æ•°ä¸æ­£ç¡®, æ˜¯DatabaseErrorçš„ä¸€ä¸ªå­ç±»ã€‚ exception sqlite3.OperationalError æŠ›å‡ºå’Œç¨‹åºæ— æ³•æŽ§åˆ¶çš„æ•°æ®åº“æ“ä½œçš„å¼‚å¸¸,ä¾‹å¦‚: ä¸å¯é¢„æ–™çš„æ•°æ®åº“è¿žæŽ¥é”™è¯¯,æ•°æ®æºåå­—æœªæ‰¾åˆ°,äº‹åŠ¡æ²¡æœ‰è¢«æ‰§è¡Œ,æ˜¯DatabaseErrorçš„ä¸€ä¸ªå­ç±»ã€‚ exception sqlite3.NotSupportedError æŠ›å‡ºå½“ä¸€ä¸ªæ–¹æ³•å¯¹å½“å‰æ•°æ®åº“ä¸æ”¯æŒçš„å¼‚å¸¸,ä¾‹å¦‚:è°ƒç”¨ rollback()æ—¶,æ•°æ®åº“äº‹åŠ¡ä¸æ”¯æŒæˆ–è€…äº‹åŠ¡è¢«å…³é—­ã€‚æ˜¯DatabaseErrorçš„ä¸€ä¸ªå­ç±» SQLite ä¸Ž Python ç±»åž‹æ¦‚è¿°SQLite åŽŸç”Ÿæ”¯æŒå¦‚ä¸‹çš„ç±»åž‹ï¼š NULLï¼ŒINTEGERï¼ŒREALï¼ŒTEXTï¼ŒBLOBã€‚ Python ç±»åž‹ SQLite ç±»åž‹ None NULL int INTEGER float REAL str TEXT bytes BLOB è¿™æ˜¯SQLiteç±»åž‹é»˜è®¤è½¬æ¢ä¸ºPythonç±»åž‹çš„æ–¹å¼ï¼š SQLite ç±»åž‹ Python ç±»åž‹ NULL None INTEGER int REAL float TEXT å–å†³äºŽ text_factory , é»˜è®¤ä¸º str BLOB bytes sqlite3 ä¸­æ•°æ®ç±»åž‹çš„æ‰©å±•æœ‰ä¸¤ç§é€”å¾„: ä¸€ç§æ˜¯ä½¿ç”¨SQLiteå¯¹è±¡é€‚é…å™¨æ‰©å±•é™„åŠ çš„Pythonæ•°æ®ç±»åž‹ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨Pythonç±»åž‹è½¬æ¢å‡½æ•°è½¬æ¢SQLiteç±»åž‹ã€‚ ä½¿ç”¨é€‚é…å™¨åœ¨SQLiteä¸­å­˜å‚¨é™„åŠ çš„pythonæ•°æ®ç±»åž‹æ­£å¦‚ä¹‹å‰æè¿°çš„è½¬æ¢æ–¹æ³•ä¸­è¯´æ˜Žçš„,SQLiteåªæ”¯æŒæœ‰é™çš„å‡ ç§æ•°æ®ç±»åž‹ã€‚å¦‚æžœæƒ³åœ¨SQLiteä¸­ä½¿ç”¨Pythonçš„ç›¸å…³æ•°æ®ç±»åž‹,ä½ å¿…é¡»é€šè¿‡é€‚é…å™¨,è®©SQLiteçš„æ¨¡å—è®©SQLiteæ”¯æŒè¯¸å¦‚: one of NoneType, int, float, str, bytesç­‰ç±»åž‹ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­: è®©å¯¹è±¡è‡ªè¡Œè°ƒæ•´å¦‚æžœè‡ªå·±ç¼–å†™ç±»ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•ã€‚å‡è®¾æœ‰è¿™æ ·çš„ç±»ï¼šï¼š 123class Point: def __init__(self, x, y): self.x, self.y = x, y æˆ‘ä»¬æƒ³åœ¨SQLiteä¸­å­˜å‚¨,é¦–å…ˆé€‰æ‹©ä½•ç§æ•°æ®ç±»åž‹å­˜å‚¨è¿™ä¸ªPointç±»ã€‚ æŽ¥ä¸‹æ¥ä½¿ç”¨ç±»æ–¹æ³• __conform__è¿”å›žè½¬æ¢åŽçš„å€¼, å‚æ•°æ˜¯ PrepareProtocolç±»åž‹çš„protocolã€‚ 123456789101112131415161718import sqlite3class Point: def __init__(self, x, y): self.x, self.y = x, y def __conform__(self, protocol): if protocol is sqlite3.PrepareProtocol: return "%f;%f" % (self.x, self.y)con = sqlite3.connect(":memory:")cur = con.cursor()p = Point(4.0, -3.2)cur.execute("select ?", (p,))print(cur.fetchone()[0])con.close() æ³¨å†Œå¯è°ƒç”¨çš„é€‚é…å™¨å¦ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•æ—¶åˆ›å»ºä¸€ä¸ªå¯ä»¥è½¬æ¢stringå’Œå…¶ä»–ç±»åž‹çš„å‡½æ•°,ä½¿ç”¨register_adapter(). 12345678910111213141516171819import sqlite3class Point: def __init__(self, x, y): self.x, self.y = x, ydef adapt_point(point): return "%f;%f" % (point.x, point.y)sqlite3.register_adapter(Point, adapt_point)con = sqlite3.connect(":memory:")cur = con.cursor()p = Point(4.0, -3.2)cur.execute("select ?", (p,))print(cur.fetchone()[0])con.close() å¯¹äºŽPythonä¸­çš„å†…ç½®æ•°æ®ç±»åž‹ datetime.date å’Œ datetime.datetime ,æˆ‘ä»¬å¯ä»¥å­˜å‚¨ datetime.datetime ä½¿ç”¨ISO å®žçŽ°è€Œéž Unix æ—¶é—´æˆ³ã€‚è¯·å‚è€ƒä¸‹é¢çš„ä¾‹å­: 1234567891011121314151617import sqlite3import datetimeimport timedef adapt_datetime(ts): return time.mktime(ts.timetuple())sqlite3.register_adapter(datetime.datetime, adapt_datetime)con = sqlite3.connect(":memory:")cur = con.cursor()now = datetime.datetime.now()cur.execute("select ?", (now,))print(cur.fetchone()[0])con.close() å°†SQLite å€¼è½¬æ¢ä¸ºè‡ªå®šä¹‰Python ç±»åž‹è®©æˆ‘ä»¬å›žåˆ°åˆšæ‰å®šä¹‰çš„Point ç±»,åœ¨SQLiteä¸­å­˜å‚¨x,yå­—ç¬¦ä¸²ç±»åž‹å‚æ•°ã€‚ é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè½¬æ¢å‡½æ•°,æŽ¥æ”¶å­—ç¬¦ä¸²ç±»åž‹çš„å‚æ•°,è½¬æ¢ä¸ºPointç±»çš„å¯¹è±¡ã€‚ è½¬æ¢å‡½æ•°é€šå¸¸å¤„ç†çš„æ˜¯byteç±»åž‹å¯¹è±¡,æ— è®ºä½ ä¼ å…¥çš„æ˜¯ä»€ä¹ˆç±»åž‹ æ•°æ®ã€‚ 123def convert_point(s): x, y = map(float, s.split(b";")) return Point(x, y) çŽ°åœ¨æˆ‘ä»¬éœ€è¦è®© sqlite3 æ¨¡å—çŸ¥é“ä½ æŸ¥è¯¢çš„æ˜¯ä¸€ä¸ªpointå¯¹è±¡ï¼Œæœ‰ä¸¤ç§æ–¹å¼å®žçŽ°: éšå¼çš„å£°æ˜Žç±»åž‹ æ˜¾å¼çš„é€šè¿‡åˆ—å 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import sqlite3class Point: def __init__(self, x, y): self.x, self.y = x, y def __repr__(self): return "(%f;%f)" % (self.x, self.y)def adapt_point(point): return ("%f;%f" % (point.x, point.y)).encode('ascii')def convert_point(s): x, y = list(map(float, s.split(b";"))) return Point(x, y)# Register the adaptersqlite3.register_adapter(Point, adapt_point)# Register the convertersqlite3.register_converter("point", convert_point)p = Point(4.0, -3.2)########################## 1) Using declared typescon = sqlite3.connect(":memory:", detect_types=sqlite3.PARSE_DECLTYPES)cur = con.cursor()cur.execute("create table test(p point)")cur.execute("insert into test(p) values (?)", (p,))cur.execute("select p from test")print("with declared types:", cur.fetchone()[0])cur.close()con.close()######################## 1) Using column namescon = sqlite3.connect(":memory:", detect_types=sqlite3.PARSE_COLNAMES)cur = con.cursor()cur.execute("create table test(p)")cur.execute("insert into test(p) values (?)", (p,))cur.execute('select p as "p [point]" from test')print("with column names:", cur.fetchone()[0])cur.close()con.close() é»˜è®¤é€‚é…å™¨å’Œè½¬æ¢å™¨å¯¹äºŽæ—¶é—´å’Œ æ—¥æœŸæ—¶é—´ç±»åž‹, sqliteæ¨¡å—å·²ç»åšäº†è‡ªåŠ¨è½¬æ¢ã€‚ ä¸‹é¢çš„ç¤ºä¾‹æ¼”ç¤ºäº†è¿™ä¸€ç‚¹ã€‚ 12345678910111213141516171819202122import sqlite3import datetimecon = sqlite3.connect(":memory:", detect_types=sqlite3.PARSE_DECLTYPES|sqlite3.PARSE_COLNAMES)cur = con.cursor()cur.execute("create table test(d date, ts timestamp)")today = datetime.date.today()now = datetime.datetime.now()cur.execute("insert into test(d, ts) values (?, ?)", (today, now))cur.execute("select d, ts from test")row = cur.fetchone()print(today, "=&gt;", row[0], type(row[0]))print(now, "=&gt;", row[1], type(row[1]))cur.execute('select current_date as "d [date]", current_timestamp as "ts [timestamp]"')row = cur.fetchone()print("current_date", row[0], type(row[0]))print("current_timestamp", row[1], type(row[1]))con.close() æŽ§åˆ¶äº‹åŠ¡é»˜è®¤sqlite3ä¸­å¯¹äºŽautocommit é»˜è®¤æ˜¯å¼€å¯çš„,ä½†æ˜¯Pythonä¸­çš„sqlite3æ¨¡å—é»˜è®¤å¹¶æ²¡æœ‰å¼€å¯ã€‚ autocommit æ¨¡å¼æ„å‘³ç€å½“ä¿®æ”¹æ•°æ®åº“æ—¶å¯¹æ•°æ®åº“å½±å“ç«‹å³ç”Ÿæ•ˆã€‚ä¸€ä¸ªBEGIN å’Œ SAVEPOINTçš„è¯­å¥ç¦æ­¢automode,å¦‚æžœæ˜¯COMMITï¼ŒROLLBACK æˆ–RELASE è¯­å¥æ‰§è¡ŒåŽ,autocommitæ¨¡å¼æ‰è®¾ç½®æˆå¯ç”¨ã€‚ Python sqlite3 é»˜è®¤åœ¨DDL è¯­å¥( (ä¾‹å¦‚: INSERT/UPDATE/DELETE/REPLACE).)æ‰§è¡Œå‰æ‰§è¡ŒBEGIN è¯­å¥ã€‚ ä½ å¯ä»¥é€šè¿‡æŽ§åˆ¶ BEGIN è¯­å¥,éšå¼æ‰§è¡Œconnect()æ–¹æ³•çš„ isolation_level å‚æ•°,æˆ–æ˜¯connectionsçš„ isolation_level å±žæ€§æ¥å®žçŽ°ã€‚å¦‚æžœä½ æ²¡æœ‰å£°æ˜Ž isolation_level,é‚£ä¹ˆä½¿ç”¨çš„å°±æ˜¯æ™®é€šçš„BEGINä½¿ç”¨,å’ŒDEFERREDæ˜¯ä¸€æ ·çš„ã€‚å…¶ä»–å¯èƒ½çš„å€¼è¿˜æœ‰IMMEDIATE å’Œ EXCLUSIVEã€‚ ä½ å¯ä»¥åœ¨ä»£ç ä¸­é€šè¿‡ç¦æ­¢ sqlite3 æ¨¡å—ä¸­è®¾å®š control the transaction state çš„å€¼ä¸ºBEGIN, ROLLBACK, SAVEPOINT, and RELEASE è¯­å¥å®žçŽ°äº‹åŠ¡å¤„ç†ã€‚ æœ‰æ•ˆä½¿ç”¨ sqlite3ä½¿ç”¨å¿«æ·æ–¹å¼ä½¿ç”¨ Connection å¯¹è±¡çš„éžæ ‡å‡† execute(), executemany() å’Œ executescript() æ–¹æ³•ï¼Œå¯ä»¥æ›´ç®€æ´åœ°ç¼–å†™ä»£ç ï¼Œå› ä¸ºä¸å¿…æ˜¾å¼åˆ›å»ºï¼ˆé€šå¸¸æ˜¯å¤šä½™çš„ï¼‰ Cursor å¯¹è±¡ã€‚ç›¸åï¼Œ Cursor å¯¹è±¡æ˜¯éšå¼åˆ›å»ºçš„ï¼Œè¿™äº›å¿«æ·æ–¹æ³•è¿”å›žæ¸¸æ ‡å¯¹è±¡ã€‚è¿™æ ·ï¼Œåªéœ€å¯¹ Connection å¯¹è±¡è°ƒç”¨ä¸€æ¬¡ï¼Œå°±èƒ½ç›´æŽ¥æ‰§è¡Œ SELECT è¯­å¥å¹¶éåŽ†å¯¹è±¡ã€‚ 123456789101112131415161718192021222324import sqlite3persons = [ ("Hugo", "Boss"), ("Calvin", "Klein") ]con = sqlite3.connect(":memory:")# Create the tablecon.execute("create table person(firstname, lastname)")# Fill the tablecon.executemany("insert into person(firstname, lastname) values (?, ?)", persons)# Print the table contentsfor row in con.execute("select firstname, lastname from person"): print(row)print("I just deleted", con.execute("delete from person").rowcount, "rows")# close is not a shortcut method and it's not called automatically,# so the connection object should be closed manuallycon.close() é€šè¿‡åç§°è€Œä¸æ˜¯ç´¢å¼•è®¿é—®ç´¢å¼•sqlite3 æ¨¡å—çš„ä¸€ä¸ªæœ‰ç”¨åŠŸèƒ½æ˜¯å†…ç½®çš„ sqlite3.Row ç±»ï¼Œè¯¥ç±»æ—¨åœ¨ç”¨ä½œè¡Œå·¥åŽ‚ã€‚ è¯¥ç±»çš„è¡Œè£…é¥°å™¨å¯ä»¥ç”¨ç´¢å¼•ï¼ˆå¦‚å…ƒç»„ï¼‰å’Œä¸åŒºåˆ†å¤§å°å†™çš„åç§°è®¿é—®ï¼š 1234567891011121314import sqlite3con = sqlite3.connect(":memory:")con.row_factory = sqlite3.Rowcur = con.cursor()cur.execute("select 'John' as name, 42 as age")for row in cur: assert row[0] == row["name"] assert row["name"] == row["nAmE"] assert row[1] == row["age"] assert row[1] == row["AgE"]con.close() ä½¿ç”¨è¿žæŽ¥ä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨è¿žæŽ¥å¯¹è±¡å¯ä»¥ç”¨æ¥ä½œä¸ºä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æäº¤æˆ–è€…å›žæ»šäº‹åŠ¡ã€‚å¦‚æžœå‡ºçŽ°å¼‚å¸¸ï¼Œäº‹åŠ¡ä¼šè¢«å›žæ»šï¼›å¦åˆ™ï¼Œäº‹åŠ¡ä¼šè¢«æäº¤ã€‚ 1234567891011121314151617181920import sqlite3con = sqlite3.connect(":memory:")con.execute("create table person (id integer primary key, firstname varchar unique)")# Successful, con.commit() is called automatically afterwardswith con: con.execute("insert into person(firstname) values (?)", ("Joe",))# con.rollback() is called after the with block finishes with an exception, the# exception is still raised and must be caughttry: with con: con.execute("insert into person(firstname) values (?)", ("Joe",))except sqlite3.IntegrityError: print("couldn't add Joe twice")# Connection object used as context manager only commits or rollbacks transactions,# so the connection object should be closed manuallycon.close() å¸¸è§é—®é¢˜å¤šçº¿ç¨‹è¾ƒè€ç‰ˆæœ¬çš„ SQLite åœ¨å…±äº«çº¿ç¨‹ä¹‹é—´å­˜åœ¨è¿žæŽ¥é—®é¢˜ã€‚è¿™å°±æ˜¯Pythonæ¨¡å—ä¸å…è®¸çº¿ç¨‹ä¹‹é—´å…±äº«è¿žæŽ¥å’Œæ¸¸æ ‡çš„åŽŸå› ã€‚å¦‚æžœä»ç„¶å°è¯•è¿™æ ·åšï¼Œåˆ™åœ¨è¿è¡Œæ—¶ä¼šå‡ºçŽ°å¼‚å¸¸ã€‚ å”¯ä¸€çš„ä¾‹å¤–æ˜¯è°ƒç”¨ interrupt() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä»…åœ¨ä»Žå…¶ä»–çº¿ç¨‹è¿›è¡Œè°ƒç”¨æ—¶æ‰æœ‰æ„ä¹‰ã€‚ å…³äºŽäº‹åŠ¡çš„è¡¥å……è¯´æ˜Žisolation_level åˆ°åº•æŽ§åˆ¶çš„æ˜¯ä»€ä¹ˆ,ä¸‹å›¾æ‘˜è‡ªSQLiteå®˜ç½‘ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨connect()ä¸­ä¸ä¼ å…¥ isolation_levelçš„ä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132#!/usr/bin/env python# -*- coding:utf-8 -*-'''sqlite3äº‹åŠ¡æ€»ç»“:åœ¨connect()ä¸­ä¸ä¼ å…¥ isolation_leveläº‹åŠ¡å¤„ç†: ä½¿ç”¨connection.commit()åˆ†æž: æ™ºèƒ½commitçŠ¶æ€: ç”Ÿæˆæ–¹å¼: åœ¨connect()ä¸­ä¸ä¼ å…¥ isolation_level, æ­¤æ—¶isolation_level=='' åœ¨è¿›è¡Œ æ‰§è¡ŒData Modification Language (DML) æ“ä½œ(INSERT/UPDATE/DELETE/REPLACE)æ—¶, ä¼šè‡ªåŠ¨æ‰“å¼€ä¸€ä¸ªäº‹åŠ¡, åœ¨æ‰§è¡Œ éžDML, éžquery (éž SELECT å’Œä¸Šé¢æåˆ°çš„)è¯­å¥æ—¶, ä¼šéšå¼æ‰§è¡Œcommit å¯ä»¥ä½¿ç”¨ connection.commit()æ–¹æ³•æ¥è¿›è¡Œæäº¤ æ³¨æ„: ä¸èƒ½å’Œcur.execute("COMMIT")å…±ç”¨ è‡ªåŠ¨commitçŠ¶æ€: ç”Ÿæˆæ–¹å¼: åœ¨connect()ä¸­ä¼ å…¥ isolation_level=None è¿™æ ·,åœ¨ä»»ä½•DMLæ“ä½œæ—¶,éƒ½ä¼šè‡ªåŠ¨æäº¤ äº‹åŠ¡å¤„ç† connection.execute("BEGIN TRANSACTION") connection.execute("COMMIT") å¦‚æžœä¸ä½¿ç”¨äº‹åŠ¡, æ‰¹é‡æ·»åŠ æ•°æ®éžå¸¸ç¼“æ…¢æ•°æ®å¯¹æ¯”: ä¸¤ç§æ–¹å¼, äº‹åŠ¡è€—æ—¶å·®åˆ«ä¸å¤§ count = 100000 æ™ºèƒ½commitå³æ—¶æäº¤è€—æ—¶: 0.621 è‡ªåŠ¨commitè€—æ—¶: 0.601 æ™ºèƒ½commitå³æ—¶æäº¤è€—æ—¶: 0.588 è‡ªåŠ¨commitè€—æ—¶: 0.581 æ™ºèƒ½commitå³æ—¶æäº¤è€—æ—¶: 0.598 è‡ªåŠ¨commitè€—æ—¶: 0.588 æ™ºèƒ½commitå³æ—¶æäº¤è€—æ—¶: 0.589 è‡ªåŠ¨commitè€—æ—¶: 0.602 æ™ºèƒ½commitå³æ—¶æäº¤è€—æ—¶: 0.588 è‡ªåŠ¨commitè€—æ—¶: 0.622'''import sysimport timeclass Elapse_time(object): '''è€—æ—¶ç»Ÿè®¡å·¥å…·''' def __init__(self, prompt=''): self.prompt = prompt self.start = time.time() def __del__(self): print('%sè€—æ—¶: %.3f' % (self.prompt, time.time() - self.start))CElapseTime = Elapse_timeimport sqlite3# -------------------------------------------------------------------------------# æµ‹è¯•#filename = 'e:/temp/a.db'def prepare(isolation_level = ''): connection = sqlite3.connect(filename, isolation_level = isolation_level) connection.execute("create table IF NOT EXISTS people (num, age)") connection.execute('delete from people') connection.commit() return connection, connection.cursor()def db_insert_values(cursor, count): num = 1 age = 2 * num while num &lt;= count: cursor.execute("insert into people values (?, ?)", (num, age)) num += 1 age = 2 * num def study_case1_intelligent_commit(count): ''' åœ¨æ™ºèƒ½commitçŠ¶æ€ä¸‹, ä¸èƒ½å’Œcur.execute("COMMIT")å…±ç”¨ ''' connection, cursor = prepare() elapse_time = Elapse_time(' æ™ºèƒ½commit') db_insert_values(cursor, count) #cursor.execute("COMMIT") #äº§ç”Ÿå¼‚å¸¸ cursor.execute("select count(*) from people") print (cursor.fetchone()) def study_case2_autocommit(count): connection, cursor = prepare(isolation_level = None) elapse_time = Elapse_time(' è‡ªåŠ¨commit') db_insert_values(cursor, count) cursor.execute("select count(*) from people") print (cursor.fetchone())def study_case3_intelligent_commit_manual(count): connection, cursor = prepare() elapse_time = Elapse_time(' æ™ºèƒ½commitå³æ—¶æäº¤') db_insert_values(cursor, count) connection.commit() cursor.execute("select count(*) from people") print (cursor.fetchone())def study_case4_autocommit_transaction(count): connection, cursor = prepare(isolation_level = None) elapse_time = Elapse_time(' è‡ªåŠ¨commit') connection.execute("BEGIN TRANSACTION;") # å…³é”®ç‚¹ db_insert_values(cursor, count) connection.execute("COMMIT;") #å…³é”®ç‚¹ cursor.execute("select count(*) from people;") print (cursor.fetchone())if __name__ == '__main__': count = 10000 prepare() for i in range(5): #study_case1_intelligent_commit(count) #ä¸æäº¤æ•°æ® #study_case2_autocommit(count) #éžå¸¸ç¼“æ…¢ study_case3_intelligent_commit_manual(count) study_case4_autocommit_transaction(count) å‚è€ƒæ–‡æ¡£python sqlite3 äº‹åŠ¡æŽ§åˆ¶ python sqlite3 äº‹åŠ¡æ€»ç»“]]></content>
      <categories>
        <category>python</category>
        <category>standard_library</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>sqlite3</tag>
        <tag>standard_library</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Understand Python GIL]]></title>
    <url>%2F2020%2F01%2F19%2FUnderstand-Python-GIL%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ threadingæ¯æ—¥ä¸€è¯: US[â€˜weÃ°É™r] UK[â€˜weÃ°É™(r)] n.å¤©æ°”ï¼›æ°”è±¡ï¼›æ°”è±¡é¢„123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242&gt;&gt; v.å˜å½¢ï¼›ç»å—ä½&gt;&gt; ç½‘ç»œ:`````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````````æ°”å€™ï¼›å¤©æ°”é¢„æŠ¥ï¼›é£ŽåŒ–&gt;&gt; ç»™å¤§å®¶æŽ¨èä¸€éƒ¨ç”µå½±: æ°”è±¡å…ˆç”Ÿ![](&lt;https://github.com/jeffsui/app_image_resource/blob/master/20200119_weather_man.jpg?raw=tru&gt;)&gt; This shit life,we must chuck some things&lt;!--more--&gt;## æºä»£ç **æºä»£ç :** [Lib/threading.py](https://github.com/python/cpython/tree/3.8/Lib/threading.py)## æ ¸å¿ƒå‡½æ•°- `threading.active_count`() è¿”å›žå½“å‰å­˜æ´»çš„çº¿ç¨‹ç±» [`Thread`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread) å¯¹è±¡ã€‚è¿”å›žçš„è®¡æ•°ç­‰äºŽ [`enumerate()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.enumerate) è¿”å›žçš„åˆ—è¡¨é•¿åº¦ã€‚- `threading.current_thread`() è¿”å›žå½“å‰å¯¹åº”è°ƒç”¨è€…çš„æŽ§åˆ¶çº¿ç¨‹çš„ [`Thread`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread) å¯¹è±¡ã€‚å¦‚æžœè°ƒç”¨è€…çš„æŽ§åˆ¶çº¿ç¨‹ä¸æ˜¯åˆ©ç”¨ [`threading`](https://docs.python.org/zh-cn/3.8/library/threading.html#module-threading) åˆ›å»ºï¼Œä¼šè¿”å›žä¸€ä¸ªåŠŸèƒ½å—é™çš„è™šæ‹Ÿçº¿ç¨‹å¯¹è±¡ã€‚- `threading.excepthook`(*args*, */*) å‚æ•°å¯ä»¥æ˜¯ä¸‹é¢ä»»æ„ä¸€ç§ç±»åž‹ - *exc_type*: å¼‚å¸¸ç±»åž‹ - *exc_value*: å¼‚å¸¸å€¼ï¼Œå¯ä»¥æ˜¯ `None`. - *exc_traceback*: å¼‚å¸¸å›žæº¯ï¼Œå¯ä»¥æ˜¯ `None`. - *thread*: çº¿ç¨‹è·‘å‡ºçš„å¼‚å¸¸ å¯ä»¥æ˜¯`None`.- `threading.get_ident`() è¿”å›žå½“å‰çº¿ç¨‹çš„ â€œçº¿ç¨‹æ ‡è¯†ç¬¦â€ã€‚å®ƒæ˜¯ä¸€ä¸ªéžé›¶çš„æ•´æ•°ã€‚å®ƒçš„å€¼æ²¡æœ‰ç›´æŽ¥å«ä¹‰ï¼Œä¸»è¦æ˜¯ç”¨ä½œ magic cookieï¼Œæ¯”å¦‚ä½œä¸ºå«æœ‰çº¿ç¨‹ç›¸å…³æ•°æ®çš„å­—å…¸çš„ç´¢å¼•ã€‚çº¿ç¨‹æ ‡è¯†ç¬¦å¯èƒ½ä¼šåœ¨çº¿ç¨‹é€€å‡ºï¼Œæ–°çº¿ç¨‹åˆ›å»ºæ—¶è¢«å¤ç”¨ã€‚*3.3 æ–°ç‰ˆåŠŸèƒ½.*- `threading.get_native_id`() è¿”å›žå†…æ ¸åˆ†é…ç»™å½“å‰çº¿ç¨‹çš„åŽŸç”Ÿé›†æˆçº¿ç¨‹ IDã€‚ è¿™æ˜¯ä¸€ä¸ªéžè´Ÿæ•´æ•°ã€‚ å®ƒçš„å€¼å¯è¢«ç”¨æ¥åœ¨æ•´ä¸ªç³»ç»Ÿä¸­å”¯ä¸€åœ°æ ‡è¯†è¿™ä¸ªç‰¹å®šçº¿ç¨‹ï¼ˆç›´åˆ°çº¿ç¨‹ç»ˆç»“ï¼Œåœ¨é‚£ä¹‹åŽè¯¥å€¼å¯èƒ½ä¼šè¢« OS å›žæ”¶å†åˆ©ç”¨ï¼‰ã€‚[å¯ç”¨æ€§](https://docs.python.org/zh-cn/3.8/library/intro.html#availability): Windows, FreeBSD, Linux, macOS, OpenBSD, NetBSD, AIXã€‚*3.8 æ–°ç‰ˆåŠŸèƒ½.*- `threading.enumerate`() ä»¥åˆ—è¡¨å½¢å¼è¿”å›žå½“å‰æ‰€æœ‰å­˜æ´»çš„ [`Thread`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread) å¯¹è±¡ã€‚ è¯¥åˆ—è¡¨åŒ…å«å®ˆæŠ¤çº¿ç¨‹ï¼Œ[`current_thread()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.current_thread) åˆ›å»ºçš„è™šæ‹Ÿçº¿ç¨‹å¯¹è±¡å’Œä¸»çº¿ç¨‹ã€‚å®ƒä¸åŒ…å«å·²ç»ˆç»“çš„çº¿ç¨‹å’Œå°šæœªå¼€å§‹çš„çº¿ç¨‹ã€‚- `threading.main_thread`() è¿”å›žä¸» [`Thread`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread) å¯¹è±¡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹æ˜¯Pythonè§£é‡Šå™¨å¼€å§‹æ—¶åˆ›å»ºçš„çº¿ç¨‹ã€‚*3.4 æ–°ç‰ˆåŠŸèƒ½.*- `threading.settrace`(*func*) ä¸ºæ‰€æœ‰ [`threading`](https://docs.python.org/zh-cn/3.8/library/threading.html#module-threading) æ¨¡å—å¼€å§‹çš„çº¿ç¨‹è®¾ç½®è¿½è¸ªå‡½æ•°ã€‚åœ¨æ¯ä¸ªçº¿ç¨‹çš„ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•è¢«è°ƒç”¨å‰ï¼Œ*func* ä¼šè¢«ä¼ é€’ç»™ [`sys.settrace()`](https://docs.python.org/zh-cn/3.8/library/sys.html#sys.settrace) ã€‚- `threading.setprofile`(*func*) ä¸ºæ‰€æœ‰ [`threading`](https://docs.python.org/zh-cn/3.8/library/threading.html#module-threading) æ¨¡å—å¼€å§‹çš„çº¿ç¨‹è®¾ç½®æ€§èƒ½æµ‹è¯•å‡½æ•°ã€‚åœ¨æ¯ä¸ªçº¿ç¨‹çš„ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•è¢«è°ƒç”¨å‰ï¼Œ*func* ä¼šè¢«ä¼ é€’ç»™ [`sys.setprofile()`](https://docs.python.org/zh-cn/3.8/library/sys.html#sys.setprofile) ã€‚- `threading.stack_size`([*size*]) è¿”å›žåˆ›å»ºçº¿ç¨‹æ—¶ç”¨çš„å †æ ˆå¤§å°ã€‚å¯é€‰å‚æ•° *size* æŒ‡å®šä¹‹åŽæ–°å»ºçš„çº¿ç¨‹çš„å †æ ˆå¤§å°ï¼Œè€Œä¸”ä¸€å®šè¦æ˜¯0ï¼ˆæ ¹æ®å¹³å°æˆ–è€…é»˜è®¤é…ç½®ï¼‰æˆ–è€…æœ€å°æ˜¯32,768(32KiB)çš„ä¸€ä¸ªæ­£æ•´æ•°ã€‚å¦‚æžœ *size* æ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤æ˜¯0ã€‚å¦‚æžœä¸æ”¯æŒæ”¹å˜çº¿ç¨‹å †æ ˆå¤§å°ï¼Œä¼šæŠ›å‡º [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) é”™è¯¯ã€‚å¦‚æžœæŒ‡å®šçš„å †æ ˆå¤§å°ä¸åˆæ³•ï¼Œä¼šæŠ›å‡º [`ValueError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#ValueError) é”™è¯¯å¹¶ä¸”ä¸ä¼šä¿®æ”¹å †æ ˆå¤§å°ã€‚32KiBæ˜¯å½“å‰æœ€å°çš„èƒ½ä¿è¯è§£é‡Šå™¨æœ‰è¶³å¤Ÿå †æ ˆç©ºé—´çš„å †æ ˆå¤§å°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯éƒ¨åˆ†å¹³å°å¯¹äºŽå †æ ˆå¤§å°ä¼šæœ‰ç‰¹å®šçš„é™åˆ¶ï¼Œä¾‹å¦‚è¦æ±‚å¤§äºŽ32KiBçš„å †æ ˆå¤§å°æˆ–è€…éœ€è¦æ ¹æ®ç³»ç»Ÿå†…å­˜é¡µé¢çš„æ•´æ•°å€è¿›è¡Œåˆ†é… - åº”å½“æŸ¥é˜…å¹³å°æ–‡æ¡£æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼ˆ4KiBé¡µé¢æ¯”è¾ƒæ™®éï¼Œåœ¨æ²¡æœ‰æ›´å…·ä½“ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå»ºè®®çš„æ–¹æ³•æ˜¯ä½¿ç”¨4096çš„å€æ•°ä½œä¸ºå †æ ˆå¤§å°ï¼‰ã€‚[é€‚ç”¨äºŽ](https://docs.python.org/zh-cn/3.8/library/intro.html#availability): Windowsï¼Œå…·æœ‰ POSIX çº¿ç¨‹çš„ç³»ç»Ÿã€‚## å¸¸é‡`threading.TIMEOUT_MAX`[Â¶](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.TIMEOUT_MAX) é˜»å¡žå‡½æ•°ï¼ˆ [`Lock.acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire), [`RLock.acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.RLock.acquire), [`Condition.wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait), ...ï¼‰ä¸­å½¢å‚ *timeout* å…è®¸çš„æœ€å¤§å€¼ã€‚ä¼ å…¥è¶…è¿‡è¿™ä¸ªå€¼çš„ timeout ä¼šæŠ›å‡º [`OverflowError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#OverflowError) å¼‚å¸¸ã€‚## å¸¸ç”¨å‡½æ•°### çº¿ç¨‹æœ¬åœ°æ•°æ®çº¿ç¨‹æœ¬åœ°æ•°æ®æ˜¯ç‰¹å®šçº¿ç¨‹çš„æ•°æ®ã€‚ç®¡ç†çº¿ç¨‹æœ¬åœ°æ•°æ®ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ª [`local`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.local) ï¼ˆæˆ–è€…ä¸€ä¸ªå­ç±»åž‹ï¼‰çš„å®žä¾‹å¹¶åœ¨å®žä¾‹ä¸­å‚¨å­˜å±žæ€§ï¼š~~~pythonmydata = threading.local()mydata.x = 1~~~åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ï¼Œå®žä¾‹çš„å€¼ä¼šä¸åŒã€‚- *class* `threading.local` ä¸€ä¸ªä»£è¡¨çº¿ç¨‹æœ¬åœ°æ•°æ®çš„ç±»ã€‚æ›´å¤šç›¸å…³ç»†èŠ‚å’Œå¤§é‡ç¤ºä¾‹ï¼Œå‚è§ `_threading_local` æ¨¡å—çš„æ–‡æ¡£ã€‚### çº¿ç¨‹å¯¹è±¡å½“çº¿ç¨‹å¯¹è±¡ä¸€ä½†è¢«åˆ›å»ºï¼Œå…¶æ´»åŠ¨ä¸€å®šä¼šå› è°ƒç”¨çº¿ç¨‹çš„ [`start()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.start) æ–¹æ³•å¼€å§‹ã€‚è¿™ä¼šåœ¨ç‹¬ç«‹çš„æŽ§åˆ¶çº¿ç¨‹è°ƒç”¨ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•ã€‚ä¸€æ—¦çº¿ç¨‹æ´»åŠ¨å¼€å§‹ï¼Œè¯¥çº¿ç¨‹ä¼šè¢«è®¤ä¸ºæ˜¯ &apos;å­˜æ´»çš„&apos; ã€‚å½“å®ƒçš„ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•ç»ˆç»“äº†ï¼ˆä¸ç®¡æ˜¯æ­£å¸¸çš„è¿˜æ˜¯æŠ›å‡ºæœªè¢«å¤„ç†çš„å¼‚å¸¸ï¼‰ï¼Œå°±ä¸æ˜¯&apos;å­˜æ´»çš„&apos;ã€‚ [`is_alive()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.is_alive) æ–¹æ³•ç”¨äºŽæ£€æŸ¥çº¿ç¨‹æ˜¯å¦å­˜æ´»ã€‚å…¶ä»–çº¿ç¨‹å¯ä»¥è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹çš„ [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) æ–¹æ³•ã€‚è¿™ä¼šé˜»å¡žè°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹ï¼Œç›´åˆ°è¢«è°ƒç”¨ [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) æ–¹æ³•çš„çº¿ç¨‹ç»ˆç»“ã€‚çº¿ç¨‹æœ‰åå­—ã€‚åå­—å¯ä»¥ä¼ é€’ç»™æž„é€ å‡½æ•°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ [`name`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.name) å±žæ€§è¯»å–æˆ–è€…ä¿®æ”¹ã€‚å¦‚æžœè¿è¡Œçº¿ç¨‹ä¸­çš„ `run()`æŠ›å‡ºäº†å¼‚å¸¸, [threading.excepthook()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.excepthook) æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨,é»˜è®¤æƒ…å†µä¸‹,å¿½ç•¥ [`SystemExit`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#SystemExit).ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¢«æ ‡è®°æˆä¸€ä¸ªâ€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚ è¿™ä¸ªæ ‡å¿—çš„æ„ä¹‰æ˜¯ï¼Œå½“å‰©ä¸‹çš„çº¿ç¨‹éƒ½æ˜¯å®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œæ•´ä¸ª Python ç¨‹åºå°†ä¼šé€€å‡ºã€‚ åˆå§‹å€¼ç»§æ‰¿äºŽåˆ›å»ºçº¿ç¨‹ã€‚ è¿™ä¸ªæ ‡å¿—å¯ä»¥é€šè¿‡ [`daemon`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.daemon) ç‰¹å¾å±žæ€§æˆ–è€… *daemon* æž„é€ å™¨å‚æ•°æ¥è®¾ç½®ã€‚&gt; å®ˆæŠ¤çº¿ç¨‹åœ¨ç¨‹åºå…³é—­æ—¶ä¼šçªç„¶å…³é—­ã€‚ä»–ä»¬çš„èµ„æºï¼ˆä¾‹å¦‚å·²ç»æ‰“å¼€çš„æ–‡æ¡£ï¼Œæ•°æ®åº“äº‹åŠ¡ç­‰ç­‰ï¼‰å¯èƒ½æ²¡æœ‰è¢«æ­£ç¡®é‡Šæ”¾ã€‚å¦‚æžœä½ æƒ³ä½ çš„çº¿ç¨‹æ­£å¸¸åœæ­¢ï¼Œè®¾ç½®ä»–ä»¬æˆä¸ºéžå®ˆæŠ¤æ¨¡å¼å¹¶ä¸”ä½¿ç”¨åˆé€‚çš„ä¿¡å·æœºåˆ¶ï¼Œä¾‹å¦‚ï¼š [`Event`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Event)ã€‚æœ‰ä¸ª &quot;ä¸»çº¿ç¨‹&quot; å¯¹è±¡ï¼›è¿™å¯¹åº”Pythonç¨‹åºé‡Œé¢åˆå§‹çš„æŽ§åˆ¶çº¿ç¨‹ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ã€‚&quot;è™šæ‹Ÿçº¿ç¨‹å¯¹è±¡&quot; æ˜¯å¯ä»¥è¢«åˆ›å»ºçš„ã€‚è¿™äº›æ˜¯å¯¹åº”äºŽâ€œå¤–éƒ¨çº¿ç¨‹â€çš„çº¿ç¨‹å¯¹è±¡ï¼Œå®ƒä»¬æ˜¯åœ¨çº¿ç¨‹æ¨¡å—å¤–éƒ¨å¯åŠ¨çš„æŽ§åˆ¶çº¿ç¨‹ï¼Œä¾‹å¦‚ç›´æŽ¥æ¥è‡ªCä»£ç ã€‚è™šæ‹Ÿçº¿ç¨‹å¯¹è±¡åŠŸèƒ½å—é™ï¼›ä»–ä»¬æ€»æ˜¯è¢«è®¤ä¸ºæ˜¯å­˜æ´»çš„å’Œå®ˆæŠ¤æ¨¡å¼ï¼Œä¸èƒ½è¢« [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) ã€‚å› ä¸ºæ— æ³•æ£€æµ‹å¤–æ¥çº¿ç¨‹çš„ç»ˆç»“ï¼Œå®ƒä»¬æ°¸è¿œä¸ä¼šè¢«åˆ é™¤ã€‚*class* `threading.Thread`(*group=None*, *target=None*, *name=None*, *args=()*, *kwargs=&#123;&#125;*, ***, *daemon=None*)è°ƒç”¨è¿™ä¸ªæž„é€ å‡½æ•°æ—¶ï¼Œå¿…éœ€å¸¦æœ‰å…³é”®å­—å‚æ•°ã€‚å‚æ•°å¦‚ä¸‹ï¼š*group* åº”è¯¥ä¸º `None`ï¼›ä¸ºäº†æ—¥åŽæ‰©å±• `ThreadGroup` ç±»å®žçŽ°è€Œä¿ç•™ã€‚*target* æ˜¯ç”¨äºŽ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•è°ƒç”¨çš„å¯è°ƒç”¨å¯¹è±¡ã€‚é»˜è®¤æ˜¯ `None`ï¼Œè¡¨ç¤ºä¸éœ€è¦è°ƒç”¨ä»»ä½•æ–¹æ³•ã€‚*name* æ˜¯çº¿ç¨‹åç§°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç”± &quot;Thread-*N*&quot; æ ¼å¼æž„æˆä¸€ä¸ªå”¯ä¸€çš„åç§°ï¼Œå…¶ä¸­ *N* æ˜¯å°çš„åè¿›åˆ¶æ•°ã€‚*args* æ˜¯ç”¨äºŽè°ƒç”¨ç›®æ ‡å‡½æ•°çš„å‚æ•°å…ƒç»„ã€‚é»˜è®¤æ˜¯ `()`ã€‚*kwargs* æ˜¯ç”¨äºŽè°ƒç”¨ç›®æ ‡å‡½æ•°çš„å…³é”®å­—å‚æ•°å­—å…¸ã€‚é»˜è®¤æ˜¯ `&#123;&#125;`ã€‚- `start`() å¼€å§‹çº¿ç¨‹æ´»åŠ¨ã€‚å®ƒåœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œæœ€å¤šåªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒå®‰æŽ’å¯¹è±¡çš„ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æŽ§åˆ¶è¿›ç¨‹ä¸­è°ƒç”¨ã€‚å¦‚æžœåŒä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ¬¡æ•°å¤§äºŽä¸€æ¬¡ï¼Œä¼šæŠ›å‡º [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) ã€‚- `run`() ä»£è¡¨çº¿ç¨‹æ´»åŠ¨çš„æ–¹æ³•ã€‚ä½ å¯ä»¥åœ¨å­ç±»åž‹é‡Œé‡è½½è¿™ä¸ªæ–¹æ³•ã€‚ æ ‡å‡†çš„ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•ä¼šå¯¹ä½œä¸º *target* å‚æ•°ä¼ é€’ç»™è¯¥å¯¹è±¡æž„é€ å™¨çš„å¯è°ƒç”¨å¯¹è±¡ï¼ˆå¦‚æžœå­˜åœ¨ï¼‰å‘èµ·è°ƒç”¨ï¼Œå¹¶é™„å¸¦ä»Ž *args* å’Œ *kwargs* å‚æ•°åˆ†åˆ«èŽ·å–çš„ä½ç½®å’Œå…³é”®å­—å‚æ•°ã€‚- `join`(*timeout=None*) ç­‰å¾…ï¼Œç›´åˆ°çº¿ç¨‹ç»ˆç»“ã€‚è¿™ä¼šé˜»å¡žè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„çº¿ç¨‹ï¼Œç›´åˆ°è¢«è°ƒç”¨ [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) çš„çº¿ç¨‹ç»ˆç»“ -- ä¸ç®¡æ˜¯æ­£å¸¸ç»ˆç»“è¿˜æ˜¯æŠ›å‡ºæœªå¤„ç†å¼‚å¸¸ -- æˆ–è€…ç›´åˆ°å‘ç”Ÿè¶…æ—¶ï¼Œè¶…æ—¶é€‰é¡¹æ˜¯å¯é€‰çš„ã€‚å½“ *timeout* å‚æ•°å­˜åœ¨è€Œä¸”ä¸æ˜¯ `None` æ—¶ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªç”¨äºŽæŒ‡å®šæ“ä½œè¶…æ—¶çš„ä»¥ç§’ä¸ºå•ä½çš„æµ®ç‚¹æ•°ï¼ˆæˆ–è€…åˆ†æ•°ï¼‰ã€‚å› ä¸º [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) æ€»æ˜¯è¿”å›ž `None` ï¼Œæ‰€ä»¥ä½ ä¸€å®šè¦åœ¨ [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) åŽè°ƒç”¨ [`is_alive()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.is_alive) æ‰èƒ½åˆ¤æ–­æ˜¯å¦å‘ç”Ÿè¶…æ—¶ -- å¦‚æžœçº¿ç¨‹ä»ç„¶å­˜è´§ï¼Œåˆ™ [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) è¶…æ—¶ã€‚å½“ *timeout* å‚æ•°ä¸å­˜åœ¨æˆ–è€…æ˜¯ `None` ï¼Œè¿™ä¸ªæ“ä½œä¼šé˜»å¡žç›´åˆ°çº¿ç¨‹ç»ˆç»“ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¢« [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) å¾ˆå¤šæ¬¡ã€‚å¦‚æžœå°è¯•åŠ å…¥å½“å‰çº¿ç¨‹ä¼šå¯¼è‡´æ­»é”ï¼Œ [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) ä¼šå¼•èµ· [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚å¦‚æžœå°è¯• [`join()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.join) ä¸€ä¸ªå°šæœªå¼€å§‹çš„çº¿ç¨‹ï¼Œä¹Ÿä¼šæŠ›å‡ºç›¸åŒçš„å¼‚å¸¸ã€‚- `name` åªç”¨äºŽè¯†åˆ«çš„å­—ç¬¦ä¸²ã€‚å®ƒæ²¡æœ‰è¯­ä¹‰ã€‚å¤šä¸ªçº¿ç¨‹å¯ä»¥èµ‹äºˆç›¸åŒçš„åç§°ã€‚ åˆå§‹åç§°ç”±æž„é€ å‡½æ•°è®¾ç½®ã€‚- `getName`()- `setName`() æ—§çš„ [`name`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.name) å–å€¼/è®¾å€¼ APIï¼›ç›´æŽ¥å½“åšç‰¹å¾å±žæ€§ä½¿ç”¨å®ƒã€‚- `ident` è¿™ä¸ªçº¿ç¨‹çš„ &apos;çº¿ç¨‹æ ‡è¯†ç¬¦&apos;ï¼Œå¦‚æžœçº¿ç¨‹å°šæœªå¼€å§‹åˆ™ä¸º `None` ã€‚è¿™æ˜¯ä¸ªéžé›¶æ•´æ•°ã€‚å‚è§ [`get_ident()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.get_ident) å‡½æ•°ã€‚å½“ä¸€ä¸ªçº¿ç¨‹é€€å‡ºè€Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹è¢«åˆ›å»ºï¼Œçº¿ç¨‹æ ‡è¯†ç¬¦ä¼šè¢«å¤ç”¨ã€‚å³ä½¿çº¿ç¨‹é€€å‡ºåŽï¼Œä»å¯å¾—åˆ°æ ‡è¯†ç¬¦ã€‚- **native_id** å†…éƒ¨ç”Ÿæˆçš„çº¿ç¨‹id,ä¸€ä¸ªéžè´Ÿçš„æ•´æ•°,å¦‚æžœä¸º`None`æ„å‘³ç€çº¿ç¨‹è¿˜æ²¡æœ‰å¯åŠ¨ã€‚- `is_alive`() è¿”å›žçº¿ç¨‹æ˜¯å¦å­˜æ´»ã€‚å½“ [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•åˆšå¼€å§‹ç›´åˆ° [`run()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.run) æ–¹æ³•åˆšç»“æŸï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ž `True` ã€‚æ¨¡å—å‡½æ•° [`enumerate()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.enumerate) è¿”å›žåŒ…å«æ‰€æœ‰å­˜æ´»çº¿ç¨‹çš„åˆ—è¡¨ã€‚- `daemon` ä¸€ä¸ªè¡¨ç¤ºè¿™ä¸ªçº¿ç¨‹æ˜¯ï¼ˆTrueï¼‰å¦ï¼ˆFalseï¼‰å®ˆæŠ¤çº¿ç¨‹çš„å¸ƒå°”å€¼ã€‚ä¸€å®šè¦åœ¨è°ƒç”¨ [`start()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.start) å‰è®¾ç½®å¥½ï¼Œä¸ç„¶ä¼šæŠ›å‡º [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) ã€‚åˆå§‹å€¼ç»§æ‰¿äºŽåˆ›å»ºçº¿ç¨‹ï¼›ä¸»çº¿ç¨‹ä¸æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œå› æ­¤ä¸»çº¿ç¨‹åˆ›å»ºçš„æ‰€æœ‰çº¿ç¨‹é»˜è®¤éƒ½æ˜¯ [`daemon`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.daemon) = `False`ã€‚å½“æ²¡æœ‰å­˜æ´»çš„éžå®ˆæŠ¤çº¿ç¨‹æ—¶ï¼Œæ•´ä¸ªPythonç¨‹åºæ‰ä¼šé€€å‡ºã€‚- `isDaemon`()- `setDaemon`() æ—§çš„ [`name`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Thread.name) å–å€¼/è®¾å€¼ APIï¼›å»ºè®®ç›´æŽ¥å½“åšç‰¹å¾å±žæ€§ä½¿ç”¨å®ƒã€‚**CPython implementation detail:** CPythonä¸‹ï¼Œå› ä¸º [Global Interpreter Lock](https://docs.python.org/zh-cn/3.8/glossary.html#term-global-interpreter-lock)ï¼Œä¸€ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡ŒPythonä»£ç ï¼ˆå°½ç®¡å¦‚æ­¤ï¼ŒæŸäº›æ€§èƒ½å¯¼å‘çš„åº“å¯èƒ½ä¼šå…‹æœè¿™ä¸ªé™åˆ¶ï¼‰ã€‚å¦‚æžœä½ æƒ³è®©ä½ çš„åº”ç”¨æ›´å¥½çš„åˆ©ç”¨å¤šæ ¸è®¡ç®—æœºçš„è®¡ç®—æ€§èƒ½ï¼ŒæŽ¨èä½ ä½¿ç”¨ [`multiprocessing`](https://docs.python.org/zh-cn/3.8/library/multiprocessing.html#module-multiprocessing) æˆ–è€… [`concurrent.futures.ProcessPoolExecutor`](https://docs.python.org/zh-cn/3.8/library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor) ã€‚ä½†æ˜¯å¦‚æžœä½ æƒ³åŒæ—¶è¿è¡Œå¤šä¸ªI/Oç»‘å®šä»»åŠ¡ï¼Œçº¿ç¨‹ä»ç„¶æ˜¯ä¸€ä¸ªåˆé€‚çš„æ¨¡åž‹ã€‚### é”å¯¹è±¡åŽŸå§‹é”æ˜¯ä¸€ä¸ªåœ¨é”å®šæ—¶ä¸å±žäºŽç‰¹å®šçº¿ç¨‹çš„åŒæ­¥åŸºå…ƒç»„ä»¶ã€‚åœ¨Pythonä¸­ï¼Œå®ƒæ˜¯èƒ½ç”¨çš„æœ€ä½Žçº§çš„åŒæ­¥åŸºå…ƒç»„ä»¶ï¼Œç”± [`_thread`](https://docs.python.org/zh-cn/3.8/library/_thread.html#module-_thread) æ‰©å±•æ¨¡å—ç›´æŽ¥å®žçŽ°ã€‚åŽŸå§‹é”å¤„äºŽ &quot;é”å®š&quot; æˆ–è€… &quot;éžé”å®š&quot; ä¸¤ç§çŠ¶æ€ä¹‹ä¸€ã€‚å®ƒè¢«åˆ›å»ºæ—¶ä¸ºéžé”å®šçŠ¶æ€ã€‚å®ƒæœ‰ä¸¤ä¸ªåŸºæœ¬æ–¹æ³•ï¼Œ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire) å’Œ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) ã€‚å½“çŠ¶æ€ä¸ºéžé”å®šæ—¶ï¼Œ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire) å°†çŠ¶æ€æ”¹ä¸º é”å®š å¹¶ç«‹å³è¿”å›žã€‚å½“çŠ¶æ€æ˜¯é”å®šæ—¶ï¼Œ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire) å°†é˜»å¡žè‡³å…¶ä»–çº¿ç¨‹è°ƒç”¨ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) å°†å…¶æ”¹ä¸ºéžé”å®šçŠ¶æ€ï¼Œç„¶åŽ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire) è°ƒç”¨é‡ç½®å…¶ä¸ºé”å®šçŠ¶æ€å¹¶è¿”å›žã€‚ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) åªåœ¨é”å®šçŠ¶æ€ä¸‹è°ƒç”¨ï¼› å®ƒå°†çŠ¶æ€æ”¹ä¸ºéžé”å®šå¹¶ç«‹å³è¿”å›žã€‚å¦‚æžœå°è¯•é‡Šæ”¾ä¸€ä¸ªéžé”å®šçš„é”ï¼Œåˆ™ä¼šå¼•å‘ [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚é”åŒæ ·æ”¯æŒ [ä¸Šä¸‹æ–‡ç®¡ç†åè®®](https://docs.python.org/zh-cn/3.8/library/threading.html#with-locks)ã€‚å½“å¤šä¸ªçº¿ç¨‹åœ¨ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire) ç­‰å¾…çŠ¶æ€è½¬å˜ä¸ºæœªé”å®šè¢«é˜»å¡žï¼Œç„¶åŽ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) é‡ç½®çŠ¶æ€ä¸ºæœªé”å®šæ—¶ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ç»§ç»­æ‰§è¡Œï¼›è‡³äºŽå“ªä¸ªç­‰å¾…çº¿ç¨‹ç»§ç»­æ‰§è¡Œæ²¡æœ‰å®šä¹‰ï¼Œå¹¶ä¸”ä¼šæ ¹æ®å®žçŽ°è€Œä¸åŒã€‚æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œéƒ½æ˜¯åŽŸå­æ€§çš„ã€‚*class* `threading.Lock`å®žçŽ°åŽŸå§‹é”å¯¹è±¡çš„ç±»ã€‚ä¸€æ—¦ä¸€ä¸ªçº¿ç¨‹èŽ·å¾—ä¸€ä¸ªé”ï¼Œä¼šé˜»å¡žéšåŽå°è¯•èŽ·å¾—é”çš„çº¿ç¨‹ï¼Œç›´åˆ°å®ƒè¢«é‡Šæ”¾ï¼›ä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥é‡Šæ”¾å®ƒã€‚éœ€è¦æ³¨æ„çš„æ˜¯ `Lock` å…¶å®žæ˜¯ä¸€ä¸ªå·¥åŽ‚å‡½æ•°ï¼Œè¿”å›žå¹³å°æ”¯æŒçš„å…·ä½“é”ç±»ä¸­æœ€æœ‰æ•ˆçš„ç‰ˆæœ¬çš„å®žä¾‹ã€‚- `acquire`(*blocking=True*, *timeout=-1*) å¯ä»¥é˜»å¡žæˆ–éžé˜»å¡žåœ°èŽ·å¾—é”ã€‚å½“è°ƒç”¨æ—¶å‚æ•° *blocking* è®¾ç½®ä¸º `True` ï¼ˆç¼ºçœå€¼ï¼‰ï¼Œé˜»å¡žç›´åˆ°é”è¢«é‡Šæ”¾ï¼Œç„¶åŽå°†é”é”å®šå¹¶è¿”å›ž `True` ã€‚åœ¨å‚æ•° *blocking* è¢«è®¾ç½®ä¸º `False` çš„æƒ…å†µä¸‹è°ƒç”¨ï¼Œå°†ä¸ä¼šå‘ç”Ÿé˜»å¡žã€‚å¦‚æžœè°ƒç”¨æ—¶ *blocking* è®¾ä¸º `True` ä¼šé˜»å¡žï¼Œå¹¶ç«‹å³è¿”å›ž `False` ï¼›å¦åˆ™ï¼Œå°†é”é”å®šå¹¶è¿”å›ž `True`ã€‚å½“æµ®ç‚¹åž‹ *timeout* å‚æ•°è¢«è®¾ç½®ä¸ºæ­£å€¼è°ƒç”¨æ—¶ï¼Œåªè¦æ— æ³•èŽ·å¾—é”ï¼Œå°†æœ€å¤šé˜»å¡ž *timeout* è®¾å®šçš„ç§’æ•°ã€‚*timeout* å‚æ•°è¢«è®¾ç½®ä¸º `-1` æ—¶å°†æ— é™ç­‰å¾…ã€‚å½“ *blocking* ä¸º false æ—¶ï¼Œ*timeout* æŒ‡å®šçš„å€¼å°†è¢«å¿½ç•¥ã€‚å¦‚æžœæˆåŠŸèŽ·å¾—é”ï¼Œåˆ™è¿”å›ž `True`ï¼Œå¦åˆ™è¿”å›ž `False` (ä¾‹å¦‚å‘ç”Ÿ *è¶…æ—¶* çš„æ—¶å€™)ã€‚*åœ¨ 3.2 ç‰ˆæ›´æ”¹:* æ–°çš„ *timeout* å½¢å‚ã€‚*åœ¨ 3.2 ç‰ˆæ›´æ”¹:* çŽ°åœ¨å¦‚æžœåº•å±‚çº¿ç¨‹å®žçŽ°æ”¯æŒï¼Œåˆ™å¯ä»¥é€šè¿‡POSIXä¸Šçš„ä¿¡å·ä¸­æ–­é”çš„èŽ·å–ã€‚- `release`() é‡Šæ”¾ä¸€ä¸ªé”ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨ä»»ä½•çº¿ç¨‹ä¸­è°ƒç”¨ï¼Œä¸å•æŒ‡èŽ·å¾—é”çš„çº¿ç¨‹ã€‚å½“é”è¢«é”å®šï¼Œå°†å®ƒé‡ç½®ä¸ºæœªé”å®šï¼Œå¹¶è¿”å›žã€‚å¦‚æžœå…¶ä»–çº¿ç¨‹æ­£åœ¨ç­‰å¾…è¿™ä¸ªé”è§£é”è€Œè¢«é˜»å¡žï¼Œåªå…è®¸å…¶ä¸­ä¸€ä¸ªå…è®¸ã€‚åœ¨æœªé”å®šçš„é”è°ƒç”¨æ—¶ï¼Œä¼šå¼•å‘ [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚æ²¡æœ‰è¿”å›žå€¼ã€‚- `locked`() Return true if the lock is acquired.### é€’å½’é”é‡å…¥é”æ˜¯ä¸€ä¸ªå¯ä»¥è¢«åŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡èŽ·å–çš„åŒæ­¥åŸºå…ƒç»„ä»¶ã€‚åœ¨å†…éƒ¨ï¼Œå®ƒåœ¨åŸºå…ƒé”çš„é”å®š/éžé”å®šçŠ¶æ€ä¸Šé™„åŠ äº† &quot;æ‰€å±žçº¿ç¨‹&quot; å’Œ &quot;é€’å½’ç­‰çº§&quot; çš„æ¦‚å¿µã€‚åœ¨é”å®šçŠ¶æ€ä¸‹ï¼ŒæŸäº›çº¿ç¨‹æ‹¥æœ‰é” ï¼› åœ¨éžé”å®šçŠ¶æ€ä¸‹ï¼Œ æ²¡æœ‰çº¿ç¨‹æ‹¥æœ‰å®ƒã€‚è‹¥è¦é”å®šé”ï¼Œçº¿ç¨‹è°ƒç”¨å…¶ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.RLock.acquire) æ–¹æ³•ï¼›ä¸€æ—¦çº¿ç¨‹æ‹¥æœ‰äº†é”ï¼Œæ–¹æ³•å°†è¿”å›žã€‚è‹¥è¦è§£é”ï¼Œçº¿ç¨‹è°ƒç”¨ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) æ–¹æ³•ã€‚ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire)/[`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) å¯¹å¯ä»¥åµŒå¥—ï¼›åªæœ‰æœ€ç»ˆ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) (æœ€å¤–é¢ä¸€å¯¹çš„ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.release) ) å°†é”è§£å¼€ï¼Œæ‰èƒ½è®©å…¶ä»–çº¿ç¨‹ç»§ç»­å¤„ç† [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock.acquire) é˜»å¡žã€‚é€’å½’é”ä¹Ÿæ”¯æŒ [ä¸Šä¸‹æ–‡ç®¡ç†åè®®](https://docs.python.org/zh-cn/3.8/library/threading.html#with-locks)ã€‚*class* `threading.RLock`æ­¤ç±»å®žçŽ°äº†é‡å…¥é”å¯¹è±¡ã€‚é‡å…¥é”å¿…é¡»ç”±èŽ·å–å®ƒçš„çº¿ç¨‹é‡Šæ”¾ã€‚ä¸€æ—¦çº¿ç¨‹èŽ·å¾—äº†é‡å…¥é”ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹å†æ¬¡èŽ·å–å®ƒå°†ä¸é˜»å¡žï¼›çº¿ç¨‹å¿…é¡»åœ¨æ¯æ¬¡èŽ·å–å®ƒæ—¶é‡Šæ”¾ä¸€æ¬¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ `RLock` å…¶å®žæ˜¯ä¸€ä¸ªå·¥åŽ‚å‡½æ•°ï¼Œè¿”å›žå¹³å°æ”¯æŒçš„å…·ä½“é€’å½’é”ç±»ä¸­æœ€æœ‰æ•ˆçš„ç‰ˆæœ¬çš„å®žä¾‹ã€‚- `acquire`(*blocking=True*, *timeout=-1*) å¯ä»¥é˜»å¡žæˆ–éžé˜»å¡žåœ°èŽ·å¾—é”ã€‚ å½“æ— å‚æ•°è°ƒç”¨æ—¶ï¼š å¦‚æžœè¿™ä¸ªçº¿ç¨‹å·²ç»æ‹¥æœ‰é”ï¼Œé€’å½’çº§åˆ«å¢žåŠ ä¸€ï¼Œå¹¶ç«‹å³è¿”å›žã€‚å¦åˆ™ï¼Œå¦‚æžœå…¶ä»–çº¿ç¨‹æ‹¥æœ‰è¯¥é”ï¼Œåˆ™é˜»å¡žè‡³è¯¥é”è§£é”ã€‚ä¸€æ—¦é”è¢«è§£é”(ä¸å±žäºŽä»»ä½•çº¿ç¨‹)ï¼Œåˆ™æŠ¢å¤ºæ‰€æœ‰æƒï¼Œè®¾ç½®é€’å½’ç­‰çº§ä¸ºä¸€ï¼Œå¹¶è¿”å›žã€‚å¦‚æžœå¤šä¸ªçº¿ç¨‹è¢«é˜»å¡žï¼Œç­‰å¾…é”è¢«è§£é”ï¼Œä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŠ¢åˆ°é”çš„æ‰€æœ‰æƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ²¡æœ‰è¿”å›žå€¼ã€‚ å½“å‘èµ·è°ƒç”¨æ—¶å°† *blocking* å‚æ•°è®¾ä¸ºçœŸå€¼ï¼Œåˆ™æ‰§è¡Œä¸Žæ— å‚æ•°è°ƒç”¨æ—¶ä¸€æ ·çš„æ“ä½œï¼Œç„¶åŽè¿”å›ž `True`ã€‚ å½“å‘èµ·è°ƒç”¨æ—¶å°† *blocking* å‚æ•°è®¾ä¸ºå‡å€¼ï¼Œåˆ™ä¸è¿›è¡Œé˜»å¡žã€‚ å¦‚æžœä¸€ä¸ªæ— å‚æ•°è°ƒç”¨å°†è¦é˜»å¡žï¼Œåˆ™ç«‹å³è¿”å›ž `False`ï¼›åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæ‰§è¡Œä¸Žæ— å‚æ•°è°ƒç”¨æ—¶ä¸€æ ·çš„æ“ä½œï¼Œç„¶åŽè¿”å›ž `True`ã€‚ å½“å‘èµ·è°ƒç”¨æ—¶å°†æµ®ç‚¹æ•°çš„ *timeout* å‚æ•°è®¾ä¸ºæ­£å€¼æ—¶ï¼Œåªè¦æ— æ³•èŽ·å¾—é”ï¼Œå°†æœ€å¤šé˜»å¡ž *timeout* æ‰€æŒ‡å®šçš„ç§’æ•°ã€‚ å¦‚æžœå·²ç»èŽ·å¾—é”åˆ™è¿”å›ž `True`ï¼Œå¦‚æžœè¶…æ—¶åˆ™è¿”å›žå‡å€¼ã€‚- `release`() é‡Šæ”¾é”ï¼Œè‡ªå‡é€’å½’ç­‰çº§ã€‚å¦‚æžœå‡åˆ°é›¶ï¼Œåˆ™å°†é”é‡ç½®ä¸ºéžé”å®šçŠ¶æ€(ä¸è¢«ä»»ä½•çº¿ç¨‹æ‹¥æœ‰)ï¼Œå¹¶ä¸”ï¼Œå¦‚æžœå…¶ä»–çº¿ç¨‹æ­£è¢«é˜»å¡žç€ç­‰å¾…é”è¢«è§£é”ï¼Œåˆ™ä»…å…è®¸å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ç»§ç»­ã€‚å¦‚æžœè‡ªå‡åŽï¼Œé€’å½’ç­‰çº§ä»ç„¶ä¸æ˜¯é›¶ï¼Œåˆ™é”ä¿æŒé”å®šï¼Œä»ç”±è°ƒç”¨çº¿ç¨‹æ‹¥æœ‰ã€‚ åªæœ‰å½“å‰çº¿ç¨‹æ‹¥æœ‰é”æ‰èƒ½è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æžœé”è¢«é‡Šæ”¾åŽè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šå¼•èµ· [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚ æ²¡æœ‰è¿”å›žå€¼ã€‚### æ¡ä»¶å¯¹è±¡æ¡ä»¶å˜é‡æ€»æ˜¯ä¸ŽæŸç§ç±»åž‹çš„é”å¯¹è±¡ç›¸å…³è”ï¼Œé”å¯¹è±¡å¯ä»¥é€šè¿‡ä¼ å…¥èŽ·å¾—ï¼Œæˆ–è€…åœ¨ç¼ºçœçš„æƒ…å†µä¸‹è‡ªåŠ¨åˆ›å»ºã€‚å½“å¤šä¸ªæ¡ä»¶å˜é‡éœ€è¦å…±äº«åŒä¸€ä¸ªé”æ—¶ï¼Œä¼ å…¥ä¸€ä¸ªé”å¾ˆæœ‰ç”¨ã€‚é”æ˜¯æ¡ä»¶å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½ ä¸å¿…å•ç‹¬åœ°è·Ÿè¸ªå®ƒã€‚æ¡ä»¶å˜é‡æœä»Ž [ä¸Šä¸‹æ–‡ç®¡ç†åè®®](https://docs.python.org/zh-cn/3.8/library/threading.html#with-locks)ï¼šä½¿ç”¨ `with` è¯­å¥ä¼šåœ¨å®ƒåŒ…å›´çš„ä»£ç å—å†…èŽ·å–å…³è”çš„é”ã€‚ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.acquire) å’Œ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.release) æ–¹æ³•ä¹Ÿèƒ½è°ƒç”¨å…³è”é”çš„ç›¸å…³æ–¹æ³•ã€‚å…¶å®ƒæ–¹æ³•å¿…é¡»åœ¨æŒæœ‰å…³è”çš„é”çš„æƒ…å†µä¸‹è°ƒç”¨ã€‚ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) æ–¹æ³•é‡Šæ”¾é”ï¼Œç„¶åŽé˜»å¡žç›´åˆ°å…¶å®ƒçº¿ç¨‹è°ƒç”¨ [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) æ–¹æ³•æˆ– [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) æ–¹æ³•å”¤é†’å®ƒã€‚ä¸€æ—¦è¢«å”¤é†’ï¼Œ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) æ–¹æ³•é‡æ–°èŽ·å–é”å¹¶è¿”å›žã€‚å®ƒä¹Ÿå¯ä»¥æŒ‡å®šè¶…æ—¶æ—¶é—´ã€‚The [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) method wakes up one of the threads waiting for the condition variable, if any are waiting. The [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) method wakes up all threads waiting for the condition variable.æ³¨æ„ï¼š [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) æ–¹æ³•å’Œ [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) æ–¹æ³•å¹¶ä¸ä¼šé‡Šæ”¾é”ï¼Œè¿™æ„å‘³ç€è¢«å”¤é†’çš„çº¿ç¨‹ä¸ä¼šç«‹å³ä»Žå®ƒä»¬çš„ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) æ–¹æ³•è°ƒç”¨ä¸­è¿”å›žï¼Œè€Œæ˜¯ä¼šåœ¨è°ƒç”¨äº† [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) æ–¹æ³•æˆ– [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) æ–¹æ³•çš„çº¿ç¨‹æœ€ç»ˆæ”¾å¼ƒäº†é”çš„æ‰€æœ‰æƒåŽè¿”å›žã€‚ä½¿ç”¨æ¡ä»¶å˜é‡çš„å…¸åž‹ç¼–ç¨‹é£Žæ ¼æ˜¯å°†é”ç”¨äºŽåŒæ­¥æŸäº›å…±äº«çŠ¶æ€çš„æƒé™ï¼Œé‚£äº›å¯¹çŠ¶æ€çš„æŸäº›ç‰¹å®šæ”¹å˜æ„Ÿå…´è¶£çš„çº¿ç¨‹ï¼Œå®ƒä»¬é‡å¤è°ƒç”¨ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) æ–¹æ³•ï¼Œç›´åˆ°çœ‹åˆ°æ‰€æœŸæœ›çš„æ”¹å˜å‘ç”Ÿï¼›è€Œå¯¹äºŽä¿®æ”¹çŠ¶æ€çš„çº¿ç¨‹ï¼Œå®ƒä»¬å°†å½“å‰çŠ¶æ€æ”¹å˜ä¸ºå¯èƒ½æ˜¯ç­‰å¾…è€…æ‰€æœŸå¾…çš„æ–°çŠ¶æ€åŽï¼Œè°ƒç”¨ [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) æ–¹æ³•æˆ–è€… [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æ˜¯ä¸€ä¸ªé€šç”¨çš„æ— é™ç¼“å†²åŒºå®¹é‡çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æƒ…å½¢ï¼š Consume one itemwith cv: while not an_item_is_available(): cv.wait() get_an_available_item() Produce one itemwith cv: make_an_item_available() cv.notify()12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788ä½¿ç”¨ `while` å¾ªçŽ¯æ£€æŸ¥æ‰€è¦æ±‚çš„æ¡ä»¶æˆç«‹ä¸Žå¦æ˜¯æœ‰å¿…è¦çš„ï¼Œå› ä¸º [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) æ–¹æ³•å¯èƒ½è¦ç»è¿‡ä¸ç¡®å®šé•¿åº¦çš„æ—¶é—´åŽæ‰ä¼šè¿”å›žï¼Œè€Œæ­¤æ—¶å¯¼è‡´ [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) æ–¹æ³•è°ƒç”¨çš„é‚£ä¸ªæ¡ä»¶å¯èƒ½å·²ç»ä¸å†æˆç«‹ã€‚è¿™æ˜¯å¤šçº¿ç¨‹ç¼–ç¨‹æ‰€å›ºæœ‰çš„é—®é¢˜ã€‚ [`wait_for()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait_for) æ–¹æ³•å¯è‡ªåŠ¨åŒ–æ¡ä»¶æ£€æŸ¥ï¼Œå¹¶ç®€åŒ–è¶…æ—¶è®¡ç®—ã€‚~~~python# Consume an itemwith cv: cv.wait_for(an_item_is_available) get_an_available_item()~~~é€‰æ‹© [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) è¿˜æ˜¯ [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) ï¼Œå–å†³äºŽä¸€æ¬¡çŠ¶æ€æ”¹å˜æ˜¯åªèƒ½è¢«ä¸€ä¸ªè¿˜æ˜¯èƒ½è¢«å¤šä¸ªç­‰å¾…çº¿ç¨‹æ‰€ç”¨ã€‚ä¾‹å¦‚åœ¨ä¸€ä¸ªå…¸åž‹çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æƒ…å½¢ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªé¡¹ç›®åˆ°ç¼“å†²åŒºåªéœ€å”¤é†’ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹ã€‚*class* `threading.Condition`(*lock=None*)å®žçŽ°æ¡ä»¶å˜é‡å¯¹è±¡çš„ç±»ã€‚ä¸€ä¸ªæ¡ä»¶å˜é‡å¯¹è±¡å…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹åœ¨è¢«å…¶å®ƒçº¿ç¨‹æ‰€é€šçŸ¥ä¹‹å‰è¿›è¡Œç­‰å¾…ã€‚å¦‚æžœç»™å‡ºäº†éž `None` çš„ *lock* å‚æ•°ï¼Œåˆ™å®ƒå¿…é¡»ä¸º [`Lock`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Lock) æˆ–è€… [`RLock`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.RLock) å¯¹è±¡ï¼Œå¹¶ä¸”å®ƒå°†è¢«ç”¨ä½œåº•å±‚é”ã€‚å¦åˆ™ï¼Œå°†ä¼šåˆ›å»ºæ–°çš„ [`RLock`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.RLock) å¯¹è±¡ï¼Œå¹¶å°†å…¶ç”¨ä½œåº•å±‚é”ã€‚*åœ¨ 3.3 ç‰ˆæ›´æ”¹:* ä»Žå·¥åŽ‚å‡½æ•°å˜ä¸ºç±»ã€‚- `acquire`(**args*) è¯·æ±‚åº•å±‚é”ã€‚æ­¤æ–¹æ³•è°ƒç”¨åº•å±‚é”çš„ç›¸åº”æ–¹æ³•ï¼Œè¿”å›žå€¼æ˜¯åº•å±‚é”ç›¸åº”æ–¹æ³•çš„è¿”å›žå€¼ã€‚- `release`() é‡Šæ”¾åº•å±‚é”ã€‚æ­¤æ–¹æ³•è°ƒç”¨åº•å±‚é”çš„ç›¸åº”æ–¹æ³•ã€‚æ²¡æœ‰è¿”å›žå€¼ã€‚- `wait`(*timeout=None*) ç­‰å¾…ç›´åˆ°è¢«é€šçŸ¥æˆ–å‘ç”Ÿè¶…æ—¶ã€‚å¦‚æžœçº¿ç¨‹åœ¨è°ƒç”¨æ­¤æ–¹æ³•æ—¶æ²¡æœ‰èŽ·å¾—é”ï¼Œå°†ä¼šå¼•å‘ [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚è¿™ä¸ªæ–¹æ³•é‡Šæ”¾åº•å±‚é”ï¼Œç„¶åŽé˜»å¡žï¼Œç›´åˆ°åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸­è°ƒç”¨åŒä¸€ä¸ªæ¡ä»¶å˜é‡çš„ [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) æˆ– [`notify_all()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify_all) å”¤é†’å®ƒï¼Œæˆ–è€…ç›´åˆ°å¯é€‰çš„è¶…æ—¶å‘ç”Ÿã€‚ä¸€æ—¦è¢«å”¤é†’æˆ–è€…è¶…æ—¶ï¼Œå®ƒé‡æ–°èŽ·å¾—é”å¹¶è¿”å›žã€‚å½“æä¾›äº† *timeout* å‚æ•°ä¸”ä¸æ˜¯ `None` æ—¶ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œä»£è¡¨æ“ä½œçš„è¶…æ—¶æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼ˆå¯ä»¥ä¸ºå°æ•°ï¼‰ã€‚å½“åº•å±‚é”æ˜¯ä¸ª [`RLock`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.RLock) ï¼Œä¸ä¼šä½¿ç”¨å®ƒçš„ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.release) æ–¹æ³•é‡Šæ”¾é”ï¼Œå› ä¸ºå½“å®ƒè¢«é€’å½’å¤šæ¬¡èŽ·å–æ—¶ï¼Œå®žé™…ä¸Šå¯èƒ½æ— æ³•è§£é”ã€‚ç›¸åï¼Œä½¿ç”¨äº† [`RLock`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.RLock) ç±»çš„å†…éƒ¨æŽ¥å£ï¼Œå³ä½¿å¤šæ¬¡é€’å½’èŽ·å–å®ƒä¹Ÿèƒ½è§£é”å®ƒã€‚ ç„¶åŽï¼Œåœ¨é‡æ–°èŽ·å–é”æ—¶ï¼Œä½¿ç”¨å¦ä¸€ä¸ªå†…éƒ¨æŽ¥å£æ¥æ¢å¤é€’å½’çº§åˆ«ã€‚è¿”å›ž `True` ï¼Œé™¤éžæä¾›çš„ *timeout* è¿‡æœŸï¼Œè¿™ç§æƒ…å†µä¸‹è¿”å›ž `False`ã€‚*åœ¨ 3.2 ç‰ˆæ›´æ”¹:* å¾ˆæ˜Žæ˜¾ï¼Œæ–¹æ³•æ€»æ˜¯è¿”å›ž `None`ã€‚- `wait_for`(*predicate*, *timeout=None*) ç­‰å¾…ï¼Œç›´åˆ°æ¡ä»¶è®¡ç®—ä¸ºçœŸã€‚ *predicate* åº”è¯¥æ˜¯ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡è€Œä¸”å®ƒçš„è¿”å›žå€¼å¯è¢«è§£é‡Šä¸ºä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¯ä»¥æä¾› *timeout* å‚æ•°ç»™å‡ºæœ€å¤§ç­‰å¾…æ—¶é—´ã€‚è¿™ä¸ªå®žç”¨æ–¹æ³•ä¼šé‡å¤åœ°è°ƒç”¨ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) ç›´åˆ°æ»¡è¶³åˆ¤æ–­å¼æˆ–è€…å‘ç”Ÿè¶…æ—¶ã€‚è¿”å›žå€¼æ˜¯åˆ¤æ–­å¼æœ€åŽä¸€ä¸ªè¿”å›žå€¼ï¼Œè€Œä¸”å¦‚æžœæ–¹æ³•å‘ç”Ÿè¶…æ—¶ä¼šè¿”å›ž `False` ã€‚å¿½ç•¥è¶…æ—¶åŠŸèƒ½ï¼Œè°ƒç”¨æ­¤æ–¹æ³•å¤§è‡´ç›¸å½“äºŽç¼–å†™:`while not predicate(): cv.wait() `å› æ­¤ï¼Œè§„åˆ™åŒæ ·é€‚ç”¨äºŽ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) ï¼šé”å¿…é¡»åœ¨è¢«è°ƒç”¨æ—¶ä¿æŒèŽ·å–ï¼Œå¹¶åœ¨è¿”å›žæ—¶é‡æ–°èŽ·å–ã€‚ éšç€é”å®šæ‰§è¡Œåˆ¤æ–­å¼ã€‚*3.2 æ–°ç‰ˆåŠŸèƒ½.*- `notify`(*n=1*) é»˜è®¤å”¤é†’ä¸€ä¸ªç­‰å¾…è¿™ä¸ªæ¡ä»¶çš„çº¿ç¨‹ã€‚å¦‚æžœè°ƒç”¨çº¿ç¨‹åœ¨æ²¡æœ‰èŽ·å¾—é”çš„æƒ…å†µä¸‹è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šå¼•å‘ [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚è¿™ä¸ªæ–¹æ³•å”¤é†’æœ€å¤š *n* ä¸ªæ­£åœ¨ç­‰å¾…è¿™ä¸ªæ¡ä»¶å˜é‡çš„çº¿ç¨‹ï¼›å¦‚æžœæ²¡æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œè¿™æ˜¯ä¸€ä¸ªç©ºæ“ä½œã€‚å½“å‰å®žçŽ°ä¸­ï¼Œå¦‚æžœè‡³å°‘æœ‰ *n* ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…ï¼Œå‡†ç¡®å”¤é†’ *n* ä¸ªçº¿ç¨‹ã€‚ä½†æ˜¯ä¾èµ–è¿™ä¸ªè¡Œä¸ºå¹¶ä¸å®‰å…¨ã€‚æœªæ¥ï¼Œä¼˜åŒ–çš„å®žçŽ°æœ‰æ—¶ä¼šå”¤é†’è¶…è¿‡ *n* ä¸ªçº¿ç¨‹ã€‚æ³¨æ„ï¼šè¢«å”¤é†’çš„çº¿ç¨‹å®žé™…ä¸Šä¸ä¼šè¿”å›žå®ƒè°ƒç”¨çš„ [`wait()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.wait) ï¼Œç›´åˆ°å®ƒå¯ä»¥é‡æ–°èŽ·å¾—é”ã€‚å› ä¸º [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) ä¸ä¼šé‡Šæ”¾é”ï¼Œåªæœ‰å®ƒçš„è°ƒç”¨è€…åº”è¯¥è¿™æ ·åšã€‚- `notify_all`() å”¤é†’æ‰€æœ‰æ­£åœ¨ç­‰å¾…è¿™ä¸ªæ¡ä»¶çš„çº¿ç¨‹ã€‚è¿™ä¸ªæ–¹æ³•è¡Œä¸ºä¸Ž [`notify()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Condition.notify) ç›¸ä¼¼ï¼Œä½†å¹¶ä¸åªå”¤é†’å•ä¸€çº¿ç¨‹ï¼Œè€Œæ˜¯å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ã€‚å¦‚æžœè°ƒç”¨çº¿ç¨‹åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶æ²¡æœ‰èŽ·å¾—é”ï¼Œä¼šå¼•å‘ [`RuntimeError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#RuntimeError) å¼‚å¸¸ã€‚### ä¿¡å·é‡å¯¹è±¡è¿™æ˜¯è®¡ç®—æœºç§‘å­¦å²ä¸Šæœ€å¤è€çš„åŒæ­¥åŽŸè¯­ä¹‹ä¸€ï¼Œæ—©æœŸçš„è·å…°ç§‘å­¦å®¶ Edsger W. Dijkstra å‘æ˜Žäº†å®ƒã€‚ï¼ˆä»–ä½¿ç”¨åç§° `P()` å’Œ `V()` è€Œä¸æ˜¯ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.acquire) å’Œ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.release) ï¼‰ã€‚ä¸€ä¸ªä¿¡å·é‡ç®¡ç†ä¸€ä¸ªå†…éƒ¨è®¡æ•°å™¨ï¼Œè¯¥è®¡æ•°å™¨å›  [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.acquire) æ–¹æ³•çš„è°ƒç”¨è€Œé€’å‡ï¼Œå›  [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.release) æ–¹æ³•çš„è°ƒç”¨è€Œé€’å¢žã€‚ è®¡æ•°å™¨çš„å€¼æ°¸è¿œä¸ä¼šå°äºŽé›¶ï¼›å½“ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.acquire) æ–¹æ³•å‘çŽ°è®¡æ•°å™¨ä¸ºé›¶æ—¶ï¼Œå°†ä¼šé˜»å¡žï¼Œç›´åˆ°å…¶å®ƒçº¿ç¨‹è°ƒç”¨ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.release) æ–¹æ³•ã€‚ä¿¡å·é‡å¯¹è±¡ä¹Ÿæ”¯æŒ [ä¸Šä¸‹æ–‡ç®¡ç†åè®®](https://docs.python.org/zh-cn/3.8/library/threading.html#with-locks) ã€‚- *class* `threading.Semaphore`(*value=1*) è¯¥ç±»å®žçŽ°ä¿¡å·é‡å¯¹è±¡ã€‚ä¿¡å·é‡å¯¹è±¡ç®¡ç†ä¸€ä¸ªåŽŸå­æ€§çš„è®¡æ•°å™¨ï¼Œä»£è¡¨ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.release) æ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°å‡åŽ» [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.acquire) çš„è°ƒç”¨æ¬¡æ•°å†åŠ ä¸Šä¸€ä¸ªåˆå§‹å€¼ã€‚å¦‚æžœéœ€è¦ï¼Œ [`acquire()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.acquire) æ–¹æ³•å°†ä¼šé˜»å¡žç›´åˆ°å¯ä»¥è¿”å›žè€Œä¸ä¼šä½¿å¾—è®¡æ•°å™¨å˜æˆè´Ÿæ•°ã€‚åœ¨æ²¡æœ‰æ˜¾å¼ç»™å‡º *value* çš„å€¼æ—¶ï¼Œé»˜è®¤ä¸º1ã€‚ å¯é€‰å‚æ•° *value* èµ‹äºˆå†…éƒ¨è®¡æ•°å™¨åˆå§‹å€¼ï¼Œé»˜è®¤å€¼ä¸º `1` ã€‚å¦‚æžœ *value* è¢«èµ‹äºˆå°äºŽ0çš„å€¼ï¼Œå°†ä¼šå¼•å‘ [`ValueError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#ValueError) å¼‚å¸¸ã€‚ - `acquire`(*blocking=True*, *timeout=None*) èŽ·å–ä¸€ä¸ªä¿¡å·é‡ã€‚åœ¨ä¸å¸¦å‚æ•°çš„æƒ…å†µä¸‹è°ƒç”¨æ—¶ï¼šå¦‚æžœåœ¨è¿›å…¥æ—¶å†…éƒ¨è®¡æ•°å™¨çš„å€¼å¤§äºŽé›¶ï¼Œåˆ™å°†å…¶å‡ä¸€å¹¶ç«‹å³è¿”å›ž `True`.å¦‚æžœåœ¨è¿›å…¥æ—¶å†…éƒ¨è®¡æ•°å™¨çš„å€¼ä¸ºé›¶ï¼Œåˆ™å°†ä¼šé˜»å¡žç›´åˆ°è¢«å¯¹ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.release) çš„è°ƒç”¨å”¤é†’ã€‚ ä¸€æ—¦è¢«å”¤é†’ï¼ˆå¹¶ä¸”è®¡æ•°å™¨çš„å€¼å¤§äºŽ 0ï¼‰ï¼Œåˆ™å°†è®¡æ•°å™¨å‡ 1 å¹¶è¿”å›ž `True`ã€‚ æ¯æ¬¡å¯¹ [`release()`](https://docs.python.org/zh-cn/3.8/library/threading.html#threading.Semaphore.release) çš„è°ƒç”¨å°†åªå”¤é†’ä¸€ä¸ªçº¿ç¨‹ã€‚ çº¿ç¨‹è¢«å”¤é†’çš„æ¬¡åºæ˜¯ä¸å¯ç¡®å®šçš„ã€‚å½“å‘èµ·è°ƒç”¨æ—¶å°† *blocking* è®¾ä¸ºå‡å€¼ï¼Œåˆ™ä¸è¿›è¡Œé˜»å¡žã€‚ å¦‚æžœä¸€ä¸ªæ— å‚æ•°è°ƒç”¨å°†è¦é˜»å¡žï¼Œåˆ™ç«‹å³è¿”å›ž `False`ï¼›åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæ‰§è¡Œä¸Žæ— å‚æ•°è°ƒç”¨æ—¶ä¸€æ ·çš„æ“ä½œï¼Œç„¶åŽè¿”å›ž `True`ã€‚å½“å‘èµ·è°ƒç”¨æ—¶å¦‚æžœ *timeout* ä¸ä¸º `None`ï¼Œåˆ™å®ƒå°†é˜»å¡žæœ€å¤š *timeout* ç§’ã€‚ è¯·æ±‚åœ¨æ­¤æ—¶æ®µæ—¶æœªèƒ½æˆåŠŸå®ŒæˆèŽ·å–åˆ™å°†è¿”å›ž `False`ã€‚ åœ¨å…¶ä»–æƒ…å†µä¸‹è¿”å›ž `True`ã€‚*åœ¨ 3.2 ç‰ˆæ›´æ”¹:* æ–°çš„ *timeout* å½¢å‚ã€‚ - `release`() é‡Šæ”¾ä¸€ä¸ªä¿¡å·é‡ï¼Œå°†å†…éƒ¨è®¡æ•°å™¨çš„å€¼å¢žåŠ 1ã€‚å½“è®¡æ•°å™¨åŽŸå…ˆçš„å€¼ä¸º0ä¸”æœ‰å…¶å®ƒçº¿ç¨‹æ­£åœ¨ç­‰å¾…å®ƒå†æ¬¡å¤§äºŽ0æ—¶ï¼Œå”¤é†’æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ã€‚- *class* `threading.BoundedSemaphore`(*value=1*) è¯¥ç±»å®žçŽ°æœ‰ç•Œä¿¡å·é‡ã€‚æœ‰ç•Œä¿¡å·é‡é€šè¿‡æ£€æŸ¥ä»¥ç¡®ä¿å®ƒå½“å‰çš„å€¼ä¸ä¼šè¶…è¿‡åˆå§‹å€¼ã€‚å¦‚æžœè¶…è¿‡äº†åˆå§‹å€¼ï¼Œå°†ä¼šå¼•å‘ [`ValueError`](https://docs.python.org/zh-cn/3.8/library/exceptions.html#ValueError) å¼‚å¸¸ã€‚åœ¨å¤§å¤šæƒ…å†µä¸‹ï¼Œä¿¡å·é‡ç”¨äºŽä¿æŠ¤æ•°é‡æœ‰é™çš„èµ„æºã€‚å¦‚æžœä¿¡å·é‡è¢«é‡Šæ”¾çš„æ¬¡æ•°è¿‡å¤šï¼Œåˆ™è¡¨æ˜Žå‡ºçŽ°äº†é”™è¯¯ã€‚æ²¡æœ‰æŒ‡å®šæ—¶ï¼Œ *value* çš„å€¼é»˜è®¤ä¸º1ã€‚*åœ¨ 3.3 ç‰ˆæ›´æ”¹:* ä»Žå·¥åŽ‚å‡½æ•°å˜ä¸ºç±»ã€‚#### `Semaphore`ä¾‹å­ä¿¡å·é‡é€šå¸¸ç”¨äºŽä¿æŠ¤æ•°é‡æœ‰é™çš„èµ„æºï¼Œä¾‹å¦‚æ•°æ®åº“æœåŠ¡å™¨ã€‚åœ¨èµ„æºæ•°é‡å›ºå®šçš„ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½åº”è¯¥ä½¿ç”¨æœ‰ç•Œä¿¡å·é‡ã€‚åœ¨ç”Ÿæˆä»»ä½•å·¥ä½œçº¿ç¨‹å‰ï¼Œåº”è¯¥åœ¨ä¸»çº¿ç¨‹ä¸­åˆå§‹åŒ–ä¿¡å·é‡ã€‚~~~pythonmaxconnections = 5# ...pool_sema = BoundedSemaphore(value=maxconnections)~~~å·¥ä½œçº¿ç¨‹ç”ŸæˆåŽï¼Œå½“éœ€è¦è¿žæŽ¥æœåŠ¡å™¨æ—¶ï¼Œè¿™äº›çº¿ç¨‹å°†è°ƒç”¨ä¿¡å·é‡çš„ acquire å’Œ release æ–¹æ³•ï¼š```python conn = connectdb() try: # ... use connection ... finally: conn.close() ä½¿ç”¨æœ‰ç•Œä¿¡å·é‡èƒ½å‡å°‘è¿™ç§ç¼–ç¨‹é”™è¯¯ï¼šä¿¡å·é‡çš„é‡Šæ”¾æ¬¡æ•°å¤šäºŽå…¶è¯·æ±‚æ¬¡æ•°ã€‚ äº‹ä»¶å¯¹è±¡è¿™æ˜¯çº¿ç¨‹ä¹‹é—´é€šä¿¡çš„æœ€ç®€å•æœºåˆ¶ä¹‹ä¸€ï¼šä¸€ä¸ªçº¿ç¨‹å‘å‡ºäº‹ä»¶ä¿¡å·ï¼Œè€Œå…¶ä»–çº¿ç¨‹ç­‰å¾…è¯¥ä¿¡å·ã€‚ ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ç®¡ç†ä¸€ä¸ªå†…éƒ¨æ ‡å¿—ï¼Œè°ƒç”¨ set() æ–¹æ³•å¯å°†å…¶è®¾ç½®ä¸ºtrueï¼Œè°ƒç”¨ clear() æ–¹æ³•å¯å°†å…¶è®¾ç½®ä¸ºfalseï¼Œè°ƒç”¨ wait() æ–¹æ³•å°†è¿›å…¥é˜»å¡žç›´åˆ°æ ‡å¿—ä¸ºtrueã€‚ class threading.Event å®žçŽ°äº‹ä»¶å¯¹è±¡çš„ç±»ã€‚äº‹ä»¶å¯¹è±¡ç®¡ç†ä¸€ä¸ªå†…éƒ¨æ ‡å¿—ï¼Œè°ƒç”¨ set() æ–¹æ³•å¯å°†å…¶è®¾ç½®ä¸ºtrueã€‚è°ƒç”¨ clear() æ–¹æ³•å¯å°†å…¶è®¾ç½®ä¸ºfalseã€‚è°ƒç”¨ wait() æ–¹æ³•å°†è¿›å…¥é˜»å¡žç›´åˆ°æ ‡å¿—ä¸ºtrueã€‚è¿™ä¸ªæ ‡å¿—åˆå§‹æ—¶ä¸ºfalseã€‚åœ¨ 3.3 ç‰ˆæ›´æ”¹: ä»Žå·¥åŽ‚å‡½æ•°å˜ä¸ºç±»ã€‚is_set()å½“ä¸”ä»…å½“å†…éƒ¨æ——æ ‡ä¸ºæ—¶è¿”å›ž Trueã€‚set()å°†å†…éƒ¨æ ‡å¿—è®¾ç½®ä¸ºtrueã€‚æ‰€æœ‰æ­£åœ¨ç­‰å¾…è¿™ä¸ªäº‹ä»¶çš„çº¿ç¨‹å°†è¢«å”¤é†’ã€‚å½“æ ‡å¿—ä¸ºtrueæ—¶ï¼Œè°ƒç”¨ wait() æ–¹æ³•çš„çº¿ç¨‹ä¸ä¼šè¢«è¢«é˜»å¡žã€‚clear()å°†å†…éƒ¨æ ‡å¿—è®¾ç½®ä¸ºfalseã€‚ä¹‹åŽè°ƒç”¨ wait() æ–¹æ³•çš„çº¿ç¨‹å°†ä¼šè¢«é˜»å¡žï¼Œç›´åˆ°è°ƒç”¨ set() æ–¹æ³•å°†å†…éƒ¨æ ‡å¿—å†æ¬¡è®¾ç½®ä¸ºtrueã€‚wait(timeout=None)é˜»å¡žçº¿ç¨‹ç›´åˆ°å†…éƒ¨å˜é‡ä¸ºtrueã€‚å¦‚æžœè°ƒç”¨æ—¶å†…éƒ¨æ ‡å¿—ä¸ºtrueï¼Œå°†ç«‹å³è¿”å›žã€‚å¦åˆ™å°†é˜»å¡žçº¿ç¨‹ï¼Œç›´åˆ°è°ƒç”¨ set() æ–¹æ³•å°†æ ‡å¿—è®¾ç½®ä¸ºtrueæˆ–è€…å‘ç”Ÿå¯é€‰çš„è¶…æ—¶ã€‚å½“æä¾›äº†timeoutå‚æ•°ä¸”ä¸æ˜¯ None æ—¶ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°ï¼Œä»£è¡¨æ“ä½œçš„è¶…æ—¶æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ï¼ˆå¯ä»¥ä¸ºå°æ•°ï¼‰ã€‚å½“ä¸”ä»…å½“å†…éƒ¨æ——æ ‡åœ¨ç­‰å¾…è°ƒç”¨ä¹‹å‰æˆ–è€…ç­‰å¾…å¼€å§‹ä¹‹åŽè¢«è®¾ä¸ºçœŸå€¼æ—¶æ­¤æ–¹æ³•å°†è¿”å›ž Trueï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå°†æ€»æ˜¯è¿”å›ž True é™¤éžè®¾å®šäº†è¶…æ—¶ä¸”æ“ä½œå‘ç”Ÿäº†è¶…æ—¶ã€‚ å®šæ—¶å™¨å¯¹è±¡æ­¤ç±»è¡¨ç¤ºä¸€ä¸ªæ“ä½œåº”è¯¥åœ¨ç­‰å¾…ä¸€å®šçš„æ—¶é—´ä¹‹åŽè¿è¡Œ â€” ç›¸å½“äºŽä¸€ä¸ªå®šæ—¶å™¨ã€‚ Timer ç±»æ˜¯ Thread ç±»çš„å­ç±»ï¼Œå› æ­¤å¯ä»¥åƒä¸€ä¸ªè‡ªå®šä¹‰çº¿ç¨‹ä¸€æ ·å·¥ä½œã€‚ ä¸Žçº¿ç¨‹ä¸€æ ·ï¼Œé€šè¿‡è°ƒç”¨ start() æ–¹æ³•å¯åŠ¨å®šæ—¶å™¨ã€‚è€Œ cancel() æ–¹æ³•å¯ä»¥åœæ­¢è®¡æ—¶å™¨ï¼ˆåœ¨è®¡æ—¶ç»“æŸå‰ï¼‰ï¼Œ å®šæ—¶å™¨åœ¨æ‰§è¡Œå…¶æ“ä½œä¹‹å‰ç­‰å¾…çš„æ—¶é—´é—´éš”å¯èƒ½ä¸Žç”¨æˆ·æŒ‡å®šçš„æ—¶é—´é—´éš”ä¸å®Œå…¨ç›¸åŒã€‚ ä¾‹å¦‚: 12345def hello(): print("hello, world")t = Timer(30.0, hello)t.start() # after 30 seconds, "hello, world" will be printed class threading.Timer(interval, function, args=None, kwargs=None) åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨ç»è¿‡ interval ç§’çš„é—´éš”äº‹ä»¶åŽï¼Œå°†ä¼šç”¨å‚æ•° args å’Œå…³é”®å­—å‚æ•° kwargs è°ƒç”¨ functionã€‚å¦‚æžœ args ä¸º None ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™ä¼šä½¿ç”¨ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚å¦‚æžœ kwargs ä¸º None ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™ä¼šä½¿ç”¨ä¸€ä¸ªç©ºå­—å…¸ã€‚ cancel()Â¶ åœæ­¢å®šæ—¶å™¨å¹¶å–æ¶ˆæ‰§è¡Œè®¡æ—¶å™¨å°†è¦æ‰§è¡Œçš„æ“ä½œã€‚ä»…å½“è®¡æ—¶å™¨ä»å¤„äºŽç­‰å¾…çŠ¶æ€æ—¶æœ‰æ•ˆã€‚ æ …æ å¯¹è±¡æ …æ ç±»æä¾›ä¸€ä¸ªç®€å•çš„åŒæ­¥åŽŸè¯­ï¼Œç”¨äºŽåº”å¯¹å›ºå®šæ•°é‡çš„çº¿ç¨‹éœ€è¦å½¼æ­¤ç›¸äº’ç­‰å¾…çš„æƒ…å†µã€‚çº¿ç¨‹è°ƒç”¨ wait() æ–¹æ³•åŽå°†é˜»å¡žï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½è°ƒç”¨äº† wait() æ–¹æ³•ã€‚æ­¤æ—¶æ‰€æœ‰çº¿ç¨‹å°†è¢«åŒæ—¶é‡Šæ”¾ã€‚ æ …æ å¯¹è±¡å¯ä»¥è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œä½†è¿›ç¨‹çš„æ•°é‡ä¸èƒ½æ”¹å˜ã€‚ è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ç®€ä¾¿çš„æ–¹æ³•å®žçŽ°å®¢æˆ·ç«¯è¿›ç¨‹ä¸ŽæœåŠ¡ç«¯è¿›ç¨‹åŒæ­¥çš„ä¾‹å­ï¼š 1234567891011121314b = Barrier(2, timeout=5)def server(): start_server() b.wait() while True: connection = accept_connection() process_server_connection(connection)def client(): b.wait() while True: connection = make_connection() process_client_connection(connection) class threading.Barrier(parties, action=None, timeout=None) åˆ›å»ºä¸€ä¸ªéœ€è¦ parties ä¸ªçº¿ç¨‹çš„æ …æ å¯¹è±¡ã€‚å¦‚æžœæä¾›äº†å¯è°ƒç”¨çš„ action å‚æ•°ï¼Œå®ƒä¼šåœ¨æ‰€æœ‰çº¿ç¨‹è¢«é‡Šæ”¾æ—¶åœ¨å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ä¸­è‡ªåŠ¨è°ƒç”¨ã€‚ timeout æ˜¯é»˜è®¤çš„è¶…æ—¶æ—¶é—´ï¼Œå¦‚æžœæ²¡æœ‰åœ¨ wait() æ–¹æ³•ä¸­æŒ‡å®šè¶…æ—¶æ—¶é—´çš„è¯ã€‚ wait(timeout=None) å†²å‡ºæ …æ ã€‚å½“æ …æ ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½å·²ç»è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå®ƒä»¬å°†åŒæ—¶è¢«é‡Šæ”¾ã€‚å¦‚æžœæä¾›äº† timeout å‚æ•°ï¼Œè¿™é‡Œçš„ timeout å‚æ•°ä¼˜å…ˆäºŽåˆ›å»ºæ …æ å¯¹è±¡æ—¶æä¾›çš„ timeout å‚æ•°ã€‚å‡½æ•°è¿”å›žå€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå–å€¼èŒƒå›´åœ¨0åˆ° parties â€“ 1ï¼Œåœ¨æ¯ä¸ªçº¿ç¨‹ä¸­çš„è¿”å›žå€¼ä¸ç›¸åŒã€‚å¯ç”¨äºŽä»Žæ‰€æœ‰çº¿ç¨‹ä¸­é€‰æ‹©å”¯ä¸€çš„ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€äº›ç‰¹åˆ«çš„å·¥ä½œã€‚ä¾‹å¦‚ï¼š 1234i = barrier.wait()if i == 0: # Only one thread needs to print this print("passed the barrier") å¦‚æžœåˆ›å»ºæ …æ å¯¹è±¡æ—¶åœ¨æž„é€ å‡½æ•°ä¸­æä¾›äº† action å‚æ•°ï¼Œå®ƒå°†åœ¨å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾å‰è¢«è°ƒç”¨ã€‚å¦‚æžœæ­¤è°ƒç”¨å¼•å‘äº†å¼‚å¸¸ï¼Œæ …æ å¯¹è±¡å°†è¿›å…¥æŸåæ€ã€‚ å¦‚æžœå‘ç”Ÿäº†è¶…æ—¶ï¼Œæ …æ å¯¹è±¡å°†è¿›å…¥ç ´æŸæ€ã€‚ å¦‚æžœæ …æ å¯¹è±¡è¿›å…¥ç ´æŸæ€ï¼Œæˆ–é‡ç½®æ …æ æ—¶ä»æœ‰çº¿ç¨‹ç­‰å¾…é‡Šæ”¾ï¼Œå°†ä¼šå¼•å‘ BrokenBarrierError å¼‚å¸¸ã€‚ reset() é‡ç½®æ …æ ä¸ºé»˜è®¤çš„åˆå§‹æ€ã€‚å¦‚æžœæ …æ ä¸­ä»æœ‰çº¿ç¨‹ç­‰å¾…é‡Šæ”¾ï¼Œè¿™äº›çº¿ç¨‹å°†ä¼šæ”¶åˆ° BrokenBarrierError å¼‚å¸¸ã€‚ abort() Put the barrier into a broken state. This causes any active or future calls to wait() to fail with the BrokenBarrierError. Use this for example if one of the threads needs to abort, to avoid deadlocking the application.æ›´å¥½çš„æ–¹å¼æ˜¯ï¼šåˆ›å»ºæ …æ æ—¶æä¾›ä¸€ä¸ªåˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œæ¥è‡ªåŠ¨é¿å…æŸä¸ªçº¿ç¨‹å‡ºé”™ã€‚ parties å†²å‡ºæ …æ æ‰€éœ€è¦çš„çº¿ç¨‹æ•°é‡ã€‚ n_waiting å½“å‰æ—¶åˆ»æ­£åœ¨æ …æ ä¸­é˜»å¡žçš„çº¿ç¨‹æ•°é‡ã€‚ broken ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå€¼ä¸º True è¡¨æ˜Žæ …æ ä¸ºç ´æŸæ€ã€‚ exception threading.BrokenBarrierError å¼‚å¸¸ç±»ï¼Œæ˜¯ RuntimeError å¼‚å¸¸çš„å­ç±»ï¼Œåœ¨ Barrier å¯¹è±¡é‡ç½®æ—¶ä»æœ‰çº¿ç¨‹é˜»å¡žæ—¶å’Œå¯¹è±¡è¿›å…¥ç ´æŸæ€æ—¶è¢«å¼•å‘ã€‚ åœ¨ with è¯­å¥ä¸­ä½¿ç”¨é”ã€æ¡ä»¶å’Œä¿¡å·é‡è¿™ä¸ªæ¨¡å—æä¾›çš„å¸¦æœ‰ acquire() å’Œ release() æ–¹æ³•çš„å¯¹è±¡ï¼Œå¯ä»¥è¢«ç”¨ä½œ with è¯­å¥çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚å½“è¿›å…¥è¯­å¥å—æ—¶ acquire() æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œé€€å‡ºè¯­å¥å—æ—¶ release() ä¼šè¢«è°ƒç”¨ã€‚å› æ­¤ï¼Œä»¥ä¸‹ç‰‡æ®µ: 12with some_lock: # do something... ç›¸å½“äºŽ: 12345some_lock.acquire()try: # do something...finally: some_lock.release() å°ç»“GIL åŽŸç†å‚è€ƒ stackoverflowä¸Š å¤§ç¥žçš„è§£é‡Š Pythonâ€™s GIL is intended to serialize access to interpreter internals from different threads. On multi-core systems, it means that multiple threads canâ€™t effectively make use of multiple cores. (If the GIL didnâ€™t lead to this problem, most people wouldnâ€™t care about the GIL - itâ€™s only being raised as an issue because of the increasing prevalence of multi-core systems.) If you want to understand it in detail, you can view this video or look at this set of slides. It might be too much information, but then you did ask for details :-) Note that Pythonâ€™s GIL is only really an issue for CPython, the reference implementation. Jython and IronPython donâ€™t have a GIL. As a Python developer, you donâ€™t generally come across the GIL unless youâ€™re writing a C extension. C extension writers need to release the GIL when their extensions do blocking I/O, so that other threads in the Python process get a chance to run. ç®€å•è¯´ æ‰€è°“çš„å…¨å±€çº¿ç¨‹é”,å°±æ˜¯åŒæ­¥çº¿ç¨‹é—´ä¿¡å·çš„ä¸€ç§å¤„ç†æ–¹å¼ã€‚ åœ¨å¤šçº¿ç¨‹ç³»ç»Ÿä¸­,å¹¶ä¸èƒ½å……åˆ†åˆ©ç”¨å¤šçº¿ç¨‹,æ¥æé«˜æ•´ä½“çš„æ€§èƒ½ã€‚æ‰€ä»¥æ‰æœ‰äº† GILã€‚ æ ¹æ®æˆ‘çš„ç†è§£,GILçš„ä¸€ä¸ªåº”ç”¨åœºæ™¯æ˜¯åœ¨åŒä¸€æ—¶åˆ»åªèƒ½è·‘ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™æ ·åœ¨è·‘å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œåªæœ‰å½“çº¿ç¨‹èŽ·å–åˆ°å…¨å±€è§£é‡Šå™¨é”åŽæ‰èƒ½è¿è¡Œï¼Œè€Œå…¨å±€è§£é‡Šå™¨é”åªæœ‰ä¸€ä¸ªï¼Œå› æ­¤å³ä½¿åœ¨å¤šæ ¸çš„æƒ…å†µä¸‹ä¹Ÿåªèƒ½å‘æŒ¥å‡ºå•æ ¸çš„åŠŸèƒ½ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤º: GILä»…ä»…å¯¹cpythonå®žçŽ°å’Œæ‰©å±•çš„æ¨¡å—èµ·ä½œç”¨,jythonæˆ–è€…ironpythonæ²¡æœ‰GILçš„æ¦‚å¿µã€‚ åˆ°åº•æ˜¯å¹¶è¡Œè¿˜æ˜¯å¤šçº¿ç¨‹,åœ¨å¾ˆå¤šåœºæ™¯ä¸­éƒ½æœ‰äº‰è®ºã€‚ GIL å¯¹çº¿ç¨‹æ‰§è¡Œçš„å½±å“ï¼šé¦–å…ˆç†è§£ä»€ä¹ˆæ˜¯intervalæ—¶é—´,å’Œæ“ä½œç³»ç»Ÿç»‘å®š: 1234&gt;&gt;&gt; import sys&gt;&gt;&gt; # The interval is set to 100 instructions:&gt;&gt;&gt; sys.getcheckinterval()100 å¤šçº¿ç¨‹çŽ¯å¢ƒä¸­ï¼Œpythonè™šæ‹ŸæœºæŒ‰ç…§ä»¥ä¸‹æ–¹å¼æ‰§è¡Œï¼š è®¾ç½®GIL åˆ‡æ¢åˆ°ä¸€ä¸ªçº¿ç¨‹åŽ»æ‰§è¡Œ è¿è¡Œä»£ç ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æœºåˆ¶ï¼š q æŒ‡å®šæ•°é‡çš„å­—èŠ‚ç æŒ‡ä»¤ï¼ˆ100ä¸ªï¼‰ å›ºå®šæ—¶é—´15msçº¿ç¨‹ä¸»åŠ¨è®©å‡ºæŽ§åˆ¶ æŠŠçº¿ç¨‹è®¾ç½®ä¸ºç¡çœ çŠ¶æ€ è§£é”GIL å†æ¬¡é‡å¤ä»¥ä¸Šæ­¥éª¤ ä¸€ä¸ªæ —å­Code 1: CPU bound program that perform simple countdown 123456789101112131415import time from threading import Thread COUNT = 50000000 def countdown(n): while n&gt;0: n -= 1 start = time.time() countdown(COUNT) end = time.time() print('Time taken in seconds -', end - start) &gt;&gt;&gt; Time taken in seconds - 2.5236213207244873 Code 2: Two threads running parallel 123456789101112131415161718192021import time from threading import Thread COUNT = 50000000 def countdown(n): while n&gt;0: n -= 1 t1 = Thread(target = countdown, args =(COUNT//2, )) t2 = Thread(target = countdown, args =(COUNT//2, )) start = time.time() t1.start() t2.start() t1.join() t2.join() end = time.time() print('Time taken in seconds -', end - start) &gt;&gt;&gt; Time taken in seconds - 2.183610439300537 pythonçš„è§£å†³æ–¹æ¡ˆ 123456789101112131415161718192021222324252627import multiprocessing import time COUNT = 50000000 def countdown(n): while n&gt;0: n -= 1 if __name__ == "__main__": # creating processes start = time.time() p1 = multiprocessing.Process(target = countdown, args =(COUNT//2, )) p2 = multiprocessing.Process(target = countdown, args =(COUNT//2, )) # starting process 1 p1.start() # starting process 2 p2.start() # wait until process 1 is finished p1.join() # wait until process 2 is finished p2.join() end = time.time() print('Time taken in seconds -', end - start) &gt;&gt;&gt; Time taken in seconds - 2.5148496627807617 å‚è€ƒæ–‡æ¡£UnderstandingGIL understanding-python-gil what is the python interpreter lock gil]]></content>
      <categories>
        <category>python</category>
        <category>standard_library</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>thread</tag>
        <tag>GIL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library numbers]]></title>
    <url>%2F2020%2F01%2F18%2Fpython-standard-library-numbers%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“æ•°å­—çš„æŠ½è±¡åŸºç±» numbersæ˜¨å¤©æ·±å¤œ çº¢è–¯ ä¸€ç¯‡åšæ–‡ æ‚¼ @å®å“¥ ,è®©æˆ‘ä¹…ä¹…ä¸èƒ½å¹³é™ã€‚ æ—¶é—´å®šæ ¼åœ¨äº†2020å¹´1æœˆ16å·ã€‚ è¿˜ä¾ç¨€è®°å¾—å‡ å¹´å‰å’Œå®å“¥èŠå¤©,å¬è¯´ä»–åŽ»åˆ›ä¸šäº†ã€‚ è¿˜è®°å¾—é‚£æ—¶æ„æ°”é£Žå‘,èˆŒæˆ˜ç¾¤å„’,æ²¡æƒ³åˆ°å¦‚ä»Šé˜´é˜³ä¸¤éš”ã€‚ åˆ›ä¸šè¿™æ¡è·¯,çœŸçš„ä¸å¥½èµ°ã€‚ æ„¿å¤©å ‚æ²¡æœ‰ä»£ç ã€‚ å¤§å®¶éƒ½å¥½å¥½æ´»ç€å§ã€‚ æºä»£ç æºä»£ç ï¼š Lib/numbers.py numbers æ¨¡å— (PEP 3141) å®šä¹‰äº†æ•°å­— æŠ½è±¡åŸºç±» çš„å±‚æ¬¡ç»“æž„ï¼Œå…¶ä¸­é€çº§å®šä¹‰äº†æ›´å¤šæ“ä½œã€‚ æ­¤æ¨¡å—ä¸­æ‰€å®šä¹‰çš„ç±»åž‹éƒ½ä¸å¯è¢«å®žä¾‹åŒ–ã€‚ æ ¸å¿ƒç±»class numbers.Number æ•°å­—çš„å±‚æ¬¡ç»“æž„çš„åŸºç¡€ã€‚å¦‚æžœä½ åªæƒ³ç¡®è®¤å‚æ•° x æ˜¯ä¸æ˜¯æ•°å­—è€Œä¸å…³å¿ƒå…¶ç±»åž‹ï¼Œåˆ™ä½¿ç”¨isinstance(x, Number)ã€‚ æ•°å­—çš„å±‚æ¬¡ class numbers.Complex å†…ç½®åœ¨ç±»åž‹ complex é‡Œçš„å­ç±»æè¿°äº†å¤æ•°å’Œå®ƒçš„è¿ç®—æ“ä½œã€‚è¿™äº›æ“ä½œæœ‰ï¼šè½¬åŒ–è‡³ complex å’Œ boolï¼Œ realã€ imagã€+ã€-ã€*ã€/ã€ abs()ã€ conjugate()ã€ == å’Œ !=ã€‚ æ‰€æœ‰çš„å¼‚å¸¸ï¼Œ- å’Œ != ï¼Œéƒ½æ˜¯æŠ½è±¡çš„ã€‚realæŠ½è±¡çš„ã€‚å¾—åˆ°è¯¥æ•°å­—çš„å®žæ•°éƒ¨åˆ†ã€‚imagæŠ½è±¡çš„ã€‚å¾—åˆ°è¯¥æ•°å­—çš„è™šæ•°éƒ¨åˆ†ã€‚abstractmethod conjugate()æŠ½è±¡çš„ã€‚è¿”å›žå…±è½­å¤æ•°ã€‚ä¾‹å¦‚ (1+3j).conjugate() == (1-3j)ã€‚ class numbers.Real ç›¸å¯¹äºŽ Complexï¼ŒReal åŠ å…¥äº†åªæœ‰å®žæ•°æ‰èƒ½è¿›è¡Œçš„æ“ä½œã€‚ç®€å•çš„è¯´ï¼Œå®ƒä»¬æ˜¯ï¼šè½¬åŒ–è‡³ floatï¼Œmath.trunc()ã€ round()ã€ math.floor()ã€ math.ceil()ã€ divmod()ã€ //ã€ %ã€ &lt;ã€ &lt;=ã€ &gt;ã€ å’Œ &gt;=ã€‚å®žæ•°åŒæ ·é»˜è®¤æ”¯æŒ complex()ã€ realã€ imag å’Œ conjugate()ã€‚ class numbers.Rational å­ç±»åž‹ Real å¹¶åŠ å…¥ numerator å’Œ denominator ä¸¤ç§å±žæ€§ï¼Œè¿™ä¸¤ç§å±žæ€§åº”è¯¥å±žäºŽæœ€ä½Žçš„çº§åˆ«ã€‚åŠ å…¥åŽï¼Œè¿™é»˜è®¤æ”¯æŒ float()ã€‚numeratoræ‘˜è¦ã€‚denominatoræ‘˜è¦ã€‚ class numbers.Integral å­ç±»åž‹ Rational åŠ ä¸Šè½¬åŒ–è‡³ intã€‚ é»˜è®¤æ”¯æŒ float()ã€ numerator å’Œ denominatorã€‚ åœ¨ ** ä¸­åŠ å…¥æŠ½è±¡æ–¹æ³•å’Œæ¯”ç‰¹å­—ç¬¦ä¸²çš„æ“ä½œï¼š &lt;&lt;ã€ &gt;&gt;ã€ &amp;ã€ ^ã€ |ã€ ~ã€‚ ç±»åž‹æŽ¥å£æ³¨è§£å®žçŽ°è€…éœ€è¦æ³¨æ„ä½¿ç›¸ç­‰çš„æ•°å­—ç›¸ç­‰å¹¶æ‹¥æœ‰åŒæ ·çš„å€¼ã€‚å½“è¿™ä¸¤ä¸ªæ•°ä½¿ç”¨ä¸åŒçš„æ‰©å±•æ¨¡å—æ—¶ï¼Œè¿™å…¶ä¸­çš„å·®å¼‚æ˜¯å¾ˆå¾®å¦™çš„ã€‚ä¾‹å¦‚ï¼Œç”¨ fractions.Fraction å®žçŽ° hash() å¦‚ä¸‹: 1234567891011def __hash__(self): if self.denominator == 1: # Get integers right. return hash(self.numerator) # Expensive check, but definitely correct. if self == float(self): return hash(float(self)) else: # Use tuple's hash to avoid a high collision rate on # simple fractions. return hash((self.numerator, self.denominator)) æ·»åŠ æ›´å¤šæ•°å­—çš„ABC(åˆ›é€ è‡ªå®šä¹‰çš„æ•°å­—å­ç±»)å½“ç„¶ï¼Œè¿™é‡Œæœ‰æ›´å¤šæ”¯æŒæ•°å­—çš„ABCï¼Œå¦‚æžœä¸åŠ å…¥è¿™äº›ï¼Œå°±å°†ç¼ºå°‘å±‚æ¬¡æ„Ÿã€‚ä½ å¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•åœ¨ Complex å’Œ Real ä¸­åŠ å…¥MyFooï¼š 123class MyFoo(Complex): passMyFoo.register(Real) å®žçŽ°ç®—æ•°è¿ç®—æˆ‘ä»¬å¸Œæœ›å®žçŽ°è®¡ç®—ï¼Œå› æ­¤ï¼Œæ··åˆæ¨¡å¼æ“ä½œè¦ä¹ˆè°ƒç”¨ä¸€ä¸ªä½œè€…çŸ¥é“å‚æ•°ç±»åž‹çš„å®žçŽ°ï¼Œè¦ä¹ˆè½¬å˜æˆä¸ºæœ€æŽ¥è¿‘çš„å†…ç½®ç±»åž‹å¹¶å¯¹è¿™ä¸ªæ‰§è¡Œæ“ä½œã€‚å¯¹äºŽå­ç±» Integralï¼Œè¿™æ„å‘³ç€ __add__() å’Œ __radd__() å¿…é¡»ç”¨å¦‚ä¸‹æ–¹å¼å®šä¹‰ï¼š 1234567891011121314151617181920212223class MyIntegral(Integral): def __add__(self, other): if isinstance(other, MyIntegral): return do_my_adding_stuff(self, other) elif isinstance(other, OtherTypeIKnowAbout): return do_my_other_adding_stuff(self, other) else: return NotImplemented def __radd__(self, other): if isinstance(other, MyIntegral): return do_my_adding_stuff(other, self) elif isinstance(other, OtherTypeIKnowAbout): return do_my_other_adding_stuff(other, self) elif isinstance(other, Integral): return int(other) + int(self) elif isinstance(other, Real): return float(other) + float(self) elif isinstance(other, Complex): return complex(other) + complex(self) else: return NotImplemented å¤æ•°çš„å­ç±»ä¸Šçš„æ··åˆæ“ä½œæœ‰äº”ç§æƒ…å†µã€‚å‰è¿°çš„ä»£ç ä¸­é™¤åŽ»MyIntegralå’ŒOtherTypeIKnowçš„æ–‡æœ¬å°†ä½œä¸ºä¸‹é¢æè¿°çš„æ ·æ¿ã€‚aæ˜¯Açš„å®žä¾‹ï¼Œå¹¶ä¸”ä½¿å¤æ•°çš„å­ç±»ï¼ˆaï¼šA&lt;ï¼šComplexï¼‰ï¼Œbæ˜¯Bçš„å®žä¾‹ï¼Œä¹Ÿæ˜¯å¤æ•°çš„å­ç±»ã€‚æˆ‘ä»¬ä»¥a+båšå¦‚ä¸‹è®¨è®ºï¼š å¦‚æžœ A è¢«å®šä¹‰æˆä¸€ä¸ªæ‰¿è®¤b çš„ __add__()ï¼Œä¸€åˆ‡éƒ½æ²¡æœ‰é—®é¢˜ã€‚ å¦‚æžœ A è½¬å›žæˆâ€œæ¨¡æ¿â€å¤±è´¥ï¼Œå®ƒå°†è¿”å›žä¸€ä¸ªå±žäºŽ __add__() çš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦é¿å… B å®šä¹‰äº†ä¸€ä¸ªæ›´åŠ æ™ºèƒ½çš„ __radd__()ï¼Œå› æ­¤æ¨¡æ¿éœ€è¦è¿”å›žä¸€ä¸ªå±žäºŽ __add__() çš„ NotImplemented ã€‚ï¼ˆæˆ–è€… A å¯èƒ½å®Œå…¨ä¸å®žçŽ° __add__() ã€‚ï¼‰ æŽ¥ç€çœ‹ B çš„ __radd__() ã€‚å¦‚æžœå®ƒæŽ¥å—a ï¼Œä¸€åˆ‡éƒ½å°†å®Œç¾Žã€‚ å¦‚æžœæ²¡æœ‰æˆåŠŸå›žé€€åˆ°æ¨¡æ¿ï¼Œå°±æ²¡æœ‰æ›´å¤šçš„æ–¹æ³•å¯ä»¥åŽ»å°è¯•ï¼Œå› æ­¤è¿™é‡Œå°†ä½¿ç”¨é»˜è®¤çš„å®žçŽ°ã€‚ å¦‚æžœ B &lt;: A ï¼Œ Python åœ¨ A.__add__ ä¹‹å‰å°è¯• B.__radd__ ã€‚ è¿™æ˜¯å¯è¡Œçš„ï¼Œæ˜¯é€šè¿‡å¯¹ A çš„è®¤è¯†å®žçŽ°çš„ï¼Œå› æ­¤è¿™å¯ä»¥åœ¨äº¤ç»™ Complex å¤„ç†ä¹‹å‰å¤„ç†è¿™äº›å®žä¾‹ã€‚ å¦‚æžœ A &lt;: Complex å’Œ B &lt;: Real æ²¡æœ‰å…±äº«ä»»ä½•èµ„æºï¼Œé‚£ä¹ˆé€‚å½“çš„å…±äº«æ“ä½œæ¶‰åŠå†…ç½®çš„ complex ï¼Œå¹¶ä¸”åˆ†åˆ«èŽ·å¾— __radd__() ï¼Œå› æ­¤ a+b == b+aã€‚ ç”±äºŽå¯¹ä»»ä½•ä¸€ç›´ç±»åž‹çš„å¤§éƒ¨åˆ†æ“ä½œæ˜¯ååˆ†ç›¸ä¼¼çš„ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªå¸®åŠ©å‡½æ•°ï¼Œå³ä¸€ä¸ªç”ŸæˆåŽç»­æˆ–ç›¸åçš„å®žä¾‹çš„ç”Ÿæˆå™¨ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ fractions.Fraction å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637def _operator_fallbacks(monomorphic_operator, fallback_operator): def forward(a, b): if isinstance(b, (int, Fraction)): return monomorphic_operator(a, b) elif isinstance(b, float): return fallback_operator(float(a), b) elif isinstance(b, complex): return fallback_operator(complex(a), b) else: return NotImplemented forward.__name__ = '__' + fallback_operator.__name__ + '__' forward.__doc__ = monomorphic_operator.__doc__ def reverse(b, a): if isinstance(a, Rational): # Includes ints. return monomorphic_operator(a, b) elif isinstance(a, numbers.Real): return fallback_operator(float(a), float(b)) elif isinstance(a, numbers.Complex): return fallback_operator(complex(a), complex(b)) else: return NotImplemented reverse.__name__ = '__r' + fallback_operator.__name__ + '__' reverse.__doc__ = monomorphic_operator.__doc__ return forward, reversedef _add(a, b): """a + b""" return Fraction(a.numerator * b.denominator + b.numerator * a.denominator, a.denominator * b.denominator)__add__, __radd__ = _operator_fallbacks(_add, operator.add)# ...]]></content>
      <categories>
        <category>python</category>
        <category>standard_library</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard libary heapq]]></title>
    <url>%2F2020%2F01%2F17%2Fpython-standard-library-heapq%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ å †é˜Ÿåˆ—ç®—æ³• heapqæ¯æ—¥ä¸€è¯: Pollen n èŠ±ç²‰ ä¾‹å¥: Good news for all you hay fever and asthma suffererså¯¹äºŽèŠ±ç²‰ç—‡å’Œå“®å–˜ç—…æ‚£è€…æ˜¯ä¸ªå¥½æ¶ˆæ¯ ä»Šå¤©æ˜¯å°å¹´,ç¥å¤§å®¶å¿ƒæƒ³äº‹æˆ æºç æºç ï¼šLib/heapq.py ä¸»è¦æ¨¡å—å’Œæ–¹æ³•ï¼š 12__all__ = ['heappush', 'heappop', 'heapify', 'heapreplace', 'merge', 'nlargest', 'nsmallest', 'heappushpop'] è¿™ä¸ªæ¨¡å—æä¾›äº†å †é˜Ÿåˆ—ç®—æ³•çš„å®žçŽ°ï¼Œä¹Ÿç§°ä¸ºä¼˜å…ˆé˜Ÿåˆ—ç®—æ³•ã€‚ å †æ˜¯ä¸€ä¸ªäºŒå‰æ ‘ï¼Œå®ƒçš„æ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å€¼éƒ½åªä¼šå°äºŽæˆ–å¤§äºŽæ‰€æœ‰å­©å­èŠ‚ç‚¹ï¼ˆçš„å€¼ï¼‰ã€‚å®ƒä½¿ç”¨äº†æ•°ç»„æ¥å®žçŽ°ï¼šä»Žé›¶å¼€å§‹è®¡æ•°ï¼Œå¯¹äºŽæ‰€æœ‰çš„ k ï¼Œéƒ½æœ‰ heap[k] &lt;= heap[2*k+1] å’Œ heap[k] &lt;= heap[2*k+2]ã€‚ ä¸ºäº†ä¾¿äºŽæ¯”è¾ƒï¼Œä¸å­˜åœ¨çš„å…ƒç´ è¢«è®¤ä¸ºæ˜¯æ— é™å¤§ã€‚ å †æœ€æœ‰è¶£çš„ç‰¹æ€§åœ¨äºŽæœ€å°çš„å…ƒç´ æ€»æ˜¯åœ¨æ ¹ç»“ç‚¹ï¼šheap[0]ã€‚ è¿™ä¸ªAPIä¸Žæ•™æçš„å †ç®—æ³•å®žçŽ°æœ‰æ‰€ä¸åŒï¼Œå…·ä½“åŒºåˆ«æœ‰ä¸¤æ–¹é¢ï¼šï¼ˆaï¼‰æˆ‘ä»¬ä½¿ç”¨äº†ä»Žé›¶å¼€å§‹çš„ç´¢å¼•ã€‚è¿™ä½¿å¾—èŠ‚ç‚¹å’Œå…¶å­©å­èŠ‚ç‚¹ç´¢å¼•ä¹‹é—´çš„å…³ç³»ä¸å¤ªç›´è§‚ä½†æ›´åŠ é€‚åˆï¼Œå› ä¸º Python ä½¿ç”¨ä»Žé›¶å¼€å§‹çš„ç´¢å¼•ã€‚ ï¼ˆbï¼‰æˆ‘ä»¬çš„ pop æ–¹æ³•è¿”å›žæœ€å°çš„é¡¹è€Œä¸æ˜¯æœ€å¤§çš„é¡¹ï¼ˆè¿™åœ¨æ•™æä¸­ç§°ä¸ºâ€œæœ€å°å †â€ï¼›è€Œâ€œæœ€å¤§å †â€åœ¨æ•™æä¸­æ›´ä¸ºå¸¸è§ï¼Œå› ä¸ºå®ƒæ›´é€‚ç”¨äºŽåŽŸåœ°æŽ’åºï¼‰ã€‚ åŸºäºŽè¿™ä¸¤æ–¹é¢ï¼ŒæŠŠå †çœ‹ä½œåŽŸç”Ÿçš„Python listä¹Ÿæ²¡ä»€ä¹ˆå¥‡æ€ªçš„ï¼š heap[0] è¡¨ç¤ºæœ€å°çš„å…ƒç´ ï¼ŒåŒæ—¶ heap.sort() ç»´æŠ¤äº†å †çš„ä¸å˜æ€§ï¼ è¦åˆ›å»ºä¸€ä¸ªå †ï¼Œå¯ä»¥ä½¿ç”¨listæ¥åˆå§‹åŒ–ä¸º [] ï¼Œæˆ–è€…ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªå‡½æ•° heapify() ï¼Œæ¥æŠŠä¸€ä¸ªlistè½¬æ¢æˆå †ã€‚ å®šä¹‰äº†ä»¥ä¸‹å‡½æ•°ï¼š heapq.heappush(heap, item) å°† item çš„å€¼åŠ å…¥ heap ä¸­ï¼Œä¿æŒå †çš„ä¸å˜æ€§ã€‚ heapq.heappop(heap) å¼¹å‡ºå¹¶è¿”å›ž heap çš„æœ€å°çš„å…ƒç´ ï¼Œä¿æŒå †çš„ä¸å˜æ€§ã€‚å¦‚æžœå †ä¸ºç©ºï¼ŒæŠ›å‡º IndexError ã€‚ä½¿ç”¨ heap[0] ï¼Œå¯ä»¥åªè®¿é—®æœ€å°çš„å…ƒç´ è€Œä¸å¼¹å‡ºå®ƒã€‚ heapq.heappushpop(heap, item) å°† item æ”¾å…¥å †ä¸­ï¼Œç„¶åŽå¼¹å‡ºå¹¶è¿”å›ž heap çš„æœ€å°å…ƒç´ ã€‚è¯¥ç»„åˆæ“ä½œæ¯”å…ˆè°ƒç”¨ heappush() å†è°ƒç”¨ heappop() è¿è¡Œèµ·æ¥æ›´æœ‰æ•ˆçŽ‡ã€‚ heapq.heapify(x) å°†list x è½¬æ¢æˆå †ï¼ŒåŽŸåœ°ï¼Œçº¿æ€§æ—¶é—´å†…ã€‚ heapq.heapreplace(heap, item) å¼¹å‡ºå¹¶è¿”å›ž heap ä¸­æœ€å°çš„ä¸€é¡¹ï¼ŒåŒæ—¶æŽ¨å…¥æ–°çš„ itemã€‚ å †çš„å¤§å°ä¸å˜ã€‚ å¦‚æžœå †ä¸ºç©ºåˆ™å¼•å‘ IndexErrorã€‚è¿™ä¸ªå•æ­¥éª¤æ“ä½œæ¯” heappop() åŠ  heappush() æ›´é«˜æ•ˆï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨å›ºå®šå¤§å°çš„å †æ—¶æ›´ä¸ºé€‚å®œã€‚ pop/push ç»„åˆæ€»æ˜¯ä¼šä»Žå †ä¸­è¿”å›žä¸€ä¸ªå…ƒç´ å¹¶å°†å…¶æ›¿æ¢ä¸º itemã€‚è¿”å›žçš„å€¼å¯èƒ½ä¼šæ¯”æ·»åŠ çš„ item æ›´å¤§ã€‚ å¦‚æžœä¸å¸Œæœ›å¦‚æ­¤ï¼Œå¯è€ƒè™‘æ”¹ç”¨ heappushpop()ã€‚ å®ƒçš„ push/pop ç»„åˆä¼šè¿”å›žä¸¤ä¸ªå€¼ä¸­è¾ƒå°çš„ä¸€ä¸ªï¼Œå°†è¾ƒå¤§çš„å€¼ç•™åœ¨å †ä¸­ã€‚ è¯¥æ¨¡å—è¿˜æä¾›äº†ä¸‰ä¸ªåŸºäºŽå †çš„é€šç”¨åŠŸèƒ½å‡½æ•°ã€‚ heapq.merge(*iterables, key=None, reverse=False) å°†å¤šä¸ªå·²æŽ’åºçš„è¾“å…¥åˆå¹¶ä¸ºä¸€ä¸ªå·²æŽ’åºçš„è¾“å‡ºï¼ˆä¾‹å¦‚ï¼Œåˆå¹¶æ¥è‡ªå¤šä¸ªæ—¥å¿—æ–‡ä»¶çš„å¸¦æ—¶é—´æˆ³çš„æ¡ç›®ï¼‰ã€‚ è¿”å›žå·²æŽ’åºå€¼çš„ iteratorã€‚ç±»ä¼¼äºŽ sorted(itertools.chain(*iterables)) ä½†è¿”å›žä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œä¸ä¼šä¸€æ¬¡æ€§åœ°å°†æ•°æ®å…¨éƒ¨æ”¾å…¥å†…å­˜ï¼Œå¹¶å‡å®šæ¯ä¸ªè¾“å…¥æµéƒ½æ˜¯å·²æŽ’åºçš„ï¼ˆä»Žå°åˆ°å¤§ï¼‰ã€‚å…·æœ‰ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼Œå®ƒä»¬éƒ½å¿…é¡»æŒ‡å®šä¸ºå…³é”®å­—å‚æ•°ã€‚key æŒ‡å®šå¸¦æœ‰å•ä¸ªå‚æ•°çš„ key functionï¼Œç”¨äºŽä»Žæ¯ä¸ªè¾“å…¥å…ƒç´ ä¸­æå–æ¯”è¾ƒé”®ã€‚ é»˜è®¤å€¼ä¸º None (ç›´æŽ¥æ¯”è¾ƒå…ƒç´ )ã€‚reverse ä¸ºä¸€ä¸ªå¸ƒå°”å€¼ã€‚ å¦‚æžœè®¾ä¸º Trueï¼Œåˆ™è¾“å…¥å…ƒç´ å°†æŒ‰æ¯”è¾ƒç»“æžœé€†åºè¿›è¡Œåˆå¹¶ã€‚ è¦è¾¾æˆä¸Ž sorted(itertools.chain(*iterables), reverse=True) ç±»ä¼¼çš„è¡Œä¸ºï¼Œæ‰€æœ‰å¯è¿­ä»£å¯¹è±¡å¿…é¡»æ˜¯å·²ä»Žå¤§åˆ°å°æŽ’åºçš„ã€‚åœ¨ 3.5 ç‰ˆæ›´æ”¹: æ·»åŠ äº†å¯é€‰çš„ key å’Œ reverse å½¢å‚ã€‚ heapq.nlargest(n, iterable, key=None) ä»Ž iterable æ‰€å®šä¹‰çš„æ•°æ®é›†ä¸­è¿”å›žå‰ n ä¸ªæœ€å¤§å…ƒç´ ç»„æˆçš„åˆ—è¡¨ã€‚ å¦‚æžœæä¾›äº† key åˆ™å…¶åº”æŒ‡å®šä¸€ä¸ªå•å‚æ•°çš„å‡½æ•°ï¼Œç”¨äºŽä»Ž iterable çš„æ¯ä¸ªå…ƒç´ ä¸­æå–æ¯”è¾ƒé”® (ä¾‹å¦‚ key=str.lower)ã€‚ ç­‰ä»·äºŽ: sorted(iterable, key=key, reverse=True)[:n]ã€‚ heapq.nsmallest(n, iterable, key=None) ä»Ž iterable æ‰€å®šä¹‰çš„æ•°æ®é›†ä¸­è¿”å›žå‰ n ä¸ªæœ€å°å…ƒç´ ç»„æˆçš„åˆ—è¡¨ã€‚ å¦‚æžœæä¾›äº† key åˆ™å…¶åº”æŒ‡å®šä¸€ä¸ªå•å‚æ•°çš„å‡½æ•°ï¼Œç”¨äºŽä»Ž iterable çš„æ¯ä¸ªå…ƒç´ ä¸­æå–æ¯”è¾ƒé”® (ä¾‹å¦‚ key=str.lower)ã€‚ ç­‰ä»·äºŽ: sorted(iterable, key=key)[:n]ã€‚ åŽä¸¤ä¸ªå‡½æ•°åœ¨ n å€¼è¾ƒå°æ—¶æ€§èƒ½æœ€å¥½ã€‚ å¯¹äºŽæ›´å¤§çš„å€¼ï¼Œä½¿ç”¨ sorted() å‡½æ•°ä¼šæ›´æœ‰æ•ˆçŽ‡ã€‚ æ­¤å¤–ï¼Œå½“ n==1 æ—¶ï¼Œä½¿ç”¨å†…ç½®çš„ min() å’Œ max() å‡½æ•°ä¼šæ›´æœ‰æ•ˆçŽ‡ã€‚ å¦‚æžœéœ€è¦é‡å¤ä½¿ç”¨è¿™äº›å‡½æ•°ï¼Œè¯·è€ƒè™‘å°†å¯è¿­ä»£å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„å †ã€‚ åŸºæœ¬å®žä¾‹å †æŽ’åº å¯ä»¥é€šè¿‡å°†æ‰€æœ‰å€¼æŽ¨å…¥å †ä¸­ç„¶åŽæ¯æ¬¡å¼¹å‡ºä¸€ä¸ªæœ€å°å€¼é¡¹æ¥å®žçŽ°ã€‚ 12345678&gt;&gt;&gt; def heapsort(iterable):... h = []... for value in iterable:... heappush(h, value)... return [heappop(h) for i in range(len(h))]...&gt;&gt;&gt; heapsort([1, 3, 5, 7, 9, 2, 4, 6, 8, 0])[0, 1, 2, 3, 4, 5, 6, 7, 8, 9] è¿™ç±»ä¼¼äºŽ sorted(iterable)ï¼Œä½†ä¸Ž sorted() ä¸åŒçš„æ˜¯è¿™ä¸ªå®žçŽ°æ˜¯ä¸ç¨³å®šçš„ã€‚ å †å…ƒç´ å¯ä»¥ä¸ºå…ƒç»„ã€‚ è¿™é€‚ç”¨äºŽå°†æ¯”è¾ƒå€¼ï¼ˆä¾‹å¦‚ä»»åŠ¡ä¼˜å…ˆçº§ï¼‰ä¸Žè·Ÿè¸ªçš„ä¸»è®°å½•è¿›è¡Œèµ‹å€¼çš„åœºåˆ: 1234567&gt;&gt;&gt; h = []&gt;&gt;&gt; heappush(h, (5, 'write code'))&gt;&gt;&gt; heappush(h, (7, 'release product'))&gt;&gt;&gt; heappush(h, (1, 'write spec'))&gt;&gt;&gt; heappush(h, (3, 'create tests'))&gt;&gt;&gt; heappop(h)(1, 'write spec') ä¼˜å…ˆé˜Ÿåˆ—å®žçŽ°è¯´æ˜Žä¼˜å…ˆé˜Ÿåˆ— æ˜¯å †çš„å¸¸ç”¨åœºåˆï¼Œå¹¶ä¸”å®ƒçš„å®žçŽ°åŒ…å«äº†å¤šä¸ªæŒ‘æˆ˜ï¼š æŽ’åºç¨³å®šæ€§ï¼šä½ è¯¥å¦‚ä½•ä»¤ç›¸åŒä¼˜å…ˆçº§çš„ä¸¤ä¸ªä»»åŠ¡æŒ‰å®ƒä»¬æœ€åˆè¢«åŠ å…¥æ—¶çš„é¡ºåºè¿”å›žï¼Ÿ å¦‚æžœä¼˜å…ˆçº§ç›¸åŒä¸”ä»»åŠ¡æ²¡æœ‰é»˜è®¤æ¯”è¾ƒé¡ºåºï¼Œåˆ™ (priority, task) å¯¹çš„å…ƒç»„æ¯”è¾ƒå°†ä¼šä¸­æ–­ã€‚ å¦‚æžœä»»åŠ¡ä¼˜å…ˆçº§å‘ç”Ÿæ”¹å˜ï¼Œä½ è¯¥å¦‚ä½•å°†å…¶ç§»è‡³å †ä¸­çš„æ–°ä½ç½®ï¼Ÿ æˆ–è€…å¦‚æžœä¸€ä¸ªæŒ‚èµ·çš„ä»»åŠ¡éœ€è¦è¢«åˆ é™¤ï¼Œä½ è¯¥å¦‚ä½•æ‰¾åˆ°å®ƒå¹¶å°†å…¶ç§»å‡ºé˜Ÿåˆ—ï¼Ÿ é’ˆå¯¹å‰ä¸¤é¡¹æŒ‘æˆ˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°†æ¡ç›®ä¿å­˜ä¸ºåŒ…å«ä¼˜å…ˆçº§ã€æ¡ç›®è®¡æ•°å’Œä»»åŠ¡å¯¹è±¡ 3 ä¸ªå…ƒç´ çš„åˆ—è¡¨ã€‚ æ¡ç›®è®¡æ•°å¯ç”¨æ¥æ‰“ç ´å¹³å±€ï¼Œè¿™æ ·å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„ä»»åŠ¡å°†æŒ‰å®ƒä»¬çš„æ·»åŠ é¡ºåºè¿”å›žã€‚ å¹¶ä¸”ç”±äºŽæ²¡æœ‰å“ªä¸¤ä¸ªæ¡ç›®è®¡æ•°æ˜¯ç›¸åŒçš„ï¼Œå…ƒç»„æ¯”è¾ƒå°†æ°¸è¿œä¸ä¼šç›´æŽ¥æ¯”è¾ƒä¸¤ä¸ªä»»åŠ¡ã€‚ ä¸å¯æ¯”è¾ƒä»»åŠ¡é—®é¢˜çš„å¦ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯åˆ›å»ºä¸€ä¸ªå¿½ç•¥ä»»åŠ¡æ¡ç›®å¹¶ä¸”åªæ¯”è¾ƒä¼˜å…ˆçº§å­—æ®µçš„åŒ…è£…å™¨ç±»: 1234567from dataclasses import dataclass, fieldfrom typing import Any@dataclass(order=True)class PrioritizedItem: priority: int item: Any=field(compare=False) å…¶ä½™çš„æŒ‘æˆ˜ä¸»è¦åŒ…æ‹¬æ‰¾åˆ°æŒ‚èµ·çš„ä»»åŠ¡å¹¶ä¿®æ”¹å…¶ä¼˜å…ˆçº§æˆ–å°†å…¶å®Œå…¨ç§»é™¤ã€‚ æ‰¾åˆ°ä¸€ä¸ªä»»åŠ¡å¯ä½¿ç”¨ä¸€ä¸ªæŒ‡å‘é˜Ÿåˆ—ä¸­æ¡ç›®çš„å­—å…¸æ¥å®žçŽ°ã€‚ ç§»é™¤æ¡ç›®æˆ–æ”¹å˜å…¶ä¼˜å…ˆçº§çš„æ“ä½œå®žçŽ°èµ·æ¥æ›´ä¸ºå›°éš¾ï¼Œå› ä¸ºå®ƒä¼šç ´åå †ç»“æž„ä¸å˜é‡ã€‚ å› æ­¤ï¼Œä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†æ¡ç›®æ ‡è®°ä¸ºå·²ç§»é™¤ï¼Œå†æ·»åŠ ä¸€ä¸ªæ”¹å˜äº†ä¼˜å…ˆçº§çš„æ–°æ¡ç›®: 123456789101112131415161718192021222324252627pq = [] # list of entries arranged in a heapentry_finder = &#123;&#125; # mapping of tasks to entriesREMOVED = '&lt;removed-task&gt;' # placeholder for a removed taskcounter = itertools.count() # unique sequence countdef add_task(task, priority=0): 'Add a new task or update the priority of an existing task' if task in entry_finder: remove_task(task) count = next(counter) entry = [priority, count, task] entry_finder[task] = entry heappush(pq, entry)def remove_task(task): 'Mark an existing task as REMOVED. Raise KeyError if not found.' entry = entry_finder.pop(task) entry[-1] = REMOVEDdef pop_task(): 'Remove and return the lowest priority task. Raise KeyError if empty.' while pq: priority, count, task = heappop(pq) if task is not REMOVED: del entry_finder[task] return task raise KeyError('pop from an empty priority queue') ç†è®ºå †æ˜¯é€šè¿‡æ•°ç»„æ¥å®žçŽ°çš„ï¼Œå…¶ä¸­çš„å…ƒç´ ä»Ž 0 å¼€å§‹è®¡æ•°ï¼Œå¯¹äºŽæ‰€æœ‰çš„ k éƒ½æœ‰ a[k] &lt;= a[2*k+1] ä¸” a[k] &lt;= a[2*k+2]ã€‚ ä¸ºäº†ä¾¿äºŽæ¯”è¾ƒï¼Œä¸å­˜åœ¨çš„å…ƒç´ è¢«è§†ä¸ºæ— ç©·å¤§ã€‚ å †æœ€æœ‰è¶£çš„ç‰¹æ€§åœ¨äºŽ a[0] æ€»æ˜¯å…¶ä¸­æœ€å°çš„å…ƒç´ ã€‚ ä¸Šé¢çš„ç‰¹æ®Šä¸å˜é‡æ˜¯ç”¨æ¥ä½œä¸ºä¸€åœºé”¦æ ‡èµ›çš„é«˜æ•ˆå†…å­˜è¡¨ç¤ºã€‚ ä¸‹é¢çš„æ•°å­—æ˜¯ k è€Œä¸æ˜¯ a[k]: 123456789 0 1 2 3 4 5 6 7 8 9 10 11 12 13 1415 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 åœ¨ä¸Šé¢çš„æ ‘ä¸­ï¼Œæ¯ä¸ª k å•å…ƒéƒ½ä½äºŽ 2*k+1 å’Œ 2*k+2 ä¹‹ä¸Šã€‚ ä½“è‚²è¿åŠ¨ä¸­æˆ‘ä»¬ç»å¸¸è§åˆ°äºŒå…ƒé”¦æ ‡èµ›æ¨¡å¼ï¼Œæ¯ä¸ªèƒœè€…å•å…ƒéƒ½ä½äºŽå¦ä¸¤ä¸ªå•å…ƒä¹‹ä¸Šï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ²¿ç€æ ‘å½¢å›¾å‘ä¸‹è¿½æº¯èƒœè€…æ‰€é‡åˆ°çš„æ‰€æœ‰å¯¹æ‰‹ã€‚ ä½†æ˜¯ï¼Œåœ¨è®¸å¤šé‡‡ç”¨è¿™ç§é”¦æ ‡èµ›æ¨¡å¼çš„è®¡ç®—æœºåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è¿½æº¯èƒœè€…çš„åŽ†å²ã€‚ ä¸ºäº†èŽ·å¾—æ›´é«˜çš„å†…å­˜åˆ©ç”¨æ•ˆçŽ‡ï¼Œå½“ä¸€ä¸ªèƒœè€…æ™‹çº§æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨è¾ƒä½Žå±‚çº§çš„å¦ä¸€æ¡ç›®æ¥æ›¿ä»£å®ƒï¼Œå› æ­¤è§„åˆ™å˜ä¸ºä¸€ä¸ªå•å…ƒå’Œå®ƒä¹‹ä¸‹çš„ä¸¤ä¸ªå•å…ƒåŒ…å«ä¸‰ä¸ªä¸åŒæ¡ç›®ï¼Œä¸Šæ–¹å•å…ƒâ€œèƒœè¿‡â€äº†ä¸¤ä¸ªä¸‹æ–¹å•å…ƒã€‚ å¦‚æžœæ­¤å †çš„ä¸å˜é‡å§‹ç»ˆå—åˆ°ä¿æŠ¤ï¼Œåˆ™åºå· 0 æ˜¾ç„¶æ˜¯æœ€åŽçš„èµ¢å®¶ã€‚ åˆ é™¤å®ƒå¹¶æ‰¾å‡ºâ€œä¸‹ä¸€ä¸ªâ€èµ¢å®¶çš„æœ€ç®€å•ç®—æ³•æ–¹å¼æ˜¯å®¶æŸä¸ªè¾“å®¶ï¼ˆè®©æˆ‘ä»¬å‡å®šæ˜¯ä¸Šå›¾ä¸­çš„ 30 å·å•å…ƒï¼‰ç§»è‡³ 0 å·ä½ç½®ï¼Œç„¶åŽå°†è¿™ä¸ªæ–°çš„ 0 å·æ²¿æ ‘ä¸‹è¡Œï¼Œä¸æ–­è¿›è¡Œå€¼çš„äº¤æ¢ï¼Œç›´åˆ°ä¸å˜é‡é‡æ–°å»ºç«‹ã€‚ è¿™æ˜¾ç„¶ä¼šæ˜¯æ ‘ä¸­æ¡ç›®æ€»æ•°çš„å¯¹æ•°ã€‚ é€šè¿‡è¿­ä»£æ‰€æœ‰æ¡ç›®ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ª O(n log n) å¤æ‚åº¦çš„æŽ’åºã€‚ æ­¤æŽ’åºæœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§å°±æ˜¯ä½ å¯ä»¥åœ¨æŽ’åºè¿›è¡ŒæœŸé—´é«˜æ•ˆåœ°æ’å…¥æ–°æ¡ç›®ï¼Œå‰ææ˜¯æ’å…¥çš„æ¡ç›®ä¸æ¯”ä½ æœ€è¿‘å–å‡ºçš„ 0 å·å…ƒç´ â€œæ›´å¥½â€ã€‚ è¿™åœ¨æ¨¡æ‹Ÿä¸Šä¸‹æ–‡æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ ‘ä¿å­˜çš„æ˜¯æ‰€æœ‰ä¼ å…¥äº‹ä»¶ï¼Œâ€œèƒœå‡ºâ€æ¡ä»¶æ˜¯æœ€å°è°ƒåº¦æ—¶é—´ã€‚ å½“ä¸€ä¸ªäº‹ä»¶å°†å…¶ä»–äº‹ä»¶æŽ’å…¥æ‰§è¡Œè®¡åˆ’æ—¶ï¼Œå®ƒä»¬çš„è°ƒè¯•æ—¶é—´å‘æœªæ¥æ–¹å‘å»¶é•¿ï¼Œè¿™æ ·å®ƒä»¬å¯æ–¹ä¾¿åœ°å…¥å †ã€‚ å› æ­¤ï¼Œå †ç»“æž„å¾ˆé€‚å®œç”¨æ¥å®žçŽ°è°ƒåº¦å™¨ï¼Œæˆ‘çš„ MIDI éŸ³åºå™¨å°±æ˜¯ç”¨çš„è¿™ä¸ª :-)ã€‚ ç”¨äºŽå®žçŽ°è°ƒåº¦å™¨çš„å„ç§ç»“æž„éƒ½å¾—åˆ°äº†å……åˆ†çš„ç ”ç©¶ï¼Œå †æ˜¯éžå¸¸é€‚å®œçš„ä¸€ç§ï¼Œå› ä¸ºå®ƒä»¬çš„é€Ÿåº¦ç›¸å½“å¿«ï¼Œå¹¶ä¸”å‡ ä¹Žæ˜¯æ’å®šçš„ï¼Œæœ€åçš„æƒ…å†µä¸Žå¹³å‡æƒ…å†µæ²¡æœ‰å¤ªå¤§å·®åˆ«ã€‚ è™½ç„¶è¿˜å­˜åœ¨å…¶ä»–æ€»ä½“è€Œè¨€æ›´é«˜æ•ˆçš„å®žçŽ°æ–¹å¼ï¼Œä½†å…¶æœ€åçš„æƒ…å†µå´å¯èƒ½éžå¸¸ç³Ÿç³•ã€‚ å †åœ¨å¤§ç£ç›˜æŽ’åºä¸­ä¹Ÿéžå¸¸æœ‰ç”¨ã€‚ ä½ åº”è¯¥å·²ç»äº†è§£å¤§è§„æ¨¡æŽ’åºä¼šæœ‰å¤šä¸ªâ€œè¿è¡Œè½®æ¬¡â€ï¼ˆå³é¢„æŽ’åºçš„åºåˆ—ï¼Œå…¶å¤§å°é€šå¸¸ä¸Ž CPU å†…å­˜å®¹é‡ç›¸å…³ï¼‰ï¼ŒéšåŽè¿™äº›è½®æ¬¡ä¼šè¿›å…¥åˆå¹¶é€šé“ï¼Œè½®æ¬¡åˆå¹¶çš„ç»„ç»‡å¾€å¾€éžå¸¸å·§å¦™ 1ã€‚ éžå¸¸é‡è¦çš„ä¸€ç‚¹æ˜¯åˆå§‹æŽ’åºåº”äº§ç”Ÿå°½å¯èƒ½é•¿çš„è¿è¡Œè½®æ¬¡ã€‚ é”¦æ ‡èµ›æ¨¡å¼æ˜¯è¾¾æˆæ­¤ç›®æ ‡çš„å¥½åŠžæ³•ã€‚ å¦‚æžœä½ ä½¿ç”¨å…¨éƒ¨æœ‰ç”¨å†…å­˜æ¥è¿›è¡Œé”¦æ ‡èµ›ï¼Œæ›¿æ¢å’Œå®‰æŽ’æ°å¥½é€‚åˆå½“å‰è¿è¡Œè½®æ¬¡çš„æ¡ç›®ï¼Œä½ å°†å¯ä»¥å¯¹äºŽéšæœºè¾“å…¥ç”Ÿæˆä¸¤å€äºŽå†…å­˜å¤§å°çš„è¿è¡Œè½®æ¬¡ï¼Œå¯¹äºŽæ¨¡ç³ŠæŽ’åºçš„è¾“å…¥è¿˜ä¼šæœ‰æ›´å¥½çš„æ•ˆæžœã€‚ å¦å¤–ï¼Œå¦‚æžœä½ è¾“å‡ºç£ç›˜ä¸Šçš„ç¬¬ 0 ä¸ªæ¡ç›®å¹¶èŽ·å¾—ä¸€ä¸ªå¯èƒ½ä¸é€‚åˆå½“å‰é”¦æ ‡èµ›çš„è¾“å…¥ï¼ˆå› ä¸ºå…¶å€¼è¦â€œèƒœè¿‡â€ä¸Šä¸€ä¸ªè¾“å‡ºå€¼ï¼‰ï¼Œå®ƒæ— æ³•è¢«æ”¾å…¥å †ä¸­ï¼Œå› æ­¤å †çš„å°ºå¯¸å°†ç¼©å°ã€‚ è¢«é‡Šæ”¾çš„å†…å­˜å¯ä»¥è¢«å·§å¦™åœ°ç«‹å³é‡ç”¨ä»¥é€æ­¥æž„å»ºç¬¬äºŒä¸ªå †ï¼Œå…¶å¢žé•¿é€Ÿåº¦ä¸Žç¬¬ä¸€ä¸ªå †çš„ç¼©å‡é€Ÿåº¦æ­£å¥½ç›¸åŒã€‚ å½“ç¬¬ä¸€ä¸ªå †å®Œå…¨æ¶ˆå¤±æ—¶ï¼Œä½ å¯ä»¥åˆ‡æ¢æ–°å †å¹¶å¯åŠ¨æ–°çš„è¿è¡Œè½®æ¬¡ã€‚ è¿™æ ·åšæ—¢èªæ˜Žåˆé«˜æ•ˆï¼ æ€»ä¹‹ï¼Œå †æ˜¯å€¼å¾—äº†è§£çš„æœ‰ç”¨å†…å­˜ç»“æž„ã€‚ æˆ‘åœ¨ä¸€äº›åº”ç”¨ä¸­ç”¨åˆ°äº†å®ƒä»¬ï¼Œå¹¶ä¸”è®¤ä¸ºä¿ç•™ä¸€ä¸ª â€˜heapâ€™ æ¨¡å—æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ã€‚ :-) å †æŽ’åºå›¾ä¾‹]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>heapq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library calendar]]></title>
    <url>%2F2020%2F01%2F16%2Fpython-standard-library-calendar%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ calendaræ¯æ—¥ä¸€è¯: calendar è‹± [ËˆkÃ¦lÉªndÉ™(r)] ç¾Ž [ËˆkÃ¦lÉªndÉ™r] n. æ—¥åŽ†ï¼›[å¤©] åŽ†æ³•ï¼›æ—¥ç¨‹è¡¨ vt. å°†â€¦åˆ—å…¥è¡¨ä¸­ï¼›å°†â€¦æŽ’å…¥æ—¥ç¨‹è¡¨ çŸ­è¯­ chinese calendar ä¸­å›½ä¼ ç»ŸåŽ†æ³• ; é˜´åŽ† ; ä¸­å›½å†œåŽ† lunar calendar é˜´åŽ† ; å¤åŽ† ; æ¥è‡ªæ—¥æœˆæ˜Ÿè¾°çš„åŠ›é‡ ; å¤ªé˜´åŽ† solar calendar å¤ªé˜³åŽ† ; å…¬åŽ† ; é˜³åŽ†ä¸Žé˜´åŽ† è¿˜æœ‰å‡ å¤©å°±è¿‡å¹´äº†,2020å¹´å……æ»¡äº†æœŸå¾…,ä½ å‘¢ï¼Ÿ ä»Šå¤©æˆ‘ä»¬å­¦ä¹ python æ ‡å‡†åº“ calendar ã€‚ è¾“å‡ºåƒ Unix cal é‚£æ ·çš„æ—¥åŽ†ï¼Œå®ƒè¿˜æä¾›äº†å…¶å®ƒä¸Žæ—¥åŽ†ç›¸å…³çš„å®žç”¨å‡½æ•°ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›æ—¥åŽ†æŠŠæ˜ŸæœŸä¸€å½“ä½œä¸€å‘¨çš„ç¬¬ä¸€å¤©ï¼Œæ˜ŸæœŸå¤©ä¸ºä¸€å‘¨çš„æœ€åŽä¸€å¤©ï¼ˆæŒ‰ç…§æ¬§æ´²æƒ¯ä¾‹ï¼‰ã€‚ å¯ä»¥ä½¿ç”¨ setfirstweekday() æ–¹æ³•è®¾ç½®ä¸€å‘¨çš„ç¬¬ä¸€å¤©ä¸ºæ˜ŸæœŸå¤© (6) æˆ–è€…å…¶å®ƒä»»æ„ä¸€å¤©ã€‚ ä½¿ç”¨æ•´æ•°ä½œä¸ºæŒ‡å®šæ—¥æœŸçš„å‚æ•°ã€‚ æ›´å¤šç›¸å…³çš„å‡½æ•°ï¼Œå‚è§ datetime å’Œ time æ¨¡å—ã€‚ åœ¨è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„å‡½æ•°å’Œç±»éƒ½åŸºäºŽä¸€ä¸ªç†æƒ³åŒ–çš„æ—¥åŽ†ï¼ŒçŽ°è¡Œå…¬åŽ†å‘è¿‡åŽ»å’Œæœªæ¥ä¸¤ä¸ªæ–¹å‘æ— é™æ‰©å±•ã€‚è¿™ä¸Ž Dershowitz å’Œ Reingold çš„ä¹¦ â€œåŽ†æ³•è®¡ç®—â€ ä¸­æ‰€æœ‰è®¡ç®—çš„åŸºæœ¬æ—¥åŽ† â€“ â€œproleptic Gregorianâ€ æ—¥åŽ†çš„å®šä¹‰ç›¸ç¬¦åˆã€‚ ISO 8601æ ‡å‡†è¿˜è§„å®šäº† 0 å’Œ è´Ÿæ•°å¹´ä»½ã€‚0å¹´æŒ‡å…¬å…ƒå‰1å¹´ï¼Œ -1å¹´æŒ‡å…¬å…ƒå‰2å¹´ï¼Œä¾æ­¤ç±»æŽ¨ . æºä»£ç  æºä»£ç ï¼š Lib/calendar.py ä¸»è¦ç±»å’Œæ–¹æ³•,èŠ‚é€‰è‡ªæºç  123456__all__ = ["IllegalMonthError", "IllegalWeekdayError", "setfirstweekday", "firstweekday", "isleap", "leapdays", "weekday", "monthrange", "monthcalendar", "prmonth", "month", "prcal", "calendar", "timegm", "month_name", "month_abbr", "day_name", "day_abbr", "Calendar", "TextCalendar", "HTMLCalendar", "LocaleTextCalendar", "LocaleHTMLCalendar", "weekheader"] ç±»class calendar.Calendar(firstweekday=0)Â¶åˆ›å»ºä¸€ä¸ª Calendar å¯¹è±¡ã€‚ firstweekday æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºŽæŒ‡å®šä¸€å‘¨çš„ç¬¬ä¸€å¤©ã€‚ 0 æ˜¯æ˜ŸæœŸä¸€ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œ6 æ˜¯æ˜ŸæœŸå¤©ã€‚ Calendar å¯¹è±¡æä¾›äº†ä¸€äº›å¯è¢«ç”¨äºŽå‡†å¤‡æ—¥åŽ†æ•°æ®æ ¼å¼åŒ–çš„æ–¹æ³•ã€‚ è¿™ä¸ªç±»æœ¬èº«ä¸æ‰§è¡Œä»»ä½•æ ¼å¼åŒ–æ“ä½œã€‚ è¿™éƒ¨åˆ†ä»»åŠ¡åº”ç”±å­ç±»æ¥å®Œæˆã€‚ Calendar ç±»çš„å®žä¾‹æœ‰ä¸‹åˆ—æ–¹æ³•ï¼š iterweekdays() è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å†…å®¹ä¸ºä¸€æ˜ŸæœŸçš„æ•°å­—ã€‚è¿­ä»£å™¨çš„ç¬¬ä¸€ä¸ªå€¼ä¸Ž firstweekday å±žæ€§çš„å€¼ä¸€è‡³ã€‚ itermonthdates(year, month) è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å†…å®¹ä¸º year å¹´ month æœˆ(1-12)çš„æ—¥æœŸã€‚è¿™ä¸ªè¿­ä»£å™¨è¿”å›žå½“æœˆçš„æ‰€æœ‰æ—¥æœŸ ( datetime.date å¯¹è±¡)ï¼Œæ—¥æœŸåŒ…å«äº†æœ¬æœˆå¤´å°¾ç”¨äºŽç»„æˆå®Œæ•´ä¸€å‘¨çš„æ—¥æœŸã€‚ itermonthdays(year, month) è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å†…å®¹ä¸Ž itermonthdates() ç±»ä¼¼ï¼Œä¸º year å¹´ month æœˆçš„æ—¥æœŸï¼Œä½†ä¸å— datetime.date èŒƒå›´é™åˆ¶ã€‚è¿”å›žçš„æ—¥æœŸä¸ºå½“æœˆæ¯ä¸€å¤©çš„æ—¥æœŸå¯¹åº”çš„å¤©æ•°ã€‚å¯¹äºŽä¸åœ¨å½“æœˆçš„æ—¥æœŸï¼Œæ˜¾ç¤ºä¸º 0ã€‚ itermonthdays2(year, month) è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å†…å®¹ä¸Ž itermonthdates() ç±»ä¼¼ä¸º year å¹´ month æœˆçš„æ—¥æœŸï¼Œä½†ä¸å— datetime.date èŒƒå›´çš„é™åˆ¶ã€‚è¿­ä»£å™¨ä¸­çš„å…ƒç´ ä¸ºä¸€ä¸ªç”±æ—¥æœŸå’Œä»£è¡¨æ˜ŸæœŸå‡ çš„æ•°å­—ç»„æˆçš„çš„å…ƒç»„ã€‚ itermonthdays3(year, month) è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å†…å®¹ä¸Ž itermonthdates() ç±»ä¼¼ä¸º year å¹´ month æœˆçš„æ—¥æœŸï¼Œä½†ä¸å— datetime.date èŒƒå›´çš„é™åˆ¶ã€‚è¿­ä»£å™¨çš„å…ƒç´ ä¸ºä¸€ä¸ªç”±å¹´ï¼Œæœˆï¼Œæ—¥ç»„æˆçš„å…ƒç»„ã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. itermonthdays4(year, month) è¿”å›žä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨çš„å†…å®¹ä¸Ž itermonthdates() ç±»ä¼¼ä¸º year å¹´ month æœˆçš„æ—¥æœŸï¼Œä½†ä¸å— datetime.date èŒƒå›´çš„é™åˆ¶ã€‚è¿­ä»£å™¨çš„å…ƒç´ ä¸ºä¸€ä¸ªç”±å¹´ï¼Œæœˆï¼Œæ—¥å’Œä»£è¡¨æ˜ŸæœŸå‡ çš„æ•°å­—ç»„æˆçš„å…ƒç»„ã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. monthdatescalendar(year, month) è¿”å›žä¸€ä¸ªè¡¨ç¤ºæŒ‡å®šå¹´æœˆçš„å‘¨åˆ—è¡¨ã€‚å‘¨åˆ—è¡¨ç”±ä¸ƒä¸ª datetime.date å¯¹è±¡ç»„æˆã€‚ monthdays2calendar(year, month) è¿”å›žä¸€ä¸ªè¡¨ç¤ºæŒ‡å®šå¹´æœˆçš„å‘¨åˆ—è¡¨ã€‚å‘¨åˆ—è¡¨ç”±ä¸ƒä¸ªä»£è¡¨æ—¥æœŸçš„æ•°å­—å’Œä»£è¡¨å‘¨å‡ çš„æ•°å­—ç»„æˆçš„äºŒå…ƒå…ƒç»„ã€‚ monthdayscalendar(year, month) è¿”å›žä¸€ä¸ªè¡¨ç¤ºæŒ‡å®šå¹´æœˆçš„å‘¨åˆ—è¡¨ã€‚å‘¨åˆ—è¡¨ç”±ä¸ƒä¸ªä»£è¡¨æ—¥æœŸçš„æ•°å­—ç»„æˆã€‚ yeardatescalendar(year, width=3) è¿”å›žå¯ä»¥ç”¨æ¥æ ¼å¼åŒ–çš„æŒ‡å®šå¹´æœˆçš„æ•°æ®ã€‚è¿”å›žçš„å€¼æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨æ˜¯æœˆä»½ç»„æˆçš„è¡Œã€‚æ¯ä¸€è¡ŒåŒ…å«äº†æœ€å¤š width ä¸ªæœˆ(é»˜è®¤ä¸º3)ã€‚æ¯ä¸ªæœˆåŒ…å«äº†4åˆ°6å‘¨ï¼Œæ¯å‘¨åŒ…å«1â€“7å¤©ã€‚æ¯ä¸€å¤©ä½¿ç”¨ datetime.date å¯¹è±¡ã€‚ yeardays2calendar(year, width=3) è¿”å›žå¯ä»¥ç”¨æ¥æ¨¡å¼åŒ–çš„æŒ‡å®šå¹´æœˆçš„æ•°æ®(ä¸Ž yeardatescalendar() ç±»ä¼¼)ã€‚å‘¨åˆ—è¡¨çš„å…ƒç´ æ˜¯ç”±è¡¨ç¤ºæ—¥æœŸçš„æ•°å­—å’Œè¡¨ç¤ºæ˜ŸæœŸå‡ çš„æ•°å­—ç»„æˆçš„å…ƒç»„ã€‚ä¸åœ¨è¿™ä¸ªæœˆçš„æ—¥å­ä¸º0ã€‚ yeardayscalendar(year, width=3) è¿”å›žå¯ä»¥ç”¨æ¥æ¨¡å¼åŒ–çš„æŒ‡å®šå¹´æœˆçš„æ•°æ®(ä¸Ž yeardatescalendar() ç±»ä¼¼)ã€‚å‘¨åˆ—è¡¨çš„å…ƒç´ æ˜¯è¡¨ç¤ºæ—¥æœŸçš„æ•°å­—ã€‚ä¸åœ¨è¿™ä¸ªæœˆçš„æ—¥å­ä¸º0ã€‚ class calendar.TextCalendar(firstweekday=0)å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»ç”Ÿæˆçº¯æ–‡æœ¬æ—¥åŽ†ã€‚ TextCalendar å®žä¾‹æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š formatmonth(theyear, themonth, w=0, l=0) è¿”å›žä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²æ¥è¡¨ç¤ºæŒ‡å®šå¹´æœˆçš„æ—¥åŽ†ã€‚w ä¸ºæ—¥æœŸçš„å®½åº¦ï¼Œä½†å§‹ç»ˆä¿æŒæ—¥æœŸå±…ä¸­ã€‚l æŒ‡å®šäº†æ¯æ˜ŸæœŸå ç”¨çš„è¡Œæ•°ã€‚ä»¥ä¸Šè¿™äº›è¿˜ä¾èµ–äºŽæž„é€ å™¨æˆ–è€… setfirstweekday() æ–¹æ³•æŒ‡å®šçš„å‘¨çš„ç¬¬ä¸€å¤©æ˜¯å“ªä¸€å¤©ã€‚ prmonth(theyear, themonth, w=0, l=0) ä¸Ž formatmonth() æ–¹æ³•ä¸€æ ·ï¼Œè¿”å›žä¸€ä¸ªæœˆçš„æ—¥åŽ†ã€‚ formatyear(theyear, w=2, l=1, c=6, m=3) è¿”å›žä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¸ºä¸€ä¸ª m åˆ—æ—¥åŽ†ã€‚å¯é€‰å‚æ•° w, l, å’Œ c åˆ†åˆ«è¡¨ç¤ºæ—¥æœŸåˆ—æ•°ï¼Œ å‘¨çš„è¡Œæ•°ï¼Œ å’Œæœˆä¹‹é—´çš„é—´éš”ã€‚åŒæ ·ï¼Œä»¥ä¸Šè¿™äº›è¿˜ä¾èµ–äºŽæž„é€ å™¨æˆ–è€… setfirstweekday() æŒ‡å®šå“ªä¸€å¤©ä¸ºä¸€å‘¨çš„ç¬¬ä¸€å¤©ã€‚æ—¥åŽ†çš„ç¬¬ä¸€å¹´ç”±å¹³å°ä¾èµ–äºŽä½¿ç”¨çš„å¹³å°ã€‚ pryear(theyear, w=2, l=1, c=6, m=3) ä¸Ž formatyear() æ–¹æ³•ä¸€æ ·ï¼Œè¿”å›žä¸€æ•´å¹´çš„æ—¥åŽ†ã€‚ class calendar.HTMLCalendar(firstweekday=0)å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»ç”Ÿæˆ HTML æ—¥åŽ†ã€‚HTMLCalendar å®žä¾‹æœ‰ä»¥ä¸‹æ–¹æ³•ï¼šformatmonth(theyear, themonth, withyear=True)è¿”å›žä¸€ä¸ª HTML è¡¨æ ¼ä½œä¸ºæŒ‡å®šå¹´æœˆçš„æ—¥åŽ†ã€‚ withyear ä¸ºçœŸï¼Œåˆ™å¹´ä»½å°†ä¼šåŒ…å«åœ¨è¡¨å¤´ï¼Œå¦åˆ™åªæ˜¾ç¤ºæœˆä»½ã€‚formatyear(theyear, width=3)è¿”å›žä¸€ä¸ª HTML è¡¨æ ¼ä½œä¸ºæŒ‡å®šå¹´ä»½çš„æ—¥åŽ†ã€‚ width (é»˜è®¤ä¸º3) ç”¨äºŽè§„å®šæ¯ä¸€è¡Œæ˜¾ç¤ºæœˆä»½çš„æ•°é‡ã€‚formatyearpage(theyear, width=3, css=â€™calendar.cssâ€™, encoding=None)è¿”å›žä¸€ä¸ªå®Œæ•´çš„ HTML é¡µé¢ä½œä¸ºæŒ‡å®šå¹´ä»½çš„æ—¥åŽ†ã€‚ width\(é»˜è®¤ä¸º3) ç”¨äºŽè§„å®šæ¯ä¸€è¡Œæ˜¾ç¤ºçš„æœˆä»½æ•°é‡ã€‚ *css ä¸ºå±‚å æ ·å¼è¡¨çš„åå­—ã€‚å¦‚æžœä¸ä½¿ç”¨ä»»ä½•å±‚å æ ·å¼è¡¨ï¼Œå¯ä»¥ä½¿ç”¨ None ã€‚ encoding* ä¸ºè¾“å‡ºé¡µé¢çš„ç¼–ç  (é»˜è®¤ä¸ºç³»ç»Ÿçš„é»˜è®¤ç¼–ç )ã€‚HTMLCalendar æœ‰ä»¥ä¸‹å±žæ€§ï¼Œä½ å¯ä»¥é‡è½½å®ƒä»¬æ¥è‡ªå®šä¹‰åº”ç”¨æ—¥åŽ†çš„æ ·å¼ã€‚ cssclassesä¸€ä¸ªå¯¹åº”æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸå¤©çš„ CSS class åˆ—è¡¨ã€‚é»˜è®¤åˆ—è¡¨ä¸º 1cssclasses = ["mon", "tue", "wed", "thu", "fri", "sat", "sun"] å¯ä»¥å‘æ¯å¤©åŠ å…¥å…¶å®ƒæ ·å¼ 1cssclasses = ["mon text-bold", "tue", "wed", "thu", "fri", "sat", "sun red"] éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ—è¡¨çš„é•¿åº¦å¿…é¡»ä¸º7ã€‚ cssclass_noday å·¥ä½œæ—¥çš„ CSS ç±»åœ¨ä¸Šä¸ªæœˆæˆ–ä¸‹ä¸ªæœˆå‘ç”Ÿã€‚ cssclasses_weekday_head ç”¨äºŽæ ‡é¢˜è¡Œä¸­çš„å·¥ä½œæ—¥åç§°çš„ CSS ç±» åˆ—è¡¨ã€‚é»˜è®¤å€¼ä¸Ž cssclasses ç›¸åŒã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. cssclass_month_head æœˆä»½çš„å¤´ CSS ç±»ï¼ˆç”± formatmonthname() ä½¿ç”¨ï¼‰ã€‚é»˜è®¤å€¼ä¸º &quot;month&quot; ã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. cssclass_month æŸä¸ªæœˆçš„æœˆåŽ†çš„ CSS ç±»ï¼ˆç”± formatmonth() ä½¿ç”¨ï¼‰ã€‚é»˜è®¤å€¼ä¸º &quot;month&quot; ã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. cssclass_year æŸå¹´çš„å¹´åŽ†çš„ CSS ç±»ï¼ˆç”± formatyear() ä½¿ç”¨ï¼‰ã€‚é»˜è®¤å€¼ä¸º &quot;year&quot; ã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. cssclass_year_head å¹´åŽ†çš„Â·è¡¨å¤´ CSS ç±»ï¼ˆç”± formatyear() ä½¿ç”¨ï¼‰ã€‚é»˜è®¤å€¼ä¸º &quot;year&quot; ã€‚3.7 æ–°ç‰ˆåŠŸèƒ½. éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡ä¸Šé¢å‘½åçš„æ ·å¼ç±»éƒ½æ˜¯å•ç‹¬å‡ºçŽ°çš„(å¦‚ï¼š cssclass_month cssclass_noday), ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç©ºæ ¼å°†æ ·å¼ç±»åˆ—è¡¨ä¸­çš„å¤šä¸ªå…ƒç´ åˆ†éš”å¼€ï¼Œä¾‹å¦‚ï¼š 1"text-bold text-red" ä¸‹é¢æ˜¯ä¸€ä¸ªå¦‚ä½•è‡ªå®šä¹‰ HTMLCalendar çš„ç¤ºä¾‹ 123456class CustomHTMLCal(calendar.HTMLCalendar): cssclasses = [style + " text-nowrap" for style in calendar.HTMLCalendar.cssclasses] cssclass_month_head = "text-center month-head" cssclass_month = "text-center month" cssclass_year = "text-italic lead" class calendar.LocaleTextCalendar(firstweekday=0, locale=None)è¿™ä¸ªå­ç±» TextCalendar å¯ä»¥åœ¨æž„é€ å‡½æ•°ä¸­ä¼ é€’ä¸€ä¸ªè¯­è¨€çŽ¯å¢ƒåç§°ï¼Œå¹¶ä¸”è¿”å›žæœˆä»½å’Œæ˜ŸæœŸå‡ çš„åç§°åœ¨ç‰¹å®šè¯­è¨€çŽ¯å¢ƒä¸­ã€‚å¦‚æžœæ­¤è¯­è¨€çŽ¯å¢ƒåŒ…å«ç¼–ç ï¼Œåˆ™åŒ…å«æœˆä»½å’Œå·¥ä½œæ—¥åç§°çš„æ‰€æœ‰å­—ç¬¦ä¸²å°†ä½œä¸º unicode è¿”å›žã€‚ class calendar.LocaleHTMLCalendar(firstweekday=0, locale=None) calendar.setfirstweekday(weekday) è®¾ç½®æ¯ä¸€å‘¨çš„å¼€å§‹(0 è¡¨ç¤ºæ˜ŸæœŸä¸€ï¼Œ6 è¡¨ç¤ºæ˜ŸæœŸå¤©)ã€‚calendarè¿˜æä¾›äº† MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY å’Œ SUNDAY å‡ ä¸ªå¸¸é‡æ–¹ä¾¿ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®æ¯å‘¨çš„ç¬¬ä¸€å¤©ä¸ºæ˜ŸæœŸå¤© 12import calendarcalendar.setfirstweekday(calendar.SUNDAY) calendar.firstweekday() è¿”å›žå½“å‰è®¾ç½®çš„æ¯æ˜ŸæœŸçš„ç¬¬ä¸€å¤©çš„æ•°å€¼ã€‚ calendar.isleap(year) å¦‚æžœ year æ˜¯é—°å¹´åˆ™è¿”å›ž True ,å¦åˆ™è¿”å›ž Falseã€‚ calendar.leapdays(y1, y2) è¿”å›žåœ¨èŒƒå›´ y1 è‡³ y2 ï¼ˆåŒ…å« y1 å’Œ y2 ï¼‰ä¹‹é—´çš„é—°å¹´çš„å¹´æ•°ï¼Œå…¶ä¸­ y1 å’Œ y2 æ˜¯å¹´ä»½ã€‚æ­¤å‡½æ•°é€‚ç”¨äºŽè·¨è¶Šä¸€ä¸ªä¸–çºªå˜åŒ–çš„èŒƒå›´ã€‚ calendar.weekday(year, month, day) è¿”å›žæŸå¹´ï¼ˆ 1970 â€“ â€¦ï¼‰ï¼ŒæŸæœˆï¼ˆ 1 â€“ 12 ï¼‰ï¼ŒæŸæ—¥ï¼ˆ 1 â€“ 31 ï¼‰æ˜¯æ˜ŸæœŸå‡ ï¼ˆ 0 æ˜¯æ˜ŸæœŸä¸€ï¼‰ã€‚ calendar.weekheader(n) è¿”å›žä¸€ä¸ªåŒ…å«æ˜ŸæœŸå‡ çš„ç¼©å†™åçš„å¤´ã€‚ n æŒ‡å®šæ˜ŸæœŸå‡ ç¼©å†™çš„å­—ç¬¦å®½åº¦ã€‚ calendar.monthrange(year, month) è¿”å›žæŒ‡å®š å¹´ä»½ çš„æŒ‡å®š æœˆä»½ çš„ç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ å’Œè¿™ä¸ªæœˆçš„å¤©æ•°ã€‚ calendar.monthcalendar(year, month) è¿”å›žè¡¨ç¤ºä¸€ä¸ªæœˆçš„æ—¥åŽ†çš„çŸ©é˜µã€‚æ¯ä¸€è¡Œä»£è¡¨ä¸€å‘¨ï¼›æ­¤æœˆä»½å¤–çš„æ—¥å­ç”±é›¶è¡¨ç¤ºã€‚é™¤éžç”± setfirstweekday() è®¾ç½®ï¼Œå¦åˆ™æ¯å‘¨ä»¥å‘¨ä¸€ä¸ºå§‹ã€‚ calendar.prmonth(theyear, themonth, w=0, l=0) æ‰“å°ç”± month() è¿”å›žçš„ä¸€ä¸ªæœˆçš„æ—¥åŽ†ã€‚ calendar.month(theyear, themonth, w=0, l=0) ä½¿ç”¨ TextCalendar ç±»çš„ formatmonth() ä»¥å¤šè¡Œå­—ç¬¦ä¸²å½¢å¼è¿”å›žæœˆä»½æ—¥åŽ†ã€‚ calendar.prcal(year, w=0, l=0, c=6, m=3) æ‰“å°ç”± calendar() è¿”å›žçš„æ•´å¹´çš„æ—¥åŽ†ã€‚ calendar.calendar(year, w=2, l=1, c=6, m=3) ä½¿ç”¨ TextCalendar ç±»çš„ formatyear() è¿”å›žæ•´å¹´çš„3åˆ—çš„æ—¥åŽ†ä»¥å¤šè¡Œå­—ç¬¦ä¸²çš„å½¢å¼ã€‚ calendar.timegm(tuple) ä¸€ä¸ªä¸ç›¸å…³ä½†å¾ˆå¥½ç”¨çš„å‡½æ•°ï¼Œå®ƒæŽ¥å—ä¸€ä¸ªæ—¶é—´å…ƒç»„ä¾‹å¦‚ time æ¨¡å—ä¸­çš„ gmtime() å‡½æ•°çš„è¿”å›žå¹¶è¿”å›žç›¸åº”çš„ Unix æ—¶é—´æˆ³å€¼ï¼Œå‡å®š 1970 å¹´å¼€å§‹è®¡æ•°ï¼Œ POSIX ç¼–ç ã€‚å®žé™…ä¸Šï¼Œ time.gmtime() å’Œ timegm() æ˜¯å½¼æ­¤ç›¸åçš„ã€‚ å±žæ€§ calendar.day_name åœ¨å½“å‰è¯­è¨€çŽ¯å¢ƒä¸‹è¡¨ç¤ºæ˜ŸæœŸå‡ çš„æ•°ç»„ã€‚ calendar.day_abbr åœ¨å½“å‰è¯­è¨€çŽ¯å¢ƒä¸‹è¡¨ç¤ºæ˜ŸæœŸå‡ ç¼©å†™çš„æ•°ç»„ã€‚ calendar.month_name åœ¨å½“å‰è¯­è¨€çŽ¯å¢ƒä¸‹è¡¨ç¤ºä¸€å¹´ä¸­æœˆä»½çš„æ•°ç»„ã€‚è¿™éµå¾ªä¸€æœˆçš„æœˆå·ä¸º 1 çš„é€šå¸¸æƒ¯ä¾‹ï¼Œæ‰€ä»¥å®ƒçš„é•¿åº¦ä¸º 13 ä¸” month_name[0] æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚ calendar.month_abbr åœ¨å½“å‰è¯­è¨€çŽ¯å¢ƒä¸‹è¡¨ç¤ºæœˆä»½ç®€å†™çš„æ•°ç»„ã€‚è¿™éµå¾ªä¸€æœˆçš„æœˆå·ä¸º 1 çš„é€šå¸¸æƒ¯ä¾‹ï¼Œæ‰€ä»¥å®ƒçš„é•¿åº¦ä¸º 13 ä¸” month_abbr[0] æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚ ä¾‹å­ å°ç»“ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›æ—¥åŽ†å°†æ˜ŸæœŸä¸€ä½œä¸ºä¸€å‘¨çš„ç¬¬ä¸€å¤©ï¼Œå°†æ˜ŸæœŸæ—¥ä½œä¸ºä¸€å‘¨çš„æœ€åŽä¸€å¤©(æ¬§æ´²æƒ¯ä¾‹)ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨setfirstweekday()æ–¹æ³•æ¥è®¾ç½®ä¸€å‘¨çš„ç¬¬ä¸€å¤©ä¸ºæ˜ŸæœŸæ—¥æˆ–hè€…å…¶ä»–å·¥ä½œæ—¥ï¼ŒæŒ‡å®šçš„æ—¥æœŸä»¥æ•´æ•°å½¢å¼ç»™å‡ºã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>calendar</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library iterator and generator]]></title>
    <url>%2F2020%2F01%2F15%2Fpython-standard-library-iterator-and-generator%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ ç±»åž‹ï¼š è¿­ä»£å™¨ å’Œ ç”Ÿæˆå™¨æ¯æ—¥è‹±è¯­: miracle n [è‹±] [ËˆmÉªrÉ™kl] [ç¾Ž] [ ËˆmÉªrÉ™kÉ™l ] å¥‡è¿¹ï¼Œåœ£è¿¹ï¼Œç¥žè¿¹ï¼› ä»¤äººæƒŠå¥‡çš„äººï¼ˆæˆ–äº‹ï¼‰ æŽ¨èä¸€ä¸ªè€ç”µå½±ï¼š æ¯ä¸ªäººç»ˆå°†éƒ½ä¼šè¸ä¸Šè‡ªå·±çš„ç»¿è‰²æ—…ç¨‹,å–„æ¶å°±åœ¨ä¸€å¿µä¹‹é—´ã€‚æ„¿ä¸–ç•Œç¾Žå¥½,æ¸©æƒ…ä»¥å¾…ã€‚ å…ˆçœ‹ä¸€å¼ å›¾: 1ï¼Œè¿­ä»£å™¨åè®®ï¼šå¯¹è±¡éœ€è¦æä¾›next()æ–¹æ³•ï¼Œå®ƒè¦ä¹ˆè¿”å›žè¿­ä»£ä¸­çš„ä¸‹ä¸€é¡¹ï¼Œè¦ä¹ˆå°±å¼•èµ·ä¸€ä¸ªStopIterationå¼‚å¸¸ï¼Œä»¥ç»ˆæ­¢è¿­ä»£ã€‚ 2ï¼Œå¯è¿­ä»£å¯¹è±¡ï¼šå®žçŽ°äº†è¿­ä»£å™¨åè®®å¯¹è±¡ã€‚listã€tupleã€dictéƒ½æ˜¯Iterableï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰ï¼Œä½†ä¸æ˜¯Iteratorï¼ˆè¿­ä»£å™¨å¯¹è±¡ï¼‰ã€‚ä½†å¯ä»¥ä½¿ç”¨å†…å»ºå‡½æ•°iter()ï¼ŒæŠŠè¿™äº›éƒ½å˜æˆIterableï¼ˆå¯è¿­ä»£å™¨å¯¹è±¡ï¼‰ã€‚ 3ï¼Œfor item in Iterable å¾ªçŽ¯çš„æœ¬è´¨å°±æ˜¯å…ˆé€šè¿‡iter()å‡½æ•°èŽ·å–å¯è¿­ä»£å¯¹è±¡Iterableçš„è¿­ä»£å™¨ï¼Œç„¶åŽå¯¹èŽ·å–åˆ°çš„è¿­ä»£å™¨ä¸æ–­è°ƒç”¨next()æ–¹æ³•æ¥èŽ·å–ä¸‹ä¸€ä¸ªå€¼å¹¶å°†å…¶èµ‹å€¼ç»™itemï¼Œå½“é‡åˆ°StopIterationçš„å¼‚å¸¸åŽå¾ªçŽ¯ç»“æŸ è¿­ä»£å™¨ç±»åž‹Python æ”¯æŒåœ¨å®¹å™¨ä¸­è¿›è¡Œè¿­ä»£çš„æ¦‚å¿µã€‚ è¿™æ˜¯é€šè¿‡ä½¿ç”¨ä¸¤ä¸ªå•ç‹¬æ–¹æ³•æ¥å®žçŽ°çš„ï¼›å®ƒä»¬è¢«ç”¨äºŽå…è®¸ç”¨æˆ·è‡ªå®šä¹‰ç±»å¯¹è¿­ä»£çš„æ”¯æŒã€‚ å°†åœ¨ä¸‹æ–‡ä¸­è¯¦ç»†æè¿°çš„åºåˆ—æ€»æ˜¯æ”¯æŒè¿­ä»£æ–¹æ³•ã€‚ å®¹å™¨å¯¹è±¡è¦æä¾›è¿­ä»£æ”¯æŒï¼Œå¿…é¡»å®šä¹‰ä¸€ä¸ªæ–¹æ³•: container.__iter__() è¿”å›žä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ã€‚ è¯¥å¯¹è±¡éœ€è¦æ”¯æŒä¸‹æ–‡æ‰€è¿°çš„è¿­ä»£å™¨åè®®ã€‚ å¦‚æžœå®¹å™¨æ”¯æŒä¸åŒçš„è¿­ä»£ç±»åž‹ï¼Œåˆ™å¯ä»¥æä¾›é¢å¤–çš„æ–¹æ³•æ¥ä¸“é—¨åœ°è¯·æ±‚ä¸åŒè¿­ä»£ç±»åž‹çš„è¿­ä»£å™¨ã€‚ ï¼ˆæ”¯æŒå¤šç§è¿­ä»£å½¢å¼çš„å¯¹è±¡çš„ä¾‹å­æœ‰åŒæ—¶æ”¯æŒå¹¿åº¦ä¼˜å…ˆå’Œæ·±åº¦ä¼˜å…ˆéåŽ†çš„æ ‘ç»“æž„ã€‚ï¼‰ æ­¤æ–¹æ³•å¯¹åº”äºŽ Python/C API ä¸­ Python å¯¹è±¡ç±»åž‹ç»“æž„ä½“çš„ tp_iter æ§½ä½ã€‚ è¿­ä»£å™¨å¯¹è±¡è‡ªèº«éœ€è¦æ”¯æŒä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å…±åŒç»„æˆäº† è¿­ä»£å™¨åè®®: iterator.__iter__() è¿”å›žè¿­ä»£å™¨å¯¹è±¡æœ¬èº«ã€‚ è¿™æ˜¯åŒæ—¶å…è®¸å®¹å™¨å’Œè¿­ä»£å™¨é…åˆ for å’Œ in è¯­å¥ä½¿ç”¨æ‰€å¿…é¡»çš„ã€‚ æ­¤æ–¹æ³•å¯¹åº”äºŽ Python/C API ä¸­ Python å¯¹è±¡ç±»åž‹ç»“æž„ä½“çš„ tp_iter æ§½ä½ã€‚ iterator.__next__() ä»Žå®¹å™¨ä¸­è¿”å›žä¸‹ä¸€é¡¹ã€‚ å¦‚æžœå·²ç»æ²¡æœ‰é¡¹å¯è¿”å›žï¼Œåˆ™ä¼šå¼•å‘ StopIteration å¼‚å¸¸ã€‚ æ­¤æ–¹æ³•å¯¹åº”äºŽ Python/C API ä¸­ Python å¯¹è±¡ç±»åž‹ç»“æž„ä½“çš„ tp_iternext æ§½ä½ã€‚ Python å®šä¹‰äº†å‡ ç§è¿­ä»£å™¨å¯¹è±¡ä»¥æ”¯æŒå¯¹ä¸€èˆ¬å’Œç‰¹å®šåºåˆ—ç±»åž‹ã€å­—å…¸å’Œå…¶ä»–æ›´ç‰¹åˆ«çš„å½¢å¼è¿›è¡Œè¿­ä»£ã€‚ é™¤äº†è¿­ä»£å™¨åè®®çš„å®žçŽ°ï¼Œç‰¹å®šç±»åž‹çš„å…¶ä»–æ€§è´¨å¯¹è¿­ä»£æ“ä½œæ¥è¯´éƒ½ä¸é‡è¦ã€‚ ä¸€æ—¦è¿­ä»£å™¨çš„ __next__() æ–¹æ³•å¼•å‘äº† StopIterationï¼Œå®ƒå¿…é¡»ä¸€ç›´å¯¹åŽç»­è°ƒç”¨å¼•å‘åŒæ ·çš„å¼‚å¸¸ã€‚ ä¸éµå¾ªæ­¤è¡Œä¸ºç‰¹æ€§çš„å®žçŽ°å°†æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚ è¿­ä»£å™¨ä½¿ç”¨å®žä¾‹ 123456789101112131415161718# éšä¾¿å®šä¹‰ä¸€ä¸ªlistlistArray=[1,2,3]# ä½¿ç”¨iter()å‡½æ•°iterName=iter(listArray)print(iterName)# ç»“æžœå¦‚ä¸‹ï¼šæ˜¯ä¸€ä¸ªåˆ—è¡¨listçš„è¿­ä»£å™¨# &lt;list_iterator object at 0x0000017B0D984278&gt;print(next(iterName))print(next(iterName))print(next(iterName))print(next(iterName))#æ²¡æœ‰è¿­ä»£åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œç›´æŽ¥æŠ›å‡ºå¼‚å¸¸# 1# 2# 3# Traceback (most recent call last):# File "python_iterator.py", line 32, in &lt;module&gt;# StopIteration è‡ªå®šä¹‰è¿­ä»£å™¨å®žä¾‹ 123456789101112131415161718192021222324252627class Fib(object): def __init__(self, max): super(Fib, self).__init__() self.max = max def __iter__(self): self.a = 0 self.b = 1 return self def __next__(self): fib = self.a if fib &gt; self.max: raise StopIteration self.a, self.b = self.b, self.a + self.b return fib# å®šä¹‰ä¸€ä¸ªmainå‡½æ•°ï¼Œå¾ªçŽ¯éåŽ†æ¯ä¸€ä¸ªè²æ³¢é‚£åˆ‡æ•°def main(): # 20ä»¥å†…çš„æ•° fib = Fib(20) for i in fib: print(i)# æµ‹è¯•if __name__ == '__main__': main() ç”Ÿæˆå™¨ç±»åž‹Python çš„ generator æä¾›äº†ä¸€ç§å®žçŽ°è¿­ä»£å™¨åè®®çš„ä¾¿æ·æ–¹å¼ã€‚ å¦‚æžœå®¹å™¨å¯¹è±¡ __iter__() æ–¹æ³•è¢«å®žçŽ°ä¸ºä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå®ƒå°†è‡ªåŠ¨è¿”å›žä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼ˆä»ŽæŠ€æœ¯ä¸Šè¯´æ˜¯ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼‰ï¼Œè¯¥å¯¹è±¡æä¾› __iter__() å’Œ __next__() æ–¹æ³•ã€‚ æœ‰å…³ç”Ÿæˆå™¨çš„æ›´å¤šä¿¡æ¯å¯ä»¥å‚é˜… yield è¡¨è¾¾å¼çš„æ–‡æ¡£ã€‚ ç”Ÿæˆå™¨å‡½æ•°123456789101112131415161718# è²æ³¢é‚£åˆ‡æ•°åˆ—def Fib(max): n, a, b = 0, 0, 1 while n &lt; max: yield b a, b = b, a + b n = n + 1 return 'äº²ï¼æ²¡æœ‰æ•°æ®äº†...'# è°ƒç”¨æ–¹æ³•ï¼Œç”Ÿæˆå‡º10ä¸ªæ•°æ¥f=Fib(10)# ä½¿ç”¨ä¸€ä¸ªå¾ªçŽ¯æ•èŽ·æœ€åŽreturn è¿”å›žçš„å€¼ï¼Œä¿å­˜åœ¨å¼‚å¸¸StopIterationçš„valueä¸­while True: try: x=next(f) print("f:",x) except StopIteration as e: print("ç”Ÿæˆå™¨æœ€åŽçš„è¿”å›žå€¼æ˜¯ï¼š",e.value) break ç”Ÿæˆå™¨è¡¨è¾¾å¼1234567891011121314151617181920212223242526272829# ä¸€ä¸ªåˆ—è¡¨xiaoke=[2,3,4,5]# ç”Ÿæˆå™¨generatorï¼Œç±»ä¼¼äºŽlistï¼Œä½†æ˜¯æ˜¯æŠŠ[]æ”¹ä¸º()gen=(a for a in xiaoke)for i in gen: print(i)#ç»“æžœæ˜¯ï¼š2345# ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç”Ÿæˆå™¨ï¼Ÿå› ä¸ºæ•ˆçŽ‡ã€‚# ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼å–ä»£åˆ—è¡¨æŽ¨å¯¼å¼å¯ä»¥åŒæ—¶èŠ‚çœ cpu å’Œ å†…å­˜(RAM)ã€‚# å¦‚æžœä½ æž„é€ ä¸€ä¸ªåˆ—è¡¨(list)çš„ç›®çš„ä»…ä»…æ˜¯ä¼ é€’ç»™åˆ«çš„å‡½æ•°,# æ¯”å¦‚ ä¼ é€’ç»™tuple()æˆ–è€…set(), é‚£å°±ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æ›¿ä»£å§!# æœ¬æ¡ˆä¾‹æ˜¯ç›´æŽ¥æŠŠåˆ—è¡¨è½¬åŒ–ä¸ºå…ƒç»„kk=tuple(a for a in xiaoke)print(kk)#ç»“æžœæ˜¯ï¼š(2, 3, 4, 5)# pythonå†…ç½®çš„ä¸€äº›å‡½æ•°ï¼Œå¯ä»¥è¯†åˆ«è¿™æ˜¯ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œå¤–é¢æœ‰ä¸€å¯¹å°æ‹¬å·ï¼Œå°±æ˜¯ç”Ÿæˆå™¨result1=sum(a for a in range(3))print(result1)# åˆ—è¡¨æŽ¨å¯¼å¼result2=sum([a for a in range(3)])print(result2) yieldå…³é”®å­—ä½¿ç”¨yieldå…³é”®å­—å®žçŽ°ç”Ÿæˆå™¨å‡½æ•° 12345def fib(max): a, b = 1, 1 while a &lt; max: yield a #è¿™æ—¶a,bå€¼åˆ†åˆ«ä¸º1,1ï¼Œå½“ç„¶ï¼Œç¨‹åºä¹Ÿåœ¨æ‰§è¡Œåˆ°è¿™æ—¶ï¼Œè¿”å›ž a, b = b, a+b ä½¿ç”¨yieldå…³é”®å­—å®žçŽ°è‡ªå®šä¹‰ç”Ÿæˆå™¨ 123456789101112131415161718class Fib: def __init__(self, max): self.max = max def __iter__(self): self.a = 0 self.b = 1 return self def next(self): fib = self.a if fib &gt; self.max: raise StopIteration self.a, self.b = self.b, self.a + self.b return fib if __name__ == '__main__': for f in Fib(6): print f]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>iterator</tag>
        <tag>generator</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library pickle]]></title>
    <url>%2F2020%2F01%2F14%2Fpython-standard-library-pickle%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ pickleå¿«è¿‡å¹´äº†,å‡†å¤‡äº†ä¸€äº›è¿‡èŠ‚ç”¨çš„è‹±è¯­ ä¼ ç»Ÿä¸­å›½èŠ‚æ—¥ï¼štraditional Chinese festival å†œåŽ†ï¼šlunar calendar è…Šå…«èŠ‚ï¼šLaba Festival å°å¹´ï¼šLittle New Year é™¤å¤•ï¼šLunar New Yearâ€™s Eve æ˜¥èŠ‚ï¼šthe Spring Festival æ­£æœˆåˆä¸€ï¼šthe lunar New Yearâ€™s Day å…ƒå®µèŠ‚ï¼šthe Lantern Festival æ­£æœˆï¼šthe first month of the lunar year äºŒæœˆäºŒï¼šDragon Heads-raising Day æ—¶é—´è¿‡å¾—å¥½å¿«,åˆæ˜¯ä¸€å¹´è¿‡åŽ»äº†ã€‚ python æ ‡å‡†åº“å­¦ä¹ ä¹‹ pickleå¸¸ç”¨çš„æ–‡æœ¬å¤„ç† é™¤äº†æ–‡ä»¶,æ•°æ®åº“,json,xml ä»¥å¤–,pythonè¿˜æä¾›äº†ä¸€ç§å­˜å‚¨æ–¹æ¡ˆ,è¿™å°±æ˜¯pickleã€‚ æ¨¡å— pickle å®žçŽ°äº†å¯¹ä¸€ä¸ª Python å¯¹è±¡ç»“æž„çš„äºŒè¿›åˆ¶åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚â€œpicklingâ€ æ˜¯å°† Python å¯¹è±¡åŠå…¶æ‰€æ‹¥æœ‰çš„å±‚æ¬¡ç»“æž„è½¬åŒ–ä¸ºä¸€ä¸ªå­—èŠ‚æµçš„è¿‡ç¨‹ï¼Œè€Œ â€œunpicklingâ€ æ˜¯ç›¸åçš„æ“ä½œï¼Œä¼šå°†ï¼ˆæ¥è‡ªä¸€ä¸ª binary file æˆ–è€… bytes-like object çš„ï¼‰å­—èŠ‚æµè½¬åŒ–å›žä¸€ä¸ªå¯¹è±¡å±‚æ¬¡ç»“æž„ã€‚ picklingï¼ˆå’Œ unpicklingï¼‰ä¹Ÿè¢«ç§°ä¸ºâ€œåºåˆ—åŒ–â€, â€œç¼–ç»„â€ æˆ–è€… â€œå¹³é¢åŒ–â€ã€‚è€Œä¸ºäº†é¿å…æ··ä¹±ï¼Œæ­¤å¤„é‡‡ç”¨æœ¯è¯­ â€œå°å­˜ (pickling)â€ å’Œ â€œè§£å° (unpickling)â€ã€‚ è­¦å‘Š : pickle æ¨¡å—å¹¶ä¸å®‰å…¨ã€‚ä½ åªåº”è¯¥å¯¹ä½ ä¿¡ä»»çš„æ•°æ®è¿›è¡Œunpickleæ“ä½œã€‚æž„å»ºæ¶æ„çš„ pickle æ•°æ®æ¥åœ¨è§£å°æ—¶æ‰§è¡Œä»»æ„ä»£ç æ˜¯å¯èƒ½çš„ã€‚ç»å¯¹ä¸è¦å¯¹ä¸ä¿¡ä»»æ¥æºçš„æ•°æ®å’Œå¯èƒ½è¢«ç¯¡æ”¹è¿‡çš„æ•°æ®è¿›è¡Œè§£å°ã€‚è¯·è€ƒè™‘ä½¿ç”¨ hmac æ¥å¯¹æ•°æ®è¿›è¡Œç­¾åï¼Œç¡®ä¿æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚åœ¨ä½ å¤„ç†ä¸ä¿¡ä»»æ•°æ®æ—¶ï¼Œæ›´å®‰å…¨çš„åºåˆ—åŒ–æ ¼å¼å¦‚ json å¯èƒ½æ›´ä¸ºé€‚åˆã€‚å‚è§ ä¸Ž json æ¨¡å—çš„æ¯”è¾ƒ æºä»£ç ï¼š Lib/pickle.pyæœ¬èŠ‚å†…å®¹æ¯”è¾ƒå¤š,å…ˆçœ‹ä¸‹ç±»å±‚æ¬¡ç»“æž„,æœ‰ä¸€ä¸ªå¤§ä½“çš„æ¦‚å¿µ(èŠ‚é€‰è‡ªæºç )ï¼š 123456789101112131415Classes: Pickler UnpicklerFunctions: dump(object, file) dumps(object) -&gt; string load(file) -&gt; object loads(string) -&gt; objectMisc variables: __version__ format_version compatible_formats __all__ = ["PickleError", "PicklingError", "UnpicklingError", "Pickler", "Unpickler", "dump", "dumps", "load", "loads"] æ•°æ®æµæ ¼å¼pickletools æ¨¡å—åŒ…å«äº†ç›¸åº”çš„å·¥å…·ç”¨äºŽåˆ†æž pickle ç”Ÿæˆçš„æ•°æ®æµã€‚pickletools æºç ä¸­åŒ…å«äº†å¯¹ pickle åè®®ä½¿ç”¨çš„æ“ä½œç çš„å¤§é‡æ³¨é‡Šã€‚ å½“å‰å…±æœ‰ 6 ç§ä¸åŒçš„åè®®å¯ç”¨äºŽå°å­˜æ“ä½œã€‚ ä½¿ç”¨çš„åè®®ç‰ˆæœ¬è¶Šé«˜ï¼Œè¯»å–æ‰€ç”Ÿæˆ pickle å¯¹è±¡æ‰€éœ€çš„ Python ç‰ˆæœ¬å°±è¦è¶Šæ–°ã€‚ v0 ç‰ˆåè®®æ˜¯åŽŸå§‹çš„â€œäººç±»å¯è¯»â€åè®®ï¼Œå¹¶ä¸”å‘åŽå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„ Pythonã€‚ v1 ç‰ˆåè®®æ˜¯è¾ƒæ—©çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ƒä¹Ÿä¸Žæ—©æœŸç‰ˆæœ¬çš„ Python å…¼å®¹ã€‚ v2 ç‰ˆåè®®æ˜¯åœ¨ Python 2.3 ä¸­å¼•å…¥çš„ã€‚å®ƒä¸ºå­˜å‚¨ new-style class æä¾›äº†æ›´é«˜æ•ˆçš„æœºåˆ¶ã€‚æ¬²äº†è§£æœ‰å…³ç¬¬ 2 ç‰ˆåè®®å¸¦æ¥çš„æ”¹è¿›ï¼Œè¯·å‚é˜… PEP 307ã€‚ v3 ç‰ˆåè®®æ˜¯åœ¨ Python 3.0 ä¸­å¼•å…¥çš„ã€‚ å®ƒæ˜¾å¼åœ°æ”¯æŒ bytes å­—èŠ‚å¯¹è±¡ï¼Œä¸èƒ½ä½¿ç”¨ Python 2.x è§£å°ã€‚è¿™æ˜¯ Python 3.0-3.7 çš„é»˜è®¤åè®®ã€‚ v4 ç‰ˆåè®®æ·»åŠ äºŽ Python 3.4ã€‚å®ƒæ”¯æŒå­˜å‚¨éžå¸¸å¤§çš„å¯¹è±¡ï¼Œèƒ½å­˜å‚¨æ›´å¤šç§ç±»çš„å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›é’ˆå¯¹æ•°æ®æ ¼å¼çš„ä¼˜åŒ–ã€‚å®ƒæ˜¯Python 3.8ä½¿ç”¨çš„é»˜è®¤åè®®ã€‚æœ‰å…³ç¬¬ 4 ç‰ˆåè®®å¸¦æ¥æ”¹è¿›çš„ä¿¡æ¯ï¼Œè¯·å‚é˜… PEP 3154ã€‚ ç¬¬ 5 ç‰ˆåè®®æ˜¯åœ¨ Python 3.8 ä¸­åŠ å…¥çš„ã€‚ å®ƒå¢žåŠ äº†å¯¹å¸¦å¤–æ•°æ®çš„æ”¯æŒï¼Œå¹¶å¯åŠ é€Ÿå¸¦å†…æ•°æ®å¤„ç†ã€‚ è¯·å‚é˜… PEP 574 äº†è§£ç¬¬ 5 ç‰ˆåè®®æ‰€å¸¦æ¥çš„æ”¹è¿›çš„è¯¦æƒ…ã€‚ æ¨¡å—æŽ¥å£è¦åºåˆ—åŒ–æŸä¸ªåŒ…å«å±‚æ¬¡ç»“æž„çš„å¯¹è±¡ï¼Œåªéœ€è°ƒç”¨ dumps() å‡½æ•°å³å¯ã€‚åŒæ ·ï¼Œè¦ååºåˆ—åŒ–æ•°æ®æµï¼Œå¯ä»¥è°ƒç”¨ loads() å‡½æ•°ã€‚ä½†æ˜¯ï¼Œå¦‚æžœè¦å¯¹åºåˆ—åŒ–å’Œååºåˆ—åŒ–åŠ ä»¥æ›´å¤šçš„æŽ§åˆ¶ï¼Œå¯ä»¥åˆ†åˆ«åˆ›å»º Pickler æˆ– Unpickler å¯¹è±¡ã€‚ pickle æ¨¡å—åŒ…å«äº†ä»¥ä¸‹å¸¸é‡ï¼š pickle.HIGHEST_PROTOCOL æ•´æ•°ï¼Œå¯ç”¨çš„æœ€é«˜ åè®®ç‰ˆæœ¬ã€‚æ­¤å€¼å¯ä»¥ä½œä¸º åè®® å€¼ä¼ é€’ç»™ dump() å’Œ dumps() å‡½æ•°ï¼Œä»¥åŠ Pickler çš„æž„é€ å‡½æ•°ã€‚ pickle.DEFAULT_PROTOCOL æ•´æ•°ï¼Œç”¨äºŽ pickle æ•°æ®çš„é»˜è®¤ åè®®ç‰ˆæœ¬ã€‚å®ƒå¯èƒ½å°äºŽ HIGHEST_PROTOCOLã€‚å½“å‰é»˜è®¤åè®®æ˜¯ v4ï¼Œå®ƒåœ¨ Python 3.4 ä¸­é¦–æ¬¡å¼•å…¥ï¼Œä¸Žä¹‹å‰çš„ç‰ˆæœ¬ä¸å…¼å®¹ã€‚åœ¨ 3.8 ç‰ˆæ›´æ”¹: é»˜è®¤åè®®ç‰ˆæœ¬è¿˜æ˜¯ 4ã€‚ æ¨¡å—æ–¹æ³• pickle.dump(obj, file, protocol=None, **, fix_imports=True, buffer_callback=None*) å°†å¯¹è±¡ obj å°å­˜ä»¥åŽçš„å¯¹è±¡å†™å…¥å·²æ‰“å¼€çš„ file object fileã€‚å®ƒç­‰åŒäºŽ Pickler(file, protocol).dump(obj)ã€‚å‚æ•° fileã€protocolã€fix_imports å’Œ buffer_callback çš„å«ä¹‰ä¸Žå®ƒä»¬åœ¨ Pickler çš„æž„é€ å‡½æ•°ä¸­çš„å«ä¹‰ç›¸åŒã€‚åœ¨ 3.8 ç‰ˆæ›´æ”¹: åŠ å…¥äº† buffer_callback å‚æ•°ã€‚ pickle.dumps(obj, protocol=None, **, fix_imports=True, buffer_callback=None*) å°† obj å°å­˜ä»¥åŽçš„å¯¹è±¡ä½œä¸º bytes ç±»åž‹ç›´æŽ¥è¿”å›žï¼Œè€Œä¸æ˜¯å°†å…¶å†™å…¥åˆ°æ–‡ä»¶ã€‚å‚æ•° protocolã€fix_imports å’Œ buffer_callback çš„å«ä¹‰ä¸Žå®ƒä»¬åœ¨ Pickler çš„æž„é€ å‡½æ•°ä¸­çš„å«ä¹‰ç›¸åŒã€‚åœ¨ 3.8 ç‰ˆæ›´æ”¹: åŠ å…¥äº† buffer_callback å‚æ•°ã€‚ pickle.load(file, **, fix_imports=True, encoding=â€ASCIIâ€, errors=â€strictâ€, buffers=None*) ä»Žå·²æ‰“å¼€çš„ file object æ–‡ä»¶ ä¸­è¯»å–å°å­˜åŽçš„å¯¹è±¡ï¼Œé‡å»ºå…¶ä¸­ç‰¹å®šå¯¹è±¡çš„å±‚æ¬¡ç»“æž„å¹¶è¿”å›žã€‚å®ƒç›¸å½“äºŽ Unpickler(file).load()ã€‚Pickle åè®®ç‰ˆæœ¬æ˜¯è‡ªåŠ¨æ£€æµ‹å‡ºæ¥çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å‚æ•°æ¥æŒ‡å®šåè®®ã€‚å°å­˜å¯¹è±¡ä»¥å¤–çš„å…¶ä»–å­—èŠ‚å°†è¢«å¿½ç•¥ã€‚å‚æ•° fileã€fix_importsã€encodingã€errorsã€strict å’Œ buffers çš„å«ä¹‰ä¸Žå®ƒä»¬åœ¨ Unpickler çš„æž„é€ å‡½æ•°ä¸­çš„å«ä¹‰ç›¸åŒã€‚åœ¨ 3.8 ç‰ˆæ›´æ”¹: åŠ å…¥äº† buffers å‚æ•°ã€‚ pickle.loads(bytes_object, **, fix_imports=True, encoding=â€ASCIIâ€, errors=â€strictâ€, buffers=None*) å¯¹äºŽå°å­˜ç”Ÿæˆçš„å¯¹è±¡ bytes_objectï¼Œè¿˜åŽŸå‡ºåŽŸå¯¹è±¡çš„ç»“æž„å¹¶è¿”å›žã€‚Pickle åè®®ç‰ˆæœ¬æ˜¯è‡ªåŠ¨æ£€æµ‹å‡ºæ¥çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å‚æ•°æ¥æŒ‡å®šåè®®ã€‚å°å­˜å¯¹è±¡ä»¥å¤–çš„å…¶ä»–å­—èŠ‚å°†è¢«å¿½ç•¥ã€‚å‚æ•° fileã€fix_importsã€encodingã€errorsã€strict å’Œ buffers çš„å«ä¹‰ä¸Žå®ƒä»¬åœ¨ Unpickler çš„æž„é€ å‡½æ•°ä¸­çš„å«ä¹‰ç›¸åŒã€‚ å¼‚å¸¸å¤„ç†pickle æ¨¡å—å®šä¹‰äº†ä»¥ä¸‹ 3 ä¸ªå¼‚å¸¸ï¼š exception pickle.PickleError å…¶ä»– pickle å¼‚å¸¸çš„åŸºç±»ã€‚å®ƒæ˜¯ Exception çš„ä¸€ä¸ªå­ç±»ã€‚ exception pickle.PicklingError å½“ Pickler é‡åˆ°æ— æ³•è§£å°çš„å¯¹è±¡æ—¶æŠ›å‡ºæ­¤é”™è¯¯ã€‚å®ƒæ˜¯ PickleError çš„å­ç±»ã€‚å‚è€ƒ å¯ä»¥è¢«å°å­˜/è§£å°çš„å¯¹è±¡ æ¥äº†è§£å“ªäº›å¯¹è±¡å¯ä»¥è¢«å°å­˜ã€‚ exception pickle.UnpicklingError å½“è§£å°å‡ºé”™æ—¶æŠ›å‡ºæ­¤å¼‚å¸¸ï¼Œä¾‹å¦‚æ•°æ®æŸåæˆ–å¯¹è±¡ä¸å®‰å…¨ã€‚å®ƒæ˜¯ PickleError çš„å­ç±»ã€‚æ³¨æ„ï¼Œè§£å°æ—¶å¯èƒ½è¿˜ä¼šæŠ›å‡ºå…¶ä»–å¼‚å¸¸ï¼ŒåŒ…æ‹¬ï¼ˆä½†ä¸é™äºŽï¼‰ AttributeErrorã€EOFErrorã€ImportError å’Œ IndexErrorã€‚ æ¨¡å—ä¸­çš„ç±»pickle æ¨¡å—åŒ…å«äº† 3 ä¸ªç±»ï¼ŒPicklerã€Unpickler å’Œ PickleBufferï¼š Picklerclass pickle.Pickler(file, protocol=None, **, fix_imports=True, buffer_callback=None*) å®ƒæŽ¥å—ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ç”¨äºŽå†™å…¥ pickle æ•°æ®æµã€‚ å¯é€‰å‚æ•° protocol æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå‘ŠçŸ¥ pickler ä½¿ç”¨æŒ‡å®šçš„åè®®ï¼Œå¯é€‰æ‹©çš„åè®®èŒƒå›´ä»Ž 0 åˆ° HIGHEST_PROTOCOLã€‚å¦‚æžœæ²¡æœ‰æŒ‡å®šï¼Œè¿™ä¸€å‚æ•°é»˜è®¤å€¼ä¸º DEFAULT_PROTOCOLã€‚æŒ‡å®šä¸€ä¸ªè´Ÿæ•°å°±ç›¸å½“äºŽæŒ‡å®š HIGHEST_PROTOCOLã€‚ å‚æ•° file å¿…é¡»æœ‰ä¸€ä¸ª write() æ–¹æ³•ï¼Œè¯¥ write() æ–¹æ³•è¦èƒ½æŽ¥æ”¶å­—èŠ‚ä½œä¸ºå…¶å”¯ä¸€å‚æ•°ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ‰“å¼€çš„ç£ç›˜æ–‡ä»¶ï¼ˆç”¨äºŽå†™å…¥äºŒè¿›åˆ¶å†…å®¹ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª io.BytesIO å®žä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ»¡è¶³è¿™ä¸€æŽ¥å£çš„å…¶ä»–ä»»ä½•è‡ªå®šä¹‰å¯¹è±¡ã€‚ å¦‚æžœ fix_imports ä¸º True ä¸” protocol å°äºŽ 3ï¼Œpickle å°†å°è¯•å°† Python 3 ä¸­çš„æ–°åç§°æ˜ å°„åˆ° Python 2 ä¸­çš„æ—§æ¨¡å—åç§°ï¼Œå› æ­¤ Python 2 ä¹Ÿå¯ä»¥è¯»å–å°å­˜çš„æ•°æ®æµã€‚ å¦‚æžœ buffer_callback ä¸º Noneï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œç¼“å†²åŒºè§†å›¾ï¼ˆbuffer viewï¼‰å°†ä¼šä½œä¸º pickle æµçš„ä¸€éƒ¨åˆ†è¢«åºåˆ—åŒ–åˆ° file ä¸­ã€‚ å¦‚æžœ buffer_callback ä¸ä¸º Noneï¼Œé‚£å®ƒå¯ä»¥ç”¨ç¼“å†²åŒºè§†å›¾è°ƒç”¨ä»»æ„æ¬¡ã€‚å¦‚æžœæŸæ¬¡è°ƒç”¨è¿”å›žäº† False å€¼ï¼ˆä¾‹å¦‚ Noneï¼‰ï¼Œåˆ™ç»™å®šçš„ç¼“å†²åŒºæ˜¯ å¸¦å¤–çš„ï¼Œå¦åˆ™ç¼“å†²åŒºæ˜¯å¸¦å†…çš„ï¼ˆä¾‹å¦‚ä¿å­˜åœ¨äº† pickle æµé‡Œé¢ï¼‰ã€‚ å¦‚æžœ buffer_callback ä¸æ˜¯ None ä¸” protocol æ˜¯ None æˆ–å°äºŽ 5ï¼Œå°±ä¼šå‡ºé”™ã€‚ åœ¨ 3.8 ç‰ˆæ›´æ”¹: åŠ å…¥äº† buffer_callback å‚æ•°ã€‚ dump(obj) å°† obj å°å­˜åŽçš„å†…å®¹å†™å…¥å·²æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡ï¼Œè¯¥æ–‡ä»¶å¯¹è±¡å·²ç»åœ¨æž„é€ å‡½æ•°ä¸­æŒ‡å®šã€‚ persistent_id(obj) é»˜è®¤æ— åŠ¨ä½œï¼Œå­ç±»ç»§æ‰¿é‡è½½æ—¶ä½¿ç”¨ã€‚å¦‚æžœ persistent_id() è¿”å›ž Noneï¼Œobj ä¼šè¢«ç…§å¸¸ pickleã€‚å¦‚æžœè¿”å›žå…¶ä»–å€¼ï¼ŒPickler ä¼šå°†è¿™ä¸ªå‡½æ•°çš„è¿”å›žå€¼ä½œä¸º obj çš„æŒä¹…åŒ– IDï¼ˆPickler æœ¬åº”å¾—åˆ°åºåˆ—åŒ–æ•°æ®æµå¹¶å°†å…¶å†™å…¥æ–‡ä»¶ï¼Œè‹¥æ­¤å‡½æ•°æœ‰è¿”å›žå€¼ï¼Œåˆ™å¾—åˆ°æ­¤å‡½æ•°çš„è¿”å›žå€¼å¹¶å†™å…¥æ–‡ä»¶ï¼‰ã€‚è¿™ä¸ªæŒä¹…åŒ– ID çš„è§£é‡Šåº”å½“å®šä¹‰åœ¨ Unpickler.persistent_load() ä¸­ï¼ˆè¯¥æ–¹æ³•å®šä¹‰è¿˜åŽŸå¯¹è±¡çš„è¿‡ç¨‹ï¼Œå¹¶è¿”å›žå¾—åˆ°çš„å¯¹è±¡ï¼‰ã€‚æ³¨æ„ï¼Œpersistent_id() çš„è¿”å›žå€¼æœ¬èº«ä¸èƒ½æ‹¥æœ‰æŒä¹…åŒ– IDã€‚å‚é˜… æŒä¹…åŒ–å¤–éƒ¨å¯¹è±¡ èŽ·å–è¯¦æƒ…å’Œä½¿ç”¨ç¤ºä¾‹ã€‚ dispatch_table Pickler å¯¹è±¡çš„ dispatch è¡¨æ˜¯ copyreg.pickle() ä¸­ç”¨åˆ°çš„ reduction å‡½æ•° çš„æ³¨å†Œã€‚dispatch è¡¨æœ¬èº«æ˜¯ä¸€ä¸ª class åˆ°å…¶ reduction å‡½æ•°çš„æ˜ å°„é”®å€¼å¯¹ã€‚ä¸€ä¸ª reduction å‡½æ•°åªæŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯å…¶å…³è”çš„ classï¼Œå‡½æ•°è¡Œä¸ºåº”å½“éµå®ˆ __reduce__() æŽ¥å£è§„èŒƒã€‚Pickler å¯¹è±¡é»˜è®¤å¹¶æ²¡æœ‰ dispatch_table å±žæ€§ï¼Œè¯¥å¯¹è±¡é»˜è®¤ä½¿ç”¨ copyreg æ¨¡å—ä¸­å®šä¹‰çš„å…¨å±€ dispatch è¡¨ã€‚å¦‚æžœè¦ä¸ºç‰¹å®š Pickler å¯¹è±¡è‡ªå®šä¹‰åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå¯ä»¥å°† dispatch_table å±žæ€§è®¾ç½®ä¸ºç±»å­—å…¸å¯¹è±¡ï¼ˆdict-like objectï¼‰ã€‚å¦å¤–ï¼Œå¦‚æžœ Pickler çš„å­ç±»è®¾ç½®äº† dispatch_table å±žæ€§ï¼Œåˆ™è¯¥å­ç±»çš„å®žä¾‹ä¼šä½¿ç”¨è¿™ä¸ªè¡¨ä½œä¸ºé»˜è®¤çš„ dispatch è¡¨ã€‚å‚é˜… Dispatch è¡¨ èŽ·å–ä½¿ç”¨ç¤ºä¾‹ã€‚3.3 æ–°ç‰ˆåŠŸèƒ½. reducer_override(self, obj) å¯ä»¥åœ¨ Pickler çš„å­ç±»ä¸­å®šä¹‰çš„ç‰¹æ®Š reducerã€‚æ­¤æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºŽ dispatch_table ä¸­çš„ä»»ä½• reducerã€‚å®ƒåº”è¯¥ä¸Ž __reduce__() æ–¹æ³•éµå¾ªç›¸åŒçš„æŽ¥å£ï¼Œå®ƒä¹Ÿå¯ä»¥è¿”å›ž NotImplementedï¼Œè¿™å°†ä½¿ç”¨ dispatch_table é‡Œæ³¨å†Œçš„ reducer æ¥å°å­˜ objã€‚ Unpicklerclass pickle.Unpickler(file, **, fix_imports=True, encoding=â€ASCIIâ€, errors=â€strictâ€, buffers=None*) å®ƒæŽ¥å—ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ç”¨äºŽè¯»å– pickle æ•°æ®æµã€‚ Pickle åè®®ç‰ˆæœ¬æ˜¯è‡ªåŠ¨æ£€æµ‹å‡ºæ¥çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å‚æ•°æ¥æŒ‡å®šåè®®ã€‚ å‚æ•° file å¿…é¡»æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œread() æ–¹æ³•æŽ¥å—ä¸€ä¸ªæ•´æ•°å‚æ•°ï¼Œreadinto() æ–¹æ³•æŽ¥å—ä¸€ä¸ªç¼“å†²åŒºä½œä¸ºå‚æ•°ï¼Œreadline() æ–¹æ³•ä¸éœ€è¦å‚æ•°ï¼Œè¿™ä¸Ž io.BufferedIOBase é‡Œå®šä¹‰çš„æŽ¥å£æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ file å¯ä»¥æ˜¯ä¸€ä¸ªç£ç›˜ä¸Šç”¨äºŽäºŒè¿›åˆ¶è¯»å–çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ª io.BytesIO å®žä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯æ»¡è¶³è¿™ä¸€æŽ¥å£çš„å…¶ä»–ä»»ä½•è‡ªå®šä¹‰å¯¹è±¡ã€‚ å¯é€‰çš„å‚æ•°æ˜¯ fix_imports, encoding å’Œ errorsï¼Œç”¨äºŽæŽ§åˆ¶ç”±Python 2 ç”Ÿæˆçš„ pickle æµçš„å…¼å®¹æ€§ã€‚å¦‚æžœ fix_imports ä¸º Trueï¼Œåˆ™ pickle å°†å°è¯•å°†æ—§çš„ Python 2 åç§°æ˜ å°„åˆ° Python 3 ä¸­å¯¹åº”çš„æ–°åç§°ã€‚encoding å’Œ errors å‚æ•°å‘Šè¯‰ pickle å¦‚ä½•è§£ç  Python 2 å­˜å‚¨çš„ 8 ä½å­—ç¬¦ä¸²å®žä¾‹ï¼›è¿™ä¸¤ä¸ªå‚æ•°é»˜è®¤åˆ†åˆ«ä¸º â€˜ASCIIâ€™ å’Œ â€˜strictâ€™ã€‚encoding å‚æ•°å¯ç½®ä¸º â€˜bytesâ€™ æ¥å°†è¿™äº› 8 ä½å­—ç¬¦ä¸²å®žä¾‹è¯»å–ä¸ºå­—èŠ‚å¯¹è±¡ã€‚è¯»å– NumPy array å’Œ Python 2 å­˜å‚¨çš„ datetimeã€date å’Œ time å®žä¾‹æ—¶ï¼Œè¯·ä½¿ç”¨ encoding=&#39;latin1&#39;ã€‚ å¦‚æžœ buffers ä¸º Noneï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œåˆ™ååºåˆ—åŒ–æ‰€éœ€çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»åŒ…å«åœ¨ pickle æµä¸­ã€‚è¿™æ„å‘³ç€åœ¨å®žä¾‹åŒ– Pickler æ—¶ï¼ˆæˆ–è°ƒç”¨ dump() æˆ– dumps() æ—¶ï¼‰ï¼Œå‚æ•° buffer_callback ä¸º Noneã€‚ å¦‚æžœ buffers ä¸ä¸º Noneï¼Œåˆ™æ¯æ¬¡ pickle æµå¼•ç”¨ å¸¦å¤– ç¼“å†²åŒºè§†å›¾æ—¶ï¼Œæ¶ˆè€—çš„å¯¹è±¡éƒ½åº”è¯¥æ˜¯å¯è¿­ä»£çš„å¯ç”¨ç¼“å†²åŒºçš„å¯¹è±¡ã€‚è¿™æ ·çš„ç¼“å†²åŒºåº”è¯¥æŒ‰é¡ºåºåœ°æä¾›ç»™ Pickler å¯¹è±¡çš„ buffer_callback æ–¹æ³•ã€‚ åœ¨ 3.8 ç‰ˆæ›´æ”¹: åŠ å…¥äº† buffers å‚æ•°ã€‚ load() ä»Žæž„é€ å‡½æ•°ä¸­æŒ‡å®šçš„æ–‡ä»¶å¯¹è±¡é‡Œè¯»å–å°å­˜å¥½çš„å¯¹è±¡ï¼Œé‡å»ºå…¶ä¸­ç‰¹å®šå¯¹è±¡çš„å±‚æ¬¡ç»“æž„å¹¶è¿”å›žã€‚å°å­˜å¯¹è±¡ä»¥å¤–çš„å…¶ä»–å­—èŠ‚å°†è¢«å¿½ç•¥ã€‚ persistent_load(pid) é»˜è®¤æŠ›å‡º UnpicklingError å¼‚å¸¸ã€‚å¦‚æžœå®šä¹‰äº†æ­¤æ–¹æ³•ï¼Œpersistent_load() åº”å½“è¿”å›žæŒä¹…åŒ– ID pid æ‰€æŒ‡å®šçš„å¯¹è±¡ã€‚ å¦‚æžœé‡åˆ°æ— æ•ˆçš„æŒä¹…åŒ– IDï¼Œåˆ™åº”å½“å¼•å‘ UnpicklingErrorã€‚å‚é˜… æŒä¹…åŒ–å¤–éƒ¨å¯¹è±¡ èŽ·å–è¯¦æƒ…å’Œä½¿ç”¨ç¤ºä¾‹ã€‚ find_class(module, name) å¦‚æœ‰å¿…è¦ï¼Œå¯¼å…¥ module æ¨¡å—å¹¶è¿”å›žå…¶ä¸­åå« name çš„å¯¹è±¡ï¼Œå…¶ä¸­ module å’Œ name å‚æ•°éƒ½æ˜¯ str å¯¹è±¡ã€‚æ³¨æ„ï¼Œä¸è¦è¢«è¿™ä¸ªå‡½æ•°çš„åå­—è¿·æƒ‘ï¼Œ find_class() åŒæ ·å¯ä»¥ç”¨æ¥å¯¼å…¥å‡½æ•°ã€‚å­ç±»å¯ä»¥é‡è½½æ­¤æ–¹æ³•ï¼Œæ¥æŽ§åˆ¶åŠ è½½å¯¹è±¡çš„ç±»åž‹å’ŒåŠ è½½å¯¹è±¡çš„æ–¹å¼ï¼Œä»Žè€Œå°½å¯èƒ½é™ä½Žå®‰å…¨é£Žé™©ã€‚å‚é˜… é™åˆ¶å…¨å±€å˜é‡ èŽ·å–æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚å¼•å‘ä¸€ä¸ª å®¡æ ¸äº‹ä»¶ pickle.find_class é™„å¸¦å‚æ•° moduleã€nameã€‚ PickleBufferclass pickle.PickleBuffer(buffer) ç¼“å†²åŒºçš„åŒ…è£…å™¨ (wrapper)ï¼Œç¼“å†²åŒºä¸­åŒ…å«ç€å¯å°å­˜çš„æ•°æ®ã€‚buffer å¿…é¡»æ˜¯ä¸€ä¸ª buffer-providing å¯¹è±¡ï¼Œæ¯”å¦‚ bytes-like object æˆ–å¤šç»´æ•°ç»„ã€‚ PickleBuffer æœ¬èº«å°±å¯ä»¥ç”Ÿæˆç¼“å†²åŒºå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å°†å…¶ä¼ é€’ç»™éœ€è¦ç¼“å†²åŒºç”Ÿæˆå™¨çš„å…¶ä»– APIï¼Œæ¯”å¦‚ memoryviewã€‚ PickleBuffer å¯¹è±¡åªèƒ½ç”¨ pickle ç‰ˆæœ¬ 5 åŠä»¥ä¸Šåè®®è¿›è¡Œåºåˆ—åŒ–ã€‚å®ƒä»¬ç¬¦åˆ å¸¦å¤–åºåˆ—åŒ– çš„æ¡ä»¶ã€‚ 3.8 æ–°ç‰ˆåŠŸèƒ½. raw() è¿”å›žè¯¥ç¼“å†²åŒºåº•å±‚å†…å­˜åŒºåŸŸçš„ memoryviewã€‚ è¿”å›žçš„å¯¹è±¡æ˜¯ä¸€ç»´çš„ã€C è¿žç»­å¸ƒå±€çš„ memoryviewï¼Œæ ¼å¼ä¸º B (æ— ç¬¦å·å­—èŠ‚)ã€‚ å¦‚æžœç¼“å†²åŒºæ—¢ä¸æ˜¯ C è¿žç»­å¸ƒå±€ä¹Ÿä¸æ˜¯ Fortran è¿žç»­å¸ƒå±€çš„ï¼Œåˆ™æŠ›å‡º BufferError å¼‚å¸¸ã€‚ release() é‡Šæ”¾ç”± PickleBuffer å ç”¨çš„åº•å±‚ç¼“å†²åŒºã€‚ å¯ä»¥è¢«å°å­˜/è§£å°çš„å¯¹è±¡ä¸‹åˆ—ç±»åž‹å¯ä»¥è¢«å°å­˜ï¼š Noneã€True å’Œ False æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•° strã€byteã€bytearray åªåŒ…å«å¯å°å­˜å¯¹è±¡çš„é›†åˆï¼ŒåŒ…æ‹¬ tupleã€listã€set å’Œ dict å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å‡½æ•°ï¼ˆä½¿ç”¨ def å®šä¹‰ï¼Œlambda å‡½æ•°åˆ™ä¸å¯ä»¥ï¼‰ å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å†…ç½®å‡½æ•° å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„ç±» æŸäº›ç±»å®žä¾‹ï¼Œè¿™äº›ç±»çš„ __dict__ å±žæ€§å€¼æˆ– __getstate__() å‡½æ•°çš„è¿”å›žå€¼å¯ä»¥è¢«å°å­˜ï¼ˆè¯¦æƒ…å‚é˜… å°å­˜ç±»å®žä¾‹ è¿™ä¸€æ®µï¼‰ã€‚ å°è¯•å°å­˜ä¸èƒ½è¢«å°å­˜çš„å¯¹è±¡ä¼šæŠ›å‡º PicklingError å¼‚å¸¸ï¼Œå¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå¯èƒ½æœ‰éƒ¨åˆ†å­—èŠ‚å·²ç»è¢«å†™å…¥æŒ‡å®šæ–‡ä»¶ä¸­ã€‚å°è¯•å°å­˜é€’å½’å±‚çº§å¾ˆæ·±çš„å¯¹è±¡æ—¶ï¼Œå¯èƒ½ä¼šè¶…å‡ºæœ€å¤§é€’å½’å±‚çº§é™åˆ¶ï¼Œæ­¤æ—¶ä¼šæŠ›å‡º RecursionError å¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ sys.setrecursionlimit() è°ƒæ•´é€’å½’å±‚çº§ï¼Œä¸è¿‡è¯·è°¨æ…Žä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºå¯èƒ½ä¼šå¯¼è‡´è§£é‡Šå™¨å´©æºƒã€‚ æ³¨æ„ å‡½æ•°å°å­˜ å‡½æ•°ï¼ˆå†…ç½®å‡½æ•°æˆ–ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼‰åœ¨è¢«å°å­˜æ—¶ï¼Œå¼•ç”¨çš„æ˜¯å‡½æ•°å…¨åã€‚2 è¿™æ„å‘³ç€åªæœ‰å‡½æ•°æ‰€åœ¨çš„æ¨¡å—åï¼Œä¸Žå‡½æ•°åä¼šè¢«å°å­˜ï¼Œå‡½æ•°ä½“åŠå…¶å±žæ€§ä¸ä¼šè¢«å°å­˜ã€‚å› æ­¤ï¼Œåœ¨è§£å°çš„çŽ¯å¢ƒä¸­ï¼Œå‡½æ•°æ‰€å±žçš„æ¨¡å—å¿…é¡»æ˜¯å¯ä»¥è¢«å¯¼å…¥çš„ï¼Œè€Œä¸”æ¨¡å—å¿…é¡»åŒ…å«è¿™ä¸ªå‡½æ•°è¢«å°å­˜æ—¶çš„åç§°ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ ç±»å°å­˜ ç±»ä¹Ÿåªå°å­˜åç§°ï¼Œæ‰€ä»¥åœ¨è§£å°çŽ¯å¢ƒä¸­ä¹Ÿæœ‰å’Œå‡½æ•°ç›¸åŒçš„é™åˆ¶ã€‚æ³¨æ„ï¼Œç±»ä½“åŠå…¶æ•°æ®ä¸ä¼šè¢«å°å­˜ï¼Œæ‰€ä»¥åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ç±»å±žæ€§ attr ä¸ä¼šå­˜åœ¨äºŽè§£å°åŽçš„çŽ¯å¢ƒä¸­ï¼š 1234class Foo: attr = 'A class attribute'picklestring = pickle.dumps(Foo) ç±»çš„å®žä¾‹å°å­˜ åœ¨å°å­˜ç±»çš„å®žä¾‹æ—¶ï¼Œå…¶ç±»ä½“å’Œç±»æ•°æ®ä¸ä¼šè·Ÿç€å®žä¾‹ä¸€èµ·è¢«å°å­˜ï¼Œåªæœ‰å®žä¾‹æ•°æ®ä¼šè¢«å°å­˜ã€‚è¿™æ ·è®¾è®¡æ˜¯æœ‰ç›®çš„çš„ï¼Œåœ¨å°†æ¥ä¿®å¤ç±»ä¸­çš„é”™è¯¯ã€ç»™ç±»å¢žåŠ æ–¹æ³•ä¹‹åŽï¼Œä»ç„¶å¯ä»¥è½½å…¥åŽŸæ¥ç‰ˆæœ¬ç±»å®žä¾‹çš„å°å­˜æ•°æ®æ¥è¿˜åŽŸè¯¥å®žä¾‹ã€‚å¦‚æžœä½ å‡†å¤‡é•¿æœŸä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œå¯èƒ½ä¼šåŒæ—¶å­˜åœ¨è¾ƒå¤šç‰ˆæœ¬çš„ç±»ä½“ï¼Œå¯ä»¥ä¸ºå¯¹è±¡æ·»åŠ ç‰ˆæœ¬å·ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ç±»çš„ __setstate__() æ–¹æ³•å°†è€ç‰ˆæœ¬è½¬æ¢æˆæ–°ç‰ˆæœ¬ å°å­˜ç±»å®žä¾‹ é€šå¸¸ï¼Œä½¿ä¸€ä¸ªå®žä¾‹å¯è¢«å°å­˜ä¸éœ€è¦é™„åŠ ä»»ä½•ä»£ç ã€‚Pickle é»˜è®¤ä¼šé€šè¿‡ Python çš„å†…çœæœºåˆ¶èŽ·å¾—å®žä¾‹çš„ç±»åŠå±žæ€§ã€‚è€Œå½“å®žä¾‹è§£å°æ—¶ï¼Œå®ƒçš„ __init__() æ–¹æ³•é€šå¸¸ ä¸ä¼š è¢«è°ƒç”¨ã€‚å…¶é»˜è®¤åŠ¨ä½œæ˜¯ï¼šå…ˆåˆ›å»ºä¸€ä¸ªæœªåˆå§‹åŒ–çš„å®žä¾‹ï¼Œç„¶åŽè¿˜åŽŸå…¶å±žæ€§ï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†è¿™ç§è¡Œä¸ºçš„å®žçŽ°æœºåˆ¶ï¼š 1234567def save(obj): return (obj.__class__, obj.__dict__)def load(cls, attributes): obj = cls.__new__(cls) obj.__dict__.update(attributes) return obj ç±»å¯ä»¥æ”¹å˜é»˜è®¤è¡Œä¸ºï¼Œåªéœ€å®šä¹‰ä»¥ä¸‹ä¸€ç§æˆ–å‡ ç§ç‰¹æ®Šæ–¹æ³•ï¼š object.__getnewargs_ex__() å¯¹äºŽä½¿ç”¨ç¬¬ 2 ç‰ˆæˆ–æ›´é«˜ç‰ˆåè®®çš„ pickleï¼Œå®žçŽ°äº† __getnewargs_ex__() æ–¹æ³•çš„ç±»å¯ä»¥æŽ§åˆ¶åœ¨è§£å°æ—¶ä¼ ç»™ __new__() æ–¹æ³•çš„å‚æ•°ã€‚æœ¬æ–¹æ³•å¿…é¡»è¿”å›žä¸€å¯¹ (args, kwargs) ç”¨äºŽæž„å»ºå¯¹è±¡ï¼Œå…¶ä¸­ args æ˜¯è¡¨ç¤ºä½ç½®å‚æ•°çš„ tupleï¼Œè€Œ kwargs æ˜¯è¡¨ç¤ºå‘½åå‚æ•°çš„ dictã€‚å®ƒä»¬ä¼šåœ¨è§£å°æ—¶ä¼ é€’ç»™ __new__() æ–¹æ³•ã€‚å¦‚æžœç±»çš„ __new__() æ–¹æ³•åªæŽ¥å—å…³é”®å­—å‚æ•°ï¼Œåˆ™åº”å½“å®žçŽ°è¿™ä¸ªæ–¹æ³•ã€‚å¦åˆ™ï¼Œä¸ºäº†å…¼å®¹æ€§ï¼Œæ›´æŽ¨èå®žçŽ° __getnewargs__() æ–¹æ³•ã€‚åœ¨ 3.6 ç‰ˆæ›´æ”¹: __getnewargs_ex__() çŽ°åœ¨å¯ç”¨äºŽç¬¬ 2 å’Œç¬¬ 3 ç‰ˆåè®®ã€‚ object.__getnewargs__() è¿™ä¸ªæ–¹æ³•ä¸Žä¸Šä¸€ä¸ª __getnewargs_ex__() æ–¹æ³•ç±»ä¼¼ï¼Œä½†ä»…æ”¯æŒä½ç½®å‚æ•°ã€‚å®ƒè¦æ±‚è¿”å›žä¸€ä¸ª tuple ç±»åž‹çš„ argsï¼Œç”¨äºŽè§£å°æ—¶ä¼ é€’ç»™ __new__() æ–¹æ³•ã€‚å¦‚æžœå®šä¹‰äº† __getnewargs_ex__()ï¼Œé‚£ä¹ˆ __getnewargs__() å°±ä¸ä¼šè¢«è°ƒç”¨ã€‚åœ¨ 3.6 ç‰ˆæ›´æ”¹: åœ¨ Python 3.6 å‰ï¼Œç¬¬ 2ã€3 ç‰ˆåè®®ä¼šè°ƒç”¨ __getnewargs__()ï¼Œæ›´é«˜ç‰ˆæœ¬åè®®ä¼šè°ƒç”¨ __getnewargs_ex__()ã€‚ object.__getstate__() ç±»è¿˜å¯ä»¥è¿›ä¸€æ­¥æŽ§åˆ¶å…¶å®žä¾‹çš„å°å­˜è¿‡ç¨‹ã€‚å¦‚æžœç±»å®šä¹‰äº† __getstate__()ï¼Œå®ƒå°±ä¼šè¢«è°ƒç”¨ï¼Œå…¶è¿”å›žçš„å¯¹è±¡æ˜¯è¢«å½“åšå®žä¾‹å†…å®¹æ¥å°å­˜çš„ï¼Œå¦åˆ™å°å­˜çš„æ˜¯å®žä¾‹çš„ dictã€‚å¦‚æžœ __getstate__() æœªå®šä¹‰ï¼Œå®žä¾‹çš„ __dict__ ä¼šè¢«ç…§å¸¸å°å­˜ã€‚ object.__setstate__(state) å½“è§£å°æ—¶ï¼Œå¦‚æžœç±»å®šä¹‰äº† __setstate__()ï¼Œå°±ä¼šåœ¨å·²è§£å°çŠ¶æ€ä¸‹è°ƒç”¨å®ƒã€‚æ­¤æ—¶ä¸è¦æ±‚å®žä¾‹çš„ state å¯¹è±¡å¿…é¡»æ˜¯ dictã€‚æ²¡æœ‰å®šä¹‰æ­¤æ–¹æ³•çš„è¯ï¼Œå…ˆå‰å°å­˜çš„ state å¯¹è±¡å¿…é¡»æ˜¯ dictï¼Œä¸”è¯¥ dict å†…å®¹ä¼šåœ¨è§£å°æ—¶èµ‹ç»™æ–°å®žä¾‹çš„ dictã€‚ ==å¤‡æ³¨==ï¼š å¦‚æžœ __getstate__() è¿”å›ž Falseï¼Œé‚£ä¹ˆåœ¨è§£å°æ—¶å°±ä¸ä¼šè°ƒç”¨ __setstate__() æ–¹æ³•ã€‚ object.__reduce__() è¯¥æŽ¥å£å½“å‰å®šä¹‰å¦‚ä¸‹ã€‚__reduce__() æ–¹æ³•ä¸å¸¦ä»»ä½•å‚æ•°ï¼Œå¹¶ä¸”åº”è¿”å›žå­—ç¬¦ä¸²æˆ–æœ€å¥½è¿”å›žä¸€ä¸ªå…ƒç»„ï¼ˆè¿”å›žçš„å¯¹è±¡é€šå¸¸ç§°ä¸ºâ€œreduce å€¼â€ï¼‰ã€‚å¦‚æžœè¿”å›žå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²ä¼šè¢«å½“åšä¸€ä¸ªå…¨å±€å˜é‡çš„åç§°ã€‚å®ƒåº”è¯¥æ˜¯å¯¹è±¡ç›¸å¯¹äºŽå…¶æ¨¡å—çš„æœ¬åœ°åç§°ï¼Œpickle æ¨¡å—ä¼šæœç´¢æ¨¡å—å‘½åç©ºé—´æ¥ç¡®å®šå¯¹è±¡æ‰€å±žçš„æ¨¡å—ã€‚è¿™ç§è¡Œä¸ºå¸¸åœ¨å•ä¾‹æ¨¡å¼ä½¿ç”¨ã€‚å¦‚æžœè¿”å›žçš„æ˜¯å…ƒç»„ï¼Œåˆ™åº”å½“åŒ…å« 2 åˆ° 6 ä¸ªå…ƒç´ ï¼Œå¯é€‰å…ƒç´ å¯ä»¥çœç•¥æˆ–è®¾ç½®ä¸º Noneã€‚æ¯ä¸ªå…ƒç´ ä»£è¡¨çš„æ„ä¹‰å¦‚ä¸‹ï¼šä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨åˆ›å»ºå¯¹è±¡çš„æœ€åˆç‰ˆæœ¬æ—¶è°ƒç”¨ã€‚å¯è°ƒç”¨å¯¹è±¡çš„å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå…ƒç»„ã€‚å¦‚æžœå¯è°ƒç”¨å¯¹è±¡ä¸æŽ¥å—å‚æ•°ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªç©ºå…ƒç»„ã€‚å¯é€‰å…ƒç´ ï¼Œç”¨äºŽè¡¨ç¤ºå¯¹è±¡çš„çŠ¶æ€ï¼Œå°†è¢«ä¼ ç»™å‰è¿°çš„ __setstate__() æ–¹æ³•ã€‚ å¦‚æžœå¯¹è±¡æ²¡æœ‰æ­¤æ–¹æ³•ï¼Œåˆ™è¿™ä¸ªå…ƒç´ å¿…é¡»æ˜¯å­—å…¸ç±»åž‹ï¼Œå¹¶ä¼šè¢«æ·»åŠ è‡³ __dict__ å±žæ€§ä¸­ã€‚å¯é€‰å…ƒç´ ï¼Œä¸€ä¸ªè¿”å›žè¿žç»­é¡¹çš„è¿­ä»£å™¨ï¼ˆè€Œä¸æ˜¯åºåˆ—ï¼‰ã€‚è¿™äº›é¡¹ä¼šè¢« obj.append(item) é€ä¸ªåŠ å…¥å¯¹è±¡ï¼Œæˆ–è¢« obj.extend(list_of_items) æ‰¹é‡åŠ å…¥å¯¹è±¡ã€‚è¿™ä¸ªå…ƒç´ ä¸»è¦ç”¨äºŽ list çš„å­ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽé‚£äº›æ­£ç¡®å®žçŽ°äº† append() å’Œ extend() æ–¹æ³•çš„ç±»ã€‚ï¼ˆå…·ä½“æ˜¯ä½¿ç”¨ append() è¿˜æ˜¯ extend() å–å†³äºŽ pickle åè®®ç‰ˆæœ¬ä»¥åŠå¾…æ’å…¥å…ƒç´ çš„é¡¹æ•°ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæ–¹æ³•å¿…é¡»åŒæ—¶è¢«ç±»æ”¯æŒã€‚ï¼‰å¯é€‰å…ƒç´ ï¼Œä¸€ä¸ªè¿”å›žè¿žç»­é”®å€¼å¯¹çš„è¿­ä»£å™¨ï¼ˆè€Œä¸æ˜¯åºåˆ—ï¼‰ã€‚è¿™äº›é”®å€¼å¯¹å°†ä¼šä»¥ obj[key] = value çš„æ–¹å¼å­˜å‚¨äºŽå¯¹è±¡ä¸­ã€‚è¯¥å…ƒç´ ä¸»è¦ç”¨äºŽ dict å­ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽé‚£äº›å®žçŽ°äº† __setitem__() çš„ç±»ã€‚å¯é€‰å…ƒç´ ï¼Œä¸€ä¸ªå¸¦æœ‰ (obj, state) ç­¾åçš„å¯è°ƒç”¨å¯¹è±¡ã€‚è¯¥å¯è°ƒç”¨å¯¹è±¡å…è®¸ç”¨æˆ·ä»¥ç¼–ç¨‹æ–¹å¼æŽ§åˆ¶ç‰¹å®šå¯¹è±¡çš„çŠ¶æ€æ›´æ–°è¡Œä¸ºï¼Œè€Œä¸æ˜¯ä½¿ç”¨ obj çš„é™æ€ __setstate__() æ–¹æ³•ã€‚å¦‚æžœæ­¤å¤„ä¸æ˜¯ Noneï¼Œåˆ™æ­¤å¯è°ƒç”¨å¯¹è±¡çš„ä¼˜å…ˆçº§é«˜äºŽ obj çš„ __setstate__()ã€‚3.8 æ–°ç‰ˆåŠŸèƒ½: æ–°å¢žäº†å…ƒç»„çš„ç¬¬ 6 é¡¹ï¼Œå¯é€‰å…ƒç´  (obj, state)ã€‚ object.__reduce_ex__(protocol) ä½œä¸ºæ›¿ä»£é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥å®žçŽ° __reduce_ex__() æ–¹æ³•ã€‚ æ­¤æ–¹æ³•çš„å”¯ä¸€ä¸åŒä¹‹å¤„åœ¨äºŽå®ƒåº”æŽ¥å—ä¸€ä¸ªæ•´åž‹å‚æ•°ç”¨äºŽæŒ‡å®šåè®®ç‰ˆæœ¬ã€‚ å¦‚æžœå®šä¹‰äº†è¿™ä¸ªå‡½æ•°ï¼Œåˆ™ä¼šè¦†ç›– __reduce__() çš„è¡Œä¸ºã€‚ æ­¤å¤–ï¼Œ__reduce__() æ–¹æ³•ä¼šè‡ªåŠ¨æˆä¸ºæ‰©å±•ç‰ˆæ–¹æ³•çš„åŒä¹‰è¯ã€‚ è¿™ä¸ªå‡½æ•°ä¸»è¦ç”¨äºŽä¸ºä»¥å‰çš„ Python ç‰ˆæœ¬æä¾›å‘åŽå…¼å®¹çš„ reduce å€¼ã€‚ æŒä¹…åŒ–å¤–éƒ¨å¯¹è±¡ä¸ºäº†èŽ·å–å¯¹è±¡æŒä¹…åŒ–çš„åˆ©ç›Šï¼Œ pickle æ¨¡å—æ”¯æŒå¼•ç”¨å·²å°å­˜æ•°æ®æµä¹‹å¤–çš„å¯¹è±¡ã€‚ è¿™æ ·çš„å¯¹è±¡æ˜¯é€šè¿‡ä¸€ä¸ªæŒä¹…åŒ– ID æ¥å¼•ç”¨çš„ï¼Œå®ƒåº”å½“æ˜¯ä¸€ä¸ªç”±å­—æ¯æ•°å­—ç±»å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸² (å¯¹äºŽç¬¬ 0 ç‰ˆåè®®) 5 æˆ–æ˜¯ä¸€ä¸ªä»»æ„å¯¹è±¡ (ç”¨äºŽä»»æ„æ–°ç‰ˆåè®®)ã€‚ pickle æ¨¡å—ä¸æä¾›å¯¹æŒä¹…åŒ– ID çš„è§£æžå·¥ä½œï¼Œå®ƒå°†è§£æžå·¥ä½œåˆ†é…ç»™ç”¨æˆ·å®šä¹‰çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ pickler ä¸­çš„ persistent_id() æ–¹æ³•å’Œ unpickler ä¸­çš„ persistent_load() æ–¹æ³•ã€‚ è¦é€šè¿‡æŒä¹…åŒ– ID å°†å¤–éƒ¨å¯¹è±¡å°å­˜ï¼Œå¿…é¡»åœ¨ pickler ä¸­å®žçŽ° persistent_id() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æŽ¥å—éœ€è¦è¢«å°å­˜çš„å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›žä¸€ä¸ª None æˆ–è¿”å›žè¯¥å¯¹è±¡çš„æŒä¹…åŒ– IDã€‚å¦‚æžœè¿”å›ž Noneï¼Œè¯¥å¯¹è±¡ä¼šè¢«æŒ‰ç…§é»˜è®¤æ–¹å¼å°å­˜ä¸ºæ•°æ®æµã€‚å¦‚æžœè¿”å›žå­—ç¬¦ä¸²å½¢å¼çš„æŒä¹…åŒ– IDï¼Œåˆ™ä¼šå°å­˜è¿™ä¸ªå­—ç¬¦ä¸²å¹¶åŠ ä¸Šä¸€ä¸ªæ ‡è®°ï¼Œè¿™æ · unpickler æ‰èƒ½å°†å…¶è¯†åˆ«ä¸ºæŒä¹…åŒ– IDã€‚ è¦è§£å°å¤–éƒ¨å¯¹è±¡ï¼ŒUnpickler å¿…é¡»å®žçŽ° persistent_load() æ–¹æ³•ï¼ŒæŽ¥å—ä¸€ä¸ªæŒä¹…åŒ– ID å¯¹è±¡ä½œä¸ºå‚æ•°å¹¶è¿”å›žä¸€ä¸ªå¼•ç”¨çš„å¯¹è±¡ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªå…¨é¢çš„ä¾‹å­ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨æŒä¹…åŒ– ID æ¥å°å­˜å¤–éƒ¨å¯¹è±¡ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687# Simple example presenting how persistent ID can be used to pickle# external objects by reference.import pickleimport sqlite3from collections import namedtuple# Simple class representing a record in our database.MemoRecord = namedtuple("MemoRecord", "key, task")class DBPickler(pickle.Pickler): def persistent_id(self, obj): # Instead of pickling MemoRecord as a regular class instance, we emit a # persistent ID. if isinstance(obj, MemoRecord): # Here, our persistent ID is simply a tuple, containing a tag and a # key, which refers to a specific record in the database. return ("MemoRecord", obj.key) else: # If obj does not have a persistent ID, return None. This means obj # needs to be pickled as usual. return Noneclass DBUnpickler(pickle.Unpickler): def __init__(self, file, connection): super().__init__(file) self.connection = connection def persistent_load(self, pid): # This method is invoked whenever a persistent ID is encountered. # Here, pid is the tuple returned by DBPickler. cursor = self.connection.cursor() type_tag, key_id = pid if type_tag == "MemoRecord": # Fetch the referenced record from the database and return it. cursor.execute("SELECT * FROM memos WHERE key=?", (str(key_id),)) key, task = cursor.fetchone() return MemoRecord(key, task) else: # Always raises an error if you cannot return the correct object. # Otherwise, the unpickler will think None is the object referenced # by the persistent ID. raise pickle.UnpicklingError("unsupported persistent object")def main(): import io import pprint # Initialize and populate our database. conn = sqlite3.connect(":memory:") cursor = conn.cursor() cursor.execute("CREATE TABLE memos(key INTEGER PRIMARY KEY, task TEXT)") tasks = ( 'give food to fish', 'prepare group meeting', 'fight with a zebra', ) for task in tasks: cursor.execute("INSERT INTO memos VALUES(NULL, ?)", (task,)) # Fetch the records to be pickled. cursor.execute("SELECT * FROM memos") memos = [MemoRecord(key, task) for key, task in cursor] # Save the records using our custom DBPickler. file = io.BytesIO() DBPickler(file).dump(memos) print("Pickled records:") pprint.pprint(memos) # Update a record, just for good measure. cursor.execute("UPDATE memos SET task='learn italian' WHERE key=1") # Load the records from the pickle data stream. file.seek(0) memos = DBUnpickler(file, conn).load() print("Unpickled records:") pprint.pprint(memos)if __name__ == '__main__': main() è‡ªå®šä¹‰å°å­˜ Dispatch è¡¨å¦‚æžœæƒ³å¯¹æŸäº›ç±»è¿›è¡Œè‡ªå®šä¹‰å°å­˜ï¼Œè€Œåˆä¸æƒ³åœ¨ç±»ä¸­å¢žåŠ ç”¨äºŽå°å­˜çš„ä»£ç ï¼Œå°±å¯ä»¥åˆ›å»ºå¸¦æœ‰ç‰¹æ®Š dispatch è¡¨çš„ picklerã€‚ åœ¨ copyreg æ¨¡å—çš„ copyreg.dispatch_table ä¸­å®šä¹‰äº†å…¨å±€ dispatch è¡¨ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨ copyreg.dispatch_table ä¿®æ”¹åŽçš„å‰¯æœ¬ä½œä¸ºè‡ªæœ‰ dispatch è¡¨ã€‚ ä¾‹å¦‚ 1234f = io.BytesIO()p = pickle.Pickler(f)p.dispatch_table = copyreg.dispatch_table.copy()p.dispatch_table[SomeClass] = reduce_SomeClass åˆ›å»ºäº†ä¸€ä¸ªå¸¦æœ‰è‡ªæœ‰ dispatch è¡¨çš„ pickle.Pickler å®žä¾‹ï¼Œå®ƒå¯ä»¥å¯¹ SomeClass ç±»è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚å¦å¤–ï¼Œä¸‹åˆ—ä»£ç  12345class MyPickler(pickle.Pickler): dispatch_table = copyreg.dispatch_table.copy() dispatch_table[SomeClass] = reduce_SomeClassf = io.BytesIO()p = MyPickler(f) å®Œæˆäº†ç›¸åŒçš„æ“ä½œï¼Œä½†æ‰€æœ‰ MyPickler çš„å®žä¾‹éƒ½ä¼šå…±ç”¨åŒä¸€ä»½ dispatch è¡¨ã€‚ä½¿ç”¨ copyreg æ¨¡å—å®žçŽ°çš„ç­‰æ•ˆä»£ç æ˜¯ 123copyreg.pickle(SomeClass, reduce_SomeClass)f = io.BytesIO()p = pickle.Pickler(f) å¤„ç†æœ‰çŠ¶æ€çš„å¯¹è±¡ ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä¿®æ”¹ç±»åœ¨å°å­˜æ—¶çš„è¡Œä¸ºã€‚å…¶ä¸­ TextReader ç±»æ‰“å¼€äº†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ¯æ¬¡è°ƒç”¨å…¶ readline() æ–¹æ³•åˆ™è¿”å›žè¡Œå·å’Œè¯¥è¡Œçš„å­—ç¬¦ã€‚ åœ¨å°å­˜è¿™ä¸ª TextReader çš„å®žä¾‹æ—¶ï¼Œé™¤äº† æ–‡ä»¶å¯¹è±¡ï¼Œå…¶ä»–å±žæ€§éƒ½ä¼šè¢«ä¿å­˜ã€‚ å½“è§£å°å®žä¾‹æ—¶ï¼Œéœ€è¦é‡æ–°æ‰“å¼€æ–‡ä»¶ï¼Œç„¶åŽä»Žä¸Šæ¬¡çš„ä½ç½®å¼€å§‹ç»§ç»­è¯»å–ã€‚å®žçŽ°è¿™äº›åŠŸèƒ½éœ€è¦å®žçŽ° __setstate__() å’Œ __getstate__() æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536class TextReader: """Print and number lines in a text file.""" def __init__(self, filename): self.filename = filename self.file = open(filename) self.lineno = 0 def readline(self): self.lineno += 1 line = self.file.readline() if not line: return None if line.endswith('\n'): line = line[:-1] return "%i: %s" % (self.lineno, line) def __getstate__(self): # Copy the object's state from self.__dict__ which contains # all our instance attributes. Always use the dict.copy() # method to avoid modifying the original state. state = self.__dict__.copy() # Remove the unpicklable entries. del state['file'] return state def __setstate__(self, state): # Restore instance attributes (i.e., filename and lineno). self.__dict__.update(state) # Restore the previously opened file's state. To do so, we need to # reopen it and read from it until the line count is restored. file = open(self.filename) for _ in range(self.lineno): file.readline() # Finally, save the file. self.file = file ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š 12345678&gt;&gt;&gt; reader = TextReader("hello.txt")&gt;&gt;&gt; reader.readline()'1: Hello world!'&gt;&gt;&gt; reader.readline()'2: I am line number two.'&gt;&gt;&gt; new_reader = pickle.loads(pickle.dumps(reader))&gt;&gt;&gt; new_reader.readline()'3: Goodbye!' é™¤äº†Dispatcher,ç±»åž‹å’Œå‡½æ•°åŠå…¶ä»–å¯¹è±¡è‡ªå®šä¹‰è§„çº¦ æœ‰æ—¶ï¼Œdispatch_table å¯èƒ½ä¸å¤Ÿçµæ´»ã€‚ ç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬æƒ³è¦åŸºäºŽå¯¹è±¡ç±»åž‹ä»¥å¤–çš„å…¶ä»–è§„åˆ™æ¥å¯¹å°å­˜è¿›è¡Œå®šåˆ¶ï¼Œæˆ–æ˜¯å½“æˆ‘ä»¬æƒ³è¦å¯¹å‡½æ•°å’Œç±»çš„å°å­˜è¿›è¡Œå®šåˆ¶çš„æ—¶å€™ã€‚ å¯¹äºŽé‚£äº›æƒ…å†µï¼Œå¯èƒ½è¦åŸºäºŽ Pickler ç±»è¿›è¡Œå­ç±»åŒ–å¹¶å®žçŽ° reducer_override() æ–¹æ³•ã€‚ æ­¤æ–¹æ³•å¯è¿”å›žä»»æ„çš„å½’çº¦å…ƒç»„ (å‚è§ __reduce__())ã€‚ å®ƒä¹Ÿå¯ä»¥é€‰æ‹©è¿”å›ž NotImplemented æ¥å›žé€€åˆ°ä¼ ç»Ÿè¡Œä¸ºã€‚ å¦‚æžœåŒæ—¶å®šä¹‰äº† dispatch_table å’Œ reducer_override()ï¼Œåˆ™ reducer_override() æ–¹æ³•å…·æœ‰ä¼˜å…ˆæƒã€‚ æ³¨è§£ï¼šå‡ºäºŽæ€§èƒ½ç†ç”±ï¼Œå¯èƒ½ä¸ä¼šä¸ºä»¥ä¸‹å¯¹è±¡è°ƒç”¨ reducer_override(): None, True, False, ä»¥åŠ int, float, bytes, str, dict, set, frozenset, list å’Œ tuple çš„å…·ä½“å®žä¾‹ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå…¶ä¸­æˆ‘ä»¬å…è®¸å°å­˜å¹¶é‡æ–°æž„å»ºä¸€ä¸ªç»™å®šçš„ç±»: 123456789101112131415161718192021222324252627import ioimport pickleclass MyClass: my_attribute = 1class MyPickler(pickle.Pickler): def reducer_override(self, obj): """Custom reducer for MyClass.""" if getattr(obj, "__name__", None) == "MyClass": return type, (obj.__name__, obj.__bases__, &#123;'my_attribute': obj.my_attribute&#125;) else: # For any other object, fallback to usual reduction return NotImplementedf = io.BytesIO()p = MyPickler(f)p.dump(MyClass)del MyClassunpickled_class = pickle.loads(f.getvalue())assert isinstance(unpickled_class, type)assert unpickled_class.__name__ == "MyClass"assert unpickled_class.my_attribute == 1 å¤–éƒ¨ç¼“å†²åŒºåœ¨æŸäº›åœºæ™¯ä¸­ï¼Œpickle æ¨¡å—ä¼šè¢«ç”¨æ¥ä¼ è¾“æµ·é‡çš„æ•°æ®ã€‚ å› æ­¤ï¼Œæœ€å°åŒ–å†…å­˜å¤åˆ¶æ¬¡æ•°ä»¥ä¿è¯æ€§èƒ½å’ŒèŠ‚çœèµ„æºæ˜¯å¾ˆé‡è¦çš„ã€‚ ä½†æ˜¯ pickle æ¨¡å—çš„æ­£å¸¸è¿ä½œä¼šå°†å›¾ç±»å¯¹è±¡ç»“æž„è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—æµï¼Œå› æ­¤åœ¨æœ¬è´¨ä¸Šå°±è¦ä»Žå°å­˜æµä¸­æ¥å›žå¤åˆ¶æ•°æ®ã€‚ å¦‚æžœ provider (å¾…ä¼ è¾“å¯¹è±¡ç±»åž‹çš„å®žçŽ°) å’Œ consumer (é€šä¿¡ç³»ç»Ÿçš„å®žçŽ°) éƒ½æ”¯æŒ pickle ç¬¬ 5 ç‰ˆæˆ–æ›´é«˜ç‰ˆæœ¬æ‰€æä¾›çš„å¤–éƒ¨ä¼ è¾“åŠŸèƒ½ï¼Œåˆ™æ­¤çº¦æŸå¯ä»¥è¢«æ’¤é”€ã€‚ æä¾›æ–¹APIå¤§çš„å¾…å°å­˜æ•°æ®å¯¹è±¡å¿…é¡»å®žçŽ°åè®® 5 åŠä»¥ä¸Šç‰ˆæœ¬ä¸“å±žçš„ __reduce_ex__() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä¸ºä»»æ„å¤§çš„æ•°æ®è¿”å›žä¸€ä¸ª PickleBuffer å®žä¾‹ï¼ˆè€Œä¸æ˜¯ bytes å¯¹è±¡ç­‰ï¼‰ã€‚ PickleBuffer å¯¹è±¡ä¼š è¡¨æ˜Ž åº•å±‚ç¼“å†²åŒºå¯è¢«ç”¨äºŽå¤–éƒ¨æ•°æ®ä¼ è¾“ã€‚ é‚£äº›å¯¹è±¡ä»å°†ä¿æŒä¸Ž pickle æ¨¡å—çš„æ­£å¸¸ç”¨æ³•å…¼å®¹ã€‚ ä½†æ˜¯ï¼Œä½¿ç”¨æ–¹ä¹Ÿå¯ä»¥é€‰æ‹©å‘ŠçŸ¥ pickle å®ƒä»¬å°†è‡ªè¡Œå¤„ç†é‚£äº›ç¼“å†²åŒºã€‚ ä½¿ç”¨æ–¹APIå½“åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å›¾æ—¶ï¼Œé€šä¿¡ç³»ç»Ÿå¯ä»¥å¯ç”¨å¯¹æ‰€ç”Ÿæˆ PickleBuffer å¯¹è±¡çš„å®šåˆ¶å¤„ç†ã€‚ å‘é€ç«¯éœ€è¦ä¼ é€’ buffer_callback å‚æ•°åˆ° Pickler (æˆ–æ˜¯åˆ° dump() æˆ– dumps() å‡½æ•°)ï¼Œè¯¥å›žè°ƒå‡½æ•°å°†åœ¨å°å­˜å¯¹è±¡å›¾æ—¶é™„å¸¦æ¯ä¸ªæ‰€ç”Ÿæˆçš„ PickleBuffer è¢«è°ƒç”¨ã€‚ ç”± buffer_callback æ‰€ç´¯ç§¯çš„ç¼“å†²åŒºçš„æ•°æ®å°†ä¸ä¼šè¢«æ‹·è´åˆ° pickle æµï¼Œè€Œæ˜¯ä»…æ’å…¥ä¸€ä¸ªç®€å•çš„æ ‡è®°ã€‚ æŽ¥æ”¶ç«¯éœ€è¦ä¼ é€’ buffers å‚æ•°åˆ° Unpickler (æˆ–æ˜¯åˆ° load() æˆ– loads() å‡½æ•°)ï¼Œå…¶å€¼æ˜¯ä¸€ä¸ªç”±ç¼“å†²åŒºç»„æˆçš„å¯è¿­ä»£å¯¹è±¡ï¼Œå®ƒä¼šè¢«ä¼ é€’ç»™ buffer_callbackã€‚ è¯¥å¯è¿­ä»£å¯¹è±¡åº”å½“æŒ‰å…¶è¢«ä¼ é€’ç»™ buffer_callback æ—¶çš„é¡ºåºäº§ç”Ÿç¼“å†²åŒºã€‚ è¿™äº›ç¼“å†²åŒºå°†æä¾›å¯¹è±¡é‡æž„é€ å™¨æ‰€æœŸæœ›çš„æ•°æ®ï¼Œå¯¹è¿™äº›æ•°æ®çš„å°å­˜äº§ç”Ÿäº†åŽŸæœ¬çš„ PickleBuffer å¯¹è±¡ã€‚ åœ¨å‘é€ç«¯å’ŒæŽ¥å—ç«¯ä¹‹é—´ï¼Œé€šä¿¡ç³»ç»Ÿå¯ä»¥è‡ªç”±åœ°å®žçŽ°å®ƒè‡ªå·±ç”¨äºŽå¤–éƒ¨ç¼“å†²åŒºçš„ä¼ è¾“æœºåˆ¶ã€‚ æ½œåœ¨çš„ä¼˜åŒ–åŒ…æ‹¬ä½¿ç”¨å…±äº«å†…å­˜æˆ–åŸºäºŽç‰¹å®šæ•°æ®ç±»åž‹çš„åŽ‹ç¼©ç­‰ã€‚ å®žä¾‹:ä¸‹é¢æ˜¯ä¸€ä¸ªå°ä¾‹å­ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å®žçŽ°äº†ä¸€ä¸ª bytearray çš„å­ç±»ï¼Œèƒ½å¤Ÿç”¨äºŽå¤–éƒ¨ç¼“å†²åŒºå°å­˜: 1234567891011121314151617181920class ZeroCopyByteArray(bytearray): def __reduce_ex__(self, protocol): if protocol &gt;= 5: return type(self)._reconstruct, (PickleBuffer(self),), None else: # PickleBuffer is forbidden with pickle protocols &lt;= 4. return type(self)._reconstruct, (bytearray(self),) @classmethod def _reconstruct(cls, obj): with memoryview(obj) as m: # Get a handle over the original buffer object obj = m.obj if type(obj) is cls: # Original buffer object is a ZeroCopyByteArray, return it # as-is. return obj else: return cls(obj) é‡æž„é€ å™¨ (_reconstruct ç±»æ–¹æ³•) ä¼šåœ¨ç¼“å†²åŒºçš„æä¾›å¯¹è±¡å…·æœ‰æ­£ç¡®ç±»åž‹æ—¶è¿”å›žè¯¥å¯¹è±¡ã€‚ åœ¨æ­¤å°ç¤ºä¾‹ä¸­è¿™æ˜¯æ¨¡æ‹Ÿé›¶æ‹·è´è¡Œä¸ºçš„ä¾¿æ·æ–¹å¼ã€‚ åœ¨ä½¿ç”¨æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰é€šå¸¸æ–¹å¼å°å­˜é‚£äº›å¯¹è±¡ï¼Œå®ƒä»¬åœ¨ååºåˆ—åŒ–æ—¶å°†æä¾›åŽŸå§‹å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬: 12345b = ZeroCopyByteArray(b"abc")data = pickle.dumps(b, protocol=5)new_b = pickle.loads(data)print(b == new_b) # Trueprint(b is new_b) # False: a copy was made ä½†æ˜¯å¦‚æžœæˆ‘ä»¬ä¼ å…¥ buffer_callback ç„¶åŽåœ¨ååºåˆ—åŒ–æ—¶ç»™å›žç´¯ç§¯çš„ç¼“å†²åŒºï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿå–å›žåŽŸå§‹å¯¹è±¡: 123456b = ZeroCopyByteArray(b"abc")buffers = []data = pickle.dumps(b, protocol=5, buffer_callback=buffers.append)new_b = pickle.loads(data, buffers=buffers)print(b == new_b) # Trueprint(b is new_b) # True: no copy was made è¿™ä¸ªä¾‹å­å—é™äºŽ bytearray ä¼šè‡ªè¡Œåˆ†é…å†…å­˜è¿™ä¸€äº‹å®žï¼šä½ æ— æ³•åŸºäºŽå¦ä¸€ä¸ªå¯¹è±¡çš„å†…å­˜åˆ›å»º bytearray çš„å®žä¾‹ã€‚ ä½†æ˜¯ï¼Œç¬¬ä¸‰æ–¹æ•°æ®ç±»åž‹ä¾‹å¦‚ NumPy æ•°ç»„åˆ™æ²¡æœ‰è¿™ç§é™åˆ¶ï¼Œå…è®¸åœ¨å•ç‹¬è¿›ç¨‹æˆ–ç³»ç»Ÿé—´ä¼ è¾“æ—¶ä½¿ç”¨é›¶æ‹·è´çš„å°å­˜ï¼ˆæˆ–æ˜¯å°½å¯èƒ½å°‘åœ°æ‹·è´ï¼‰ ã€‚ å‚è§ï¼šPEP 574 â€“ å¸¦æœ‰å¤–éƒ¨æ•°æ®ç¼“å†²åŒºçš„ pickle åè®® 5 é™åˆ¶å…¨å±€å˜é‡é»˜è®¤æƒ…å†µä¸‹ï¼Œè§£å°å°†ä¼šå¯¼å…¥åœ¨ pickle æ•°æ®ä¸­æ‰¾åˆ°çš„ä»»ä½•ç±»æˆ–å‡½æ•°ã€‚ å¯¹äºŽè®¸å¤šåº”ç”¨æ¥è¯´ï¼Œæ­¤è¡Œä¸ºæ˜¯ä¸å¯æŽ¥å—çš„ï¼Œå› ä¸ºå®ƒä¼šå…è®¸è§£å°å™¨å¯¼å…¥å¹¶å‘èµ·è°ƒç”¨ä»»æ„ä»£ç ã€‚ åªé¡»è€ƒè™‘å½“è¿™ä¸ªæ‰‹å·¥æž„å»ºçš„ pickle æ•°æ®æµè¢«åŠ è½½æ—¶ä¼šåšä»€ä¹ˆ: 1234&gt;&gt;&gt; import pickle&gt;&gt;&gt; pickle.loads(b"cos\nsystem\n(S'echo hello world'\ntR.")hello world0 åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè§£å°å™¨å¯¼å…¥ os.system() å‡½æ•°ç„¶åŽåº”ç”¨å­—ç¬¦ä¸²å‚æ•° â€œecho hello worldâ€ã€‚ è™½ç„¶è¿™ä¸ªä¾‹å­ä¸å…·æ”»å‡»æ€§ï¼Œä½†æ˜¯ä¸éš¾æƒ³è±¡åˆ«äººèƒ½å¤Ÿé€šè¿‡æ­¤æ–¹å¼å¯¹ä½ çš„ç³»ç»Ÿé€ æˆæŸå®³ã€‚ å‡ºäºŽè¿™æ ·çš„ç†ç”±ï¼Œä½ å¯èƒ½ä¼šå¸Œæœ›é€šè¿‡å®šåˆ¶ Unpickler.find_class() æ¥æŽ§åˆ¶è¦è§£å°çš„å¯¹è±¡ã€‚ ä¸Žå…¶åç§°æ‰€æç¤ºçš„ä¸åŒï¼ŒUnpickler.find_class() ä¼šåœ¨æ‰§è¡Œå¯¹ä»»ä½•å…¨å±€å¯¹è±¡ï¼ˆä¾‹å¦‚ä¸€ä¸ªç±»æˆ–ä¸€ä¸ªå‡½æ•°ï¼‰çš„è¯·æ±‚æ—¶è¢«è°ƒç”¨ã€‚ å› æ­¤å¯ä»¥å®Œå…¨ç¦æ­¢å…¨å±€å¯¹è±¡æˆ–æ˜¯å°†å®ƒä»¬é™åˆ¶åœ¨ä¸€ä¸ªå®‰å…¨çš„å­é›†ä¸­ã€‚ ä¸‹é¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªè§£å°å™¨ï¼Œå®ƒåªå…è®¸æŸä¸€äº›å®‰å…¨çš„æ¥è‡ª builtins æ¨¡å—çš„ç±»è¢«åŠ è½½: 12345678910111213141516171819202122232425import builtinsimport ioimport picklesafe_builtins = &#123; 'range', 'complex', 'set', 'frozenset', 'slice',&#125;class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): # Only allow safe classes from builtins. if module == "builtins" and name in safe_builtins: return getattr(builtins, name) # Forbid everything else. raise pickle.UnpicklingError("global '%s.%s' is forbidden" % (module, name))def restricted_loads(s): """Helper function analogous to pickle.loads().""" return RestrictedUnpickler(io.BytesIO(s)).load() æˆ‘ä»¬è¿™ä¸ªè§£å°å™¨çš„ä¸€ä¸ªç¤ºä¾‹ç”¨æ³•æ‰€è¾¾æˆçš„ç›®æ ‡: 123456789101112&gt;&gt;&gt; restricted_loads(pickle.dumps([1, 2, range(15)]))[1, 2, range(0, 15)]&gt;&gt;&gt; restricted_loads(b"cos\nsystem\n(S'echo hello world'\ntR.")Traceback (most recent call last): ...pickle.UnpicklingError: global 'os.system' is forbidden&gt;&gt;&gt; restricted_loads(b'cbuiltins\neval\n'... b'(S\'getattr(__import__("os"), "system")'... b'("echo hello world")\'\ntR.')Traceback (most recent call last): ...pickle.UnpicklingError: global 'builtins.eval' is forbidden æ­£å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­æ‰€æ˜¾ç¤ºçš„ï¼Œå¯¹äºŽå…è®¸è§£å°çš„å¯¹è±¡ä½ å¿…é¡»è¦ä¿æŒè°¨æ…Žã€‚ å› æ­¤å¦‚æžœè¦ä¿è¯å®‰å…¨ï¼Œä½ å¯ä»¥è€ƒè™‘å…¶ä»–é€‰æ‹©ä¾‹å¦‚ xmlrpc.client ä¸­çš„ç¼–ç»„ API æˆ–æ˜¯ç¬¬ä¸‰æ–¹è§£å†³æ–¹æ¡ˆã€‚ æ€§èƒ½è¾ƒæ–°ç‰ˆæœ¬çš„ pickle åè®®ï¼ˆç¬¬ 2 ç‰ˆæˆ–æ›´é«˜ï¼‰å…·æœ‰é’ˆå¯¹æŸäº›å¸¸è§ç‰¹æ€§å’Œå†…ç½®ç±»åž‹çš„é«˜æ•ˆäºŒè¿›åˆ¶ç¼–ç æ ¼å¼ã€‚ æ­¤å¤–ï¼Œpickle æ¨¡å—è¿˜æ‹¥æœ‰ä¸€ä¸ªä»¥ C ç¼–å†™çš„é€æ˜Žä¼˜åŒ–å™¨ã€‚ å®žä¾‹ å¯¹äºŽæœ€ç®€å•çš„ä»£ç ï¼Œè¯·ä½¿ç”¨ dump() å’Œ load() å‡½æ•°ã€‚ 123456789101112import pickle# An arbitrary collection of objects supported by pickle.data = &#123; 'a': [1, 2.0, 3, 4+6j], 'b': ("character string", b"byte string"), 'c': &#123;None, True, False&#125;&#125;with open('data.pickle', 'wb') as f: # Pickle the 'data' dictionary using the highest protocol available. pickle.dump(data, f, pickle.HIGHEST_PROTOCOL) ä»¥ä¸‹ç¤ºä¾‹è¯»å–ä¹‹å‰å°å­˜çš„æ•°æ®ã€‚ 123456import picklewith open('data.pickle', 'rb') as f: # The protocol version used is detected automatically, so we do not # have to specify it. data = pickle.load(f)]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>pickle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library array type]]></title>
    <url>%2F2020%2F01%2F13%2Fpython-standard-library-array-type%2F</url>
    <content type="text"><![CDATA[æ¯æ—¥ä¸€è¯: underdog è‹± [ËˆÊŒndÉ™dÉ’g] ç¾Ž [ËˆÊŒndÉ™rdÉ”g] n.å¤±è´¥è€…ï¼› é€€å±…ä¸‹é£Žçš„äººï¼› å—åŽ‹è¿«è€…ï¼› æ‰“è´¥äº†çš„é€‰æ‰‹ å¤æ•°ï¼š underdogs è¿™ä¸ªè¯æ¥è‡ª1887å¹´å‡ºçŽ°ï¼ŒåŽŸæŒ‡åœ¨æ–—ç‹—æ¯”èµ›ä¸­æˆ˜è´¥çš„ç‹—ã€‚åŽæ¥è¯ä¹‰å¼•ç”³è‡³äººï¼ŒæŒ‡çš„æ˜¯å„ç±»ç«žèµ›å’Œå¯¹ç¢°ä¸­ä¸è¢«çœ‹å¥½çš„ä¸€æ–¹ï¼Œæˆ–æ˜¯æŒ‡å¤„åœ¨é€†å¢ƒä¸­çš„äººå’Œå›¢ä½“ã€‚ è¢«çœ‹å¥½çš„ä¸€æ–¹ï¼Œå³Topdogï¼Œä»Žæ¥ä¸ç¼ºå–å½©å’Œæ”¯æŒã€‚è€ŒUnderdogçš„è·¯åˆ™æ³¨å®šå­¤ç‹¬è®¸å¤šã€‚ä¸è¢«äººçœ‹å¥½ï¼Œè¾ƒå°‘äººæ”¯æŒã€‚ æ‰€å¹¸çš„æ˜¯ï¼Œæ­£å¦‚å€ªåŒ¡å…ˆç”Ÿæ„Ÿè¨€ï¼šå¤ªå¤šçš„æ—¶å€™ï¼Œå­¤ç‹¬æœ€å¥½ã€‚ è‹¥èƒ½ä¸Žå­¤ç‹¬ä¸ºå¸ˆ,åˆä½•é¡»æ‹…å¿ƒunderdogå‘¢ï¼Ÿ python æ ‡å‡†åº“å­¦ä¹  arrayæ­¤æ¨¡å—å®šä¹‰äº†ä¸€ç§å¯¹è±¡ç±»åž‹ï¼Œå¯ä»¥ç´§å‡‘åœ°è¡¨ç¤ºåŸºæœ¬ç±»åž‹å€¼çš„æ•°ç»„ï¼šå­—ç¬¦ã€æ•´æ•°ã€æµ®ç‚¹æ•°ç­‰ã€‚ æ•°ç»„å±žäºŽåºåˆ—ç±»åž‹ï¼Œå…¶è¡Œä¸ºä¸Žåˆ—è¡¨éžå¸¸ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºŽå…¶ä¸­å­˜å‚¨çš„å¯¹è±¡ç±»åž‹æ˜¯å—é™çš„ã€‚ ç±»åž‹åœ¨å¯¹è±¡åˆ›å»ºæ—¶ä½¿ç”¨å•ä¸ªå­—ç¬¦çš„ ç±»åž‹ç  æ¥æŒ‡å®šã€‚ å·²å®šä¹‰çš„ç±»åž‹ç å¦‚ä¸‹ï¼š ç±»åž‹ç  C ç±»åž‹ Python ç±»åž‹ ä»¥å­—èŠ‚è¡¨ç¤ºçš„æœ€å°å°ºå¯¸ æ³¨é‡Š &#39;b&#39; signed char int 1 &#39;B&#39; unsigned char int 1 &#39;u&#39; Py_UNICODE Unicode å­—ç¬¦ 2 (1) &#39;h&#39; signed short int 2 &#39;H&#39; unsigned short int 2 &#39;i&#39; signed int int 2 &#39;I&#39; æ— ç¬¦å·æ•´åž‹ int 2 &#39;l&#39; signed long int 4 &#39;L&#39; æ— ç¬¦å·é•¿æ•´åž‹ int 4 &#39;q&#39; signed long long int 8 &#39;Q&#39; æ— ç¬¦å· long long int 8 &#39;f&#39; float float 4 &#39;d&#39; double float 8 ==æ³¨é‡Š== â€˜uâ€™ç±»åž‹ç åœ¨python3å·²ç»è¢«åºŸé™¤,é»˜è®¤pythonçš„å­—ç¬¦ä¸²å°±æ˜¯unicodeå­—ç¬¦ ç±» class array.array(typecode[, initializer]) ä¸€ä¸ªåŒ…å«ç”± typecode é™åˆ¶ç±»åž‹çš„æ¡ç›®çš„æ–°æ•°ç»„ï¼Œå¹¶ç”±å¯é€‰çš„ initializer å€¼è¿›è¡Œåˆå§‹åŒ–ï¼Œè¯¥å€¼å¿…é¡»ä¸ºä¸€ä¸ªåˆ—è¡¨ã€bytes-like object æˆ–åŒ…å«æ­£ç¡®ç±»åž‹å…ƒç´ çš„å¯è¿­ä»£å¯¹è±¡ã€‚å¦‚æžœç»™å®šä¸€ä¸ªåˆ—è¡¨æˆ–å­—ç¬¦ä¸²ï¼Œè¯¥ initializer ä¼šè¢«ä¼ ç»™æ–°æ•°ç»„çš„ fromlist(), frombytes() æˆ– fromunicode() æ–¹æ³•ï¼ˆè§ä¸‹æ–‡ï¼‰ä»¥å°†åˆå§‹æ¡ç›®æ·»åŠ åˆ°æ•°ç»„ä¸­ã€‚ å¦åˆ™ä¼šå°†å¯è¿­ä»£å¯¹è±¡ä½œä¸º initializer ä¼ ç»™ extend() æ–¹æ³•ã€‚å¼•å‘ä¸€ä¸ª å®¡æ ¸äº‹ä»¶ array.__new__ é™„å¸¦å‚æ•° typecode, initializerã€‚ å±žæ€§ array.typecodes åŒ…å«æ‰€æœ‰å¯ç”¨ç±»åž‹ç çš„å­—ç¬¦ä¸²ã€‚ 123&gt;&gt;&gt; import array&gt;&gt;&gt; array.typecodes&apos;bBuhHiIlLqQfd&apos; æ•°ç»„å¯¹è±¡æ”¯æŒæ™®é€šçš„åºåˆ—æ“ä½œå¦‚ç´¢å¼•ã€åˆ‡ç‰‡ã€æ‹¼æŽ¥å’Œé‡å¤ç­‰ã€‚ å½“ä½¿ç”¨åˆ‡ç‰‡èµ‹å€¼æ—¶ï¼Œæ‰€èµ‹çš„å€¼å¿…é¡»ä¸ºå…·æœ‰ç›¸åŒç±»åž‹ç çš„æ•°ç»„å¯¹è±¡ï¼›æ‰€æœ‰å…¶ä»–æƒ…å†µéƒ½å°†å¼•å‘ TypeErrorã€‚ æ•°ç»„å¯¹è±¡ä¹Ÿå®žçŽ°äº†ç¼“å†²åŒºæŽ¥å£ï¼Œå¯ä»¥ç”¨äºŽæ‰€æœ‰æ”¯æŒ å­—èŠ‚ç±»å¯¹è±¡ çš„åœºåˆã€‚ å‡½æ•°ä»¥ä¸‹æ•°æ®é¡¹å’Œæ–¹æ³•ä¹Ÿå—åˆ°æ”¯æŒï¼š array.typecode ç”¨äºŽåˆ›å»ºæ•°ç»„çš„ç±»åž‹ç å­—ç¬¦ã€‚ array.itemsize åœ¨å†…éƒ¨è¡¨ç¤ºä¸­ä¸€ä¸ªæ•°ç»„é¡¹çš„å­—èŠ‚é•¿åº¦ã€‚ array.append(x) æ·»åŠ ä¸€ä¸ªå€¼ä¸º x çš„æ–°é¡¹åˆ°æ•°ç»„æœ«å°¾ã€‚ array.buffer_info() è¿”å›žä¸€ä¸ªå…ƒç»„ (address, length) ä»¥ç»™å‡ºç”¨äºŽå­˜æ”¾æ•°ç»„å†…å®¹çš„ç¼“å†²åŒºå…ƒç´ çš„å½“å‰å†…å­˜åœ°å€å’Œé•¿åº¦ã€‚ ä»¥å­—èŠ‚è¡¨ç¤ºçš„å†…å­˜ç¼“å†²åŒºå¤§å°å¯é€šè¿‡ array.buffer_info()[1] * array.itemsize æ¥è®¡ç®—ã€‚ è¿™åœ¨ä½¿ç”¨éœ€è¦å†…å­˜åœ°å€çš„ä½Žå±‚çº§ï¼ˆå› æ­¤ä¸å¤Ÿå®‰å…¨ï¼‰ I/O æŽ¥å£æ—¶ä¼šå¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚æŸäº› ioctl() æ“ä½œã€‚ åªè¦æ•°ç»„å­˜åœ¨å¹¶ä¸”æ²¡æœ‰åº”ç”¨æ”¹å˜é•¿åº¦çš„æ“ä½œï¼Œè¿”å›žæ•°å€¼å°±æ˜¯æœ‰æ•ˆçš„ã€‚æ³¨è§£ å½“åœ¨ C æˆ– C++ ç¼–å†™çš„ä»£ç ä¸­ä½¿ç”¨æ•°ç»„å¯¹è±¡æ—¶ï¼ˆè¿™æ˜¯æœ‰æ•ˆä½¿ç”¨æ­¤ç±»ä¿¡æ¯çš„å”¯ä¸€æ–¹å¼ï¼‰ï¼Œä½¿ç”¨æ•°ç»„å¯¹è±¡æ‰€æ”¯æŒçš„ç¼“å†²åŒºæŽ¥å£æ›´ä¸ºé€‚å®œã€‚ æ­¤æ–¹æ³•ä»…ä¿ç•™ç”¨ä½œå‘ä¸‹å…¼å®¹ï¼Œåº”é¿å…åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ã€‚ ç¼“å†²åŒºæŽ¥å£çš„æ–‡æ¡£å‚è§ ç¼“å†²åè®®ã€‚ array.byteswap() â€œå­—èŠ‚å¯¹è°ƒâ€æ‰€æœ‰æ•°ç»„é¡¹ã€‚ æ­¤æ–¹æ³•åªæ”¯æŒå¤§å°ä¸º 1, 2, 4 æˆ– 8 å­—èŠ‚çš„å€¼ï¼›å¯¹äºŽå…¶ä»–å€¼ç±»åž‹å°†å¼•å‘ RuntimeErrorã€‚ å®ƒé€‚ç”¨äºŽä»Žä¸åŒå­—èŠ‚åºæœºå™¨æ‰€ç”Ÿæˆçš„æ–‡ä»¶ä¸­è¯»å–æ•°æ®çš„æƒ…å†µã€‚ array.count(x) è¿”å›ž x åœ¨æ•°ç»„ä¸­çš„å‡ºçŽ°æ¬¡æ•°ã€‚ array.extend(iterable) å°†æ¥è‡ª iterable çš„é¡¹æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ã€‚ å¦‚æžœ iterable æ˜¯å¦ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒå¿…é¡»å…·æœ‰ å®Œå…¨ ç›¸åŒçš„ç±»åž‹ç ï¼›å¦åˆ™å°†å¼•å‘ TypeErrorã€‚ å¦‚æžœ iterable ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™å®ƒå¿…é¡»ä¸ºå¯è¿­ä»£å¯¹è±¡å¹¶ä¸”å…¶å…ƒç´ å¿…é¡»ä¸ºå¯æ·»åŠ åˆ°æ•°ç»„çš„é€‚å½“ç±»åž‹ã€‚ array.frombytes(s) æ·»åŠ æ¥è‡ªå­—ç¬¦ä¸²çš„é¡¹ï¼Œå°†å­—ç¬¦ä¸²è§£è¯»ä¸ºæœºå™¨å€¼çš„æ•°ç»„ï¼ˆç›¸å½“äºŽä½¿ç”¨ fromfile() æ–¹æ³•ä»Žæ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼‰ã€‚3.2 æ–°ç‰ˆåŠŸèƒ½: fromstring() é‡å‘½åä¸º frombytes() ä»¥ä½¿å…¶å«ä¹‰æ›´æ¸…æ™°ã€‚ array.fromfile(f, n) ä»Ž file object f ä¸­è¯»å– n é¡¹ï¼ˆè§£è¯»ä¸ºæœºå™¨å€¼ï¼‰å¹¶å°†å®ƒä»¬æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ã€‚ å¦‚æžœå¯è¯»å–æ•°æ®å°‘äºŽ n é¡¹åˆ™å°†å¼•å‘ EOFErrorï¼Œä½†æœ‰æ•ˆçš„é¡¹ä»ç„¶ä¼šè¢«æ’å…¥æ•°ç»„ã€‚ f å¿…é¡»ä¸ºä¸€ä¸ªçœŸå®žçš„å†…ç½®æ–‡ä»¶å¯¹è±¡ï¼›ä¸æ”¯æŒå¸¦æœ‰ read() æ–¹æ³•çš„å…¶å®ƒå¯¹è±¡ã€‚ array.fromlist(list) æ·»åŠ æ¥è‡ª list çš„é¡¹ã€‚ è¿™ç­‰ä»·äºŽ for x in list: a.append(x)ï¼ŒåŒºåˆ«åœ¨äºŽå¦‚æžœå‘ç”Ÿç±»åž‹é”™è¯¯ï¼Œæ•°ç»„å°†ä¸ä¼šè¢«æ”¹å˜ã€‚ array.fromstring() frombytes() çš„å·²å¼ƒç”¨åˆ«åã€‚Deprecated since version 3.2, will be removed in version 3.9. array.fromunicode(s) ä½¿ç”¨æ¥è‡ªç»™å®š Unicode å­—ç¬¦ä¸²çš„æ•°ç»„æ‰©å±•æ•°ç»„ã€‚ æ•°ç»„å¿…é¡»æ˜¯ç±»åž‹ä¸º &#39;u&#39; çš„æ•°ç»„ï¼›å¦åˆ™å°†å¼•å‘ ValueErrorã€‚ è¯·ä½¿ç”¨ array.frombytes(unicodestring.encode(enc)) æ¥å°† Unicode æ•°æ®æ·»åŠ åˆ°å…¶ä»–ç±»åž‹çš„æ•°ç»„ã€‚ array.index(x) è¿”å›žæœ€å°çš„ i ä½¿å¾— i ä¸º x åœ¨æ•°ç»„ä¸­é¦–æ¬¡å‡ºçŽ°çš„åºå·ã€‚ array.insert(i, x) å°†å€¼ x ä½œä¸ºæ–°é¡¹æ’å…¥æ•°ç»„çš„ i ä½ç½®ä¹‹å‰ã€‚ è´Ÿå€¼å°†è¢«è§†ä¸ºç›¸å¯¹äºŽæ•°ç»„æœ«å°¾çš„ä½ç½®ã€‚ array.pop([i]) ä»Žæ•°ç»„ä¸­ç§»é™¤åºå·ä¸º i çš„é¡¹å¹¶å°†å…¶è¿”å›žã€‚ å¯é€‰å‚æ•°å€¼é»˜è®¤ä¸º -1ï¼Œå› æ­¤é»˜è®¤å°†ç§»é™¤å¹¶è¿”å›žæœ«å°¾é¡¹ã€‚ array.remove(x) ä»Žæ•°ç»„ä¸­ç§»é™¤é¦–æ¬¡å‡ºçŽ°çš„ xã€‚ array.reverse() åè½¬æ•°ç»„ä¸­å„é¡¹çš„é¡ºåºã€‚ array.tobytes() å°†æ•°ç»„è½¬æ¢ä¸ºä¸€ä¸ªæœºå™¨å€¼æ•°ç»„å¹¶è¿”å›žå…¶å­—èŠ‚è¡¨ç¤ºï¼ˆå³ç›¸å½“ä¸Žé€šè¿‡ tofile() æ–¹æ³•å†™å…¥åˆ°æ–‡ä»¶çš„å­—èŠ‚åºåˆ—ã€‚ï¼‰3.2 æ–°ç‰ˆåŠŸèƒ½: tostring() è¢«é‡å‘½åä¸º tobytes() ä»¥ä½¿å…¶å«ä¹‰æ›´æ¸…æ™°ã€‚ array.tofile(f) å°†æ‰€æœ‰é¡¹ï¼ˆä½œä¸ºæœºå™¨å€¼ï¼‰å†™å…¥åˆ° file object fã€‚ array.tolist() å°†æ•°ç»„è½¬æ¢ä¸ºåŒ…å«ç›¸åŒé¡¹çš„æ™®é€šåˆ—è¡¨ã€‚ array.tostring() tobytes() çš„å·²å¼ƒç”¨åˆ«åã€‚Deprecated since version 3.2, will be removed in version 3.9. array.tounicode() å°†æ•°ç»„è½¬æ¢ä¸ºä¸€ä¸ª Unicode å­—ç¬¦ä¸²ã€‚ æ•°ç»„å¿…é¡»æ˜¯ç±»åž‹ä¸º &#39;u&#39; çš„æ•°ç»„ï¼›å¦åˆ™å°†å¼•å‘ ValueErrorã€‚ è¯·ä½¿ç”¨ array.tobytes().decode(enc) æ¥ä»Žå…¶ä»–ç±»åž‹çš„æ•°ç»„ç”Ÿæˆ Unicode å­—ç¬¦ä¸²ã€‚ å½“ä¸€ä¸ªæ•°ç»„å¯¹è±¡è¢«æ‰“å°æˆ–è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šè¡¨ç¤ºä¸º array(typecode, initializer)ã€‚ å¦‚æžœæ•°ç»„ä¸ºç©ºåˆ™ initializer ä¼šè¢«çœç•¥ï¼Œå¦åˆ™å¦‚æžœ typecode ä¸º &#39;u&#39; åˆ™å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å®ƒæ˜¯ä¸€ä¸ªæ•°å­—åˆ—è¡¨ã€‚ ä½¿ç”¨ eval() ä¿è¯èƒ½å°†å­—ç¬¦ä¸²è½¬æ¢å›žå…·æœ‰ç›¸åŒç±»åž‹å’Œå€¼çš„æ•°ç»„ï¼Œåªè¦ array ç±»å·²é€šè¿‡ from array import array è¢«å¼•å…¥ã€‚ ä¾‹å¦‚: 12345from array import arrayarray('l')array('u', 'hello \u2641')array('l', [1, 2, 3, 4, 5])array('d', [1.0, 2.0, 3.14]) æ›´é«˜æ•ˆæ•°ç»„å¤„ç†çš„å¯ä»¥è¯¦è§ numpy åº“ æ€»ç»“åŽŸæ¥pythonæ ‡å‡†åº“é‡Œå°±æœ‰ä¸“é—¨æ“ä½œarrayå¯¹è±¡çš„æ–¹æ³•,è¿™é‡Œæˆ‘ç†è§£arrayå’Œlistçš„åŒºåˆ«åœ¨äºŽ,listé‡ŒåŒ…å«çš„å…ƒç´ å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»åž‹,å¤„ç†æ•°æ®çš„æ—¶å€™ä¸æ˜¯å¾ˆæ–¹ä¾¿,è€Œarrayé‡Œçš„æ•°æ®ç±»åž‹æ˜¯ä¸€è‡´çš„,è¿™æ ·å¤„ç†æ•°æ®æ•ˆçŽ‡æ›´é«˜ã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>array</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library collections.abc]]></title>
    <url>%2F2020%2F01%2F12%2Fpython-standard-library-collections-abc%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ ä¹‹ collections.abcæ¯æ—¥ä¸€è¯: wrong adj. ä¸é“å¾·çš„, ä¸æ­£å½“çš„, ä¸ä¹‰çš„ ä¸ç¡®å®žçš„, ä¸æ­£ç¡®çš„, é”™è¯¯çš„ ä¸åˆè¦æ±‚çš„, ä¸é€‚åˆçš„, å¹¶éžåˆæ„çš„ æœ‰æ•…éšœ, æœ‰æ¯›ç—… adv. æ–¹å¼æˆ–æ–¹å‘é”™è¯¯åœ°; é”™è¯¯åœ°; ç»“æžœé”™è¯¯åœ° n. ç½ªè¿‡, è¿‡å¤±, ç½ªæ¶ ä¸ä¹‰çš„è¡Œä¸º, ä¸å…¬æ­£çš„äº‹ æ—¶ æ€: wronged, wronging, wrongså è¯: wrongerå‰¯ è¯: wronglyå è¯: wrongness è¯è¯­ï¼š confound right and wrong æ··æ·†æ˜¯éžï¼Œé»‘ç™½ä¸åˆ† get one wrong è¯¯ä¼šæŸäººï¼›è¯¯ä¼š right or wrongadv. ä¸ç®¡å¦‚ä½• something wrong with â€¦å‡ºäº†æ¯›ç—…ï¼›â€¦æœ‰é—®é¢˜ï¼›â€¦ä¸å¯¹å¤´ python æ ‡å‡†åº“å­¦ä¹ ä¹‹ æŠ½è±¡åŸºç±» collection.abcä¼—æ‰€å‘¨çŸ¥,python3ä¸­æ‰€æœ‰ç±»é»˜è®¤ç»§æ‰¿è‡ªobjectç±»,æ„å‘³ç€çˆ¶ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•,å­ç±»éƒ½ç»§æ‰¿äº†ã€‚ æˆ‘ä¸ªäººç†è§£,æŠ½è±¡åŸºç±»æ˜¯æ— æ³•è¢«å®žä¾‹åŒ–çš„,åªèƒ½å­ç±»å®žçŽ° å‚è€ƒæ–‡æ¡£ æºä»£ç ï¼š Lib/_collections_abc.py è¯¥æ¨¡å—å®šä¹‰äº†ä¸€äº› æŠ½è±¡åŸºç±»ï¼Œå®ƒä»¬å¯ç”¨äºŽåˆ¤æ–­ä¸€ä¸ªå…·ä½“ç±»æ˜¯å¦å…·æœ‰æŸä¸€ç‰¹å®šçš„æŽ¥å£ï¼›ä¾‹å¦‚ï¼Œè¿™ä¸ªç±»æ˜¯å¦å¯å“ˆå¸Œï¼Œæˆ–å…¶æ˜¯å¦ä¸ºæ˜ å°„ç±»ã€‚ æ¨¡å—é‡Œæ–¹æ³•ä¸€è§ˆ,æ‘˜è‡ªæºç  12345678910__all__ = ["Awaitable", "Coroutine", "AsyncIterable", "AsyncIterator", "AsyncGenerator", "Hashable", "Iterable", "Iterator", "Generator", "Reversible", "Sized", "Container", "Callable", "Collection", "Set", "MutableSet", "Mapping", "MutableMapping", "MappingView", "KeysView", "ItemsView", "ValuesView", "Sequence", "MutableSequence", "ByteString", ] å®¹å™¨æŠ½è±¡åŸºç±» è¿™ä¸ªå®¹å™¨æ¨¡å—æä¾›äº†ä»¥ä¸‹ ABCs: æŠ½è±¡åŸºç±» ç»§æ‰¿è‡ª æŠ½è±¡æ–¹æ³• Mixin æ–¹æ³• Container __contains__ Hashable __hash__ Iterable __iter__ Iterator Iterable __next__ __iter__ Reversible Iterable __reversed__ Generator Iterator send, throw close, __iter__, __next__ Sized __len__ Callable __call__ Collection Sized, Iterable, Container __contains__, __iter__, __len__ Sequence Reversible, Collection __getitem__, __len__ __contains__, __iter__, __reversed__, index, and count MutableSequence Sequence __getitem__, __setitem__, __delitem__, __len__, insert ç»§æ‰¿è‡ª Sequence çš„æ–¹æ³•ï¼Œä»¥åŠ append, reverse, extend, pop, removeï¼Œå’Œ __iadd__ ByteString Sequence __getitem__, __len__ ç»§æ‰¿è‡ª Sequence çš„æ–¹æ³• Set Collection __contains__, __iter__, __len__ __le__, __lt__, __eq__, __ne__, __gt__, __ge__, __and__, __or__, __sub__, __xor__, and isdisjoint MutableSet Set __contains__, __iter__, __len__, add, discard ç»§æ‰¿è‡ª Set çš„æ–¹æ³•ä»¥åŠ clear, pop, remove, __ior__, __iand__, __ixor__ï¼Œå’Œ __isub__ Mapping Collection __getitem__, __iter__, __len__ __contains__, keys, items, values, get, __eq__, and __ne__ MutableMapping Mapping __getitem__, __setitem__, __delitem__, __iter__, __len__ ç»§æ‰¿è‡ª Mapping çš„æ–¹æ³•ä»¥åŠ pop, popitem, clear, updateï¼Œå’Œ setdefault MappingView Sized __len__ ItemsView MappingView, Set __contains__, __iter__ KeysView MappingView, Set __contains__, __iter__ ValuesView MappingView, Collection __contains__, __iter__ Awaitable __await__ Coroutine Awaitable send, throw close AsyncIterable __aiter__ AsyncIterator AsyncIterable __anext__ __aiter__ AsyncGenerator AsyncIterator asend, athrow aclose, __aiter__, __anext__ ç±» class collections.abc.Container class collections.abc.Hashable class collections.abc.Sized class collections.abc.Callable åˆ†åˆ«æä¾›äº† __contains__(), __hash__(), __len__() å’Œ __call__() æ–¹æ³•çš„æŠ½è±¡åŸºç±»ã€‚ class collections.abc.Iterable æä¾›äº† __iter__() æ–¹æ³•çš„æŠ½è±¡åŸºç±»ã€‚ä½¿ç”¨ isinstance(obj, Iterable) å¯ä»¥æ£€æµ‹ä¸€ä¸ªç±»æ˜¯å¦å·²ç»æ³¨å†Œåˆ°äº† Iterable æˆ–è€…å®žçŽ°äº† __iter__() å‡½æ•°ï¼Œä½†æ˜¯æ— æ³•æ£€æµ‹è¿™ä¸ªç±»æ˜¯å¦èƒ½å¤Ÿä½¿ç”¨ __getitem__() æ–¹æ³•è¿›è¡Œè¿­ä»£ã€‚æ£€æµ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ iterable çš„å”¯ä¸€å¯ä¿¡èµ–çš„æ–¹æ³•æ˜¯è°ƒç”¨ iter(obj)ã€‚ class collections.abc.Collection é›†åˆäº† Sized å’Œ Iterable ç±»çš„æŠ½è±¡åŸºç±»ã€‚ class collections.abc.Iterator æä¾›äº† __iter__() å’Œ __next__() æ–¹æ³•çš„æŠ½è±¡åŸºç±»ã€‚å‚è§ iterator çš„å®šä¹‰ã€‚ class collections.abc.Reversible ä¸ºå¯è¿­ä»£ç±»æä¾›äº† __reversed__() æ–¹æ³•çš„æŠ½è±¡åŸºç±»ã€‚3.6 æ–°ç‰ˆåŠŸèƒ½. class collections.abc.Generator ç”Ÿæˆå™¨ç±»ï¼Œå®žçŽ°äº† PEP 342 ä¸­å®šä¹‰çš„åè®®ï¼Œç»§æ‰¿å¹¶æ‰©å±•äº†è¿­ä»£å™¨ï¼Œæä¾›äº† send(), throw() å’Œ close() æ–¹æ³•ã€‚å‚è§ generator çš„å®šä¹‰ã€‚3.5 æ–°ç‰ˆåŠŸèƒ½. class collections.abc.Sequence class collections.abc.MutableSequence class collections.abc.ByteString åªè¯»ä¸”å¯å˜çš„åºåˆ— sequences çš„æŠ½è±¡åŸºç±»ã€‚å®žçŽ°ç¬”è®°ï¼šä¸€äº›æ··å…¥ï¼ˆMaxinï¼‰æ–¹æ³•æ¯”å¦‚ __iter__(), __reversed__() å’Œ index() ä¼šé‡å¤è°ƒç”¨åº•å±‚çš„ __getitem__() æ–¹æ³•ã€‚å› æ­¤ï¼Œå¦‚æžœå®žçŽ°çš„ __getitem__() æ˜¯å¸¸æ•°çº§è®¿é—®é€Ÿåº¦ï¼Œé‚£ä¹ˆç›¸åº”çš„æ··å…¥æ–¹æ³•ä¼šæœ‰ä¸€ä¸ªçº¿æ€§çš„è¡¨çŽ°ï¼›ç„¶è€Œï¼Œå¦‚æžœåº•å±‚æ–¹æ³•æ˜¯çº¿æ€§å®žçŽ°ï¼ˆä¾‹å¦‚é“¾è¡¨ï¼‰ï¼Œé‚£ä¹ˆæ··å…¥æ–¹æ³•å°†ä¼šæ˜¯å¹³æ–¹çº§çš„è¡¨çŽ°ï¼Œè¿™ä¹Ÿè®¸å°±éœ€è¦è¢«é‡æž„äº†ã€‚åœ¨ 3.5 ç‰ˆæ›´æ”¹: index() æ–¹æ³•æ”¯æŒ stop å’Œ start å‚æ•°ã€‚ class collections.abc.Set class collections.abc.MutableSet åªè¯»ä¸”å¯å˜çš„é›†åˆçš„æŠ½è±¡åŸºç±»ã€‚ class collections.abc.Mapping class collections.abc.MutableMapping åªè¯»ä¸”å¯å˜çš„æ˜ å°„ mappings çš„æŠ½è±¡åŸºç±»ã€‚ class collections.abc.MappingView class collections.abc.ItemsView class collections.abc.KeysView class collections.abc.ValuesView æ˜ å°„åŠå…¶é”®å’Œå€¼çš„è§†å›¾ views çš„æŠ½è±¡åŸºç±»ã€‚ class collections.abc.Awaitable ä¸ºå¯ç­‰å¾…å¯¹è±¡ awaitable æä¾›çš„ç±»ï¼Œå¯ä»¥è¢«ç”¨äºŽ await è¡¨è¾¾å¼ä¸­ã€‚ä¹ æƒ¯ä¸Šå¿…é¡»å®žçŽ° __await__() æ–¹æ³•ã€‚åç¨‹å¯¹è±¡ Coroutine å’Œ Coroutine æŠ½è±¡åŸºç±»çš„å®žä¾‹éƒ½æ˜¯è¿™ä¸ªæŠ½è±¡åŸºç±»çš„å®žä¾‹ã€‚ class collections.abc.Coroutine ç”¨äºŽåç¨‹å…¼å®¹ç±»çš„æŠ½è±¡åŸºç±»ã€‚å®žçŽ°äº†å¦‚ä¸‹å®šä¹‰åœ¨ åç¨‹å¯¹è±¡: é‡Œçš„æ–¹æ³•ï¼š send()ï¼Œthrow() å’Œ close()ã€‚é€šå¸¸çš„å®žçŽ°é‡Œè¿˜éœ€è¦å®žçŽ° __await__() æ–¹æ³•ã€‚æ‰€æœ‰çš„ Coroutine å®žä¾‹éƒ½å¿…é¡»æ˜¯ Awaitable å®žä¾‹ã€‚å‚è§ coroutine çš„å®šä¹‰ã€‚æ³¨è§£ åœ¨ CPython é‡Œï¼ŒåŸºäºŽç”Ÿæˆå™¨çš„åç¨‹ï¼ˆä½¿ç”¨ types.coroutine() æˆ– asyncio.coroutine() åŒ…è£…çš„ç”Ÿæˆå™¨ï¼‰éƒ½æ˜¯ å¯ç­‰å¾…å¯¹è±¡ï¼Œå³ä½¿ä»–ä»¬ä¸å«æœ‰ __await__() æ–¹æ³•ã€‚ä½¿ç”¨ isinstance(gencoro, Coroutine) æ¥æ£€æµ‹ä»–ä»¬ä¼šè¿”å›ž Falseã€‚è¦ä½¿ç”¨ inspect.isawaitable() æ¥æ£€æµ‹ä»–ä»¬ã€‚ class collections.abc.AsyncIterable æä¾›äº† __aiter__ æ–¹æ³•çš„æŠ½è±¡åŸºç±»ã€‚å‚è§ asynchronous iterable çš„å®šä¹‰ã€‚3.5 æ–°ç‰ˆåŠŸèƒ½. class collections.abc.AsyncIterator æä¾›äº† __aiter__ å’Œ __anext__ æ–¹æ³•çš„æŠ½è±¡åŸºç±»ã€‚å‚è§ asynchronous iterator çš„å®šä¹‰ã€‚3.5 æ–°ç‰ˆåŠŸèƒ½. class collections.abc.AsyncGenerator ä¸ºå¼‚æ­¥ç”Ÿæˆå™¨ç±»æä¾›çš„æŠ½è±¡åŸºç±»ï¼Œè¿™äº›ç±»å®žçŽ°äº†å®šä¹‰åœ¨ PEP 525 å’Œ PEP 492 é‡Œçš„åè®®ã€‚ è¿™äº›æŠ½è±¡åŸºç±»è®©æˆ‘ä»¬å¯ä»¥ç¡®å®šç±»å’Œç¤ºä¾‹æ‹¥æœ‰æŸäº›ç‰¹å®šçš„å‡½æ•°ï¼Œä¾‹å¦‚ï¼š 123size = Noneif isinstance(myvar, collections.abc.Sized): size = len(myvar) æœ‰äº›æŠ½è±¡åŸºç±»ä¹Ÿå¯ä»¥ç”¨ä½œæ··å…¥ç±»ï¼ˆmixinï¼‰ï¼Œè¿™å¯ä»¥æ›´å®¹æ˜“åœ°å¼€å‘æ”¯æŒå®¹å™¨ API çš„ç±»ã€‚ä¾‹å¦‚ï¼Œè¦å†™ä¸€ä¸ªæ”¯æŒå®Œæ•´ Set API çš„ç±»ï¼Œåªéœ€è¦æä¾›ä¸‹é¢è¿™ä¸‰ä¸ªæ–¹æ³•ï¼š __contains__(), __iter__() å’Œ __len__()ã€‚æŠ½è±¡åŸºç±»ä¼šè¡¥å……ä¸Šå…¶ä½™çš„æ–¹æ³•ï¼Œæ¯”å¦‚ __and__() å’Œ isdisjoint(): 123456789101112131415161718192021class ListBasedSet(collections.abc.Set): ''' Alternate set implementation favoring space over speed and not requiring the set elements to be hashable. ''' def __init__(self, iterable): self.elements = lst = [] for value in iterable: if value not in lst: lst.append(value) def __iter__(self): return iter(self.elements) def __contains__(self, value): return value in self.elements def __len__(self): return len(self.elements)s1 = ListBasedSet('abcdef')s2 = ListBasedSet('defghi')overlap = s1 &amp; s2 # The __and__() method is supported automatically å½“æŠŠ Set å’Œ MutableSet ç”¨ä½œæ··å…¥ç±»æ—¶éœ€æ³¨æ„ï¼š ç”±äºŽæŸäº›é›†åˆæ“ä½œä¼šåˆ›å»ºæ–°é›†åˆï¼Œé»˜è®¤çš„æ··å…¥æ–¹æ³•éœ€è¦ä¸€ç§ä»Žå¯è¿­ä»£å¯¹è±¡é‡Œåˆ›å»ºæ–°å®žä¾‹çš„æ–¹æ³•ã€‚å‡å¦‚å…¶ç±»æž„é€ å‡½æ•°ç­¾åå½¢å¦‚ ClassName(iterable) ï¼Œåˆ™å…¶ä¼šè°ƒç”¨ä¸€ä¸ªå†…éƒ¨çš„ç±»æ–¹æ³• _from_iterable()ï¼Œå…¶ä¸­è°ƒç”¨äº† cls(iterable) æ¥ç”Ÿæˆä¸€ä¸ªæ–°é›†åˆã€‚å¦‚æžœè¿™ä¸ª Set æ··å…¥ç±»åœ¨ç±»ä¸­è¢«ä½¿ç”¨ï¼Œä½†å…¶æž„é€ å‡½æ•°çš„ç­¾åå´æ˜¯ä¸åŒçš„å½¢å¼ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦é‡è½½ _from_iterable() æ–¹æ³•ï¼Œå°†å…¶ç¼–å†™æˆä¸€ä¸ªç±»æ–¹æ³•ï¼Œå¹¶ä¸”å®ƒèƒ½å¤Ÿä»Žå¯è¿­ä»£å¯¹è±¡å‚æ•°ä¸­æž„é€ ä¸€ä¸ªæ–°å®žä¾‹ã€‚ é‡è½½æ¯”è¾ƒç¬¦æ—¶æ—¶ï¼ˆæƒ³å¿…æ˜¯ä¸ºäº†é€Ÿåº¦ï¼Œå› ä¸ºå…¶è¯­ä¹‰éƒ½æ˜¯å›ºå®šçš„ï¼‰ï¼Œåªéœ€è¦é‡å®šä¹‰ __le__() å’Œ __ge__() å‡½æ•°ï¼Œç„¶åŽå…¶ä»–çš„æ“ä½œä¼šè‡ªåŠ¨è·Ÿè¿›ã€‚ æ··å…¥é›†åˆç±» Set æä¾›äº†ä¸€ä¸ª _hash() æ–¹æ³•ä¸ºé›†åˆè®¡ç®—å“ˆå¸Œå€¼ï¼Œç„¶è€Œï¼Œ __hash__() å‡½æ•°å´æ²¡æœ‰è¢«å®šä¹‰ï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰é›†åˆéƒ½æ˜¯å¯å“ˆå¸Œå¹¶ä¸”ä¸å¯å˜çš„ã€‚ä¸ºäº†ä½¿ç”¨æ··å…¥ç±»ä¸ºé›†åˆæ·»åŠ å“ˆå¸Œèƒ½åŠ›ï¼Œå¯ä»¥åŒæ—¶ç»§æ‰¿ Set() å’Œ Hashable() ç±»ï¼Œç„¶åŽå®šä¹‰ __hash__ = Set._hashã€‚ æ€»ç»“æˆ‘çœ‹äº†å®˜æ–¹æ–‡æ¡£çš„æè¿°,ä¸€å¤´é›¾æ°´ã€‚ä¸‹é¢å°±æˆ‘ä¸ªäººç†è§£è°ˆè°ˆè¿™ä¸ªæ¨¡å—ã€‚ abcæ¨¡å—åº”ç”¨çš„åœºæ™¯ 1. åˆ¤å®šæŸä¸ªå¯¹è±¡çš„ç±»åž‹ 2. å¼ºåˆ¶å­ç±»å®žçŽ°æŸäº›çˆ¶ç±»æ–¹æ³•]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>collections.abc</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library context-manager-types]]></title>
    <url>%2F2020%2F01%2F11%2Fpython-standard-library-context-manager-types%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ ä¸Šä¸‹æ–‡ç®¡ç†ç±»åž‹æ¯æ—¥ä¸€è¯: intresting : US [â€˜ÉªntrÉ™stÉªÅ‹] UK [â€˜ÉªntrÉ™stÉªÅ‹] adj.æœ‰è¶£çš„ï¼›æœ‰å¸å¼•åŠ›çš„ v.â€œinterestâ€çš„çŽ°åœ¨åˆ†è¯ Webæœ‰æ„æ€çš„ï¼›ä»¤äººæ„Ÿå…´è¶£çš„ï¼›å¼•äººå…¥èƒœçš„ æ¯”è¾ƒçº§ï¼šmore interestingæœ€é«˜çº§ï¼šmost interesting å¤§éƒ¨åˆ†æ—¶å€™,ä½ éƒ½æ˜¯ä¸€ä¸ªäººåœ¨é»˜é»˜åŠªåŠ›,è¿™æ ·,è·ç¦»æˆåŠŸæ‰ä¼šæ›´è¿›ä¸€æ­¥ã€‚ â€‹ â€“ å‡­æµ·ä¸´é£Žè¯­å½• python æ ‡å‡†åº“å­¦ä¹  ä¸Šä¸‹æ–‡ç®¡ç†ä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Ÿä¸Šä¸‹æ–‡ç®¡ç†å™¨å°±æ˜¯ä¸€ä¸ªç”¨è£…é¥°å™¨å®žçŽ°ä¸Šä¸‹æ–‡åè®®ç®¡ç†çš„å¯¹è±¡ã€‚ä¸»è¦ç”¨äºŽä¿å­˜å’Œæ¢å¤å„ç§å…¨å±€çŠ¶æ€,ä¾‹å¦‚å…³é—­æ–‡ä»¶ç­‰ã€‚ä¸‹é¢æˆ‘ä»¬æ¥äº†è§£å…·ä½“çš„å†…å®¹ã€‚ å‡½æ•° contextmanager.__enter__() è¿›å…¥è¿è¡Œæ—¶ä¸Šä¸‹æ–‡å¹¶è¿”å›žæ­¤å¯¹è±¡æˆ–å…³è”åˆ°è¯¥è¿è¡Œæ—¶ä¸Šä¸‹æ–‡çš„å…¶ä»–å¯¹è±¡ã€‚ æ­¤æ–¹æ³•çš„è¿”å›žå€¼ä¼šç»‘å®šåˆ°ä½¿ç”¨æ­¤ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ with è¯­å¥çš„ as å­å¥ä¸­çš„æ ‡è¯†ç¬¦ã€‚ä¸€ä¸ªè¿”å›žå…¶è‡ªèº«çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ä¾‹å­æ˜¯ file objectã€‚ æ–‡ä»¶å¯¹è±¡ä¼šä»Ž enter() è¿”å›žå…¶è‡ªèº«ï¼Œä»¥å…è®¸ open() è¢«ç”¨ä½œ with è¯­å¥ä¸­çš„ä¸Šä¸‹æ–‡è¡¨è¾¾å¼ã€‚ä¸€ä¸ªè¿”å›žå…³è”å¯¹è±¡çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ä¾‹å­æ˜¯ decimal.localcontext() æ‰€è¿”å›žçš„å¯¹è±¡ã€‚ æ­¤ç§ç®¡ç†å™¨ä¼šå°†æ´»åŠ¨çš„ decimal ä¸Šä¸‹æ–‡è®¾ä¸ºåŽŸå§‹ decimal ä¸Šä¸‹æ–‡çš„ä¸€ä¸ªå‰¯æœ¬å¹¶è¿”å›žè¯¥å‰¯æœ¬ã€‚ è¿™å…è®¸å¯¹ with è¯­å¥çš„è¯­å¥ä½“ä¸­çš„å½“å‰ decimal ä¸Šä¸‹æ–‡è¿›è¡Œæ›´æ”¹ï¼Œè€Œä¸ä¼šå½±å“ with è¯­å¥ä»¥å¤–çš„ä»£ç ã€‚ contextmanager.__exit__(*exc_type*, *exc_val*, *exc_tb*) é€€å‡ºè¿è¡Œæ—¶ä¸Šä¸‹æ–‡å¹¶è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼æ——æ ‡æ¥è¡¨æ˜Žæ‰€å‘ç”Ÿçš„ä»»ä½•å¼‚å¸¸æ˜¯å¦åº”å½“è¢«å±è”½ã€‚ å¦‚æžœåœ¨æ‰§è¡Œ with è¯­å¥çš„è¯­å¥ä½“æœŸé—´å‘ç”Ÿäº†å¼‚å¸¸ï¼Œåˆ™å‚æ•°ä¼šåŒ…å«å¼‚å¸¸çš„ç±»åž‹ã€å€¼ä»¥åŠå›žæº¯ä¿¡æ¯ã€‚ åœ¨å…¶ä»–æƒ…å†µä¸‹ä¸‰ä¸ªå‚æ•°å‡ä¸º Noneã€‚è‡ªæ­¤æ–¹æ³•è¿”å›žä¸€ä¸ªçœŸå€¼å°†å¯¼è‡´ with è¯­å¥å±è”½å¼‚å¸¸å¹¶ç»§ç»­æ‰§è¡Œç´§éšåœ¨ with è¯­å¥ä¹‹åŽçš„è¯­å¥ã€‚ å¦åˆ™å¼‚å¸¸å°†åœ¨æ­¤æ–¹æ³•ç»“æŸæ‰§è¡ŒåŽç»§ç»­ä¼ æ’­ã€‚ åœ¨æ­¤æ–¹æ³•æ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„å¼‚å¸¸å°†ä¼šå–ä»£ with è¯­å¥çš„è¯­å¥ä½“ä¸­å‘ç”Ÿçš„ä»»ä½•å¼‚å¸¸ã€‚ä¼ å…¥çš„å¼‚å¸¸ç»å¯¹ä¸åº”å½“è¢«æ˜¾å¼åœ°é‡æ–°å¼•å‘ â€”â€” ç›¸ååœ°ï¼Œæ­¤æ–¹æ³•åº”å½“è¿”å›žä¸€ä¸ªå‡å€¼ä»¥è¡¨æ˜Žæ–¹æ³•å·²æˆåŠŸå®Œæˆå¹¶ä¸”ä¸å¸Œæœ›å±è”½è¢«å¼•å‘çš„å¼‚å¸¸ã€‚ è¿™å…è®¸ä¸Šä¸‹æ–‡ç®¡ç†ä»£ç æ–¹ä¾¿åœ°æ£€æµ‹ __exit__() æ–¹æ³•æ˜¯å¦ç¡®å®žå·²å¤±è´¥ã€‚ ä¸€ä¸ªæ–‡ä»¶æ“ä½œå®žä¾‹1234&gt;&gt;&gt; with open("/etc/hosts", "r") as file:... dir(file)... ['__class__', '__delattr__', '__doc__', '__enter__', '__exit__', '__format__', '__getattribute__', '__hash__', '__init__', '__iter__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'close', 'closed', 'encoding', 'errors', 'fileno', 'flush', 'isatty', 'mode', 'name', 'newlines', 'next', 'read', 'readinto', 'readline', 'readlines', 'seek', 'softspace', 'tell', 'truncate', 'write', 'writelines', 'xreadlines'] æ­¤æ—¶çš„openè¿”å›žçš„å¯¹è±¡file,å°±å®žçŽ°äº†ç®¡ç†æ‰“å¼€æ–‡ä»¶ã€å…³é—­æ–‡ä»¶çš„ä¸Šä¸‹æ–‡ç®¡ç†åè®®ã€‚ with è¯­å¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå®šä¹‰äº†åœ¨æ‰§è¡Œ with è¯­å¥æ—¶è¦å»ºç«‹çš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ã€‚ ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¤„ç†è¿›å…¥å’Œé€€å‡ºæ‰€éœ€è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ä»¥æ‰§è¡Œä»£ç å—ã€‚ é€šå¸¸ä½¿ç”¨ with è¯­å¥ï¼ˆåœ¨ with è¯­å¥ ä¸­æè¿°ï¼‰ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥é€šè¿‡ç›´æŽ¥è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•æ¥ä½¿ç”¨ã€‚ ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„å…¸åž‹ç”¨æ³•åŒ…æ‹¬ä¿å­˜å’Œæ¢å¤å„ç§å…¨å±€çŠ¶æ€ï¼Œé”å®šå’Œè§£é”èµ„æºï¼Œå…³é—­æ‰“å¼€çš„æ–‡ä»¶ç­‰ç­‰ã€‚ è¦äº†è§£ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç±»åž‹ã€‚ object.__enter__(self) è¿›å…¥ä¸Žæ­¤å¯¹è±¡ç›¸å…³çš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ã€‚ with è¯­å¥å°†ä¼šç»‘å®šè¿™ä¸ªæ–¹æ³•çš„è¿”å›žå€¼åˆ° as å­å¥ä¸­æŒ‡å®šçš„ç›®æ ‡ï¼Œå¦‚æžœæœ‰çš„è¯ã€‚ object.__exit__(self, exc_type, exc_value, traceback) é€€å‡ºå…³è”åˆ°æ­¤å¯¹è±¡çš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ã€‚ å„ä¸ªå‚æ•°æè¿°äº†å¯¼è‡´ä¸Šä¸‹æ–‡é€€å‡ºçš„å¼‚å¸¸ã€‚ å¦‚æžœä¸Šä¸‹æ–‡æ˜¯æ— å¼‚å¸¸åœ°é€€å‡ºçš„ï¼Œä¸‰ä¸ªå‚æ•°éƒ½å°†ä¸º Noneã€‚å¦‚æžœæä¾›äº†å¼‚å¸¸ï¼Œå¹¶ä¸”å¸Œæœ›æ–¹æ³•å±è”½æ­¤å¼‚å¸¸ï¼ˆå³é¿å…å…¶è¢«ä¼ æ’­ï¼‰ï¼Œåˆ™åº”å½“è¿”å›žçœŸå€¼ã€‚ å¦åˆ™çš„è¯ï¼Œå¼‚å¸¸å°†åœ¨é€€å‡ºæ­¤æ–¹æ³•æ—¶æŒ‰æ­£å¸¸æµç¨‹å¤„ç†ã€‚è¯·æ³¨æ„ __exit__() æ–¹æ³•ä¸åº”è¯¥é‡æ–°å¼•å‘è¢«ä¼ å…¥çš„å¼‚å¸¸ï¼Œè¿™æ˜¯è°ƒç”¨è€…çš„è´£ä»»ã€‚ å¯ä»¥å‚è€ƒ PEP 343 - â€œwithâ€ è¯­å¥ Python with è¯­å¥çš„è§„èŒƒæè¿°ã€èƒŒæ™¯å’Œç¤ºä¾‹ã€‚ è‡ªå®šä¹‰ä¸Šä¸‹æ–‡ç®¡ç†å®žçŽ°__enter__ å’Œ __exit__ æ–¹æ³•å°±æ˜¯ä¸€ä¸ªå®žçŽ°äº†ä¸Šä¸‹æ–‡ç®¡ç†çš„ç±»ã€‚ 12345678910111213141516171819class ContextManager(object): def __init__(self): print '__init__()' def __enter__(self): print '__enter__()' return self def __exit__(self, exc_type, exc_val, exc_tb): print "__exit__()"with ContextManager(): print "OK, we can do something here~~" #è¾“å‡º__init__()__enter__()OK, we can do something here~~__exit__() å¦ä¸€ä¸ªä¸è¿”å›žå½“å‰ç±»çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233class InnerContext(object): def __init__(self, obj): print 'InnerContext.__init__(%s)' % obj def do_something(self): print 'InnerContext.do_something()' def __del__(self): print 'InnerContext.__del__()'class ContextManager(object): def __init__(self): print 'ContextManager.__init__()' def __enter__(self): print 'ContextManager.__enter__()' return InnerContext(self) def __exit__(self, exc_type, exc_val, exc_tb): print "ContextManager.__exit__()"with ContextManager() as obj: obj.do_something() print "OK, we can do something here~~" #è¾“å‡ºContextManager.__init__()ContextManager.__enter__()InnerContext.__init__(&lt;__main__.ContextManager object at 0x1012f95d0&gt;)InnerContext.do_something()OK, we can do something here~~ContextManager.__exit__()InnerContext.__del__() å¼‚å¸¸å¤„ç†çš„ä¾‹å­ ï¼š 1234567891011121314151617181920212223242526272829303132class ContextManager(object): def __init__(self, flag): print 'ContextManager.__init__(%s)' % flag self.flag = flag def __enter__(self): print 'ContextManager.__enter__()' return self def __exit__(self, exc_type, exc_val, exc_tb): print 'ContextManager.__exit__(%s, %s, %s)' % (exc_type, exc_val, exc_tb) return self.flagwith ContextManager(True): raise RuntimeError('error message handled')printwith ContextManager(False): raise RuntimeError('error message propagated')#è¾“å‡ºContextManager.__init__(True)ContextManager.__enter__()ContextManager.__exit__(&lt;type 'exceptions.RuntimeError'&gt;, error message handled, &lt;traceback object at 0x10d69dbd8&gt;)ContextManager.__init__(False)ContextManager.__enter__()ContextManager.__exit__(&lt;type 'exceptions.RuntimeError'&gt;, error message propagated, &lt;traceback object at 0x109e0fbd8&gt;)Traceback (most recent call last): File "ContextManager.py", line 19, in &lt;module&gt; raise RuntimeError('error message propagated')RuntimeError: error message propagated contextlib æ¨¡å—å‚è€ƒæ–‡æ¡£ æºä»£ç  Lib/contextlib.py è¿™ä¸ªå†…ç½®æ¨¡å—å®žçŽ°äº†ä¸Šä¸‹æ–‡ç®¡ç†,ä½¿ç”¨withå…³é”®å­—ã€‚ ä¸»è¦æ–¹æ³•å¦‚ä¸‹(èŠ‚é€‰è‡ªæºç ): 1234__all__ = ["asynccontextmanager", "contextmanager", "closing", "nullcontext", "AbstractContextManager", "AbstractAsyncContextManager", "AsyncExitStack", "ContextDecorator", "ExitStack", "redirect_stdout", "redirect_stderr", "suppress"] æ ¸å¿ƒç±»class contextlib.AbstractContextManager åŒæ­¥çš„ä¸Šä¸‹æ–‡ç®¡ç†ç±» class contextlib.AbstractAsyncContextManager å¼‚æ­¥çš„ä¸Šä¸‹æ–‡ç®¡ç†ç±» è£…é¥°å™¨ `@contextlib.contextmanager` ä¸€ä¸ªå®žçŽ°äº†ä¸Šä¸‹æ–‡èµ„æºç®¡ç†çš„ä¾‹å­: 123456789101112131415from contextlib import contextmanager@contextmanagerdef managed_resource(*args, **kwds): # Code to acquire resource, e.g.: resource = acquire_resource(*args, **kwds) try: yield resource finally: # Code to release resource, e.g.: release_resource(resource)&gt;&gt;&gt; with managed_resource(timeout=3600) as resource:... # Resource is released at the end of this block,... # even if code in the block raises an exception ==tips== : æ³¨æ„è¿™é‡Œ è¿”å›žçš„æ˜¯generatorå¯¹è±¡ï¼Œæ¯æ¬¡è¿­ä»£å™¨åªä¼šyieldä¸€ä¸ªå¯¹è±¡å‡ºæ¥,è¿™ä¸ªå€¼ä¼šç”¨åœ¨withè¯­å¥ä¸­,ç»‘å®šåˆ°as åŽçš„å¯¹è±¡ä¸Šã€‚ @contextlib.asynccontextmanager` ä¸‹é¢æ˜¯ä¸€ä¸ªå®žçŽ°äº†å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„å®žä¾‹,å…³äºŽæ“ä½œæ•°æ®åº“å¯¹è±¡ 12345678910111213from contextlib import asynccontextmanager@asynccontextmanagerasync def get_connection(): conn = await acquire_db_connection() try: yield conn finally: await release_db_connection(conn)async def get_all_users(): async with get_connection() as conn: return conn.query('SELECT ...') å…¶ä»–æ–¹æ³• contextlib.closing(thing) è¿”å›žä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å¯¹è±¡,åœ¨è¯­å¥ç»“æŸä¹‹å‰è¢«è°ƒç”¨ ç›¸å½“äºŽä¸‹é¢çš„å®žçŽ° 12345678from contextlib import contextmanager@contextmanagerdef closing(thing): try: yield thing finally: thing.close() ä¹Ÿå¯ä»¥è¿™æ ·å®žçŽ° 123456from contextlib import closingfrom urllib.request import urlopenwith closing(urlopen('http://www.python.org')) as page: for line in page: print(line) contextlib.nullcontext è¿”å›žä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å¯¹è±¡( å®žçŽ°äº†__enter__æ–¹æ³•) ä¸€ä¸ªä¾‹å­ 123456789def myfunction(arg, ignore_exceptions=False): if ignore_exceptions: # Use suppress to ignore all exceptions. cm = contextlib.suppress(Exception) else: # Do not ignore any exceptions, cm has no effect. cm = contextlib.nullcontext() with cm: # Do something å¦ä¸€ä¸ªä¾‹å­ 12345678910def process_file(file_or_path): if isinstance(file_or_path, str): # If string, open file cm = open(file_or_path) else: # Caller is responsible for closing file cm = nullcontext(file_or_path) with cm as file: # Perform processing on the file contextlib.suppress è¿”å›žä¸€ä¸ªå£°æ˜Žçš„å¼‚å¸¸å¯¹è±¡çš„ä¸Šä¸‹æ–‡ç®¡ç† ä¸€ä¸ªä¾‹å­ï¼š 1234567from contextlib import suppresswith suppress(FileNotFoundError): os.remove('somefile.tmp')with suppress(FileNotFoundError): os.remove('someotherfile.tmp') å’Œä¸‹é¢çš„ä»£ç ç­‰ä»· 123456789try: os.remove('somefile.tmp')except FileNotFoundError: passtry: os.remove('someotherfile.tmp')except FileNotFoundError: pass contextlib.redirect_stdout ä¸´æ—¶è¾“å‡ºæ ‡å‡†è¾“å‡ºçš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ contextlib.redirect_stderr ä¸´æ—¶è¾“å‡ºæ ‡å‡†é”™è¯¯çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ class contextlib.ContextDecorator å…è®¸ä¸€ä¸ªç±»åƒè£…é¥°å™¨é‚£æ ·ä½¿ç”¨,ContextDecorator æ­£å¥½å®žçŽ°äº†__enter__ and __exit__ æ–¹æ³•ã€‚ ä½¿ç”¨contextlibå°±è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªè£…é¥°å™¨ã€‚ ä¸€ä¸ªå®žä¾‹ 1234567891011121314151617181920212223242526from contextlib import ContextDecoratorclass mycontext(ContextDecorator): def __enter__(self): print('Starting') return self def __exit__(self, *exc): print('Finishing') return False&gt;&gt;&gt; @mycontext()... def function():... print('The bit in the middle')...&gt;&gt;&gt; function()StartingThe bit in the middleFinishing&gt;&gt;&gt; with mycontext():... print('The bit in the middle')...StartingThe bit in the middleFinishing å…¶å®žæœ¬è´¨ä¸Šå°±æ˜¯å®žçŽ°äº†è¯­æ³•ç³– ä¾‹å¦‚ï¼š 123def f(): with cm(): # Do stuff ContextDecorator å…è®¸ä½ è¿™æ ·ä½¿ç”¨: 123@cm()def f(): # Do stuff å…è®¸ä½ é€šè¿‡ç»§æ‰¿ContextBaseClasså’ŒContextDecorator,å®žçŽ°Mixin class(æˆ‘ä¹Ÿä¸çŸ¥é“è¯¥å¦‚ä½•ç¿»è¯‘,å§‘ä¸”ç¿»è¯‘æˆæ··åˆç»§æ‰¿å§) 12345678from contextlib import ContextDecoratorclass mycontext(ContextBaseClass, ContextDecorator): def __enter__(self): return self def __exit__(self, *exc): return False class contextlib.ExitStack ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯ä»¥è¢«è®¾è®¡æˆè‡ªåŠ¨åˆå¹¶å…¶ä»–ä¸Šä¸‹æ–‡ç®¡ç†å™¨,æ¸…é™¤æ–¹æ³•(æ ˆ),å°¤å…¶æ˜¯é‚£äº›éœ€è¦è¾“å…¥æ•°æ®çš„åŠŸèƒ½å®žçŽ°ã€‚ è¿™é‡Œæˆ‘çœ‹äº†æºç ,é€šè¿‡ä¸€ä¸ªæ ˆç»“æž„ç®¡ç†ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œ å…¶å®žå°±æ˜¯å®žçŽ°äº†ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨æ ˆ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­: 12345with ExitStack() as stack: files = [stack.enter_context(open(fname)) for fname in filenames] # All opened files will automatically be closed at the end of # the with statement, even if attempts to open files later # in the list raise an exception ä¸ªäººç†è§£è¿™æ˜¯ä¸€ä¸ªä½Žçº§çš„api,å†…éƒ¨å®žçŽ°äº†,ä½ æ— éœ€å…³å¿ƒä½•æ—¶è¯¥è°ƒç”¨è¯¥æ–¹æ³•,ç”±pythonå†…éƒ¨åŽ»å¤„ç†ã€‚ å°ç»“ æœ€è¿‘æ°å¥½çœ‹flaskçš„æºç ,flaskçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¹Ÿæ˜¯ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†è£…é¥°å™¨å®žçŽ°ã€‚ ç­‰æœ‰ç©ºå†æ›´æ–°ä¸€ç¯‡å§ã€‚ ä»Šå¤©å°±åˆ°è¿™é‡Œ,ç¥å¤§å®¶å‘¨æœ«æ„‰å¿«ï¼]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>context-manager-types</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard_library operator]]></title>
    <url>%2F2020%2F01%2F10%2Fpython-standard-library-operator%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ operatorä»Šå¤©çš„å…³é”®è¯: trouble trouble [è‹±] [ËˆtrÊŒbl] [ç¾Ž] [ËˆtrÊŒbÉ™l] n.éº»çƒ¦ï¼› çƒ¦æ¼ï¼› æ•…éšœï¼› åŠ¨ä¹±ï¼› vi.è´¹å¿ƒï¼› çƒ¦æ¼ï¼› vt.éº»çƒ¦ï¼› ä½¿çƒ¦æ¼ï¼› æŠ˜ç£¨ï¼› python æ ‡å‡†åº“å­¦ä¹  operatoroperator æ¨¡å—æä¾›äº†ä¸€å¥—ä¸ŽPythonçš„å†…ç½®è¿ç®—ç¬¦å¯¹åº”çš„é«˜æ•ˆçŽ‡å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œoperator.add(x, y) ä¸Žè¡¨è¾¾å¼ x+y ç›¸åŒã€‚ è®¸å¤šå‡½æ•°åä¸Žç‰¹æ®Šæ–¹æ³•åç›¸åŒï¼Œåªæ˜¯æ²¡æœ‰åŒä¸‹åˆ’çº¿ã€‚ä¸ºäº†å‘åŽå…¼å®¹æ€§ï¼Œä¹Ÿä¿ç•™äº†è®¸å¤šåŒ…å«åŒä¸‹åˆ’çº¿çš„å‡½æ•°ã€‚ä¸ºäº†è¡¨è¿°æ¸…æ¥šï¼Œå»ºè®®ä½¿ç”¨æ²¡æœ‰åŒä¸‹åˆ’çº¿çš„å‡½æ•°ã€‚ å‡½æ•°åŒ…å«çš„ç§ç±»æœ‰ï¼šå¯¹è±¡çš„æ¯”è¾ƒè¿ç®—ã€é€»è¾‘è¿ç®—ã€æ•°å­¦è¿ç®—ä»¥åŠåºåˆ—è¿ç®—ã€‚ å¯¹è±¡æ¯”è¾ƒå‡½æ•°é€‚ç”¨äºŽæ‰€æœ‰çš„å¯¹è±¡ï¼Œå‡½æ•°åæ ¹æ®å®ƒä»¬å¯¹åº”çš„æ¯”è¾ƒè¿ç®—ç¬¦å‘½åã€‚ æ¯”è¾ƒè¿ç®—operator.lt(*a*, *b*) operator.le(*a*, *b*) operator.eq(*a*, *b*) operator.ne*a*, *b*) operator.ge*a*, *b*) operator.gt*a*, *b*) operator.__lt__*a*, *b*) operator.__le__*a*, *b*) operator.__eq__*a*, *b*) operator.__ne__*a*, *b*) operator.__ge__*a*, *b*) operator.__gt__*a*, *b*) é€»è¾‘è¿ç®— operator.not_(*obj*)` operator.__not__(*obj*) è¿”å›ž not*obj* çš„ç»“æžœã€‚ ï¼ˆè¯·æ³¨æ„å¯¹è±¡å®žä¾‹å¹¶æ²¡æœ‰ [not()](https://docs.python.org/zh-cn/3.8/library/operator.html#operator.__not__) æ–¹æ³•ï¼›åªæœ‰è§£é‡Šå™¨æ ¸å¿ƒå¯å®šä¹‰æ­¤æ“ä½œã€‚ ç»“æžœä¼šå— [bool()](https://docs.python.org/zh-cn/3.8/reference/datamodel.html#object.__bool__) å’Œ [len()`](https://docs.python.org/zh-cn/3.8/reference/datamodel.html#object.__len__) æ–¹æ³•å½±å“ã€‚ï¼‰ `operator.truth(obj) å¦‚æžœ obj ä¸ºçœŸå€¼åˆ™è¿”å›ž Trueï¼Œå¦åˆ™è¿”å›ž Falseã€‚ è¿™ç­‰ä»·äºŽä½¿ç”¨ bool æž„é€ å™¨ã€‚ operator.is_(*a*, *b*) è¿”å›ž a is bã€‚ æ£€æµ‹å¯¹è±¡æ ‡è¯†ã€‚ operator.is_not(*a*, *b*) è¿”å›ž a is not bã€‚ æ£€æµ‹å¯¹è±¡æ ‡è¯†ã€‚ æ•°å­¦è¿ç®—å’Œä½è¿ç®— operator.abs(*obj*) operator.__abs__(*obj*) è¿”å›ž obj çš„ç»å¯¹å€¼ã€‚ operator.add(*a*, *b*) operator.__add__(*a*, *b*) å¯¹äºŽæ•°å­— a å’Œ bï¼Œè¿”å›ž a + bã€‚ operator.and_(*a*, *b*) operator.__and__(*a*, *b*) è¿”å›ž x å’Œ y æŒ‰ä½ä¸Žçš„ç»“æžœã€‚ operator.floordiv(*a*, *b*) operator.__floordiv__(*a*, *b*) è¿”å›ž a // bã€‚ operator.index(*a*) operator.__index__(*a*) è¿”å›ž a è½¬æ¢ä¸ºæ•´æ•°çš„ç»“æžœã€‚ ç­‰ä»·äºŽ a.__index__()`ã€‚ operator.inv(*obj*) operator.invert(*obj*) operator.__inv__(*obj*) operator.__invert__(*obj*) è¿”å›žæ•°å­— obj æŒ‰ä½å–åçš„ç»“æžœã€‚ è¿™ç­‰ä»·äºŽ ~objã€‚ operator.lshift(*a*, *b*) operator.__lshift__(*a*, *b*) è¿”å›ž a å·¦ç§» b ä½çš„ç»“æžœã€‚ operator.mod(*a*, *b*) operator.__mod__(*a*, *b*) è¿”å›ž a % bã€‚ operator.mul(*a*, *b*) operator.__mul__(*a*, *b*) å¯¹äºŽæ•°å­— a å’Œ bï¼Œè¿”å›ž a * bã€‚ operator.matmul(*a*, *b*) operator.__matmul__(*a*, *b*) è¿”å›ž a @ bã€‚ operator.neg(*obj*) operator.__neg__(*obj*) è¿”å›ž obj å–è´Ÿçš„ç»“æžœ (-obj)`ã€‚ operator.or_(*a*, *b*) operator.__or__(*a*, *b*) è¿”å›ž a å’Œ b æŒ‰ä½æˆ–çš„ç»“æžœã€‚ operator.pos(*obj*) operator.__pos__(*obj*) è¿”å›ž obj å–æ­£çš„ç»“æžœ (+obj)`ã€‚ operator.pow(*a*, *b*) operator.__pow__(*a*, *b*) å¯¹äºŽæ•°å­— a å’Œ bï¼Œè¿”å›ž a ** bã€‚ operator.rshift(*a*, *b*) operator.__rshift__(*a*, *b*) è¿”å›ž a å³ç§» b ä½çš„ç»“æžœã€‚ operator.sub(*a*, *b*) operator.__sub__(*a*, *b*) è¿”å›ž a - bã€‚ operator.truediv(*a*, *b*) operator.__truediv__(*a*, *b*) è¿”å›ž a / b ä¾‹å¦‚ 2/3 å°†ç­‰äºŽ .66 è€Œä¸æ˜¯ 0ã€‚ è¿™ä¹Ÿè¢«ç§°ä¸ºâ€œçœŸâ€é™¤æ³•ã€‚ operator.xor(*a*, *b*) operator.__xor__(*a*, *b*) è¿”å›ž a å’Œ b æŒ‰ä½å¼‚æˆ–çš„ç»“æžœã€‚ é€‚ç”¨äºŽåºåˆ—çš„æ“ä½œï¼ˆå…¶ä¸­ä¸€äº›ä¹Ÿé€‚ç”¨äºŽæ˜ å°„ï¼‰åŒ…æ‹¬ï¼š operator.concat(*a*, *b*) operator.__concat__(*a*, *b*) å¯¹äºŽåºåˆ— a å’Œ bï¼Œè¿”å›ž a + bã€‚ operator.contains(*a*, *b*) operator.__contains__(*a*, *b*) è¿”å›ž b in a æ£€æµ‹çš„ç»“æžœã€‚ è¯·æ³¨æ„æ“ä½œæ•°æ˜¯ååºçš„ã€‚ operator.countOf(*a*, *b*) è¿”å›ž b åœ¨ a ä¸­çš„å‡ºçŽ°æ¬¡æ•°ã€‚ operator.delitem(*a*, *b*) operator.__delitem__(*a*, *b*) ç§»é™¤ç´¢å¼•å· b ä¸Šçš„å€¼ aã€‚ operator.getitem(*a*, *b*) operator.__getitem__(*a*, *b*) è¿”å›žç´¢å¼•å· b ä¸Šçš„å€¼ aã€‚ operator.indexOf(*a*, *b*) è¿”å›ž b åœ¨ a ä¸­é¦–æ¬¡å‡ºçŽ°æ‰€åœ¨çš„ç´¢å¼•å·ã€‚ operator.setitem(*a*, *b*, *c*) operator.__setitem__(*a*, *b*, *c*) å°†ç´¢å¼•å· b ä¸Šçš„å€¼ a è®¾ä¸º cã€‚ operator.length_hint(*obj*, *default=0*) è¿”å›žå¯¹è±¡ o çš„ä¼°è®¡é•¿åº¦ã€‚ é¦–å…ˆå°è¯•è¿”å›žå…¶å®žé™…é•¿åº¦ï¼Œå†ä½¿ç”¨ object.__length_hint__() å¾—å‡ºä¼°è®¡å€¼ï¼Œæœ€åŽè¿”å›žé»˜è®¤å€¼ã€‚ å·¥å…·operator.attrgetter(*attr*) operator.attrgetter(**attrs*) è¿”å›žä¸€ä¸ªå¯ä»Žæ“ä½œæ•°ä¸­èŽ·å– attr çš„å¯è°ƒç”¨å¯¹è±¡ã€‚ å¦‚æžœè¯·æ±‚äº†ä¸€ä¸ªä»¥ä¸Šçš„å±žæ€§ï¼Œåˆ™è¿”å›žä¸€ä¸ªå±žæ€§å…ƒç»„ã€‚ å±žæ€§åç§°è¿˜å¯åŒ…å«ç‚¹å·ã€‚ ä¾‹å¦‚ï¼š åœ¨ f = attrgetter(&#39;name&#39;) ä¹‹åŽï¼Œè°ƒç”¨ f(b) å°†è¿”å›ž b.nameã€‚ åœ¨ f = attrgetter(&#39;name&#39;, &#39;date&#39;) ä¹‹åŽï¼Œè°ƒç”¨ f(b) å°†è¿”å›ž (b.name, b.date)`ã€‚ åœ¨ f = attrgetter(&#39;name.first&#39;, &#39;name.last&#39;) ä¹‹åŽï¼Œè°ƒç”¨ f(b) å°†è¿”å›ž (b.name.first, b.name.last)`ã€‚ `operator.itemgetter(item) `operator.itemgetter(*items) è¿”å›žä¸€ä¸ªä½¿ç”¨æ“ä½œæ•°çš„ __getitem__() æ–¹æ³•ä»Žæ“ä½œæ•°ä¸­èŽ·å– item çš„å¯è°ƒç”¨å¯¹è±¡ã€‚ å¦‚æžœæŒ‡å®šäº†å¤šä¸ªæ¡ç›®ï¼Œåˆ™è¿”å›žä¸€ä¸ªæŸ¥æ‰¾å€¼çš„å…ƒç»„ã€‚ ä¾‹å¦‚ï¼š åœ¨ f = itemgetter(2) ä¹‹åŽï¼Œè°ƒç”¨ f(r) å°†è¿”å›ž r[2]ã€‚ åœ¨ g = itemgetter(2, 5, 3) ä¹‹åŽï¼Œè°ƒç”¨ g(r) å°†è¿”å›ž (r[2], r[5], r[3])`ã€‚ å°†è¿ç®—ç¬¦æ˜ å°„åˆ°å‡½æ•° è¿ç®— è¯­æ³• å‡½æ•° åŠ æ³• a + b add(a, b) å­—ç¬¦ä¸²æ‹¼æŽ¥ seq1 + seq2 concat(seq1, seq2) åŒ…å«æµ‹è¯• obj in seq contains(seq, obj) é™¤æ³• a / b truediv(a, b) é™¤æ³• a // b floordiv(a, b) æŒ‰ä½ä¸Ž a &amp; b and_(a, b) æŒ‰ä½å¼‚æˆ– a ^ b xor(a, b) æŒ‰ä½å–å ~ a invert(a) æŒ‰ä½æˆ– `a b` or_(a, b) å–å¹‚ a ** b pow(a, b) æ ‡è¯† a is b is_(a, b) æ ‡è¯† a is not b is_not(a, b) ç´¢å¼•èµ‹å€¼ obj[k] = v setitem(obj, k, v) ç´¢å¼•åˆ é™¤ del obj[k] delitem(obj, k) ç´¢å¼•å–å€¼ obj[k] getitem(obj, k) å·¦ç§» a &lt;&lt; b lshift(a, b) å–æ¨¡ a % b mod(a, b) ä¹˜æ³• a * b mul(a, b) çŸ©é˜µä¹˜æ³• a @ b matmul(a, b) å–åï¼ˆç®—æœ¯ï¼‰ - a neg(a) å–åï¼ˆé€»è¾‘ï¼‰ not a not_(a) æ­£æ•° + a pos(a) å³ç§» a &gt;&gt; b rshift(a, b) åˆ‡ç‰‡èµ‹å€¼ seq[i:j] = values setitem(seq, slice(i, j), values) åˆ‡ç‰‡åˆ é™¤ del seq[i:j] delitem(seq, slice(i, j)) åˆ‡ç‰‡å–å€¼ seq[i:j] getitem(seq, slice(i, j)) å­—ç¬¦ä¸²æ ¼å¼åŒ– s % obj mod(s, obj) å‡æ³• a - b sub(a, b) çœŸå€¼æµ‹è¯• obj truth(obj) æ¯”è¾ƒ a &lt; b lt(a, b) æ¯”è¾ƒ a &lt;= b le(a, b) ç›¸ç­‰ a == b eq(a, b) ä¸ç­‰ a != b ne(a, b) æ¯”è¾ƒ a &gt;= b ge(a, b) æ¯”è¾ƒ a &gt; b gt(a, b) åŽŸåœ°è¿ç®—ç¬¦ operator.iadd(*a*, *b*) operator.__iadd__(*a*, *b*) a = iadd(a, b) ç­‰ä»·äºŽ a += bã€‚ operator.iand(*a*, *b*) operator.__iand__(*a*, *b*) a = iand(a, b) ç­‰ä»·äºŽ a &amp;= bã€‚ operator.iconcat(*a*, *b*) operator.__iconcat__(*a*, *b*) a = iconcat(a, b) ç­‰ä»·äºŽ a += b å…¶ä¸­ a å’Œ b ä¸ºåºåˆ—ã€‚ operator.ifloordiv(*a*, *b*) operator.__ifloordiv__(*a*, *b*) a = ifloordiv(a, b) ç­‰ä»·äºŽ a //= bã€‚ operator.ilshift(*a*, *b*) operator.__ilshift__(*a*, *b*) a = ilshift(a, b) ç­‰ä»·äºŽ a &lt;&lt;= bã€‚ operator.imod(*a*, *b*) operator.__imod__(*a*, *b*) a = imod(a, b) ç­‰ä»·äºŽ a %= bã€‚ operator.imul(*a*, *b*) operator.__imul__(*a*, *b*) a = imul(a, b) ç­‰ä»·äºŽ a *= bã€‚ operator.imatmul(*a*, *b*) operator.__imatmul__(*a*, *b*) a = imatmul(a, b) ç­‰ä»·äºŽ a @= bã€‚3.5 æ–°ç‰ˆåŠŸèƒ½. operator.ior(*a*, *b*) operator.__ior__(*a*, *b*) a = ior(a, b) ç­‰ä»·äºŽ a |= bã€‚ operator.ipow(*a*, *b*) operator.__ipow__(*a*, *b*) a = ipow(a, b) ç­‰ä»·äºŽ a **= bã€‚ operator.irshift(*a*, *b*) operator.__irshift__(*a*, *b*) a = irshift(a, b) ç­‰ä»·äºŽ a &gt;&gt;= bã€‚ operator.isub(*a*, *b*) operator.__isub__(*a*, *b*) a = isub(a, b) ç­‰ä»·äºŽ a -= bã€‚ operator.itruediv(*a*, *b*) operator.__itruediv__(*a*, *b*) a = itruediv(a, b) ç­‰ä»·äºŽ a /= bã€‚ operator.ixor(*a*, *b*) operator.__ixor__(*a*, *b*) a = ixor(a, b) ç­‰ä»·äºŽ a ^= bã€‚ å®žä¾‹æœ‹å‹å»ºè®®æˆ‘è¯´,åˆ«å…‰è¯´æ ‡å‡†åº“çš„åŸºæœ¬ä½¿ç”¨,æœ€å¥½æœ‰ä¸€äº›å®žé™…çš„ä¾‹å­,æŽ¥ä¸‹æ¥æˆ‘ä¼šåœ¨æ¯ä¸€ç¯‡åšå®¢çš„æœ€åŽç»™å¤§å®¶ä¸€äº›å®žé™…åº”ç”¨çš„ä¾‹å­ï¼Œæ¬¢è¿Žå¤§å®¶æ‰¹è¯„æŒ‡æ­£ã€‚ ç¨åŽæˆ‘ä¼šåœ¨å¯¹åº”çš„æ–‡ç« ä¸‹é¢å¼€é€šgitalk,å¤§å®¶å¯ä»¥åŠæ—¶ç»™æˆ‘ç•™è¨€ã€‚ å®žçŽ°ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨,ä¸ä½¿ç”¨if else 12345678910111213from operator import *def calculator(a, b, k): return &#123; '+': add, '-': sub, '*': mul, '/': truediv, '**': pow &#125;[k](a, b)calculator(1, 2, '+') # 3calculator(3, 4, '**') # 81]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>operator</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library http.cookies]]></title>
    <url>%2F2020%2F01%2F09%2Fpython-standard-library-http-cookies%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ http.cookiesæœ€è¿‘éœ€è¦æ•™å­©å­è‡ªç„¶æ‹¼è¯»,æ‰€ä»¥æˆ‘æƒ³è¿˜æ˜¯æ¯å¤©ç”¨ä¸€ä¸ªå…³é”®è¯æè¿°å§ã€‚ traffic .n UK /trÃ¦f.Éªk/ US /ËˆtrÃ¦f.Éªk/ äº¤é€š(æ‹¥å µ) There was heavy/a lot of traffic on the roads this morning.ä»Šå¤©æ—©æ™¨é“è·¯ä¸Šè½¦æµé‡å¾ˆå¤§ã€‚ We got stuck in traffic for several hours.æˆ‘ä»¬ç¢°ä¸Šäº¤é€šé˜»å¡žè¢«å µäº†å¥½å‡ ä¸ªå°æ—¶ã€‚ New measures have been introduced to try and ease traffic congestion in the city.è¿™ä¸ªåŸŽå¸‚å·²ç»é‡‡å–äº†æ–°æŽªæ–½ï¼Œè¯•å›¾ç¼“è§£äº¤é€šæ‹¥å µã€‚ Five people were injured in a traffic accident (= one involving vehicles).æœ‰5äººåœ¨äº¤é€šäº‹æ•…ä¸­å—ä¼¤ã€‚ US I heard about the accident on the traffic report on the radio this morning.æˆ‘åœ¨ä»Šæ—©ç”µå°çš„äº¤é€šèŠ‚ç›®ä¸­å¬åˆ°äº†è¿™èµ·äº‹æ•…ã€‚ Air traffic has increased 30 percent in the last decade.åœ¨è¿‡åŽ»çš„10å¹´é‡Œï¼Œç©ºä¸­äº¤é€šé‡å¢žåŠ äº†30%ã€‚ python æ ‡å‡†åº“å­¦ä¹  http.cookieshttp.cookies æ¨¡å—å®šä¹‰äº†ç±»å®žçŽ°äº†httpçŠ¶æ€ç®¡ç†æœºåˆ¶å’Œcookiesæ¦‚å¿µã€‚ä¸ä»…æ”¯æŒå­—ç¬¦ä¸²æ ¼å¼åŒ–çš„cookieå€¼,è¿˜æ”¯æŒä»»ä½•åºåˆ—åŒ–å¯¹è±¡çš„cookieå€¼ã€‚ æ¨¡å—çš„å®žçŽ°å®Œå…¨éµå¾ª RFC 2109 å’Œ RFC 2068 åè®®è§„èŒƒã€‚ä½†MSIE 3.0xä¸éµå¾ªé‚£äº›è§„èŒƒä¸­æ¦‚è¿°çš„å­—ç¬¦è§„åˆ™ï¼Œå¹¶ä¸”å½“æ¶‰åŠCookieå¤„ç†æ—¶ï¼Œè®¸å¤šå½“ä»Šçš„æµè§ˆå™¨å’ŒæœåŠ¡å™¨å·²ç»æ”¾å®½äº†è§£æžè§„åˆ™ã€‚ Cookieåå®šä¹‰å­—ç¬¦é›†ä¸­éžæ³•å­—ç¬¦å›Šæ‹¬åœ¨ string.ascii_letters,string.digits å’Œ !#$%&amp;&#39;*+-.^_|~:`ä¸­ã€‚ æ ¸å¿ƒç±» exception http.cookies.CookieError è¿åRFC 2109 è§„èŒƒä¸­çš„é”™è¯¯,ä¾‹å¦‚:ä¸æ­£ç¡®çš„å±žæ€§æˆ–ä¸æ­£ç¡®çš„Set-Cookies header class http.cookies.BaseCookie([*input*]) è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªå­—å…¸ç±»åž‹çš„å¯¹è±¡,é”®æ˜¯å­—ç¬¦ä¸²,å€¼æ˜¯ Morsel çš„å®žä¾‹ã€‚ å¦‚æžœè®¾ç½®å‚æ•°input,å®žé™…ä¸Šæ˜¯é€šè¿‡load() æ–¹æ³•è®¾ç½®ã€‚ class http.cookies.SimpleCookie([*input*]) è¿™ä¸ªç±»æ˜¯ä»ŽBaseCookie ç»§æ‰¿è¿‡æ¥å¹¶é‡å†™äº† value_decode() and value_encode()æ–¹æ³•ã€‚ SimpleCookiesæ”¯æŒå­—ç¬¦ä¸²æ ¼å¼çš„cookie values. Cookieå¯¹è±¡ BaseCookie.value_decode(val) ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ž ä¸€ä¸ªå…ƒç»„(real_value,coded_value)ã€‚å…¶ä¸­real_valueå¯ä»¥æ˜¯ä»»æ„ç±»åž‹ã€‚æ­¤æ–¹æ³•åœ¨[BaseCookie]ï¼ˆhttps://docs.python.org/zh-cn/3.8/library/http.cookies.html#http.cookies.BaseCookieï¼‰ä¸­ä¸è¿›è¡Œè§£ç ,---å› ä¸ºå·²ç»å­˜åœ¨è¢«é‡å†™äº†ã€‚ BaseCookie.value_encode(val) ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ž ä¸€ä¸ªå…ƒç»„(real_value,coded_value)ã€‚å…¶ä¸­valå¯ä»¥æ˜¯ä»»æ„ç±»åž‹,coded_value é€šå¸¸è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»åž‹ã€‚ BaseCookie.output(*attrs=None*, *header=&#39;Set-Cookie:&#39;*, *sep=&#39;\r\n&#39;*) è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºçš„ ç”¨æ¥é€‚é… Httpè¯·æ±‚å¤´,å±žæ€§çš„ç›¸å…³æ–¹æ³•ã€‚åˆ†éš”ç¬¦é»˜è®¤ä½¿ç”¨\r\nï¼ˆCRLFï¼‰ã€‚ BaseCookie.js_output(*attrs=None*) è¿”å›žä¸€ä¸ªç»‘å®šJavascriptè„šæœ¬çš„å¯¹è±¡,å¦‚æžœè¿è¡Œçš„æµè§ˆå™¨æ”¯æŒJavascriptè„šæœ¬,ä½œä¸ºè¾“å‡ºå’Œ out_put()çš„å®žçŽ°ä¸€æ ·ã€‚ BaseCookie.load(rawdata)` å¦‚æžœå‚æ•°rawdata æ˜¯å­—ç¬¦ä¸²,è½¬åŒ–ä¸º HTTP_COOKIEå¯¹è±¡,å¹¶æ·»åŠ å€¼ã€‚ å¦‚æžœå‚æ•°æ˜¯å­—å…¸ç±»åž‹,å¯ä»¥è¿™æ ·å–å€¼ã€‚ 12for k, v in rawdata.items(): cookie[k] = v Morsel å¯¹è±¡class http.cookies.Morsel éƒ¨åˆ†å®žçŽ°äº† RFC 2109 è§„èŒƒçš„é”®å€¼å¯¹æŠ½è±¡ç±»ã€‚ Morselsæ˜¯ä¸€ä¸ªå­—å…¸ç±»åž‹çš„å¯¹è±¡, é‡Œé¢çš„é”®æ˜¯ä¸€ä¸ªå¸¸é‡,åŒRFC 2109 è§„èŒƒ,å¦‚ä¸‹é¢æ‰€ç¤º: expires path comment domain max-age secure version httponly samesite httponly å±žæ€§å£°æ˜Žäº†cookieåªèƒ½é€šè¿‡HTTP è¯·æ±‚ä¼ è¾“,å¹¶ä¸”åŒ…æ‹¬Javascriptè„šæœ¬ã€‚è¿™å°†ä¼šè¢«åˆå¹¶åˆ°è·¨ç«™è„šæœ¬éƒ¨åˆ†ã€‚ samesite å£°æ˜Žäº†æµè§ˆå™¨æ˜¯å¦å…è®¸å‘é€è·¨ç«™è¯·æ±‚çš„cookieã€‚è¿™å°†ä¼šé¿å…CSRF æ”»å‡»ã€‚æ— æ•ˆçš„å€¼åŒ…æ‹¬ â€œStrictâ€ and â€œLaxâ€ã€‚ è¿™äº›é”®æ˜¯å¤§å°å†™æ•æ„Ÿçš„.é»˜è®¤å€¼æ˜¯&#39;&#39;. Morsel.value Cookieçš„å€¼ã€‚ Morsel.coded_valueç¼–ç åŽçš„cookieå€¼ã€‚ Morsel.key cookieçš„åå­— Morsel.set(key, value, coded_value) è®¾ç½®key ,valueå’Œ coded_value* attributes å±žæ€§ã€‚ Morsel.isReservedKey(*K*) åˆ¤æ–­ é”® çŸ¥å¦æ˜¯ Morsel é‡Œçš„é”®çš„æˆå‘˜ã€‚ Morsel.output(*attrs=None*, *header=&#39;Set-Cookie:&#39;*) è¿”å›žå­—ç¬¦ä¸²æ ¼å¼çš„ Morsel ã€‚é»˜è®¤åŒ…æ‹¬æ‰€æœ‰çš„å±žæ€§,é™¤éžæŒ‡å®šå£°æ˜Žattrs å±žæ€§,header å‚æ•°é»˜è®¤å€¼æ˜¯&quot;Set-Cookie:&quot;. Morsel.js_output(*attrs=None*) è¿”å›žä¸€ä¸ªç»‘å®šJavascriptè„šæœ¬çš„å¯¹è±¡,å¦‚æžœè¿è¡Œçš„æµè§ˆå™¨æ”¯æŒJavascriptè„šæœ¬,ä½œä¸ºè¾“å‡ºå’Œ out_put()çš„å®žçŽ°ä¸€æ ·ã€‚ Morsel.OutputString(*attrs=None*) è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼çš„ Morsel,ä¸åŒ…æ‹¬Httpæˆ–Javascriptã€‚ Morsel.update(*values*) æ ¹æ®å‚æ•°å€¼æ›´æ–°Morsel å­—å…¸ã€‚å¦‚æžœå‚æ•°ä¸åœ¨å­—å…¸ä¸­åˆ™å¼•å‘å¼‚å¸¸ã€‚å…·ä½“å¯ä»¥å‚è€ƒ RFC 2109 Morsel.copy(*value*) è¿”å›žä¸€ä¸ª Morsel å¯¹è±¡çš„æµ…æ‹·è´ã€‚ Morsel.setdefault(*key*, *value=None*) Raise an error if key is not a valid RFC 2109 attribute, otherwise behave the same as dict.setdefault(). å®žä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445&gt;&gt;&gt; from http import cookies&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C["fig"] = "newton"&gt;&gt;&gt; C["sugar"] = "wafer"&gt;&gt;&gt; print(C) # generate HTTP headersSet-Cookie: fig=newtonSet-Cookie: sugar=wafer&gt;&gt;&gt; print(C.output()) # same thingSet-Cookie: fig=newtonSet-Cookie: sugar=wafer&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C["rocky"] = "road"&gt;&gt;&gt; C["rocky"]["path"] = "/cookie"&gt;&gt;&gt; print(C.output(header="Cookie:"))Cookie: rocky=road; Path=/cookie&gt;&gt;&gt; print(C.output(attrs=[], header="Cookie:"))Cookie: rocky=road&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C.load("chips=ahoy; vienna=finger") # load from a string (HTTP header)&gt;&gt;&gt; print(C)Set-Cookie: chips=ahoySet-Cookie: vienna=finger&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C.load('keebler="E=everybody; L=\\"Loves\\"; fudge=\\012;";')&gt;&gt;&gt; print(C)Set-Cookie: keebler="E=everybody; L=\"Loves\"; fudge=\012;"&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C["oreo"] = "doublestuff"&gt;&gt;&gt; C["oreo"]["path"] = "/"&gt;&gt;&gt; print(C)Set-Cookie: oreo=doublestuff; Path=/&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C["twix"] = "none for you"&gt;&gt;&gt; C["twix"].value'none for you'&gt;&gt;&gt; C = cookies.SimpleCookie()&gt;&gt;&gt; C["number"] = 7 # equivalent to C["number"] = str(7)&gt;&gt;&gt; C["string"] = "seven"&gt;&gt;&gt; C["number"].value'7'&gt;&gt;&gt; C["string"].value'seven'&gt;&gt;&gt; print(C)Set-Cookie: number=7Set-Cookie: string=seven å°ç»“é¡ºä¾¿äº†è§£äº†ä¸‹httpåè®®çš„ç›¸å…³å†…å®¹,é™„é“¾æŽ¥ã€‚ RFC 2068 ï¼šhttpè¶…æ–‡æœ¬ä¼ è¾“åè®®1.0 RFC 2616 ï¼šhttpè¶…æ–‡æœ¬ä¼ è¾“åè®®1.1 RFC 2109: httpçŠ¶æ€ç®¡ç†æœºåˆ¶]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>http</tag>
        <tag>cookies</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library http]]></title>
    <url>%2F2020%2F01%2F08%2Fpython-standard-library-http%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ä¹‹ http å±±é›¨æ¬²æ¥é£Žæ»¡æ¥¼,æœ€è¿‘ä¸æ˜¯å¾ˆå¤ªå¹³,å¸Œæœ›ä¸–ç•Œå’Œå¹³å§ã€‚ python æ ‡å‡†åº“å­¦ä¹  ä¹‹ httphttp æ˜¯ä¸€ä¸ªåŒ…ï¼Œå®ƒæ”¶é›†äº†å¤šä¸ªç”¨äºŽå¤„ç†è¶…æ–‡æœ¬ä¼ è¾“åè®®çš„æ¨¡å—: å‚è€ƒæ–‡æ¡£ http.client æ˜¯ä¸€ä¸ªä½Žå±‚çº§çš„ HTTP åè®®å®¢æˆ·ç«¯ï¼›å¯¹äºŽé«˜å±‚çº§çš„ URL è®¿é—®è¯·ä½¿ç”¨ urllib.request http.server åŒ…å«åŸºäºŽ socketserver çš„åŸºæœ¬ HTTP æœåŠ¡ç±» http.cookies åŒ…å«ä¸€äº›æœ‰ç”¨æ¥å®žçŽ°é€šè¿‡ cookies è¿›è¡ŒçŠ¶æ€ç®¡ç†çš„å·¥å…· http.cookiejar æä¾›äº† cookies çš„æŒä¹…åŒ– æœ¬æ¬¡åªæ•´ç† http.clientçš„å†…å®¹,åŽé¢æŒç»­æ›´æ–°ã€‚ å¸¸é‡class http.HTTPStatus ä½¿ç”¨æ–¹æ³•ï¼š 12345678910111213&gt;&gt;&gt; from http import HTTPStatus&gt;&gt;&gt; HTTPStatus.OK&lt;HTTPStatus.OK: 200&gt;&gt;&gt;&gt; HTTPStatus.OK == 200True&gt;&gt;&gt; HTTPStatus.OK.value200&gt;&gt;&gt; HTTPStatus.OK.phrase'OK'&gt;&gt;&gt; HTTPStatus.OK.description'Request fulfilled, document follows'&gt;&gt;&gt; list(HTTPStatus)[&lt;HTTPStatus.CONTINUE: 100&gt;, &lt;HTTPStatus.SWITCHING_PROTOCOLS: 101&gt;, ...] HTTPçŠ¶æ€ç  çŠ¶æ€ç  æ˜ å°„å è¯¦æƒ… 100 CONTINUE HTTP/1.1 RFC 7231, 6.2.1 èŠ‚ 101 SWITCHING_PROTOCOLS HTTP/1.1 RFC 7231, 6.2.2 èŠ‚ 102 PROCESSING WebDAV RFC 2518, 10.1 èŠ‚ 200 OK HTTP/1.1 RFC 7231, 6.3.1 èŠ‚ 201 CREATED HTTP/1.1 RFC 7231, 6.3.2 èŠ‚ 202 ACCEPTED HTTP/1.1 RFC 7231, 6.3.3 èŠ‚ 203 NON_AUTHORITATIVE_INFORMATION HTTP/1.1 RFC 7231, 6.3.4 èŠ‚ 204 NO_CONTENT HTTP/1.1 RFC 7231, 6.3.5 èŠ‚ 205 RESET_CONTENT HTTP/1.1 RFC 7231, 6.3.6 èŠ‚ 206 PARTIAL_CONTENT HTTP/1.1 RFC 7233, 4.1 èŠ‚ 207 MULTI_STATUS WebDAV RFC 4918, 11.1 èŠ‚ 208 ALREADY_REPORTED WebDAV Binding Extensions RFC 5842, 7.1 èŠ‚ï¼ˆå®žéªŒæ€§ï¼‰ 226 IM_USED Delta Encoding in HTTP RFC 3229, 10.4.1 èŠ‚ 300 MULTIPLE_CHOICESï¼šæœ‰å¤šç§èµ„æºå¯é€‰æ‹© HTTP/1.1 RFC 7231, 6.4.1 èŠ‚ 301 MOVED_PERMANENTLYï¼šæ°¸ä¹…ç§»åŠ¨ HTTP/1.1 RFC 7231, 6.4.2 èŠ‚ 302 FOUNDï¼šä¸´æ—¶ç§»åŠ¨ HTTP/1.1 RFC 7231, 6.4.3 èŠ‚ 303 SEE_OTHERï¼šå·²ç»ç§»åŠ¨ HTTP/1.1 RFC 7231, 6.4.4 èŠ‚ 304 NOT_MODIFIEDï¼šæ²¡æœ‰ä¿®æ”¹ HTTP/1.1 RFC 7232, 4.1 èŠ‚ 305 USE_PROXYï¼šä½¿ç”¨ä»£ç† HTTP/1.1 RFC 7231, 6.4.5 èŠ‚ 307 TEMPORARY_REDIRECTï¼šä¸´æ—¶é‡å®šå‘ HTTP/1.1 RFC 7231, 6.4.7 èŠ‚ 308 PERMANENT_REDIRECTï¼šæ°¸ä¹…é‡å®šå‘ Permanent Redirect RFC 7238, Section 3 (Experimental) 400 BAD_REQUESTï¼šé”™è¯¯è¯·æ±‚ HTTP/1.1 RFC 7231, 6.5.1 èŠ‚ 401 UNAUTHORIZEDï¼šæœªæŽˆæƒ HTTP/1.1 Authentication RFC 7235, 3.1 èŠ‚ 402 PAYMENT_REQUIREDï¼šä¿ç•™ï¼Œå°†æ¥ä½¿ç”¨ HTTP/1.1 RFC 7231, 6.5.2 èŠ‚ 403 FORBIDDENï¼šç¦æ­¢ HTTP/1.1 RFC 7231, 6.5.3 èŠ‚ 404 NOT_FOUNDï¼šæ²¡æœ‰æ‰¾åˆ° HTTP/1.1 RFC 7231, 6.5.4 èŠ‚ 405 METHOD_NOT_ALLOWEDï¼šè¯¥è¯·æ±‚æ–¹æ³•ä¸å…è®¸ HTTP/1.1 RFC 7231, 6.5.5 èŠ‚ 406 NOT_ACCEPTABLEï¼šä¸å¯æŽ¥å— HTTP/1.1 RFC 7231, 6.5.6 èŠ‚ 407 PROXY_AUTHENTICATION_REQUIREDï¼šè¦æ±‚ä½¿ç”¨ä»£ç†éªŒè¯èº«ä»½ HTTP/1.1 Authentication RFC 7235, 3.1 èŠ‚ 408 REQUEST_TIMEOUTï¼šè¯·æ±‚è¶…æ—¶ HTTP/1.1 RFC 7231, 6.5.7 èŠ‚ 409 CONFLICTï¼šå†²çª HTTP/1.1 RFC 7231, 6.5.8 èŠ‚ 410 GONEï¼šå·²ç»ä¸åœ¨äº† HTTP/1.1 RFC 7231, 6.5.9 èŠ‚ 411 LENGTH_REQUIREDï¼šé•¿åº¦è¦æ±‚ HTTP/1.1 RFC 7231, 6.5.10 èŠ‚ 412 PRECONDITION_FAILEDï¼šå‰ææ¡ä»¶é”™è¯¯ HTTP/1.1 RFC 7232, 4.2 èŠ‚ 413 REQUEST_ENTITY_TOO_LARGEï¼šè¯·æ±‚ä½“å¤ªå¤§äº† HTTP/1.1 RFC 7231, 6.5.11 èŠ‚ 414 REQUEST_URI_TOO_LONGï¼šè¯·æ±‚URIå¤ªé•¿äº† HTTP/1.1 RFC 7231, 6.5.12 èŠ‚ 415 UNSUPPORTED_MEDIA_TYPEï¼šä¸æ”¯æŒçš„åª’ä½“æ ¼å¼ HTTP/1.1 RFC 7231, 6.5.13 èŠ‚ 416 REQUESTED_RANGE_NOT_SATISFIABLE HTTP/1.1 Range Requests RFC 7233, 4.4 èŠ‚ 417 EXPECTATION_FAILEDï¼šæœŸæœ›å¤±è´¥ HTTP/1.1 RFC 7231, 6.5.14 èŠ‚ 421 MISDIRECTED_REQUEST HTTP/2 RFC 7540, 9.1.2 èŠ‚ 422 UNPROCESSABLE_ENTITYï¼šå¯åŠ å·¥å®žä½“ WebDAV RFC 4918, 11.2 èŠ‚ 423 LOCKEDï¼šé”ç€ WebDAV RFC 4918, 11.3 èŠ‚ 424 FAILED_DEPENDENCYï¼šå¤±è´¥çš„ä¾èµ– WebDAV RFC 4918, 11.4 èŠ‚ 426 UPGRADE_REQUIREDï¼šå‡çº§éœ€è¦ HTTP/1.1 RFC 7231, 6.5.15 èŠ‚ 428 PRECONDITION_REQUIREDï¼šå…ˆå†³æ¡ä»¶è¦æ±‚ Additional HTTP Status Codes RFC 6585 429 TOO_MANY_REQUESTSï¼šå¤ªå¤šçš„è¯·æ±‚ Additional HTTP Status Codes RFC 6585 431 REQUEST_HEADER_FIELDS_TOO_LARGEï¼šè¯·æ±‚å¤´å¤ªå¤§ Additional HTTP Status Codes RFC 6585 451 UNAVAILABLE_FOR_LEGAL_REASONS HTTP çŠ¶æ€ç ç”¨äºŽæŠ¥å‘Šæ³•å¾‹éšœç¢ RFC 7725 500 INTERNAL_SERVER_ERRORï¼šå†…éƒ¨æœåŠ¡é”™è¯¯ HTTP/1.1 RFC 7231, 6.6.1 èŠ‚ 501 NOT_IMPLEMENTEDï¼šä¸å¯æ‰§è¡Œ HTTP/1.1 RFC 7231, 6.6.2 èŠ‚ 502 BAD_GATEWAYï¼šæ— æ•ˆç½‘å…³ HTTP/1.1 RFC 7231, 6.6.3 èŠ‚ 503 SERVICE_UNAVAILABLEï¼šæœåŠ¡ä¸å¯ç”¨ HTTP/1.1 RFC 7231, 6.6.4 èŠ‚ 504 GATEWAY_TIMEOUTï¼šç½‘å…³è¶…æ—¶ HTTP/1.1 RFC 7231, 6.6.5 èŠ‚ 505 HTTP_VERSION_NOT_SUPPORTEDï¼šHTTPç‰ˆæœ¬ä¸æ”¯æŒ HTTP/1.1 RFC 7231, 6.6.6 èŠ‚ 506 VARIANT_ALSO_NEGOTIATESï¼šæœåŠ¡å™¨å­˜åœ¨å†…éƒ¨é…ç½®é”™è¯¯ é€æ˜Žå†…å®¹åå•†åœ¨ï¼š HTTP RFC 2295, 8.1 èŠ‚ï¼ˆå®žéªŒæ€§ï¼‰ 507 INSUFFICIENT_STORAGEï¼šå­˜å‚¨ä¸è¶³ WebDAV RFC 4918, 11.5 èŠ‚ 508 LOOP_DETECTEDï¼šå¾ªçŽ¯æ£€æµ‹ WebDAV Binding Extensions RFC 5842, 7.2 èŠ‚ï¼ˆå®žéªŒæ€§ï¼‰ 510 NOT_EXTENDEDï¼šä¸æ‰©å±• WebDAV Binding Extensions RFC 5842, 7.2 èŠ‚ï¼ˆå®žéªŒæ€§ï¼‰ 511 NETWORK_AUTHENTICATION_REQUIREDï¼šè¦æ±‚ç½‘ç»œèº«ä»½éªŒè¯ Additional HTTP Status Codes RFC 6585, 6 èŠ‚ ä¸ºäº†ä¿æŒå‘åŽå…¼å®¹æ€§ï¼Œæžšä¸¾å€¼ä¹Ÿä»¥å¸¸é‡å½¢å¼å‡ºçŽ°åœ¨ http.client æ¨¡å—ä¸­ï¼Œã€‚ æžšä¸¾åç­‰äºŽå¸¸é‡å (ä¾‹å¦‚ http.HTTPStatus.OK ä¹Ÿå¯ä»¥æ˜¯ http.client.OK)ã€‚ http.client å¯¹è±¡è¿™ä¸ªæ¨¡å—å®šä¹‰äº†å®žçŽ° HTTP å’Œ HTTPS åè®®å®¢æˆ·ç«¯çš„ç±»ã€‚ å®ƒé€šå¸¸ä¸ç›´æŽ¥ä½¿ç”¨ â€” æ¨¡å— urllib.request ç”¨å®ƒæ¥å¤„ç†ä½¿ç”¨ HTTP å’Œ HTTPS çš„ URLã€‚ å‚è§ The Requests æ˜¯ä¸€ä¸ªé«˜çº§çš„å®žçŽ°httpåè®®çš„httpå®¢æˆ·ç«¯æŽ¥å£åº“. æ³¨æ„: HTTPS æ”¯æŒä»…åœ¨ç¼–è¯‘ Python æ—¶å¯ç”¨äº† SSL æ”¯æŒçš„æƒ…å†µä¸‹ï¼ˆé€šè¿‡ ssl æ¨¡å—ï¼‰å¯ç”¨ã€‚ å¼ºçƒˆå»ºè®®çœ‹æºä»£ç  Lib/http/client.py æˆ‘æ‘˜å–å…¶ä¸­å…³äºŽhttpè¯·æ±‚çŠ¶æ€çš„æè¿° 12345678910111213141516171819202122232425262728293031323334 (null) | | HTTPConnection() v Idle | | putrequest() v Request-started | | ( putheader() )* endheaders() v Request-sent |\_____________________________ | | getresponse() raises | response = getresponse() | ConnectionError v v Unread-response Idle [Response-headers-read] |\____________________ | | | response.read() | putrequest() v v Idle Req-started-unread-response ______/| / |response.read() | | ( putheader() )* endheaders() v v Request-started Req-sent-unread-response | | response.read() v Request-sent ç±» class http.client.HTTPConnection(*host*, *port=None*, [*timeout*, ]*source_address=None*, *blocksize=8192*) HTTPConnection çš„å®žä¾‹ä»£è¡¨ä¸Ž HTTP çš„ä¸€ä¸ªè¿žæŽ¥äº‹åŠ¡ã€‚ å®ƒçš„å®žä¾‹åŒ–åº”å½“ä¼ å…¥ä¸€ä¸ªä¸»æœºå’Œå¯é€‰çš„ç«¯å£å·ã€‚ å¦‚æžœæ²¡æœ‰ä¼ å…¥ç«¯å£å·ï¼Œå¦‚æžœä¸»æœºå­—ç¬¦ä¸²çš„å½¢å¼ä¸º ä¸»æœº:ç«¯å£ åˆ™ä¼šä»Žä¸­æå–ç«¯å£ï¼Œå¦åˆ™å°†ä½¿ç”¨é»˜è®¤çš„ HTTP ç«¯å£ï¼ˆ80ï¼‰ã€‚ å¦‚æžœç»™å‡ºäº†å¯é€‰çš„ timeout å‚æ•°ï¼Œåˆ™é˜»å¡žæ“ä½œï¼ˆä¾‹å¦‚è¿žæŽ¥å°è¯•ï¼‰å°†åœ¨æŒ‡å®šçš„ç§’æ•°ä¹‹åŽè¶…æ—¶ï¼ˆå¦‚æžœæœªç»™å‡ºï¼Œåˆ™ä½¿ç”¨å…¨å±€é»˜è®¤è¶…æ—¶è®¾ç½®ï¼‰ã€‚ å¯é€‰çš„ source_address å‚æ•°å¯ä»¥ä¸ºä¸€ä¸ª (ä¸»æœº, ç«¯å£) å…ƒç»„ï¼Œç”¨ä½œè¿›è¡Œ HTTP è¿žæŽ¥çš„æºåœ°å€ã€‚ å¯é€‰çš„ blocksize å‚æ•°å¯ä»¥å­—èŠ‚ä¸ºå•ä½è®¾ç½®ç¼“å†²åŒºçš„å¤§å°ï¼Œç”¨æ¥å‘é€æ–‡ä»¶ç±»æ¶ˆæ¯ä½“ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œä»¥ä¸‹è°ƒç”¨éƒ½æ˜¯åˆ›å»ºè¿žæŽ¥åˆ°åŒä¸€ä¸»æœºå’Œç«¯å£çš„æœåŠ¡å™¨çš„å®žä¾‹ï¼š 1234&gt;&gt;&gt; h1 = http.client.HTTPConnection('www.python.org')&gt;&gt;&gt; h2 = http.client.HTTPConnection('www.python.org:80')&gt;&gt;&gt; h3 = http.client.HTTPConnection('www.python.org', 80)&gt;&gt;&gt; h4 = http.client.HTTPConnection('www.python.org', 80, timeout=10) `class http.client.HTTPSConnection(host, port=None, key_file=None, cert_file=None, [timeout, ]source_address=None, **, context=None, check_hostname=None, blocksize=8192*)Â¶ HTTPConnection çš„å­ç±»ï¼Œä½¿ç”¨ SSL ä¸Žå®‰å…¨æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚ é»˜è®¤ç«¯å£ä¸º 443ã€‚ å¦‚æžœæŒ‡å®šäº† contextï¼Œå®ƒå¿…é¡»ä¸ºä¸€ä¸ªæè¿° SSL å„é€‰é¡¹çš„ ssl.SSLContext å®žä¾‹ã€‚ class http.client.`HTTPResponse`(sock, debuglevel=0, method=None, url=None) åœ¨æˆåŠŸè¿žæŽ¥åŽè¿”å›žç±»çš„å®žä¾‹ï¼Œè€Œä¸æ˜¯ç”±ç”¨æˆ·ç›´æŽ¥å®žä¾‹åŒ–ã€‚ å¼‚å¸¸ exception http.client.`HTTPException` æ­¤æ¨¡å—ä¸­å…¶ä»–å¼‚å¸¸çš„åŸºç±»ã€‚ å®ƒæ˜¯ Exception çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`NotConnected` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`InvalidURL` HTTPException çš„ä¸€ä¸ªå­ç±»ï¼Œå¦‚æžœç»™å‡ºäº†ä¸€ä¸ªéžæ•°å­—æˆ–ä¸ºç©ºå€¼çš„ç«¯å£å°±ä¼šè¢«å¼•å‘ã€‚ exception http.client.`UnknownProtocol` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`UnknownTransferEncoding` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`UnimplementedFileMode` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`IncompleteRead` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`ImproperConnectionState` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`CannotSendRequest` ImproperConnectionState çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`CannotSendHeader` ImproperConnectionState çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`ResponseNotReady` ImproperConnectionState çš„ä¸€ä¸ªå­ç±»ã€‚ exception http.client.`BadStatusLine` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ å¦‚æžœæœåŠ¡å™¨åé¦ˆäº†ä¸€ä¸ªæˆ‘ä»¬ä¸ç†è§£çš„ HTTP çŠ¶æ€ç å°±ä¼šè¢«å¼•å‘ã€‚ exception http.client.`LineTooLong` HTTPException çš„ä¸€ä¸ªå­ç±»ã€‚ å¦‚æžœåœ¨ HTTP åè®®ä¸­ä»ŽæœåŠ¡å™¨æŽ¥æ”¶åˆ°è¿‡é•¿çš„è¡Œå°±ä¼šè¢«å¼•å‘ã€‚ exception http.client.`RemoteDisconnected` ConnectionResetError å’Œ BadStatusLine çš„ä¸€ä¸ªå­ç±»ã€‚ å½“å°è¯•è¯»å–å“åº”æ—¶çš„ç»“æžœæ˜¯æœªä»Žè¿žæŽ¥è¯»å–åˆ°æ•°æ®æ—¶ç”± HTTPConnection.getresponse() å¼•å‘ï¼Œè¡¨æ˜Žè¿œç«¯å·²å…³é—­è¿žæŽ¥ã€‚ å¸¸é‡ http.client.`HTTP_PORT` HTTP åè®®é»˜è®¤çš„ç«¯å£å· (æ€»æ˜¯ 80)ã€‚ http.client.`HTTPS_PORT` HTTPS åè®®é»˜è®¤çš„ç«¯å£å· (æ€»æ˜¯ 443)ã€‚ http.client.`responses` è¿™ä¸ªå­—å…¸æŠŠ HTTP 1.1 çŠ¶æ€ç æ˜ å°„åˆ° W3C åç§°ã€‚ä¾‹å¦‚ï¼šhttp.client.responses[http.client.NOT_FOUND] æ˜¯ &#39;NOT FOUND ï¼ˆæœªå‘çŽ°ï¼‰ã€‚ HTTPConnection å¯¹è±¡æ–¹æ³• HTTPConnection.request(method, url, body=None, headers={}, , encode_chunked=False*) è¿™ä¼šä½¿ç”¨ HTTP è¯·æ±‚æ–¹æ³• method å’Œé€‰æ‹©å™¨ url å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚ å¦‚æžœç»™å®š bodyï¼Œé‚£ä¹ˆç»™å®šçš„æ•°æ®ä¼šåœ¨ä¿¡æ¯å¤´å®Œæˆä¹‹åŽå‘é€ã€‚å®ƒå¯èƒ½æ˜¯ä¸€ä¸ª str ã€ä¸€ä¸ª bytes-like object ã€ä¸€ä¸ªæ‰“å¼€çš„ file objectï¼Œæˆ–è€… bytes è¿­ä»£å™¨ã€‚å¦‚æžœ body æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä¼šæŒ‰ HTTP é»˜è®¤çš„ ISO-8859-1 ç¼–ç ï¼›å¦‚æžœæ˜¯ä¸€ä¸ªå­—èŠ‚ç±»å¯¹è±¡ï¼Œå®ƒä¼šæŒ‰åŽŸæ ·å‘é€ï¼›å¦‚æžœæ˜¯ file object ï¼Œæ–‡ä»¶çš„å†…å®¹ä¼šè¢«å‘é€ï¼Œè¿™ä¸ªæ–‡ä»¶å¯¹è±¡åº”è¯¥æ”¯æŒ read() æ–¹æ³•ã€‚å¦‚æžœè¿™ä¸ªæ–‡ä»¶å¯¹è±¡æ˜¯ä¸€ä¸ª io.TextIOBase å®žä¾‹ï¼Œ read() æ–¹æ³•è¿”å›žçš„æ•°æ®ä¼šæŒ‰ ISO-8859-1 ç¼–ç ï¼Œå¦åˆ™ read() æ–¹æ³•è¿”å›žçš„æ•°æ®ä¼šæŒ‰åŽŸæ ·å‘é€ï¼›å¦‚æžœ body æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨ä¸­çš„å…ƒç´ ä¼šè¢«å‘é€ï¼Œç›´åˆ°è¿­ä»£å™¨è€—å°½ã€‚ headers å‚æ•°åº”æ˜¯é¢å¤–çš„éšè¯·æ±‚å‘é€çš„ HTTP ä¿¡æ¯å¤´çš„å­—å…¸ã€‚ å¦‚æžœ headers æ—¢ä¸åŒ…å« Content-Length ä¹Ÿæ²¡æœ‰ Transfer-Encodingï¼Œä½†å­˜åœ¨è¯·æ±‚æ­£æ–‡ï¼Œé‚£ä¹ˆè¿™äº›å¤´å­—æ®µä¸­çš„ä¸€ä¸ªä¼šè‡ªåŠ¨è®¾å®šã€‚å¦‚æžœ body æ˜¯ Noneï¼Œé‚£ä¹ˆå¯¹äºŽè¦æ±‚æ­£æ–‡çš„æ–¹æ³• (PUTï¼ŒPOSTï¼Œå’Œ PATCH)ï¼ŒContent-Length å¤´ä¼šè¢«è®¾ä¸º 0ã€‚å¦‚æžœ body æ˜¯å­—ç¬¦ä¸²æˆ–è€…ç±»ä¼¼å­—èŠ‚çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¹Ÿä¸æ˜¯ æ–‡ä»¶ï¼ŒContent-Length å¤´ä¼šè®¾ä¸ºæ­£æ–‡çš„é•¿åº¦ã€‚ä»»ä½•å…¶ä»–ç±»åž‹çš„ body ï¼ˆä¸€èˆ¬æ˜¯æ–‡ä»¶æˆ–è¿­ä»£å™¨ï¼‰ä¼šæŒ‰å—ç¼–ç ï¼Œè¿™æ—¶ä¼šè‡ªåŠ¨è®¾å®š Transfer-Encoding å¤´ä»¥ä»£æ›¿ Content-Lengthã€‚ åœ¨ headers ä¸­æŒ‡å®š Transfer-Encoding æ—¶ï¼Œ encode_chunked æ˜¯å”¯ä¸€ç›¸å…³çš„å‚æ•°ã€‚å¦‚æžœ encode_chunked ä¸º Falseï¼ŒHTTPConnection å¯¹è±¡ä¼šå‡å®šæ‰€æœ‰çš„ç¼–ç éƒ½ç”±è°ƒç”¨ä»£ç å¤„ç†ã€‚å¦‚æžœä¸º Trueï¼Œæ­£æ–‡ä¼šæŒ‰å—ç¼–ç ã€‚ HTTPConnection.`set_debuglevel`(level) è®¾ç½®è°ƒè¯•ç­‰çº§ã€‚ é»˜è®¤çš„è°ƒè¯•ç­‰çº§ä¸º 0ï¼Œæ„å‘³ç€ä¸ä¼šæ‰“å°è°ƒè¯•è¾“å‡ºã€‚ ä»»ä½•å¤§äºŽ 0 çš„å€¼å°†ä½¿å¾—æ‰€æœ‰å½“å‰å®šä¹‰çš„è°ƒè¯•è¾“å‡ºè¢«æ‰“å°åˆ° stdoutã€‚ debuglevel ä¼šè¢«ä¼ ç»™ä»»ä½•æ–°åˆ›å»ºçš„ HTTPResponse å¯¹è±¡ã€‚ HTTPConnection.`set_tunnel`(host, port=None, headers=None) ä¸º HTTP è¿žæŽ¥éš§é“è®¾ç½®ä¸»æœºå’Œç«¯å£ã€‚ è¿™å°†å…è®¸é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿è¡Œè¿žæŽ¥ã€‚ host å’Œ port å‚æ•°æŒ‡æ˜Žéš§é“è¿žæŽ¥çš„ä½ç½®ï¼ˆå³ CONNECT è¯·æ±‚æ‰€åŒ…å«çš„åœ°å€ï¼Œè€Œ ä¸æ˜¯ ä»£ç†æœåŠ¡å™¨çš„åœ°å€ï¼‰ã€‚ headers å‚æ•°åº”ä¸ºä¸€ä¸ªéš CONNECT è¯·æ±‚å‘é€çš„é¢å¤– HTTP æ ‡å¤´çš„æ˜ å°„ã€‚ ä¾‹å¦‚ï¼Œè¦é€šè¿‡ä¸€ä¸ªè¿è¡ŒäºŽæœ¬æœº 8080 ç«¯å£çš„ HTTPS ä»£ç†æœåŠ¡å™¨éš§é“ï¼Œæˆ‘ä»¬åº”å½“å‘ HTTPSConnection æž„é€ å™¨ä¼ å…¥ä»£ç†çš„åœ°å€ï¼Œå¹¶å°†æˆ‘ä»¬æœ€ç»ˆæƒ³è¦è®¿é—®çš„ä¸»æœºåœ°å€ä¼ ç»™ set_tunnel() æ–¹æ³•: 1234&gt;&gt;&gt; import http.client&gt;&gt;&gt; conn = http.client.HTTPSConnection("localhost", 8080)&gt;&gt;&gt; conn.set_tunnel("www.python.org")&gt;&gt;&gt; conn.request("HEAD","/index.html") HTTPConnection.connect() å½“å¯¹è±¡è¢«åˆ›å»ºåŽè¿žæŽ¥åˆ°æŒ‡å®šçš„æœåŠ¡å™¨ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æžœå®¢æˆ·ç«¯è¿˜æœªå»ºç«‹è¿žæŽ¥ï¼Œæ­¤å‡½æ•°ä¼šåœ¨å‘é€è¯·æ±‚æ—¶è‡ªåŠ¨è¢«è°ƒç”¨ã€‚ HTTPConnection.close() å…³é—­åˆ°æœåŠ¡å™¨çš„è¿žæŽ¥ã€‚ HTTPConnection.blocksize ç”¨äºŽå‘é€æ–‡ä»¶ç±»æ¶ˆæ¯ä½“çš„ç¼“å†²åŒºå¤§å°ã€‚ HTTPConnection.send(data) å‘é€æ•°æ®åˆ°æœåŠ¡å™¨ ã€‚è¿™ä¸ªæ–¹æ³•ç›´æŽ¥ä½¿ç”¨å°†ä¼šåœ¨endheaders()æ–¹æ³•åŽå’Œ getresponse() æ–¹æ³•è°ƒç”¨ä¹‹å‰è¢«è°ƒç”¨ HTTPResponse å¯¹è±¡HTTPResponse å¯¹è±¡å®žä¾‹ç»‘å®šä»ŽæœåŠ¡å™¨è¿”å›žçš„ Http response å†…å®¹ã€‚ responseæ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡,å¯ä»¥ä½¿ç”¨withä¸Šä¸‹æ–‡è¯­å¥æ¥ç®¡ç†ã€‚ æ–¹æ³• HTTPResponse.read([amt]) è¯»å–å¹¶è¿”å›žresponse body HTTPResponse.`readinto`(b) è¯»å–ä»Ž response body çš„bé•¿åº¦çš„å­—èŠ‚æ”¾åˆ° buffer bä¸­ï¼Œå¹¶è¿”å›žè¿™ä¸ªå­—èŠ‚bã€‚ HTTPResponse.getheader(name, default=None) å¦‚æžœæœ‰åŒ¹é…çš„header name,åˆ™è¿”å›ž header nameçš„å€¼ã€‚å¦‚æžœä¸æ­¢ä¸€ä¸ªheader nameçš„åå­—ï¼Œåˆ™è¿”å›žæ‰€æœ‰çš„å€¼çš„å­—ç¬¦ä¸²,é€šè¿‡é€—å·è¿žæŽ¥ã€‚ HTTPResponse.getheaders() è¿”å›žä¸€ä¸ªåŒ…å«headerå’Œvalueçš„å…ƒç»„å…ƒç´ çš„åˆ—è¡¨ HTTPResponse.fileno() Return the fileno of the underlying socket. è¿”å›žåº•å±‚å¥—æŽ¥å­—çš„fileno HTTPResponse.msg ä¸€ä¸ªhttp.client.HTTPMessage æ¶ˆæ¯çš„å®žä¾‹,åŒ…å«response headerã€‚ http.client.HTTPMessage æ˜¯ email.message.Messageçš„å­ç±» HTTPResponse.version Http responseç‰ˆæœ¬å·,ä¾‹å¦‚ HTTP/1.0, 11 for HTTP/1.1. HTTPResponse.`status` ç”±æœåŠ¡å™¨è¿”å›žçš„çŠ¶æ€ç ã€‚ HTTPResponse.reason ä»ŽæœåŠ¡å™¨è¿”å›žçš„çŠ¶æ€ç  HTTPResponse.debuglevel ä¸€ä¸ª debugging hook. å¦‚æžœ debuglevel å¤§äºŽ0, æ¶ˆæ¯å°†ä¼šè¢«æ‰“å°åˆ°æŽ§åˆ¶å°ã€‚ HTTPResponse.closed å¦‚æžœstreamå…³é—­,è¿”å›žtrue å®žä¾‹:ä¸€ä¸ªä½¿ç”¨getè¯·æ±‚çš„å®žä¾‹ 12345678910111213141516171819202122&gt;&gt;&gt; import http.client&gt;&gt;&gt; conn = http.client.HTTPSConnection("www.python.org")&gt;&gt;&gt; conn.request("GET", "/")&gt;&gt;&gt; r1 = conn.getresponse()&gt;&gt;&gt; print(r1.status, r1.reason)200 OK&gt;&gt;&gt; data1 = r1.read() # This will return entire content.&gt;&gt;&gt; # The following example demonstrates reading data in chunks.&gt;&gt;&gt; conn.request("GET", "/")&gt;&gt;&gt; r1 = conn.getresponse()&gt;&gt;&gt; while chunk := r1.read(200):... print(repr(chunk))b'&lt;!doctype html&gt;\n&lt;!--[if"......&gt;&gt;&gt; # Example of an invalid request&gt;&gt;&gt; conn = http.client.HTTPSConnection("docs.python.org")&gt;&gt;&gt; conn.request("GET", "/parrot.spam")&gt;&gt;&gt; r2 = conn.getresponse()&gt;&gt;&gt; print(r2.status, r2.reason)404 Not Found&gt;&gt;&gt; data2 = r2.read()&gt;&gt;&gt; conn.close() ä¸€ä¸ªä½¿ç”¨headæ–¹æ³•çš„å®žä¾‹ 1234567891011&gt;&gt;&gt; import http.client&gt;&gt;&gt; conn = http.client.HTTPSConnection("www.python.org")&gt;&gt;&gt; conn.request("HEAD", "/")&gt;&gt;&gt; res = conn.getresponse()&gt;&gt;&gt; print(res.status, res.reason)200 OK&gt;&gt;&gt; data = res.read()&gt;&gt;&gt; print(len(data))0&gt;&gt;&gt; data == b''True ä¸€ä¸ªä½¿ç”¨postæäº¤è¯·æ±‚çš„å®žä¾‹ 12345678910111213&gt;&gt;&gt; import http.client, urllib.parse&gt;&gt;&gt; params = urllib.parse.urlencode(&#123;'@number': 12524, '@type': 'issue', '@action': 'show'&#125;)&gt;&gt;&gt; headers = &#123;"Content-type": "application/x-www-form-urlencoded",... "Accept": "text/plain"&#125;&gt;&gt;&gt; conn = http.client.HTTPConnection("bugs.python.org")&gt;&gt;&gt; conn.request("POST", "", params, headers)&gt;&gt;&gt; response = conn.getresponse()&gt;&gt;&gt; print(response.status, response.reason)302 Found&gt;&gt;&gt; data = response.read()&gt;&gt;&gt; datab'Redirecting to &lt;a href="http://bugs.python.org/issue12524"&gt;http://bugs.python.org/issue12524&lt;/a&gt;'&gt;&gt;&gt; conn.close() ä¸€ä¸ªä½¿ç”¨HTTP PUTè¯·æ±‚çš„å®žä¾‹ 1234567891011&gt;&gt;&gt; # This creates an HTTP message&gt;&gt;&gt; # with the content of BODY as the enclosed representation&gt;&gt;&gt; # for the resource http://localhost:8080/file...&gt;&gt;&gt; import http.client&gt;&gt;&gt; BODY = "***filecontents***"&gt;&gt;&gt; conn = http.client.HTTPConnection("localhost", 8080)&gt;&gt;&gt; conn.request("PUT", "/file", BODY)&gt;&gt;&gt; response = conn.getresponse()&gt;&gt;&gt; print(response.status, response.reason)200, OK HTTPMessage å¯¹è±¡ä¸€ä¸ª http.client.HTTPMessageçš„å®žä¾‹åŒ…å«äº†http response è¯·æ±‚å¤´. æ˜¯ email.message.Messageç±»çš„å…·ä½“å®žçŽ°. æ€»ç»“é€šè¿‡é˜…è¯»æºç åŠ æ·±äº†å¯¹httpåè®®çš„ç†è§£,çœ‹pythonå®žçŽ°çš„æ–¹å¼å—ç›Šè‰¯å¤šã€‚ç»§ç»­åŠ æ²¹!]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library glob]]></title>
    <url>%2F2020%2F01%2F07%2Fpython-standard-library-glob%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ä¹‹ glob åœ¨ä¸¥å¯’çš„å†¬å­£,æ¸©æš–äººçš„åªæœ‰ç¬‘è„¸äº†å§ã€‚ ä»Šå¤©ç»§ç»­ç»™å¤§å®¶ä»‹ç»pythonæ ‡å‡†åº“ globå‚è€ƒæ–‡æ¡£ glob æ¨¡å—å¯æ ¹æ® Unix ç»ˆç«¯æ‰€ç”¨è§„åˆ™æ‰¾å‡ºæ‰€æœ‰åŒ¹é…ç‰¹å®šæ¨¡å¼çš„è·¯å¾„åï¼Œä½†ä¼šæŒ‰ä¸ç¡®å®šçš„é¡ºåºè¿”å›žç»“æžœã€‚æ”¯æŒæŸ¥æ‰¾æ–‡ä»¶åªç”¨åˆ°ä¸‰ä¸ªåŒ¹é…ç¬¦ï¼šâ€™*â€™, â€œ?â€, â€œ[ ]â€ï¼Œä¸åŒ…æ‹¬æ³¢æµªçº¿~,å› ä¸ºè¿™ä¸ªç¬¦å·åœ¨linuxä»£è¡¨å½“å‰ç”¨æˆ·çš„homeç›®å½•ã€‚ å¯¹äºŽæ³¢æµªå·å’Œç»ˆç«¯å˜é‡æ‰©å±•ï¼Œè¯·ä½¿ç”¨ os.path.expanduser() å’Œ os.path.expandvars())ã€‚ æ ¹æ®é˜…è¯»ä»£ç å‘çŽ°,è¿™ä¸ªåº•å±‚ä½¿ç”¨cpythonå®žçŽ°, æœ‰å…´è¶£çš„ç«¥éž‹å¯ä»¥ç§»æ­¥åˆ°æºä»£ç : Lib/glob.py ç›¸å¯¹äºŽé«˜çº§é¢å‘å¯¹è±¡è·¯å¾„æŸ¥æ‰¾æ¨¡å—pathlib ,globæ›´åå‘åº•å±‚å®žçŽ°ã€‚ å‡½æ•° glob.glob(pathname, *, recursive=False) è¿”å›žåŒ¹é… pathname çš„å¯èƒ½ä¸ºç©ºçš„è·¯å¾„ååˆ—è¡¨ï¼Œå…¶ä¸­çš„å…ƒç´ å¿…é¡»ä¸ºåŒ…å«ä¸€ä¸ªè·¯å¾„ä¿¡æ¯çš„å­—ç¬¦ä¸²ã€‚ pathname å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ (å¦‚ /usr/src/Python-1.5/Makefile) æˆ–ç›¸å¯¹è·¯å¾„ (å¦‚ ../../Tools/*/*.gif)ï¼Œå¹¶ä¸”å¯åŒ…å« shell é£Žæ ¼çš„é€šé…ç¬¦ã€‚ ç»“æžœä¹Ÿå°†åŒ…å«æ— æ•ˆçš„ç¬¦å·é“¾æŽ¥ (ä¸Žåœ¨ shell ä¸­ä¸€è‡´)ã€‚ ç»“æžœæ˜¯å¦æŽ’åºå–å†³äºŽå…·ä½“æ–‡ä»¶ç³»ç»Ÿã€‚ å¦‚æžœ recursive ä¸ºçœŸå€¼ï¼Œåˆ™æ¨¡å¼ â€œ**â€œ å°†åŒ¹é…ç›®å½•ä¸­çš„ä»»ä½•æ–‡ä»¶ä»¥åŠé›¶ä¸ªæˆ–å¤šä¸ªç›®å½•ã€å­ç›®å½•å’Œç¬¦å·é“¾æŽ¥ã€‚ å¦‚æžœæ¨¡å¼åŠ äº†ä¸€ä¸ª os.sep æˆ– os.altsep åˆ™å°†ä¸åŒ¹é…æ–‡ä»¶ã€‚ å¤‡æ³¨ï¼šåœ¨ä¸€ä¸ªè¾ƒå¤§çš„ç›®å½•æ ‘ä¸­ä½¿ç”¨ â€œ**â€œ æ¨¡å¼å¯èƒ½ä¼šæ¶ˆè€—éžå¸¸å¤šçš„æ—¶é—´ã€‚ 3.5 ç‰ˆæ›´æ”¹: æ”¯æŒä½¿ç”¨ â€œ**â€œ çš„é€’å½’ glob glob.iglob(pathname, *, recursive=False) è¿”å›žä¸€ä¸ª iteratorï¼Œå®ƒä¼šäº§ç”Ÿä¸Ž glob() ç›¸åŒçš„ç»“æžœï¼Œä½†ä¸ä¼šå®žé™…åœ°åŒæ—¶ä¿å­˜å®ƒä»¬ã€‚ glob.escape(pathname) è½¬ä¹‰æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦ (&#39;?&#39;, &#39;*&#39; å’Œ &#39;[&#39;)ã€‚ è¿™é€‚ç”¨äºŽå½“ä½ æƒ³è¦åŒ¹é…å¯èƒ½å¸¦æœ‰ç‰¹æ®Šå­—ç¬¦çš„ä»»æ„å­—ç¬¦ä¸²å­—é¢å€¼çš„æƒ…å†µã€‚ åœ¨ drive/UNC å…±äº«ç‚¹ä¸­çš„ç‰¹æ®Šå­—ç¬¦ä¸ä¼šè¢«è½¬ä¹‰ï¼Œä¾‹å¦‚åœ¨ Windows ä¸Š escape(&#39;//?/c:/Quo vadis?.txt&#39;) å°†è¿”å›ž &#39;//?/c:/Quo vadis[?].txt&#39;ã€‚ å®žä¾‹123456789101112#ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„ç›®å½•ï¼šæ–‡ä»¶ 1.gif, 2.txt, card.gif ä»¥åŠä¸€ä¸ªå­ç›®å½• sub å…¶ä¸­åªåŒ…å«ä¸€ä¸ªæ–‡ä»¶ 3.txt. glob() å°†äº§ç”Ÿå¦‚ä¸‹ç»“æžœã€‚ è¯·æ³¨æ„è·¯å¾„çš„ä»»ä½•å¼€å¤´éƒ¨åˆ†éƒ½å°†è¢«ä¿ç•™ã€‚&gt;&gt;&gt; glob.glob('./[0-9].*')['./1.gif', './2.txt']&gt;&gt;&gt; glob.glob('*.gif')['1.gif', 'card.gif']&gt;&gt;&gt; glob.glob('?.gif')['1.gif']&gt;&gt;&gt; glob.glob('**/*.txt', recursive=True)['2.txt', 'sub/3.txt']&gt;&gt;&gt; glob.glob('./**/', recursive=True)['./', './sub/'] å¦‚æžœç›®å½•åŒ…å«ä»¥ . æ‰“å¤´çš„æ–‡ä»¶ï¼Œå®ƒä»¬é»˜è®¤å°†ä¸ä¼šè¢«åŒ¹é…ã€‚ ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªåŒ…å« card.gif å’Œ .card.gif çš„ç›®å½•: 12345&gt;&gt;&gt; import glob&gt;&gt;&gt; glob.glob('*.gif')['card.gif']&gt;&gt;&gt; glob.glob('.c*')['.card.gif'] è¡¥å……å†…å®¹ â€*â€åŒ¹é…ä»»æ„0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ï¼›â€?â€åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼›â€[ ]â€åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„å­—ç¬¦ï¼Œå¦‚ï¼š[0-9]åŒ¹é…æ•°å­—ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ–‡ä»¶ç»“æž„ 12345678910111213141516171819import glob# è¿”å›žä¸Šä¸€çº§æ‰€æœ‰ç›®å½•print(glob.glob(r"../*"))# è¿”å›žä¸Šæœ¬çº§æ‰€æœ‰ç›®å½•print(glob.glob(r"./*"))# æœ¬çº§æ‰€æœ‰æ–‡ä»¶print(glob.glob(r"./*.*"))# æœ¬çº§æ‰€æœ‰.pyæ–‡ä»¶print(glob.glob('./*.py'))#ä¸¤çº§ç›®å½•æ‰€æœ‰çš„.pyæ–‡ä»¶print(glob.glob('./*/*.py'))# cç›˜æ‰€æœ‰æ–‡ä»¶print(glob.glob(r'c:/*'))#Cç›˜æ‰€æœ‰åŒ…å«pr/po/br/boçš„ç›®å½•print(glob.glob('C:/*[PB][RO]*'))#Cç›˜æ‰€æœ‰åŒ…å«P_oçš„ç›®å½•print(glob.glob('C:/*P?O*'))#Cç›˜ä¸¤çº§ç›®å½•æ‰€æœ‰çš„.txtæ–‡ä»¶print(glob.glob('C:/*/*.txt')) æ˜¾ç¤ºå†…å®¹å¦‚ä¸‹: 12345['..\\class_demo.py', '..\\excel', '..\\flask_test', '..\\glob', '..\\image', '..\\mymodule', '..\\numpy', '..\\opencv', '..\\opencv_demo', '..\\othermodule', '..\\ppt', '..\\python_enuerate.py', '..\\pythoné€Ÿæˆ', '..\\selenium_test', '..\\äº¤æ¢ç®—æ³•.py', '..\\çˆ¬è™«']['.\\app', '.\\config', '.\\data', '.\\glob_demo.py', '.\\other.py', '.\\readme.md']['.\\glob_demo.py', '.\\other.py', '.\\readme.md']['.\\glob_demo.py', '.\\other.py']['.\\app\\__init__.py', '.\\config\\config.py'] å…¶ä»–é˜…è¯»æºç ä¸­å‘çŽ° 12345678"""Filename globbing utility."""import osimport reimport fnmatchimport sys__all__ = ["glob", "iglob", "escape"] é¡ºä¾¿æŠŠ__all__ç”¨æ³•æ•´ç†ä¸‹,ç®—æ˜¯æŸ¥æ¼è¡¥ç¼º, __all__é—®é¢˜æè¿°: åœ¨ç ”è¯»pythonmodelæºç æ—¶,ä¼šçœ‹åˆ°ä¸€äº›.pyæ–‡ä»¶æˆ–è€…init.pyä¸­ä¼šä½¿ç”¨allã€‚å¯¹äºŽallå…·ä½“æ‰€å…¶çš„ä½œç”¨æ˜¯ä»€ä¹ˆ?åœ¨æ­¤å¯¹æŸ¥å–ç»“æžœè¿›è¡Œæ€»ç»“ä¸‹ã€‚2.æ€»ç»“(1)åœ¨init.pyæ–‡ä»¶ä¸­è¡¨ç¤ºå½¢å¼:all=[â€œmodule_aâ€,â€module_bâ€]åœ¨ä½¿ç”¨frompackage_nameimportæ—¶,è¡¨ç¤ºimportè¯¥packageä¸­çš„ä¸¤ä¸ªmoduleåŠä¸¤ä¸ªmoduleç›¸å…³çš„ç±»ã€æ–¹ è¡¨ç¤ºå½¢å¼: __all__=[&quot;class_name&quot;,&quot;function_name&quot;] åœ¨ä½¿ç”¨ from module_name import * æ—¶,è¡¨ç¤ºimport è¯¥moduleä¸­çš„allä¸­æ‰€åˆ—å‡ºçš„ã€‚ ä½¿ç”¨æ³¨æ„äº‹é¡¹: (1) åœ¨æ™®é€šçš„*.pyä¸­, ä½¿ç”¨all æ—¶,å¯ä»¥ä½¿ç”¨allåˆ—å‡ºçš„ ç±»ã€å‡½æ•°ã€å˜é‡ç­‰,ä¸ä½¿ç”¨allæ—¶ä¼šä½¿ç”¨moduleä¸­çš„æ‰€æœ‰ä¸ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„æˆå‘˜ã€‚ (2)allåªèƒ½å½±å“åˆ° from import * è¿™ç§import æ–¹å¼, å¯¹äºŽfrom import çš„ import æ–¹å¼æ²¡æœ‰å½±å“ã€‚ (3) all çš„æ•°æ®ç±»åž‹:List or Tuple å…³è”çš„æ¨¡å—æ¨¡å— fnmatch Shell é£Žæ ¼æ–‡ä»¶åï¼ˆè€Œéžè·¯å¾„ï¼‰æ‰©å±•]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>glob</tag>
        <tag>__all__</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library textwrap]]></title>
    <url>%2F2020%2F01%2F06%2Fpython-standard-library-textwrap%2F</url>
    <content type="text"><![CDATA[Python æ ‡å‡†åº“ ä¹‹ textwrap ä»Šå¤©ç»™å¤§å®¶ä»‹ç» pythonæ ‡å‡†åº“ä¸­çš„ textwrapå‚è€ƒæ–‡æ¡£ æ ‡å‡†åº“ textwrap æ˜¯ä¸€ä¸ªå…³äºŽæ–‡æœ¬è‡ªåŠ¨æ¢è¡Œå’Œå¡«å……çš„æ¨¡å—ã€‚ å…³äºŽè¿™ä¸ªæ¨¡å—å®˜ç½‘ä»‹ç»å¦‚ä¸‹: textwrap æ¨¡å—æä¾›äº†ä¸€äº›å¿«æ·å‡½æ•°ï¼Œä»¥åŠå¯ä»¥å®Œæˆæ‰€æœ‰å·¥ä½œçš„ç±» TextWrapperã€‚ å¦‚æžœä½ åªæ˜¯è¦å¯¹ä¸€ä¸¤ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²è¿›è¡Œè‡ªåŠ¨æ¢è¡Œæˆ–å¡«å……ï¼Œå¿«æ·å‡½æ•°åº”è¯¥å°±å¤Ÿç”¨äº†ï¼› å¦åˆ™çš„è¯ï¼Œä½ åº”è¯¥ä½¿ç”¨ TextWrapper çš„å®žä¾‹æ¥æé«˜æ•ˆçŽ‡ã€‚ å‡½æ•° textwrap.wrap(*text*, *width=70*, kwargs) å¯¹ text (å­—ç¬¦ä¸²) ä¸­çš„å•ç‹¬æ®µè½è‡ªåŠ¨æ¢è¡Œä»¥ä½¿æ¯è¡Œé•¿åº¦æœ€å¤šä¸º width ä¸ªå­—ç¬¦ã€‚ è¿”å›žç”±è¾“å‡ºè¡Œç»„æˆçš„åˆ—è¡¨ï¼Œè¡Œå°¾ä¸å¸¦æ¢è¡Œç¬¦ã€‚ textwrap.fill(text, width=70, kwargs) å¯¹ text ä¸­çš„å•ç‹¬æ®µè½è‡ªåŠ¨æ¢è¡Œï¼Œå¹¶è¿”å›žä¸€ä¸ªåŒ…å«è¢«è‡ªåŠ¨æ¢è¡Œæ®µè½çš„å•ç‹¬å­—ç¬¦ä¸²ã€‚ fill() æ˜¯ä»¥ä¸‹è¯­å¥çš„å¿«æ·æ–¹å¼ 1"\n".join(wrap(text, ...)) textwrap.shorten(text, width, kwargs) æŠ˜å å¹¶æˆªçŸ­ç»™å®šçš„ text ä»¥ç¬¦åˆç»™å®šçš„ widthã€‚ textwrap.dedent(text)` ç§»é™¤ text ä¸­æ¯ä¸€è¡Œçš„ä»»ä½•ç›¸åŒå‰ç¼€ç©ºç™½ç¬¦ã€‚ 1234567# end first line with \ to avoid the empty line!s = '''\hello world'''print(repr(s)) # prints ' hello\n world\n 'print(repr(dedent(s))) # prints 'hello\n world\n' textwrap.indent(text, prefix, predicate=None)` å°† prefix æ·»åŠ åˆ° text ä¸­é€‰å®šè¡Œçš„å¼€å¤´ã€‚ é€šè¿‡è°ƒç”¨ text.splitlines(True) æ¥å¯¹è¡Œè¿›è¡Œæ‹†åˆ†ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œprefix ä¼šè¢«æ·»åŠ åˆ°æ‰€æœ‰ä¸æ˜¯åªç”±ç©ºç™½ç¬¦ï¼ˆåŒ…æ‹¬ä»»ä½•è¡Œç»“æŸç¬¦ï¼‰ç»„æˆçš„è¡Œã€‚ ä¾‹å¦‚: 123&gt;&gt;&gt; s = 'hello\n\n \nworld'&gt;&gt;&gt; indent(s, ' ')' hello\n\n \n world' å¯é€‰çš„ predicate å‚æ•°å¯ç”¨æ¥æŽ§åˆ¶å“ªäº›è¡Œè¦ç¼©è¿›ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸ºç©ºè¡Œæˆ–åªæœ‰ç©ºç™½ç¬¦çš„è¡Œæ·»åŠ  prefix: 12345&gt;&gt;&gt; print(indent(s, '+ ', lambda line: True))+ hello+++ world å®žä¾‹å±žæ€§ width (é»˜è®¤: 70) è‡ªåŠ¨æ¢è¡Œçš„æœ€å¤§è¡Œé•¿åº¦ã€‚ åªè¦è¾“å…¥æ–‡æœ¬ä¸­æ²¡æœ‰é•¿äºŽ width çš„å•ä¸ªå•è¯ï¼ŒTextWrapper å°±èƒ½ä¿è¯æ²¡æœ‰é•¿äºŽ width ä¸ªå­—ç¬¦çš„è¾“å‡ºè¡Œã€‚ expand_tabs (é»˜è®¤: True) å¦‚æžœä¸ºçœŸå€¼ï¼Œåˆ™ text ä¸­æ‰€æœ‰çš„åˆ¶è¡¨ç¬¦å°†ä½¿ç”¨ text çš„ expandtabs() æ–¹æ³•æ‰©å±•ä¸ºç©ºæ ¼ç¬¦ã€‚ tabsize (é»˜è®¤: 8) å¦‚æžœ expand_tabs ä¸ºçœŸå€¼ï¼Œåˆ™ text ä¸­æ‰€æœ‰çš„åˆ¶è¡¨ç¬¦å°†æ‰©å±•ä¸ºé›¶ä¸ªæˆ–å¤šä¸ªç©ºæ ¼ï¼Œå…·ä½“å–å†³äºŽå½“å‰åˆ—ä½ç½®å’Œç»™å®šçš„åˆ¶è¡¨å®½åº¦ã€‚ replace_whitespace (default: True) å¦‚æžœä¸ºçœŸå€¼ï¼Œåœ¨åˆ¶è¡¨ç¬¦æ‰©å±•ä¹‹åŽã€è‡ªåŠ¨æ¢è¡Œä¹‹å‰ï¼Œwrap() æ–¹æ³•å°†æŠŠæ¯ä¸ªç©ºç™½å­—ç¬¦éƒ½æ›¿æ¢ä¸ºå•ä¸ªç©ºæ ¼ã€‚ ä¼šè¢«æ›¿æ¢çš„ç©ºç™½å­—ç¬¦å¦‚ä¸‹ï¼šåˆ¶è¡¨ï¼Œæ¢è¡Œï¼Œåž‚ç›´åˆ¶è¡¨ï¼Œè¿›çº¸å’Œå›žè½¦ (&#39;\t\n\v\f\r&#39;)ã€‚æ³¨è§£ å¦‚æžœ expand_tabs ä¸ºå‡å€¼ä¸” replace_whitespace ä¸ºçœŸå€¼ï¼Œæ¯ä¸ªåˆ¶è¡¨ç¬¦å°†è¢«æ›¿æ¢ä¸ºå•ä¸ªç©ºæ ¼ï¼Œè¿™ä¸Žåˆ¶è¡¨ç¬¦æ‰©å±•æ˜¯ ä¸ ä¸€æ ·çš„ã€‚æ³¨è§£ å¦‚æžœ replace_whitespace ä¸ºå‡å€¼ï¼Œåœ¨ä¸€è¡Œçš„ä¸­é—´æœ‰å¯èƒ½å‡ºçŽ°æ¢è¡Œç¬¦å¹¶å¯¼è‡´æ€ªå¼‚çš„è¾“å‡ºã€‚ å› æ­¤ï¼Œæ–‡æœ¬åº”å½“ï¼ˆä½¿ç”¨ str.splitlines() æˆ–ç±»ä¼¼æ–¹æ³•ï¼‰æ‹†åˆ†ä¸ºæ®µè½å¹¶åˆ†åˆ«è¿›è¡Œè‡ªåŠ¨æ¢è¡Œã€‚ drop_whitespace (é»˜è®¤: True) å¦‚æžœä¸ºçœŸå€¼ï¼Œæ¯ä¸€è¡Œå¼€å¤´å’Œæœ«å°¾çš„ç©ºç™½å­—ç¬¦ï¼ˆåœ¨åŒ…è£…ä¹‹åŽã€ç¼©è¿›ä¹‹å‰ï¼‰ä¼šè¢«ä¸¢å¼ƒã€‚ ä½†æ˜¯æ®µè½å¼€å¤´çš„ç©ºç™½å­—ç¬¦å¦‚æžœåŽé¢ä¸å¸¦ä»»ä½•éžç©ºç™½å­—ç¬¦åˆ™ä¸ä¼šè¢«ä¸¢å¼ƒã€‚ å¦‚æžœè¢«ä¸¢å¼ƒçš„ç©ºç™½å­—ç¬¦å æ®äº†ä¸€ä¸ªæ•´è¡Œï¼Œåˆ™è¯¥æ•´è¡Œå°†è¢«ä¸¢å¼ƒã€‚ initial_indent (é»˜è®¤: &#39;&#39;) å°†è¢«æ·»åŠ åˆ°è¢«è‡ªåŠ¨æ¢è¡Œè¾“å‡ºå†…å®¹çš„ç¬¬ä¸€è¡Œçš„å­—ç¬¦ä¸²ã€‚ å…¶é•¿åº¦ä¼šè¢«è®¡å…¥ç¬¬ä¸€è¡Œçš„é•¿åº¦ã€‚ ç©ºå­—ç¬¦ä¸²ä¸ä¼šè¢«ç¼©è¿›ã€‚ subsequent_indent (default: &#39;&#39;) å°†è¢«æ·»åŠ åˆ°è¢«è‡ªåŠ¨æ¢è¡Œè¾“å‡ºå†…å®¹é™¤ç¬¬ä¸€è¡Œå¤–çš„æ‰€æœ‰è¡Œçš„å­—ç¬¦ä¸²ã€‚ å…¶é•¿åº¦ä¼šè¢«è®¡å…¥é™¤è¡Œä¸€è¡Œå¤–çš„æ‰€æœ‰è¡Œçš„é•¿åº¦ã€‚ fix_sentence_endings (é»˜è®¤: False) å¦‚æžœä¸ºçœŸå€¼ï¼ŒTextWrapper å°†å°è¯•æ£€æµ‹å¥å­ç»“å°¾å¹¶ç¡®ä¿å¥å­é—´æ€»æ˜¯ä»¥æ°å¥½ä¸¤ä¸ªç©ºæ ¼ç¬¦åˆ†éš”ã€‚ å¯¹äºŽä½¿ç”¨ç­‰å®½å­—ä½“çš„æ–‡æœ¬æ¥è¯´é€šå¸¸éƒ½éœ€è¦è¿™æ ·ã€‚ ä½†æ˜¯ï¼Œå¥å­æ£€æµ‹ç®—æ³•å¹¶ä¸å®Œç¾Žï¼šå®ƒå‡å®šå¥å­ç»“å°¾æ˜¯ä¸€ä¸ªå°å†™å­—æ¯åŠ å­—ç¬¦ &#39;.&#39;, &#39;!&#39; æˆ– &#39;?&#39; ä¸­çš„ä¸€ä¸ªï¼Œå¹¶å¯èƒ½å¸¦æœ‰å­—ç¬¦ &#39;&quot;&#39; æˆ– &quot;&#39;&quot;ï¼Œæœ€åŽä»¥ä¸€ä¸ªç©ºæ ¼ç»“æŸã€‚ æ­¤ç®—æ³•çš„é—®é¢˜ä¹‹ä¸€æ˜¯å®ƒæ— æ³•åŒºåˆ†ä»¥ä¸‹æ–‡æœ¬ä¸­çš„ â€œDr.â€[...] Dr. Frankenstein&#39;s monster [...]å’Œä»¥ä¸‹æ–‡æœ¬ä¸­çš„ â€œSpot.â€[...] See Spot. See Spot run [...]fix_sentence_endings é»˜è®¤ä¸ºå‡å€¼ã€‚ç”±äºŽå¥å­æ£€æµ‹ç®—æ³•ä¾èµ–äºŽ string.lowercase æ¥ç¡®å®šâ€œå°å†™å­—æ¯â€ï¼Œä»¥åŠçº¦å®šåœ¨å¥ç‚¹åŽä½¿ç”¨ä¸¤ä¸ªç©ºæ ¼æ¥åˆ†éš”å¤„äºŽåŒä¸€è¡Œçš„å¥å­ï¼Œå› æ­¤åªé€‚ç”¨äºŽè‹±è¯­æ–‡æœ¬ã€‚ break_long_words (é»˜è®¤: True) å¦‚æžœä¸ºçœŸå€¼ï¼Œåˆ™é•¿åº¦è¶…è¿‡ width çš„å•è¯å°†è¢«åˆ†å¼€ä»¥ä¿è¯è¡Œçš„é•¿åº¦ä¸ä¼šè¶…è¿‡ widthã€‚ å¦‚æžœä¸ºå‡å€¼ï¼Œè¶…é•¿å•è¯ä¸ä¼šè¢«åˆ†å¼€ï¼Œå› è€ŒæŸäº›è¡Œçš„é•¿åº¦å¯èƒ½ä¼šè¶…è¿‡ widthã€‚ ï¼ˆè¶…é•¿å•è¯å°†è¢«å•ç‹¬ä½œä¸ºä¸€è¡Œï¼Œä»¥å°½é‡å‡å°‘è¶…å‡º width çš„æƒ…å†µã€‚ï¼‰ break_on_hyphens (é»˜è®¤: True) å¦‚æžœä¸ºçœŸå€¼ï¼Œå°†æ ¹æ®è‹±è¯­çš„æƒ¯ä¾‹é¦–é€‰åœ¨ç©ºç™½ç¬¦å’Œå¤åˆè¯çš„è¿žå­—ç¬¦ä¹‹åŽè‡ªåŠ¨æ¢è¡Œã€‚ å¦‚æžœä¸ºå‡å€¼ï¼Œåˆ™åªæœ‰ç©ºç™½ç¬¦ä¼šè¢«è§†ä¸ºåˆé€‚çš„æ½œåœ¨æ–­è¡Œä½ç½®ï¼Œä½†å¦‚æžœä½ ç¡®å®žä¸å¸Œæœ›å‡ºçŽ°åˆ†å¼€çš„å•è¯åˆ™ä½ å¿…é¡»å°† break_long_words è®¾ä¸ºå‡å€¼ã€‚ ä¹‹å‰ç‰ˆæœ¬çš„é»˜è®¤è¡Œä¸ºæ€»æ˜¯å…è®¸åˆ†å¼€å¸¦æœ‰è¿žå­—ç¬¦çš„å•è¯ã€‚ max_lines (é»˜è®¤: None) å¦‚æžœä¸ä¸º Noneï¼Œåˆ™è¾“å‡ºå†…å®¹å°†æœ€å¤šåŒ…å« max_lines è¡Œï¼Œå¹¶ä½¿ placeholder å‡ºçŽ°åœ¨è¾“å‡ºå†…å®¹çš„æœ«å°¾ã€‚ placeholder (é»˜è®¤: &#39; [...]&#39;) è¯¥æ–‡æœ¬å°†åœ¨è¾“å‡ºæ–‡æœ¬è¢«æˆªçŸ­æ—¶å‡ºçŽ°åœ¨æ–‡æœ¬æœ«å°¾ã€‚ å…¬æœ‰æ–¹æ³• wrap(text) å¯¹ text (å­—ç¬¦ä¸²) ä¸­çš„å•ç‹¬æ®µè½è‡ªåŠ¨æ¢è¡Œä»¥ä½¿æ¯è¡Œé•¿åº¦æœ€å¤šä¸º width ä¸ªå­—ç¬¦ã€‚ æ‰€æœ‰è‡ªåŠ¨æ¢è¡Œé€‰é¡¹å‡èŽ·å–è‡ª TextWrapper å®žä¾‹çš„å®žä¾‹å±žæ€§ã€‚ è¿”å›žç”±è¾“å‡ºè¡Œç»„æˆçš„åˆ—è¡¨ï¼Œè¡Œå°¾ä¸å¸¦æ¢è¡Œç¬¦ã€‚ å¦‚æžœè‡ªåŠ¨æ¢è¡Œè¾“å‡ºç»“æžœæ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œåˆ™è¿”å›žç©ºåˆ—è¡¨ã€‚ fill(text) å¯¹ text ä¸­çš„å•ç‹¬æ®µè½è‡ªåŠ¨æ¢è¡Œå¹¶è¿”å›žåŒ…å«è¢«è‡ªåŠ¨æ¢è¡Œæ®µè½çš„å•ç‹¬å­—ç¬¦ä¸²ã€‚ å…·ä½“å®žä¾‹æ¯”å¦‚æˆ‘æƒ³æ ¼å¼åŒ–ä¸€ä¸ªæ–‡æœ¬,æ¯ä¸€è¡Œè¦æ±‚è¾“å‡ºçš„æ–‡å­—å›ºå®šå­—ç¬¦çš„é•¿åº¦30,å°±å¯ä»¥ä½¿ç”¨textwrapè¿™ä¸ªæ¨¡å— 1234567891011121314151617&gt;&gt;&gt; from textwrap import wrap&gt;&gt;&gt;&gt;&gt;&gt; string = 'This is python programming language. One of its kind, it is also one of the most popular language in the world.'&gt;&gt;&gt;&gt;&gt;&gt; s = wrap(text = string, width = 30)&gt;&gt;&gt; print s&gt;&gt;&gt; ['This is python programming', 'language. One of its kind, it', 'is also one of the most', 'popular language in the world.']&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; for i in s: print i This is python programminglanguage. One of its kind, itis also one of the mostpopular language in the world.&gt;&gt;&gt;]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library http.server]]></title>
    <url>%2F2020%2F01%2F05%2Fpython-standard-library-http-server%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ä¹‹ http.server ä»Šå¤©ä¸‹åˆä¸»è¦æ˜¯é™ªæˆ‘é—ºå¥³,ç»„è£…å®Œæˆä¸€ä¸ªæ¡Œé¢è¶³çƒ,å¾ˆå¼€å¿ƒçš„ä¸€ä¸‹åˆã€‚ å­©å­çš„ç«¥å¹´åªæœ‰ä¸€æ¬¡,æœ‰æ—¶é—´å¤šé™ªé™ªå­©å­å§ã€‚ python æ ‡å‡†åº“ http.serverä»Žpython2æ—¶ä»£å¼€å§‹ SimpleHttpServerå°±é™ªä¼´æˆ‘èµ°è¿‡é‚£äº›å¿«ä¹çš„æ—¶å…‰ã€‚å¯ä»¥è‡ªå·±å»ºç«‹ä¸€ä¸ªç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨,è®©åŒäº‹ä»¬é€šè¿‡æµè§ˆå™¨å°±å¯ä»¥è®¿é—®æˆ‘ç”µè„‘ä¸Šçš„èµ„æº,è€Œä¸éœ€è¦http serveræˆ–è€… ftpè½¯ä»¶ã€‚ åˆ°äº†python3æ—¶ä»£,è¿™ä¸ªæ¨¡å—è¢«åˆå¹¶è¿›äº†http.serverã€‚ å‚è€ƒç½‘å€ è¿™ä¸ªæ¨¡å—å®šä¹‰äº†å®žçŽ° HTTP æœåŠ¡å™¨ï¼ˆ Web æœåŠ¡å™¨ï¼‰çš„ç±» ã€‚ HTTPServer æ˜¯ socketserver.TCPServer çš„ä¸€ä¸ªå­ç±»ã€‚å®ƒä¼šåˆ›å»ºå’Œä¾¦å¬ HTTP å¥—æŽ¥å­—ï¼Œå¹¶å°†è¯·æ±‚è°ƒåº¦ç»™å¤„ç†ç¨‹åºã€‚ç”¨äºŽåˆ›å»ºå’Œè¿è¡ŒæœåŠ¡å™¨çš„ä»£ç çœ‹èµ·æ¥åƒè¿™æ · 1234def run(server_class=HTTPServer, handler_class=BaseHTTPRequestHandler): server_address = ('', 8000) httpd = server_class(server_address, handler_class) httpd.serve_forever() æ ¸å¿ƒç±»class http.server.HTTPServer(server_address, RequestHandlerClass) è¯¥ç±»åŸºäºŽ TCPServer ç±»ï¼Œå¹¶ä¼šå°†æœåŠ¡å™¨åœ°å€å­˜å…¥åä¸º server_name å’Œ server_port çš„å®žä¾‹å˜é‡ä¸­ã€‚æœåŠ¡å™¨å¯è¢«å¤„ç†ç¨‹åºé€šè¿‡ server å®žä¾‹å˜é‡è®¿é—®ã€‚ class http.server.ThreadingHTTPServer(server_address, RequestHandlerClass) æ ¹æ®å®˜æ–¹è¯´æ˜Ž,è¿™æ˜¯ä¸€ä¸ªåŸºäºŽ ThreadingMixInçš„ç±»,ä¸»è¦åŠŸèƒ½æ˜¯ä½¿ç”¨çº¿ç¨‹å¤„ç†è¯·æ±‚ã€‚ å®žä¾‹å˜é‡BaseHTTPRequestHandler has the following instance variables: client_address åŒ…å«æŒ‡å‘å®¢æˆ·åœ°å€çš„å…ƒç»„ç±»åž‹æ•°æ®(host,port) server åŒ…å«Serverå®žä¾‹ close_connection è¿”å›žä¸€ä¸ªBooleanç±»åž‹æ•°æ®,åœ¨handle_one_request() ,è¡¨æ˜Žå¦ä¸€ä¸ªè¯·æ±‚å¼€å§‹,æˆ–è€…å½“å‰è¯·æ±‚å…³é—­ã€‚ requestline åŒ…å«httpè¯·æ±‚è¡Œï¼Œ. è¿™ä¸ªå±žæ€§åº”è¯¥ç”¨ handle_one_request()è®¾ç½®. å¦‚æžœä¸€ä¸ªä¸å­˜åœ¨çš„è¯·æ±‚è¢«æ‰§è¡Œ,åº”å°†å…¶è®¾ç½®æˆç©ºå­—ç¬¦ä¸²ã€‚ command åŒ…å«Httpè¯·æ±‚ç±»åž‹,ä¾‹å¦‚:â€™Getâ€™ path åŒ…å«è¯·æ±‚urlè·¯å¾„ request_version åŒ…å«è¯·æ±‚çš„ç‰ˆæœ¬,ä¾‹å¦‚:â€™ HTTP/1.0 â€˜ headers åŒ…å«é€šè¿‡MessageClass ç±»å£°æ˜Žçš„å˜é‡ã€‚å®žä¾‹ä¼šè½¬åŒ–ä¸ºhttpè¯·æ±‚ã€‚http.client ä¸­parse_headers() æ–¹æ³•å¯ä»¥éªŒè¯ä¸€ä¸ªéžæ³•çš„è¯·æ±‚å¤´,å‚ç…§ RFC 2822 ä¸­è¯·æ±‚å¤´è¯´æ˜Žã€‚ rfile ä¸€ä¸ªio.BufferedIOBase è¾“å…¥æµå¯¹è±¡ï¼Œè¯»å–å¯èƒ½è¾“å…¥æ•°æ®ã€‚ wfile æ ¹æ®å®¢æˆ·ç«¯è¯·æ±‚,è¿”å›žæ•°æ® å®žä¾‹å±žæ€§ server_version æ ¼å¼åŒ–è¾“å‡ºæœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯,ä¾‹å¦‚&#39;BaseHTTP/0.2&#39;. sys_version åŒ…å«ç³»ç»Ÿç‰ˆæœ¬,ä½¿ç”¨version_string æ–¹æ³•å’Œserver_version ç±»å˜é‡,ä¾‹å¦‚:&#39;Python/1.4&#39;. error_message_format å£°æ˜Žé”™è¯¯ä¿¡æ¯ error_content_type å£°æ˜Žé”™è¯¯ä¸Šä¸‹æ–‡ç±»åž‹é»˜è®¤å€¼æ˜¯ &#39;text/html&#39;. protocol_version å£°æ˜ŽHTTPåè®®ç‰ˆæœ¬,ä¾‹å¦‚:&#39;HTTP/1.1&#39;, æœåŠ¡å™¨ä¼šä¿æŒè¿žæŽ¥ã€‚ MessageClass å£°æ˜Žemail.message.Message](https://docs.python.org/zh-cn/3.8/library/email.compat32-message.html#email.message.Message)-like ç±»å¤„ç†è¯·æ±‚å¤´ã€‚é€šå¸¸ä¸ç”¨é‡å†™,é»˜è®¤æŒ‡å‘http.client.HTTPMessageå±žæ€§ã€‚. responses å›žåº” é€šå¸¸ä½¿ç”¨send_response_only() å’Œsend_error() æ–¹æ³•å®žçŽ°ã€‚ å®žä¾‹æ–¹æ³• handle() è°ƒç”¨handle_one_request() æ–¹æ³•ä¸€æ¬¡(å¦‚æžœä¿æŒè¿žæŽ¥,ä¼šè°ƒç”¨å¤šæ¬¡) æ¥ç®¡ç†httpè¯·æ±‚ã€‚. æ­¤æ–¹æ³•ä¸éœ€è¦é‡å†™,é™¤æ­¤ä»¥å¤–,å¯ä»¥é‡å†™ do_*() ç­‰æ–¹æ³•å®žçŽ°å¤„ç†è¯·æ±‚ã€‚ handle_one_request() æ­¤æ–¹æ³•ä¸éœ€è¦é‡å†™,å®žçŽ°å¤„ç† do_*()ç­‰æ–¹æ³•. handle_expect_100() å½“ HTTP/1.1 è¯·æ±‚æ—¶,æœåŠ¡å™¨æœŸæœ›è¿”å›ž 100-continue å¹¶è¿”å›ž 200å“åº”ç ã€‚å¦‚æžœæƒ³æ‹’ç»å®¢æˆ·ç«¯è¿žæŽ¥,ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ send_error(code, message=None, explain=None) send_response(code, message=None) send_header(keyword, value) send_response_only(code, message=None) end_headers() flush_headers() log_request(code=â€™-â€˜, size=â€™-â€˜) log_error(â€¦) log_message(format, â€¦) version_string() date_time_string(timestamp=None) log_date_time_string() address_string() åˆ›å»ºä¸€ä¸ªç®€æ˜“æœåŠ¡å™¨ä¾‹å¦‚ä¸‹é¢çš„ä»£ç : 12345678910import http.serverimport socketserverPORT = 8000Handler = http.server.SimpleHTTPRequestHandlerwith socketserver.TCPServer(("", PORT), Handler) as httpd: print("serving at port", PORT) httpd.serve_forever() å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ–¹å¼åˆ›å»º,ä¾‹å¦‚: 1python -m http.server 8000 é»˜è®¤ç»‘å®šæœ¬æœºçš„ipåœ°å€ã€‚ å½“ç„¶ä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªipåœ°å€,åŠ å…¥--bindå‚æ•° 1python -m http.server 8000 --bind 127.0.0.1 3.8 æ–°å¢ž æ”¯æŒç»‘å®šipv6åœ°å€ 3.7 æ–°å¢žæ”¯æŒç»‘å®šä¸€ä¸ªcgiç¨‹åº,ä¾‹å¦‚ 1python -m http.server --cgi 8000 ä¸€ä¸ªå…·ä½“åº”ç”¨çš„å®žä¾‹12345678910111213141516171819202122232425262728293031323334#!/usr/bin/env python from http.server import BaseHTTPRequestHandler, HTTPServer # HTTPRequestHandler classclass testHTTPServer_RequestHandler(BaseHTTPRequestHandler): # GET def do_GET(self): # Send response status code self.send_response(200) # Send headers self.send_header('Content-type','text/html') self.end_headers() # Send message back to client message = "Hello world!" # Write content as utf-8 data self.wfile.write(bytes(message, "utf8")) return def run(): print('starting server...') # Server settings # Choose port 8080, for port 80, which is normally used for a http server, you need root access server_address = ('127.0.0.1', 8081) httpd = HTTPServer(server_address, testHTTPServer_RequestHandler) print('running server...') httpd.serve_forever() run() å¤‡æ³¨: æ­¤å¤„wfile.writeæ–¹æ³• éœ€è¦è½¬æˆ byteç±»åž‹, å¯ä»¥å‚è€ƒstackoverflowä¸Šçš„å…³äºŽè¿™ä¸ªé—®é¢˜çš„è®¨è®º:: python-3-x-basehttpserver-or-http-server å°ç»“çœ‹å®Œhttp.server æ·±æœ‰æ„Ÿè§¦,ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨å­¦ä¹ äº†è¿™ä¹ˆå¤šhttpåè®®å®žçŽ°,çœ‹æ¥è¿˜å¾—ç»§ç»­æ·±å…¥ç†è§£ã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>http.server</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[windows jupyter notebook nbextension usage]]></title>
    <url>%2F2020%2F01%2F04%2Fwindows-jupyter-notebook-nbextension-usage%2F</url>
    <content type="text"><![CDATA[windowsä¸‹jupyter å®‰è£…nbextension æ’ä»¶å¡«å‘è®° çŽ¯å¢ƒ è½¯ä»¶å’Œæ“ä½œç³»ç»Ÿ ç‰ˆæœ¬å· æ“ä½œç³»ç»Ÿ win7 64ä½ sp1 pythonç‰ˆæœ¬ 3.6.2 jupyter core 4.5.0 jupyter notebook 6.0.0 é—®é¢˜æè¿°æœ¬æ¥ä»¥ä¸ºç»™jupyterå®‰è£…ä¸ªæ’ä»¶,åˆ†åˆ†é’Ÿæžå®šçš„äº‹,ç»“æžœä¸‰å¤©äº†è¿˜æ˜¯æ²¡è§£å†³ã€‚ æˆ‘å›žå®¶ç”¨win10çš„ç”µè„‘,5åˆ†é’Ÿæžå®šã€‚ å°è¯•äº†å„ç§æ–¹å¼,å¸è½½é‡è£…,ä¿®æ”¹çŽ¯å¢ƒå˜é‡,æ¢ä¸åŒçš„pythonç‰ˆæœ¬ã€‚åŽæ¥æˆ‘å¿«è¦æ”¾æ”¾å¼ƒçš„æ—¶å€™ï¼Œæˆ‘ç»ˆäºŽæžå®šäº†ã€‚ é—®é¢˜å®šä½æˆ‘çªç„¶æƒ³åˆ°,æ˜¯ä¸æ˜¯å› ä¸ºæˆ‘å®‰è£…äº†anaconda,äºŽæ˜¯å¢žåŠ äº†æœç´¢å…³é”®å­—,ç»ˆäºŽå‘çŽ°äº†é—®é¢˜æ‰€åœ¨ã€‚ æ­£ç¡®æ“ä½œæ­¥éª¤ ç¡®å®šæ˜¯å·²ç»å®‰è£…å¥½anaconda è¦åœ¨anaconda promptæ¨¡å¼ä¸‹(é‡è¦çš„äº‹æƒ…è¯´ä¸‰é,ä¸‰é,ä¸‰éï¼Œæ­¤å¤„çœç•¥ä¸€ä¸‡å­—,ä¸‡é©¬å¥”è…¾) pip install jupyter_contrib_nbextensions é…ç½®ï¼šjupyter contrib nbextension install --user --skip-running-check å¯åŠ¨jupyter notebookï¼Œâ€œNbextensionsâ€å‡ºçŽ°åœ¨å¯¼èˆªæ ä¸­ï¼Œåœ¨å‹¾é€‰ç›®å½•ã€‚ æŸ¥çœ‹ jupyter ç‰ˆæœ¬123456789101112(base) C:\Users\Mr.Sui&gt;jupyter --versionjupyter core : 4.5.0jupyter-notebook : 6.0.0qtconsole : 4.5.1ipython : 7.6.1ipykernel : 5.1.1jupyter client : 5.3.1jupyter lab : 1.0.2nbconvert : 5.5.0ipywidgets : 7.5.0nbformat : 4.4.0traitlets : 4.3.2 æœ‰ç”¨çš„æ’ä»¶ ä»£ç å¯¼èˆªåŠŸèƒ½ Table of Contents å˜é‡æ£€æŸ¥å™¨ Variable Inspector æ˜¾ç¤ºå•å…ƒæ ¼è¿è¡Œçš„æ—¶é—´å’Œé•¿åº¦ Excute time æŠ˜å /æ”¾ä¸‹æ ‡é¢˜ Collapsible Headings æŠ˜å ä»£ç  Codefolding éšè—ä»£ç  hide input éšè—é€‰å®šä»£ç  hide input all éšè—æ‰€æœ‰ä»£ç  ä»£ç è‡ªåŠ¨è¡¥å…¨ Hinterland é€šçŸ¥ Notify Jupyter Notebook é¦–å…ˆä½ è¦å‹¾é€‰Notifyæ‰©å±•ï¼Œå…¶æ¬¡å†ç‚¹å‡»æŒ‰é’®æ­£å¼å¯åŠ¨ã€‚ä½ é€‰æ‹©çš„æ—¶é—´æ˜¯Jupyter Notebookè¿è¡Œçš„æœ€çŸ­æ—¶é—´ï¼Œåˆ°ç‚¹åŽå®ƒä¼šå‘ä½ å‘é€é€šçŸ¥ éšè—æ´»åŠ¨çŠ¶æ€æ  zenmode tqdm_notebook ä¸ºå¾ªçŽ¯ä»£ç æ˜¾ç¤ºæ‰§è¡Œè¿›åº¦æ¡ 12# å…ˆå®‰è£… tqdm ï¼špip install tqdm# ä½¿ç”¨æ—¶å¯¼å…¥ï¼šfrom tqdm import tqdm_notebook è„šæœ¬è‡ªåŠ¨ä¿å­˜ AutoSaveTime å‚è€ƒæ–‡ç« å®˜ç½‘æ•™ç¨‹ jupyter notebookçš„æ’ä»¶æ‹“å±•â€”-jupyter_contrib_nbextensions ä½¿ç”¨Jupyter Notebookç¼–å†™æŠ€æœ¯æ–‡æ¡£]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>windows</tag>
        <tag>python</tag>
        <tag>juypter</tag>
        <tag>nbextension</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library webbrowser]]></title>
    <url>%2F2020%2F01%2F03%2Fpython-standard-library-webbrowser%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“ä¹‹ webbrowseræ²¡å•¥å‰æä¸€å¼ å›¾è¡¨ç¤ºæˆ‘çŽ°åœ¨çš„å¿ƒæƒ… æ ‡å‡†åº“ webbrowserwebbrowser æ¨¡å—æä¾›äº†ä¸€ä¸ªé«˜çº§æŽ¥å£ï¼Œå…è®¸å‘ç”¨æˆ·æ˜¾ç¤ºåŸºäºŽWebçš„æ–‡æ¡£ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåªéœ€ä»Žè¯¥æ¨¡å—è°ƒç”¨ open() å‡½æ•°å°±å¯ä»¥äº†ã€‚ åœ¨ Unix ä¸‹ï¼Œå›¾å½¢æµè§ˆå™¨åœ¨ X11 ä¸‹æ˜¯é¦–é€‰ï¼Œä½†å¦‚æžœå›¾å½¢æµè§ˆå™¨ä¸å¯ç”¨æˆ– X11 æ˜¾ç¤ºä¸å¯ç”¨ï¼Œåˆ™å°†ä½¿ç”¨æ–‡æœ¬æ¨¡å¼æµè§ˆå™¨ã€‚ å¦‚æžœä½¿ç”¨æ–‡æœ¬æ¨¡å¼æµè§ˆå™¨ï¼Œåˆ™è°ƒç”¨è¿›ç¨‹å°†é˜»å¡žï¼Œç›´åˆ°ç”¨æˆ·é€€å‡ºæµè§ˆå™¨ã€‚ å¦‚æžœå­˜åœ¨çŽ¯å¢ƒå˜é‡ BROWSER ï¼Œåˆ™å°†å…¶è§£é‡Šä¸º os.pathsep åˆ†éš”çš„æµè§ˆå™¨åˆ—è¡¨ï¼Œä»¥ä¾¿åœ¨å¹³å°é»˜è®¤å€¼ä¹‹å‰å°è¯•ã€‚ å½“åˆ—è¡¨éƒ¨åˆ†çš„å€¼åŒ…å«å­—ç¬¦ä¸² ï¼…s æ—¶ï¼Œå®ƒè¢«è§£é‡Šä¸ºä¸€ä¸ªæ–‡å­—æµè§ˆå™¨å‘½ä»¤è¡Œï¼Œç”¨äºŽæ›¿æ¢ ï¼…s çš„å‚æ•° URL ï¼›å¦‚æžœè¯¥éƒ¨åˆ†ä¸åŒ…å« ï¼…sï¼Œåˆ™å®ƒåªè¢«è§£é‡Šä¸ºè¦å¯åŠ¨çš„æµè§ˆå™¨çš„åç§°ã€‚ è„šæœ¬ webbrowser å¯ä»¥ç”¨ä½œæ¨¡å—çš„å‘½ä»¤è¡Œç•Œé¢ã€‚å®ƒæŽ¥å—ä¸€ä¸ª URL ä½œä¸ºå‚æ•°ã€‚è¿˜æŽ¥å—ä»¥ä¸‹å¯é€‰å‚æ•°ï¼š-n å¦‚æžœå¯èƒ½ï¼Œåœ¨æ–°çš„æµè§ˆå™¨çª—å£ä¸­æ‰“å¼€ URL ï¼› -t åœ¨æ–°çš„æµè§ˆå™¨é¡µé¢ï¼ˆâ€œæ ‡ç­¾â€ï¼‰ä¸­æ‰“å¼€ URLã€‚è¿™äº›é€‰æ‹©å½“ç„¶æ˜¯ç›¸äº’æŽ’æ–¥çš„ã€‚ç”¨æ³•ç¤ºä¾‹: 1python -m webbrowser -t "https://jeffsui.github.io" å¼‚å¸¸exception webbrowser.Error å‘ç”Ÿæµè§ˆå™¨æŽ§ä»¶é”™è¯¯æ—¶å¼•å‘å¼‚å¸¸ã€‚ å‡½æ•° webbrowser.`open`(url, new=0, autoraise=True) ä½¿ç”¨é»˜è®¤æµè§ˆå™¨æ˜¾ç¤º urlã€‚ å¦‚æžœ new ä¸º 0ï¼Œåˆ™å°½å¯èƒ½åœ¨åŒä¸€æµè§ˆå™¨çª—å£ä¸­æ‰“å¼€ urlã€‚ å¦‚æžœ new ä¸º 1ï¼Œåˆ™å°½å¯èƒ½æ‰“å¼€æ–°çš„æµè§ˆå™¨çª—å£ã€‚ å¦‚æžœ new ä¸º 2ï¼Œåˆ™å°½å¯èƒ½æ‰“å¼€æ–°çš„æµè§ˆå™¨é¡µé¢ï¼ˆâ€œæ ‡ç­¾â€ï¼‰ã€‚ å¦‚æžœ autoraise ä¸º â€œTrueâ€ï¼Œåˆ™ä¼šå°½å¯èƒ½ç½®å‰çª—å£ï¼ˆè¯·æ³¨æ„ï¼Œåœ¨è®¸å¤šçª—å£ç®¡ç†å™¨ä¸‹ï¼Œæ— è®ºæ­¤å˜é‡çš„è®¾ç½®å¦‚ä½•ï¼Œéƒ½ä¼šç½®å‰çª—å£ï¼‰ã€‚è¯·æ³¨æ„ï¼Œåœ¨æŸäº›å¹³å°ä¸Šï¼Œå°è¯•ä½¿ç”¨æ­¤å‡½æ•°æ‰“å¼€æ–‡ä»¶åï¼Œå¯èƒ½ä¼šèµ·ä½œç”¨å¹¶å¯åŠ¨æ“ä½œç³»ç»Ÿçš„å…³è”ç¨‹åºã€‚ ä½†æ˜¯ï¼Œè¿™ç§æ–¹å¼ä¸è¢«æ”¯æŒä¹Ÿä¸å¯ç§»æ¤ã€‚ä½¿ç”¨ url å‚æ•°ä¼šå¼•å‘ auditing event webbrowser.open ã€‚ webbrowser.open_new(url) å¦‚æžœå¯èƒ½ï¼Œåœ¨é»˜è®¤æµè§ˆå™¨çš„æ–°çª—å£ä¸­æ‰“å¼€ urlï¼Œå¦åˆ™ï¼Œåœ¨å”¯ä¸€çš„æµè§ˆå™¨çª—å£ä¸­æ‰“å¼€ urlã€‚ webbrowser.open_new_tab(url) å¦‚æžœå¯èƒ½ï¼Œåœ¨é»˜è®¤æµè§ˆå™¨çš„æ–°é¡µé¢ï¼ˆâ€œæ ‡ç­¾â€ï¼‰ä¸­æ‰“å¼€ urlï¼Œå¦åˆ™ç­‰æ•ˆäºŽ open_new()ã€‚ webbrowser.get(*using=None*) è¿”å›žæµè§ˆå™¨ç±»åž‹ä¸º using æŒ‡å®šçš„æŽ§åˆ¶å™¨å¯¹è±¡ã€‚ å¦‚æžœ using ä¸º Noneï¼Œåˆ™è¿”å›žé€‚ç”¨äºŽè°ƒç”¨è€…çŽ¯å¢ƒçš„é»˜è®¤æµè§ˆå™¨çš„æŽ§åˆ¶å™¨ã€‚ webbrowser.register(name, constructor, instance=None, **, preferred=False*) æ³¨å†Œ name æµè§ˆå™¨ç±»åž‹ã€‚ æ³¨å†Œæµè§ˆå™¨ç±»åž‹åŽï¼Œ get() å‡½æ•°å¯ä»¥è¿”å›žè¯¥æµè§ˆå™¨ç±»åž‹çš„æŽ§åˆ¶å™¨ã€‚ å¦‚æžœæ²¡æœ‰æä¾› instanceï¼Œæˆ–è€…ä¸º Noneï¼Œconstructor å°†åœ¨æ²¡æœ‰å‚æ•°çš„æƒ…å†µä¸‹è¢«è°ƒç”¨ï¼Œä»¥åœ¨éœ€è¦æ—¶åˆ›å»ºå®žä¾‹ã€‚ å¦‚æžœæä¾›äº† instanceï¼Œåˆ™æ°¸è¿œä¸ä¼šè°ƒç”¨ constructorï¼Œå¹¶ä¸”å¯èƒ½æ˜¯ Noneã€‚å°† preferred è®¾ç½®ä¸º True ä½¿å¾—è¿™ä¸ªæµè§ˆå™¨æˆä¸º get() ä¸å¸¦å‚æ•°è°ƒç”¨çš„é¦–é€‰ç»“æžœã€‚ å¦åˆ™ï¼Œåªæœ‰åœ¨æ‚¨è®¡åˆ’è®¾ç½® BROWSER å˜é‡ï¼Œæˆ–ä½¿ç”¨ä¸Žæ‚¨å£°æ˜Žçš„å¤„ç†ç¨‹åºçš„åç§°ç›¸åŒ¹é…çš„éžç©ºå‚æ•°è°ƒç”¨ get() æ—¶ï¼Œæ­¤å…¥å£ç‚¹æ‰æœ‰ç”¨ã€‚ æµè§ˆå™¨ç±»åž‹é¢„å®šä¹‰äº†è®¸å¤šæµè§ˆå™¨ç±»åž‹ã€‚ æ­¤è¡¨ç»™å‡ºäº†å¯ä»¥ä¼ é€’ç»™ get() å‡½æ•°çš„ç±»åž‹åç§°ä»¥åŠæŽ§åˆ¶å™¨ç±»çš„ç›¸åº”å®žä¾‹åŒ–ï¼Œè¿™äº›éƒ½åœ¨æ­¤æ¨¡å—ä¸­å®šä¹‰ã€‚ ç±»åž‹å ç±»å æ³¨é‡Š &#39;mozilla&#39; Mozilla(&#39;mozilla&#39;) &#39;firefox&#39; Mozilla(&#39;mozilla&#39;) &#39;netscape&#39; Mozilla(&#39;netscape&#39;) &#39;galeon&#39; Galeon(&#39;galeon&#39;) &#39;epiphany&#39; Galeon(&#39;epiphany&#39;) &#39;skipstone&#39; BackgroundBrowser(&#39;skipstone&#39;) &#39;kfmclient&#39; Konqueror() (1) &#39;konqueror&#39; Konqueror() (1) &#39;kfm&#39; Konqueror() (1) &#39;mosaic&#39; BackgroundBrowser(&#39;mosaic&#39;) &#39;opera&#39; Opera() &#39;grail&#39; Grail() &#39;links&#39; GenericBrowser(&#39;links&#39;) &#39;elinks&#39; Elinks(&#39;elinks&#39;) &#39;lynx&#39; GenericBrowser(&#39;lynx&#39;) &#39;w3m&#39; GenericBrowser(&#39;w3m&#39;) &#39;windows-default&#39; WindowsDefault (2) &#39;macosx&#39; MacOSX(&#39;default&#39;) (3) &#39;safari&#39; MacOSX(&#39;safari&#39;) (3) &#39;google-chrome&#39; Chrome(&#39;google-chrome&#39;) &#39;chrome&#39; Chrome(&#39;chrome&#39;) &#39;chromium&#39; Chromium(&#39;chromium&#39;) &#39;chromium-browser&#39; Chromium(&#39;chromium-browser&#39;) ç®€å•çš„ä¾‹å­: 1234567url = 'http://docs.python.org/'# Open URL in a new tab, if a browser window is already open.webbrowser.open_new_tab(url)# Open URL in new window, raising the window if possible.webbrowser.open_new(url) æµè§ˆå™¨æŽ§åˆ¶å™¨å¯¹è±¡æµè§ˆå™¨æŽ§åˆ¶å™¨æä¾›ä¸‰ä¸ªä¸Žæ¨¡å—çº§ä¾¿æ·å‡½æ•°ç›¸åŒçš„æ–¹æ³•ï¼š controller.open(url, new=0, autoraise=True)` ä½¿ç”¨æ­¤æŽ§åˆ¶å™¨å¤„ç†çš„æµè§ˆå™¨æ˜¾ç¤º urlã€‚ å¦‚æžœ new ä¸º 1ï¼Œåˆ™å°½å¯èƒ½æ‰“å¼€æ–°çš„æµè§ˆå™¨çª—å£ã€‚ å¦‚æžœ new ä¸º 2ï¼Œåˆ™å°½å¯èƒ½æ‰“å¼€æ–°çš„æµè§ˆå™¨é¡µé¢ï¼ˆâ€œæ ‡ç­¾â€ï¼‰ã€‚ controller.open_new(url)` å¦‚æžœå¯èƒ½ï¼Œåœ¨æ­¤æŽ§åˆ¶å™¨å¤„ç†çš„æµè§ˆå™¨çš„æ–°çª—å£ä¸­æ‰“å¼€ url ï¼Œå¦åˆ™ï¼Œåœ¨å”¯ä¸€çš„æµè§ˆå™¨çª—å£ä¸­æ‰“å¼€ url ã€‚ åˆ«å open_new()ã€‚ controller.open_new_tab(url)` å¦‚æžœå¯èƒ½ï¼Œåœ¨æ­¤æŽ§åˆ¶å™¨å¤„ç†çš„æµè§ˆå™¨çš„æ–°é¡µé¢ï¼ˆâ€œæ ‡ç­¾â€ï¼‰ä¸­æ‰“å¼€ urlï¼Œå¦åˆ™ç­‰æ•ˆäºŽ open_new() æ€»ç»“æ ‡å‡†åº“ä¸­çš„webbrowseråªæä¾›äº†ä¸€ä¸ªç®€å•çš„æ“ä½œæœ¬åœ°æµè§ˆå™¨çš„æŽ¥å£ã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>webbrowser</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library csv]]></title>
    <url>%2F2020%2F01%2F02%2Fpython-standard-library-csv%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“å­¦ä¹ ä¹‹csvå‰è¨€2019å¹´ç«‹çš„flag,ä»Šå¹´ç»§ç»­,æ ‡å‡†åº“ç³»åˆ—æ–‡ç« ç»§ç»­æ›´æ–°ã€‚ ä»Šå¤©æ˜¯çœŸå†·å•Š,å±‹é‡Œå¤´æ‰16â„ƒ,åªèƒ½ç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤ºæˆ‘çš„å¿ƒæƒ…ã€‚ æ ‡å‡†åº“ csvæ–‡æ¡£è·¯å¾„pythonæ ‡å‡†åº“csv CSV æ–‡ä»¶æ ¼å¼æ–‡ä»¶æ‰©å±•åä¸º.csv,é€šç”¨çš„ç”µå­è¡¨æ ¼æ–‡ä»¶æ ¼å¼,ç»å¸¸ä½¿ç”¨åœ¨æ•°æ®åˆ†æžä¸­ã€‚ åˆ†éš”ç¬¦å¯èƒ½æœ‰æ‰€å·®åˆ«, pythonä¸­çš„csvæ¨¡å—æä¾›äº†å¯¹csvæ–‡ä»¶çš„è¯»å†™æ“ä½œ,éžå¸¸æ–¹ä¾¿ã€‚ csv å¸¸ç”¨æ–¹æ³•csv.reader(csvfile,dialect=&#39;excel&#39;, ***fmtparams) è¿”å›žä¸€ä¸ªreaderå¯¹è±¡,è¯¥å¯¹è±¡éåŽ†csvfileã€‚csvå¯¹è±¡å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡,åªè¦è¿™ä¸ªå¯¹è±¡æ”¯æŒiteratableåè®®,å¹¶åœ¨æ¯æ¬¡è°ƒç”¨__next__()æ–¹æ³•æ—¶éƒ½è¿”å›žå­—ç¬¦ä¸²å³å¯ã€‚å¦‚æžœcsvfileæ˜¯æ–‡ä»¶å¯¹è±¡,åˆ™æ‰“å¼€å®ƒæ—¶åº”ä½¿ç”¨newline=&#39;&#39;ã€‚å¯é€‰å‚æ•°dialectæ˜¯ç”¨äºŽä¸åŒçš„csvæ–‡ä»¶ç±»åž‹,å®ƒå¯ä»¥æ˜¯ Dialect ç±»çš„å­ç±»çš„å®žä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ list_dialects() å‡½æ•°è¿”å›žçš„å­—ç¬¦ä¸²ä¹‹ä¸€ã€‚å®Œæ•´çš„è§£é‡Šå¯ä»¥å‚è€ƒcsvæ–‡ä»¶æ ¼å¼å‚æ•°ã€‚ csvæ–‡ä»¶çš„æ¯ä¸€è¡Œéƒ½ä¼šé»˜è®¤å½“åšå­—ç¬¦ä¸²åˆ—è¡¨è§£æž,é™¤éžæŒ‡å®šäº† QUOTE_NONNUMERIC æ ¼å¼é€‰é¡¹ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæœªåŠ å¼•å·çš„å­—æ®µä¼šè½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼‰ï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œè‡ªåŠ¨æ•°æ®ç±»åž‹è½¬æ¢ã€‚ ä¸€ä¸ªè¯»æ–‡ä»¶ä¾‹å­ 1234567&gt;&gt;&gt; import csv&gt;&gt;&gt; with open('eggs.csv', newline='') as csvfile:... spamreader = csv.reader(csvfile, delimiter=' ', quotechar='|')... for row in spamreader:... print(', '.join(row))Spam, Spam, Spam, Spam, Spam, Baked BeansSpam, Lovely Spam, Wonderful Spam csv.writer(csvfile, dialect=&#39;excel&#39;, **fmtparams) è¿”å›žä¸€ä¸ª writer å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è´Ÿè´£å°†ç”¨æˆ·çš„æ•°æ®åœ¨ç»™å®šçš„æ–‡ä»¶ç±»å¯¹è±¡ä¸Šè½¬æ¢ä¸ºå¸¦åˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²ã€‚csvfile å¯ä»¥æ˜¯å…·æœ‰ write() æ–¹æ³•çš„ä»»ä½•å¯¹è±¡ã€‚å¦‚æžœ csvfile æ˜¯æ–‡ä»¶å¯¹è±¡ï¼Œåˆ™æ‰“å¼€å®ƒæ—¶åº”ä½¿ç”¨ newline=&#39;&#39;ã€‚ ä¸ºäº†å°½é‡ç®€åŒ–ä¸Žæ•°æ®åº“ API æ¨¡å—ä¹‹é—´çš„å¯¹æŽ¥ï¼ŒNone å€¼ä¼šå†™å…¥ä¸ºç©ºå­—ç¬¦ä¸²ã€‚è™½ç„¶è¿™ä¸ªè½¬æ¢æ˜¯ä¸å¯é€†çš„ï¼Œä½†å®ƒè®© SQL ç©ºæ•°æ®å€¼è½¬å‚¨åˆ° CSV æ–‡ä»¶æ›´å®¹æ˜“ï¼Œè€Œæ— éœ€é¢„å¤„ç†ä»Ž cursor.fetch* è°ƒç”¨è¿”å›žçš„æ•°æ®ã€‚å†™å…¥å‰ï¼Œæ‰€æœ‰éžå­—ç¬¦ä¸²æ•°æ®éƒ½å…ˆç”¨ str() è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å†å†™å…¥ã€‚ ä¸€ä¸ªå†™æ–‡ä»¶ä¾‹å­ 123456import csvwith open('eggs.csv', 'w', newline='') as csvfile: spamwriter = csv.writer(csvfile, delimiter=' ', quotechar='|', quoting=csv.QUOTE_MINIMAL) spamwriter.writerow(['Spam'] * 5 + ['Baked Beans']) spamwriter.writerow(['Spam', 'Lovely Spam', 'Wonderful Spam']) csv.register_dialect(name[, dialect[, **fmtparams]]) å°† name ä¸Ž dialect å…³è”èµ·æ¥ã€‚name å¿…é¡»æ˜¯å­—ç¬¦ä¸²ã€‚è¦æŒ‡å®šå˜ç§ (dialect)ï¼Œå¯ä»¥ç»™å‡º Dialect çš„å­ç±»ï¼Œæˆ–ç»™å‡º fmtparams å…³é”®å­—å‚æ•°ï¼Œæˆ–ä¸¤è€…éƒ½ç»™å‡ºï¼ˆæ­¤æ—¶å…³é”®å­—å‚æ•°ä¼šè¦†ç›– dialect å‚æ•°ï¼‰ã€‚ æœ‰å…³æ–¹è¨€å’Œæ ¼å¼è®¾ç½®å‚æ•°çš„å®Œæ•´è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ æ–¹è¨€æ ¼å¼å‚æ•° éƒ¨åˆ†ã€‚ å…¶ä»–æ–¹æ³•: csv.unregister_dialect(name) ä»Žå˜ç§æ³¨å†Œè¡¨ä¸­åˆ é™¤ name å¯¹åº”çš„å˜ç§ã€‚å¦‚æžœ name ä¸æ˜¯å·²æ³¨å†Œçš„å˜ç§åç§°ï¼Œåˆ™æŠ›å‡º Error å¼‚å¸¸ã€‚ csv.get_dialect(name) è¿”å›ž name å¯¹åº”çš„å˜ç§ã€‚å¦‚æžœ name ä¸æ˜¯å·²æ³¨å†Œçš„å˜ç§åç§°ï¼Œåˆ™æŠ›å‡º Error å¼‚å¸¸ã€‚è¯¥å‡½æ•°è¿”å›žçš„æ˜¯ä¸å¯å˜çš„ Dialect å¯¹è±¡ã€‚ csv.list_dialects() è¿”å›žæ‰€æœ‰å·²æ³¨å†Œå˜ç§çš„åç§°ã€‚ csv.field_size_limit([new_limit]) è¿”å›žè§£æžå™¨å½“å‰å…è®¸çš„æœ€å¤§å­—æ®µå¤§å°ã€‚å¦‚æžœæŒ‡å®šäº† new_limitï¼Œåˆ™å®ƒå°†æˆä¸ºæ–°çš„æœ€å¤§å­—æ®µå¤§å°ã€‚ csvæ¨¡å—å®šä¹‰çš„ç±»class csv.DictReader(*f*, *fieldnames=None*, *restkey=None*, *restval=None*, *dialect=&#39;excel&#39;*, **args*, ***kwds*) åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨æ“ä½œä¸Šç±»ä¼¼äºŽå¸¸è§„ readerï¼Œä½†æ˜¯å°†æ¯è¡Œä¸­çš„ä¿¡æ¯æ˜ å°„åˆ°ä¸€ä¸ª dictï¼Œè¯¥ dict çš„é”®ç”± fieldnames å¯é€‰å‚æ•°ç»™å‡ºã€‚ fieldnames å‚æ•°æ˜¯ä¸€ä¸ª sequenceã€‚å¦‚æžœçœç•¥ fieldnamesï¼Œåˆ™æ–‡ä»¶ f ç¬¬ä¸€è¡Œä¸­çš„å€¼å°†ç”¨ä½œå­—æ®µåã€‚æ— è®ºå­—æ®µåæ˜¯å¦‚ä½•ç¡®å®šçš„ï¼Œå­—å…¸éƒ½å°†ä¿ç•™å…¶åŽŸå§‹é¡ºåºã€‚ å¦‚æžœæŸä¸€è¡Œä¸­çš„å­—æ®µå¤šäºŽå­—æ®µåï¼Œåˆ™å…¶ä½™å­—æ®µå°†æ”¾å…¥åˆ—è¡¨ä¸­ï¼Œå­—æ®µåç”± restkey æŒ‡å®šï¼ˆé»˜è®¤ä¸º Noneï¼‰ã€‚å¦‚æžœéžç©ºç™½è¡Œçš„å­—æ®µå°‘äºŽå­—æ®µåï¼Œåˆ™ç¼ºå°‘çš„å€¼å°†ç”¨ None å¡«å……ã€‚ æ‰€æœ‰å…¶ä»–å¯é€‰æˆ–å…³é”®å­—å‚æ•°éƒ½ä¼ é€’ç»™åº•å±‚çš„ reader å®žä¾‹ã€‚ 3.8 ä¸­,è¿”å›žçš„è¡Œæ˜¯ dict ç±»åž‹ã€‚ ä¸€ä¸ªä½¿ç”¨DictReaderä¾‹å­ 1234567891011&gt;&gt;&gt; import csv&gt;&gt;&gt; with open('names.csv', newline='') as csvfile:... reader = csv.DictReader(csvfile)... for row in reader:... print(row['first_name'], row['last_name'])...Eric IdleJohn Cleese&gt;&gt;&gt; print(row)&#123;'first_name': 'John', 'last_name': 'Cleese'&#125; class csv.DictWriter(f, fieldnames, restval=&#39;&#39;, extrasaction=&#39;raise&#39;, dialect=&#39;excel&#39;, **args, **kwds) åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨æ“ä½œä¸Šç±»ä¼¼å¸¸è§„ writerï¼Œä½†ä¼šå°†å­—å…¸æ˜ å°„åˆ°è¾“å‡ºè¡Œã€‚ fieldnames å‚æ•°æ˜¯ç”±é”®ç»„æˆçš„ åºåˆ—ï¼Œå®ƒæŒ‡å®šå­—å…¸ä¸­å€¼çš„é¡ºåºï¼Œè¿™äº›å€¼ä¼šæŒ‰æŒ‡å®šé¡ºåºä¼ é€’ç»™ writerow() æ–¹æ³•å¹¶å†™å…¥æ–‡ä»¶ fã€‚ å¦‚æžœå­—å…¸ç¼ºå°‘ fieldnames ä¸­çš„é”®ï¼Œåˆ™å¯é€‰å‚æ•° restval ç”¨äºŽæŒ‡å®šè¦å†™å…¥çš„å€¼ã€‚ å¦‚æžœä¼ é€’ç»™ writerow() æ–¹æ³•çš„å­—å…¸çš„æŸäº›é”®åœ¨ fieldnames ä¸­æ‰¾ä¸åˆ°ï¼Œåˆ™å¯é€‰å‚æ•° extrasaction ç”¨äºŽæŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œã€‚ å¦‚æžœå°†å…¶è®¾ç½®ä¸ºé»˜è®¤å€¼ &#39;raise&#39;ï¼Œåˆ™ä¼šå¼•å‘ ValueErrorã€‚ å¦‚æžœå°†å…¶è®¾ç½®ä¸º &#39;ignore&#39;ï¼Œåˆ™å­—å…¸ä¸­çš„å…¶ä»–é”®å€¼å°†è¢«å¿½ç•¥ã€‚ æ‰€æœ‰å…¶ä»–å¯é€‰æˆ–å…³é”®å­—å‚æ•°éƒ½ä¼ é€’ç»™åº•å±‚çš„ writer å®žä¾‹ã€‚ æ³¨æ„ï¼Œä¸Ž DictReader ç±»ä¸åŒï¼ŒDictWriter ç±»çš„ fieldnames å‚æ•°ä¸æ˜¯å¯é€‰å‚æ•° ä¸€ä¸ªä½¿ç”¨DictWriterå†™å…¥æ–‡ä»¶ä¾‹å­ 12345678910import csvwith open('names.csv', 'w', newline='') as csvfile: fieldnames = ['first_name', 'last_name'] writer = csv.DictWriter(csvfile, fieldnames=fieldnames) writer.writeheader() writer.writerow(&#123;'first_name': 'Baked', 'last_name': 'Beans'&#125;) writer.writerow(&#123;'first_name': 'Lovely', 'last_name': 'Spam'&#125;) writer.writerow(&#123;'first_name': 'Wonderful', 'last_name': 'Spam'&#125;) å…¶ä»–æ–¹æ³•: class csv.Dialect Dialect ç±»æ˜¯ä¸»è¦ä¾èµ–äºŽå…¶å±žæ€§çš„å®¹å™¨ç±»ï¼Œç”¨äºŽå°†å®šä¹‰å¥½çš„å‚æ•°ä¼ é€’ç»™ç‰¹å®šçš„ reader æˆ– writer å®žä¾‹ã€‚ class csv.excel excel ç±»å®šä¹‰äº† Excel ç”Ÿæˆçš„ CSV æ–‡ä»¶çš„å¸¸è§„å±žæ€§ã€‚å®ƒåœ¨å˜ç§æ³¨å†Œè¡¨ä¸­çš„åç§°æ˜¯ &#39;excel&#39;ã€‚ class csv.excel_tab excel_tab ç±»å®šä¹‰äº† Excel ç”Ÿæˆçš„ã€åˆ¶è¡¨ç¬¦åˆ†éš”çš„ CSV æ–‡ä»¶çš„å¸¸è§„å±žæ€§ã€‚å®ƒåœ¨å˜ç§æ³¨å†Œè¡¨ä¸­çš„åç§°æ˜¯ &#39;excel-tab&#39;ã€‚ class csv.unix_dialect unix_dialect ç±»å®šä¹‰äº†åœ¨ UNIX ç³»ç»Ÿä¸Šç”Ÿæˆçš„ CSV æ–‡ä»¶çš„å¸¸è§„å±žæ€§ï¼Œå³ä½¿ç”¨ &#39;\n&#39; ä½œä¸ºæ¢è¡Œç¬¦ï¼Œä¸”æ‰€æœ‰å­—æ®µéƒ½æœ‰å¼•å·åŒ…å›´ã€‚å®ƒåœ¨å˜ç§æ³¨å†Œè¡¨ä¸­çš„åç§°æ˜¯ &#39;unix&#39;ã€‚ class csv.SnifferSniffer ç±»ç”¨äºŽæŽ¨æ–­ CSV æ–‡ä»¶çš„æ ¼å¼ã€‚ Sniffer ç±»æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼š sniff(sample, delimiters=None) åˆ†æžç»™å®šçš„ sample å¹¶è¿”å›žä¸€ä¸ª Dialect å­ç±»ï¼Œè¯¥å­ç±»ä¸­åŒ…å«äº†åˆ†æžå‡ºçš„æ ¼å¼å‚æ•°ã€‚å¦‚æžœç»™å‡ºå¯é€‰çš„ delimiters å‚æ•°ï¼Œåˆ™è¯¥å‚æ•°ä¼šè¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åŒ…å«äº†å¯èƒ½çš„æœ‰æ•ˆå®šç•Œç¬¦ã€‚ has_header(sample) åˆ†æžç¤ºä¾‹æ–‡æœ¬ï¼ˆå‡å®šä¸º CSV æ ¼å¼ï¼‰ï¼Œå¦‚æžœç¬¬ä¸€è¡Œå¾ˆå¯èƒ½æ˜¯ä¸€ç³»åˆ—åˆ—æ ‡é¢˜ï¼Œåˆ™è¿”å›ž Trueã€‚ ä¸€ä¸ªä½¿ç”¨Snifferçš„ä¾‹å­: 12345with open('example.csv', newline='') as csvfile: dialect = csv.Sniffer().sniff(csvfile.read(1024)) csvfile.seek(0) reader = csv.reader(csvfile, dialect) # ... process CSV file contents here ... csv ä¸­å®šä¹‰çš„å¸¸é‡ csv.QUOTE_ALL æŒ‡ç¤º writer å¯¹è±¡ç»™æ‰€æœ‰å­—æ®µåŠ ä¸Šå¼•å·ã€‚ csv.QUOTE_MINIMAL æŒ‡ç¤º writer å¯¹è±¡ä»…ä¸ºåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ å®šç•Œç¬¦ã€å¼•å·å­—ç¬¦ æˆ– è¡Œç»“æŸç¬¦ ä¸­çš„ä»»ä½•å­—ç¬¦ï¼‰çš„å­—æ®µåŠ ä¸Šå¼•å·ã€‚ csv.QUOTE_NONNUMERIC æŒ‡ç¤º writer å¯¹è±¡ä¸ºæ‰€æœ‰éžæ•°å­—å­—æ®µåŠ ä¸Šå¼•å·ã€‚æŒ‡ç¤º reader å°†æ‰€æœ‰æœªç”¨å¼•å·å¼•å‡ºçš„å­—æ®µè½¬æ¢ä¸º float ç±»åž‹ã€‚ csv.QUOTE_NONE æŒ‡ç¤º writer å¯¹è±¡ä¸ä½¿ç”¨å¼•å·å¼•å‡ºå­—æ®µã€‚å½“ å®šç•Œç¬¦ å‡ºçŽ°åœ¨è¾“å‡ºæ•°æ®ä¸­æ—¶ï¼Œå…¶å‰é¢åº”è¯¥æœ‰ è½¬ä¹‰ç¬¦ã€‚å¦‚æžœæœªè®¾ç½® è½¬ä¹‰ç¬¦ï¼Œåˆ™é‡åˆ°ä»»ä½•éœ€è¦è½¬ä¹‰çš„å­—ç¬¦æ—¶ï¼Œwriter éƒ½ä¼šæŠ›å‡º Error å¼‚å¸¸ã€‚æŒ‡ç¤º reader ä¸å¯¹å¼•å·å­—ç¬¦è¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚ csvæ¨¡å—å®šä¹‰äº†ä»¥ä¸‹å¼‚å¸¸ï¼š exception csv.Error è¯¥å¼‚å¸¸å¯èƒ½ç”±ä»»ä½•å‘ç”Ÿé”™è¯¯çš„å‡½æ•°æŠ›å‡ºã€‚ å¤‡æ³¨å¦‚æžœæ²¡æœ‰æŒ‡å®š newline=&#39;&#39;ï¼Œåˆ™åµŒå…¥å¼•å·ä¸­çš„æ¢è¡Œç¬¦å°†æ— æ³•æ­£ç¡®è§£æžï¼Œå¹¶ä¸”åœ¨å†™å…¥æ—¶ï¼Œä½¿ç”¨ \r\n æ¢è¡Œçš„å¹³å°ä¼šæœ‰å¤šä½™çš„ \r å†™å…¥ã€‚ç”±äºŽ csv æ¨¡å—ä¼šæ‰§è¡Œè‡ªå·±çš„ï¼ˆé€šç”¨ï¼‰æ¢è¡Œç¬¦å¤„ç†ï¼Œå› æ­¤æŒ‡å®š newline=&#39;&#39; åº”è¯¥æ€»æ˜¯å®‰å…¨çš„ã€‚ æ€»ç»“csvæ¨¡å—æ˜¯ä¸€ä¸ªéžå¸¸å®žç”¨çš„å¤„ç†csvæ–‡ä»¶çš„æ ‡å‡†åº“ï¼Œæä¾›äº†ä¸¤ç§å¤„ç†æ–¹æ³•ã€‚ ä¸€ä¸ªæ˜¯æŠŠcsvæ–‡ä»¶å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²åˆ—è¡¨è§£æžcsvæ–‡ä»¶çš„æ–¹æ³•,readerï¼Œ writerï¼Œ å¦ä¸€ä¸ªæ˜¯æŠŠcsvæ–‡ä»¶å¯¹è±¡å½“ä½œå­—å…¸è§£æžçš„ç±»dictReader, dictWriterã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>csv</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[using python venv to create virtual environment]]></title>
    <url>%2F2019%2F12%2F26%2Fusing-python-venv-to-create-virtual-environment%2F</url>
    <content type="text"><![CDATA[python env åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒå‰è¨€åˆæ–­æ›´äº†,é•¿æ­¤ä»¥å¾€,æˆ‘å¯èƒ½æ— æ³•å®Œæˆ100å¤©æ‰“å¡ä»»åŠ¡äº†ã€‚ çº¢åŒ…æ˜¯åˆºæ¿€è‡ªå·±å‰è¿›çš„åŠ¨åŠ›ã€‚ python æ ‡å‡†åº“03ä¹‹è™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºå‚è€ƒæ–‡æ¡£ pythonç›®å‰å®˜æ–¹æŽ¨èçš„å·¥å…·æ˜¯venv é¡ºä¾¿ä»‹ç»ä¸‹ç›®å‰å¸¸ç”¨çš„pythonè™šæ‹ŸçŽ¯å¢ƒå·¥å…· virsualenv pyvenv (3.3,3.4ä¸­æŽ¨èçš„è™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºå·¥å…·,3.6ä¸­è¢«å¼ƒç”¨) venv(3.6ä»¥åŽæŽ¨èçš„è™šæ‹ŸçŽ¯å¢ƒåˆ›å»ºå·¥å…·) åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªè™šæ‹ŸçŽ¯å¢ƒ 1python3 -m venv /path/to/new/virtual/environment windowsä¸‹ä½¿ç”¨venvæ¥åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒ 1c:\&gt;c:\Python35\python -m venv c:\path\to\myenv ä½¿ç”¨-hå‚æ•°å¯ä»¥æŸ¥çœ‹venvå‘½ä»¤è¡Œçš„å¸®åŠ©æ–‡æ¡£ 1234567891011121314151617181920212223242526usage: venv [-h] [--system-site-packages] [--symlinks | --copies] [--clear] [--upgrade] [--without-pip] [--prompt PROMPT] ENV_DIR [ENV_DIR ...]Creates virtual Python environments in one or more target directories.positional arguments: ENV_DIR A directory to create the environment in.optional arguments: -h, --help show this help message and exit --system-site-packages Give the virtual environment access to the system site-packages dir. --symlinks Try to use symlinks rather than copies, when symlinks are not the default for the platform. --copies Try to use copies rather than symlinks, even when symlinks are the default for the platform. --clear Delete the contents of the environment directory if it already exists, before environment creation. --upgrade Upgrade the environment directory to use this version of Python, assuming Python has been upgraded in-place. --without-pip Skips installing or upgrading pip in the virtual environment (pip is bootstrapped by default) --prompt PROMPT Provides an alternative prompt prefix for this environment. é™¤éžä½ ä½¿ç”¨äº†--without-pip å‚æ•°,å¦åˆ™ ensurepip æ¨¡å—ä¼šé»˜è®¤å®‰è£…pipæŒ‡ä»¤åˆ°åˆ›å»ºå¥½çš„è™šæ‹ŸçŽ¯å¢ƒä¸­ã€‚ ä¸€æ—¦ä¸€ä¸ªè™šæ‹ŸçŽ¯å¢ƒè¢«åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¿€æ´»è¿™ä¸ªè™šæ‹ŸçŽ¯å¢ƒã€‚ä¸åŒå¹³å°ä¸‹çš„æ¿€æ´»æ–¹å¼ç•¥æœ‰ä¸åŒ,ä¸‹é¢æ€»ç»“äº†å„ä¸ªå¹³å°ä¸‹è™šæ‹ŸçŽ¯å¢ƒçš„æ¿€æ´»å‘½ä»¤è„šæœ¬,è¯·å‚è€ƒã€‚ æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ å¹³å° Shell ç”¨äºŽæ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒçš„å‘½ä»¤ POSIX bash/zsh $ source /bin/activate fish $ . /bin/activate.fish csh/tcsh $ source /bin/activate.csh PowerShell Core $ /bin/Activate.ps1 Windows cmd.exe C:> \Scripts\activate.bat PowerShell PS C:> \Scripts\Activate.ps1 You donâ€™t specifically need to activate an environment; activation just prepends the virtual environmentâ€™s binary directory to your path, so that â€œpythonâ€ invokes the virtual environmentâ€™s Python interpreter and you can run installed scripts without having to use their full path. However, all scripts installed in a virtual environment should be runnable without activating it, and run with the virtual environmentâ€™s Python automatically. You can deactivate a virtual environment by typing â€œdeactivateâ€ in your shell. The exact mechanism is platform-specific and is an internal implementation detail (typically a script or shell function will be used). ä½ æ— éœ€å…³å¿ƒå¦‚ä½•æ¿€æ´»ä¸€ä¸ªè™šæ‹ŸçŽ¯å¢ƒï¼›ä½¿ç”¨ç›¸å¯¹äºŽé¡¹ç›®å½“å‰è·¯å¾„ä¸‹çš„å¯æ‰§è¡Œæ–¹æ³•,pythonè§£æžå™¨å°±å¯ä»¥æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒã€‚å·²ç»æ¿€æ´»çš„è™šæ‹ŸçŽ¯å¢ƒ, å°±å¯ä»¥ä½¿ç”¨pythonçš„å‘½ä»¤ç›´æŽ¥æ‰§è¡Œè„šæœ¬æˆ–è€…å®‰è£…å…¶ä»–è½¯ä»¶åŒ…åˆ°å½“å‰çš„è™šæ‹ŸçŽ¯å¢ƒï¼Œè€Œä¸éœ€è¦å…³å¿ƒæ˜¯å¦ä¼šæ±¡æŸ“æœ¬åœ°pythonçŽ¯å¢ƒçš„é—®é¢˜ã€‚åŒæ ·ï¼Œä½¿ç”¨deactivate å°±å¯ä»¥é€€å‡ºå½“å‰çš„è™šæ‹ŸçŽ¯å¢ƒã€‚ APIä¸‹é¢å±•ç¤ºçš„æ˜¯ä¸€ä¸ªä½¿ç”¨EnvBuilder åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰è™šæ‹ŸçŽ¯å¢ƒçš„è„šæœ¬ã€‚ 1class venv.EnvBuilder(system_site_packages=False, clear=False, symlinks=False, upgrade=False, with_pip=False, prompt=None) create(env_dir) system_site_packages â€“ ä¸€ä¸ªBooleanå€¼,æ˜¯å¦å°†site-packagesæ·»åŠ åˆ°è™šæ‹ŸçŽ¯å¢ƒä¸­ é»˜è®¤æ˜¯False. clear â€“ ä¸€ä¸ªBooleanå€¼,å¦‚æžœä¸ºçœŸ,å°†ä¼šåœ¨åˆ›å»ºçŽ¯å¢ƒä¹‹å‰æ¸…é™¤å·²ç»å­˜åœ¨çš„ç›®æ ‡è·¯å¾„. symlinks â€“ ä¸€ä¸ªBooleanå€¼,å¦‚æžœä¸ºçœŸ,å°†ä¼šåœ¨åˆ›å»ºçŽ¯å¢ƒå‰åˆ é™¤åŒ…å«å†…å®¹çš„ç›®å½• upgrade â€“ ä¸€ä¸ªBooleanå€¼,å¦‚æžœä¸ºçœŸ, åˆ™å°†ç”¨æ­£åœ¨è¿è¡Œçš„Pythonå‡çº§çŽ°æœ‰çŽ¯å¢ƒ - ç”¨äºŽåœ¨Pythonå°±åœ°å‡çº§ï¼ˆé»˜è®¤ä¸ºFalseï¼‰æ—¶ä½¿ç”¨ã€‚. with_pip â€“ ä¸€ä¸ªBooleanå€¼,å¦‚æžœä¸ºçœŸ,pipå‘½ä»¤å°†ä¼šå®‰è£…åˆ°è™šæ‹ŸçŽ¯å¢ƒä¸­ ,ä½¿ç”¨ ensurepip çš„é»˜è®¤ --default-pip å‚æ•°é€‰é¡¹. prompt â€“ åœ¨æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒåŽä½¿ç”¨çš„å­—ç¬¦ä¸²ï¼ˆé»˜è®¤ä¸ºNoneè¡¨ç¤ºå°†ä½¿ç”¨çŽ¯å¢ƒçš„ç›®å½•åç§°ï¼‰ã€‚. 1234567891011def create(self, env_dir): """ Create a virtualized Python environment in a directory. env_dir is the target directory to create an environment in. """ env_dir = os.path.abspath(env_dir) context = self.ensure_directories(env_dir) self.create_configuration(context) self.setup_python(context) self.setup_scripts(context) self.post_setup(context) ensure_directories(env_dir) åˆ›å»ºçŽ¯å¢ƒç›®å½•å’Œæ‰€æœ‰å¿…éœ€çš„ç›®å½•ï¼Œå¹¶è¿”å›žä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚è¿™åªæ˜¯å±žæ€§ï¼ˆå¦‚è·¯å¾„ï¼‰çš„æŒæœ‰è€…ï¼Œä¾›å…¶ä»–æ–¹æ³•ä½¿ç”¨ã€‚è¿™äº›ç›®å½•å·²è¢«å…è®¸å­˜åœ¨ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªclearæˆ–è¢«upgradeæŒ‡å®šä¸ºå…è®¸åœ¨çŽ°æœ‰çŽ¯å¢ƒç›®å½•ä¸Šè¿›è¡Œæ“ä½œå³å¯ã€‚ create_configuration(context) pyvenv.cfgåœ¨çŽ¯å¢ƒä¸­åˆ›å»ºé…ç½®æ–‡ä»¶ã€‚ setup_python(context) åœ¨çŽ¯å¢ƒä¸­åˆ›å»ºPythonå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆä»¥åŠWindowsä¸‹çš„DLLï¼‰çš„å‰¯æœ¬ã€‚åœ¨POSIXç³»ç»Ÿä¸­ï¼Œå¦‚æžœä¸€ä¸ªç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ python3.xä½¿ç”¨ï¼Œç¬¦å·é“¾æŽ¥pythonå’Œpython3å°†åˆ›å»ºæŒ‡å‘è¯¥å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé™¤éžå·²å­˜åœ¨å…·æœ‰è¿™äº›åç§°çš„æ–‡ä»¶ã€‚ setup_scripts(context) å°†é€‚åˆè¯¥å¹³å°çš„æ¿€æ´»è„šæœ¬å®‰è£…åˆ°è™šæ‹ŸçŽ¯å¢ƒä¸­ã€‚ post_setup(context) ä¸€ç§å ä½ç¬¦æ–¹æ³•ï¼Œå¯ä»¥åœ¨ç¬¬ä¸‰æ–¹å®žçŽ°ä¸­é‡å†™ï¼Œä»¥åœ¨è™šæ‹ŸçŽ¯å¢ƒä¸­é¢„å®‰è£…åŒ…æˆ–æ‰§è¡Œå…¶ä»–åŽåˆ›å»ºæ­¥éª¤ã€‚ æ­¤å¤–ï¼ŒEnvBuilderæä¾›è¿™ç§å·¥å…·æ–¹æ³•ï¼Œå¯ä»¥ä»Žè¢«ç§°ä¸ºsetup_scripts()æˆ–post_setup()åœ¨å­ç±»ä¸­ï¼Œä»¥ååŠ©å®‰è£…è‡ªå®šä¹‰è„šæœ¬åˆ°è™šæ‹ŸçŽ¯å¢ƒä¸­ã€‚install_scriptsï¼ˆä¸Šä¸‹æ–‡ï¼Œè·¯å¾„ï¼‰è·¯å¾„æ˜¯åº”åŒ…å«å­ç›®å½•â€œcommonâ€ï¼Œâ€œposixâ€ï¼Œâ€œntâ€çš„ç›®å½•çš„è·¯å¾„ï¼Œæ¯ä¸ªç›®å½•éƒ½åŒ…å«æŒ‡å‘çŽ¯å¢ƒä¸­binç›®å½•çš„è„šæœ¬ã€‚os.nameç»è¿‡ä¸€äº›æ–‡æœ¬æ›¿æ¢å ä½ç¬¦åŽï¼Œâ€œcommonâ€çš„å†…å®¹å’Œç›¸åº”çš„ç›®å½•è¢«å¤åˆ¶ï¼š __VENV_DIR__ è¢«æ›¿æ¢ä¸ºçŽ¯å¢ƒç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚ __VENV_NAME__ è¢«æ›¿æ¢ä¸ºçŽ¯å¢ƒåç§°ï¼ˆçŽ¯å¢ƒç›®å½•çš„æœ€ç»ˆè·¯å¾„æ®µï¼‰ã€‚ __VENV_PROMPT__ è¢«æç¤ºç¬¦æ›¿æ¢ï¼ˆçŽ¯å¢ƒåç§°ç”±æ‹¬å·æ‹¬èµ·æ¥ï¼Œå¹¶å¸¦æœ‰ä¸‹é¢çš„ç©ºæ ¼ï¼‰ __VENV_BIN_NAME__è¢«æ›¿æ¢ä¸ºbinç›®å½•çš„åç§°ï¼ˆbinæˆ–è€…Scriptsï¼‰ã€‚ __VENV_PYTHON__è¢«æ›¿æ¢ä¸ºçŽ¯å¢ƒå¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚å…è®¸ç›®å½•å­˜åœ¨ï¼ˆç”¨äºŽåœ¨çŽ°æœ‰çŽ¯å¢ƒæ­£åœ¨å‡çº§æ—¶ï¼‰ã€‚ è¿˜æœ‰ä¸€ä¸ªæ¨¡å—çº§çš„ä¾¿åˆ©åŠŸèƒ½ï¼š 12venv.createï¼ˆenv_dirï¼Œsystem_site_packages = Falseï¼Œclear = Falseï¼Œsymlinks =Falseï¼Œwith_pip = False ï¼‰ EnvBuilderç”¨ç»™å®šçš„å…³é”®å­—å‚æ•°åˆ›å»ºä¸€ä¸ªå‚æ•°ï¼Œå¹¶è°ƒç”¨create()å¹¶ä½¿ç”¨env_dirå‚æ•°ã€‚ ä¸€ä¸ªæ‰©å±•EnvBuilderä¾‹å­ä»¥ä¸‹è„šæœ¬å±•ç¤ºäº†å¦‚ä½•EnvBuilderé€šè¿‡å®žçŽ°å°†setuptoolså’Œpipå®‰è£…åˆ°åˆ›å»ºçš„è™šæ‹ŸçŽ¯å¢ƒä¸­çš„å­ç±»æ¥è¿›è¡Œæ‰©å±•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214import osimport os.pathfrom subprocess import Popen, PIPEimport sysfrom threading import Threadfrom urllib.parse import urlparsefrom urllib.request import urlretrieveimport venvclass ExtendedEnvBuilder(venv.EnvBuilder): """ This builder installs setuptools and pip so that you can pip or easy_install other packages into the created virtual environment. :param nodist: If true, setuptools and pip are not installed into the created virtual environment. :param nopip: If true, pip is not installed into the created virtual environment. :param progress: If setuptools or pip are installed, the progress of the installation can be monitored by passing a progress callable. If specified, it is called with two arguments: a string indicating some progress, and a context indicating where the string is coming from. The context argument can have one of three values: 'main', indicating that it is called from virtualize() itself, and 'stdout' and 'stderr', which are obtained by reading lines from the output streams of a subprocess which is used to install the app. If a callable is not specified, default progress information is output to sys.stderr. """ def __init__(self, *args, **kwargs): self.nodist = kwargs.pop('nodist', False) self.nopip = kwargs.pop('nopip', False) self.progress = kwargs.pop('progress', None) self.verbose = kwargs.pop('verbose', False) super().__init__(*args, **kwargs) def post_setup(self, context): """ Set up any packages which need to be pre-installed into the virtual environment being created. :param context: The information for the virtual environment creation request being processed. """ os.environ['VIRTUAL_ENV'] = context.env_dir if not self.nodist: self.install_setuptools(context) # Can't install pip without setuptools if not self.nopip and not self.nodist: self.install_pip(context) def reader(self, stream, context): """ Read lines from a subprocess' output stream and either pass to a progress callable (if specified) or write progress information to sys.stderr. """ progress = self.progress while True: s = stream.readline() if not s: break if progress is not None: progress(s, context) else: if not self.verbose: sys.stderr.write('.') else: sys.stderr.write(s.decode('utf-8')) sys.stderr.flush() stream.close() def install_script(self, context, name, url): _, _, path, _, _, _ = urlparse(url) fn = os.path.split(path)[-1] binpath = context.bin_path distpath = os.path.join(binpath, fn) # Download script into the virtual environment's binaries folder urlretrieve(url, distpath) progress = self.progress if self.verbose: term = '\n' else: term = '' if progress is not None: progress('Installing %s ...%s' % (name, term), 'main') else: sys.stderr.write('Installing %s ...%s' % (name, term)) sys.stderr.flush() # Install in the virtual environment args = [context.env_exe, fn] p = Popen(args, stdout=PIPE, stderr=PIPE, cwd=binpath) t1 = Thread(target=self.reader, args=(p.stdout, 'stdout')) t1.start() t2 = Thread(target=self.reader, args=(p.stderr, 'stderr')) t2.start() p.wait() t1.join() t2.join() if progress is not None: progress('done.', 'main') else: sys.stderr.write('done.\n') # Clean up - no longer needed os.unlink(distpath) def install_setuptools(self, context): """ Install setuptools in the virtual environment. :param context: The information for the virtual environment creation request being processed. """ url = 'https://bitbucket.org/pypa/setuptools/downloads/ez_setup.py' self.install_script(context, 'setuptools', url) # clear up the setuptools archive which gets downloaded pred = lambda o: o.startswith('setuptools-') and o.endswith('.tar.gz') files = filter(pred, os.listdir(context.bin_path)) for f in files: f = os.path.join(context.bin_path, f) os.unlink(f) def install_pip(self, context): """ Install pip in the virtual environment. :param context: The information for the virtual environment creation request being processed. """ url = 'https://raw.github.com/pypa/pip/master/contrib/get-pip.py' self.install_script(context, 'pip', url)def main(args=None): compatible = True if sys.version_info &lt; (3, 3): compatible = False elif not hasattr(sys, 'base_prefix'): compatible = False if not compatible: raise ValueError('This script is only for use with ' 'Python 3.3 or later') else: import argparse parser = argparse.ArgumentParser(prog=__name__, description='Creates virtual Python ' 'environments in one or ' 'more target ' 'directories.') parser.add_argument('dirs', metavar='ENV_DIR', nargs='+', help='A directory in which to create the 'virtual environment.') parser.add_argument('--no-setuptools', default=False, action='store_true', dest='nodist', help="Don't install setuptools or pip in the " "virtual environment.") parser.add_argument('--no-pip', default=False, action='store_true', dest='nopip', help="Don't install pip in the virtual " "environment.") parser.add_argument('--system-site-packages', default=False, action='store_true', dest='system_site', help='Give the virtual environment access to the ' 'system site-packages dir.') if os.name == 'nt': use_symlinks = False else: use_symlinks = True parser.add_argument('--symlinks', default=use_symlinks, action='store_true', dest='symlinks', help='Try to use symlinks rather than copies, ' 'when symlinks are not the default for ' 'the platform.') parser.add_argument('--clear', default=False, action='store_true', dest='clear', help='Delete the contents of the ' 'virtual environment ' 'directory if it already ' 'exists, before virtual ' 'environment creation.') parser.add_argument('--upgrade', default=False, action='store_true', dest='upgrade', help='Upgrade the virtual ' 'environment directory to ' 'use this version of ' 'Python, assuming Python ' 'has been upgraded ' 'in-place.') parser.add_argument('--verbose', default=False, action='store_true', dest='verbose', help='Display the output ' 'from the scripts which ' 'install setuptools and pip.') options = parser.parse_args(args) if options.upgrade and options.clear: raise ValueError('you cannot supply --upgrade and --clear together.') builder = ExtendedEnvBuilder(system_site_packages=options.system_site, clear=options.clear, symlinks=options.symlinks, upgrade=options.upgrade, nodist=options.nodist, nopip=options.nopip, verbose=options.verbose) for d in options.dirs: builder.create(d)if __name__ == '__main__': rc = 1 try: main() rc = 0 except Exception as e: print('Error: %s' % e, file=sys.stderr) sys.exit(rc) å®žè·µåœ¨windowsä¸‹vscodeä¸­é€šè¿‡venv åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒæ­¥éª¤: powershellä¸‹,æ‰§è¡Œå‘½ä»¤ python -m venv .venv æ‰§è¡Œæ¿€æ´»å‘½ä»¤ .\Scripts\activate.ps1 é€€å‡ºè™šæ‹ŸçŽ¯å¢ƒ åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œdeactivate å³å¯ã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python standard library -2 dictionary]]></title>
    <url>%2F2019%2F12%2F23%2Fpython-standard-library-2-dictionary%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“å­¦ä¹ ç¬”è®° â€“ dictionary0.0 å‰è¨€å®¶é‡Œå­©å­å‘çƒ§äº†,å»¶è¿Ÿæ›´æ–°æ ‡å‡†åº“å­¦ä¹ ç¬”è®° æŠ˜è…¾äº†ä¸‰ä¸ªæ™šä¸Š,ä¸€å®¶ä¸‰å£éƒ½ç´¯å€’äº†ã€‚ äººç”Ÿå°±å¥½æ¯”ä¸€ä¸ªè¹’è·šå­¦æ­¥çš„å­©ç«¥,å¾ˆå®¹æ˜“è¢«å¤–ç•ŒçŽ¯å¢ƒå½±å“ã€‚ 1.0 æ ‡å‡†åº“- å†…ç½®å‡½æ•°å‚è€ƒæ–‡æ¡£: å†…ç½®ç±»åž‹-å­—å…¸ pythonä¸­ä¸»è¦å†…ç½®ç±»åž‹åŒ…æ‹¬numbers,sequences,mappings,classes,instanceå’Œexceptionã€‚ 1.1 é€»è¾‘å€¼æ£€æµ‹ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥è¿›è¡Œé€»è¾‘å€¼æ£€æµ‹,ä»¥ä¾¿åœ¨if æˆ–whileä½œä¸ºæ¡ä»¶æˆ–æ˜¯ä½œä¸ºä¸Šä¸‹æ–‡æ‰€æŒ‡è¿”å›žå€¼æ˜¯å¸ƒå°”ç±»åž‹çš„è¡¨è¾¾å¼æ¥ä½¿ç”¨ã€‚æ‰€ä»¥å°±æœ‰ä¸‹é¢çš„ç”¨æ³•ã€‚ 12345L = []if(L): passwhile(L): pass ä¸€ä¸ªå¯¹è±¡åœ¨é»˜è®¤æƒ…å†µä¸‹è¢«è®¤ä¸ºæ˜¯True,é™¤éžè¯¥å¯¹è±¡å®šä¹‰äº†__boolean__() æ–¹æ³•ä¸”è¿”å›žFalse æˆ–è€…å®šä¹‰__len__()æ–¹æ³•ä¸”è¿”å›žé›¶ã€‚ä¸‹é¢ä¸‰ç§æƒ…å†µçš„å†…ç½®å¯¹è±¡éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯é€»è¾‘å‡å€¼ã€‚ None æˆ– False ä»»ä½•æ•°å€¼ç±»åž‹çš„é›¶ ç©ºçš„åºåˆ—å’Œå¤šé¡¹é›† åŒ…æ‹¬ ç©ºå­—ç¬¦ä¸²ã€ç©ºåˆ—è¡¨ã€ç©ºé›†åˆã€ç©ºå­—å…¸ã€ç©ºå…ƒç»„ä»¥åŠç©ºæ•°åˆ—(reange(0)) 1.2 å¸ƒå°”è¿ç®— â€“ and,or,not è¿ç®— ç»“æžœ æ³¨é‡Š x or y if x is false, then y, else x çŸ­è·¯è¿ç®—,åªæœ‰ç¬¬ä¸€ä¸ªä¸ºå‡çš„æ—¶å€™æ‰ä¼šå¯¹ç¬¬äºŒä¸ªæ±‚å€¼ x and y if x is false, then x, else y çŸ­è·¯è¿ç®—,åªæœ‰ç¬¬äºŒä¸ªä¸ºçœŸçš„æ—¶å€™æ‰ä¼šå¯¹ç¬¬äºŒä¸ªæ±‚å€¼ not x if x is false, then True, else False é€»è¾‘å–å 1.3 æ¯”è¾ƒè¿ç®— è¿ç®— å«ä¹‰ &lt; ä¸¥æ ¼å°äºŽ &lt;= å°äºŽæˆ–ç­‰äºŽ &gt; ä¸¥æ ¼å¤§äºŽ &gt;= å¤§äºŽæˆ–ç­‰äºŽ == ç­‰äºŽ != ä¸ç­‰äºŽ is å¯¹è±¡æ ‡è¯† is not å¦å®šçš„å¯¹è±¡æ ‡è¯† ==tips== ä¸åŒç±»åž‹çš„å¯¹è±¡ä¹‹é—´ä¸èƒ½ä½¿ç”¨æ¯”è¾ƒè¿ç®—,é™¤éžå®šä¹‰äº†å¯¹åº”çš„æ–¹æ³•ï¼Œä¾‹å¦‚__lt__(),__eq__()è¿™æ ·çš„å‡½æ•° å…·æœ‰ä¸åŒæ ‡è¯†çš„ç±»çš„å®žä¾‹,æ¯”è¾ƒç»“æžœä¸ºFalse,é™¤éžä½ è‡ªå·±å®šä¹‰äº†__eq__()æ–¹æ³• ä¸€ä¸ªç±»å®žä¾‹ä¸èƒ½ä¸Žç›¸åŒç±»æˆ–çš„å…¶ä»–å®žä¾‹æˆ–å…¶ä»–ç±»åž‹çš„å¯¹è±¡è¿›è¡ŒæŽ’åº,é™¤éžå®šä¹‰äº†å¯¹åº”çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ __lt__(), __le__(), __gt__() ä»¥åŠ __ge__() 1.4 æ•°å­—ç±»åž‹ â€“ intã€floatã€complexpythonä¸­å­˜åœ¨ä¸‰ç§ä¸åŒçš„æ•°å­—ç±»åž‹: æ•´æ•°, æµ®ç‚¹æ•° å’Œ å¤æ•°*ã€‚ è¿ç®— ç»“æžœ æ³¨é‡Š å®Œæ•´æ–‡æ¡£ x + y x å’Œ y çš„å’Œ x - y x å’Œ y çš„å·® x * y x å’Œ y çš„ä¹˜ç§¯ x / y x å’Œ y çš„å•† x // y x å’Œ y çš„å•†æ•° å–æ•´ x % y remainder of x / y ä¸å¯ç”¨äºŽè´Ÿæ•° -x x å–å +x x ä¸å˜ abs(x) x çš„ç»å¯¹å€¼æˆ–å¤§å° abs() int(x) å°† x è½¬æ¢ä¸ºæ•´æ•° å°æ•°ä¼šè¢«æˆªæ–­ int() float(x) å°† x è½¬æ¢ä¸ºæµ®ç‚¹æ•° (4)(6) float() complex(re, im) ä¸€ä¸ªå¸¦æœ‰å®žéƒ¨ re å’Œè™šéƒ¨ im çš„å¤æ•°ã€‚im é»˜è®¤ä¸º0ã€‚ (6) complex() c.conjugate() å¤æ•° c çš„å…±è½­ divmod(x, y) (x // y, x % y) (2) divmod() pow(x, y) x çš„ y æ¬¡å¹‚ (5) pow() x ** y x çš„ y æ¬¡å¹‚ (5) æ‰€æœ‰çš„numbers.Realç±»åž‹ï¼ˆåŒ…æ‹¬int å’Œ float)è¿˜åŒ…æ‹¬ä»¥ä¸‹è¿ç®—: è¿ç®— ç»“æžœ math.trunc(x) x æˆªæ–­ä¸º Integral round(x[, n\]) x èˆå…¥åˆ° n ä½å°æ•°ï¼ŒåŠæ•°å€¼ä¼šèˆå…¥åˆ°å¶æ•°ã€‚ å¦‚æžœçœç•¥ nï¼Œåˆ™é»˜è®¤ä¸º 0ã€‚ math.floor(x) &lt;= x çš„æœ€å¤§ Integral math.ceil(x) &gt;= x çš„æœ€å° Integral 1.5 æ•´æ•°ç±»åž‹çš„é™„åŠ æ–¹æ³•int.bit_length() è¿”å›žä»¥äºŒè¿›åˆ¶è¡¨ç¤ºä¸€ä¸ªæ•´æ•°é”éœ€è¦çš„ä½æ•°ï¼Œä¸åŒ…æ‹¬ç¬¦å·ä½å’Œå‰é¢çš„é›¶ 1.6 æµ®ç‚¹æ•°ç±»åž‹çš„é™„åŠ æ–¹æ³•float.as_integer_ratio() è¿”å›žä¸€å¯¹æ•´æ•°ï¼Œå…¶æ¯”çŽ‡æ­£å¥½ç­‰äºŽåŽŸæµ®ç‚¹æ•°å¹¶ä¸”åˆ†æ¯ä¸ºæ­£æ•°ã€‚ æ— ç©·å¤§ä¼šå¼•å‘ OverflowError è€Œ NaN åˆ™ä¼šå¼•å‘ ValueErrorã€‚ float.is_integer() å¦‚æžœ float å®žä¾‹å¯ç”¨æœ‰é™ä½æ•´æ•°è¡¨ç¤ºåˆ™è¿”å›ž Trueï¼Œå¦åˆ™è¿”å›ž False: float.hex() ä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›žä¸€ä¸ªæµ®ç‚¹æ•°è¡¨ç¤ºã€‚ å¯¹äºŽæœ‰é™æµ®ç‚¹æ•°ï¼Œè¿™ç§è¡¨ç¤ºæ³•å°†æ€»æ˜¯åŒ…å«å‰å¯¼çš„ 0x å’Œå°¾éšçš„ p åŠ æŒ‡æ•°ã€‚ classmethod float.fromhex(s) è¿”å›žä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸² s è¡¨ç¤ºçš„æµ®ç‚¹æ•°çš„ç±»æ–¹æ³•ã€‚ å­—ç¬¦ä¸² s å¯ä»¥å¸¦æœ‰å‰å¯¼å’Œå°¾éšçš„ç©ºæ ¼ã€‚ ==tips==: float.hex() æ˜¯å®žä¾‹æ–¹æ³•, float.fromhex(s)æ˜¯ç±»æ–¹æ³• 1234&gt;&gt;&gt; float.fromhex('0x3.a7p10')3740.0&gt;&gt;&gt; float.hex(3740.0)'0x1.d380000000000p+11' 1.7 æ•°å­—ç±»åž‹çš„å“ˆå¸Œè¿ç®—ä¸€ä¸ªä¾‹å­è¯´æ˜Ž 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import sys, mathdef hash_fraction(m, n): """Compute the hash of a rational number m / n. Assumes m and n are integers, with n positive. Equivalent to hash(fractions.Fraction(m, n)). """ P = sys.hash_info.modulus # Remove common factors of P. (Unnecessary if m and n already coprime.) while m % P == n % P == 0: m, n = m // P, n // P if n % P == 0: hash_value = sys.hash_info.inf else: # Fermat's Little Theorem: pow(n, P-1, P) is 1, so # pow(n, P-2, P) gives the inverse of n modulo P. hash_value = (abs(m) % P) * pow(n, P - 2, P) % P if m &lt; 0: hash_value = -hash_value if hash_value == -1: hash_value = -2 return hash_valuedef hash_float(x): """Compute the hash of a float x.""" if math.isnan(x): return sys.hash_info.nan elif math.isinf(x): return sys.hash_info.inf if x &gt; 0 else -sys.hash_info.inf else: return hash_fraction(*x.as_integer_ratio())def hash_complex(z): """Compute the hash of a complex number z.""" hash_value = hash_float(z.real) + sys.hash_info.imag * hash_float(z.imag) # do a signed reduction modulo 2**sys.hash_info.width M = 2**(sys.hash_info.width - 1) hash_value = (hash_value &amp; (M - 1)) - (hash_value &amp; M) if hash_value == -1: hash_value = -2 return hash_value 1.8 æ˜ å°„ç±»åž‹ â€“ dictpythonä¸­ç›®å‰åªæœ‰ä¸€ç§æ˜ å°„ç±»åž‹, å­—å…¸,æ˜ å°„å±žäºŽå¯å˜å¯¹è±¡ã€‚æ˜ å°„ç±»åž‹ä¼šå°†hashtableå€¼æ˜ å°„åˆ°ä»»æ„å¯¹è±¡. å­—å…¸çš„é”® å‡ ä¹Žå¯ä»¥æ˜¯ä»»æ„å€¼ï¼Œ å¯hashçš„ä»»æ„å€¼,ä¹Ÿå°±æ˜¯åŒ…å«åˆ—è¡¨ã€å­—å…¸å’Œå…¶ä»–å¯å˜ç±»åž‹çš„å€¼,ä¸å¯ä»¥ç”¨æ¥å……å½“å­—å…¸ä¸­çš„é”®ã€‚ 1.åˆ›å»ºå­—å…¸å­—å…¸å¯ä»¥é€šè¿‡å°†ä»¥é€—å·åˆ†éš”çš„ é”®: å€¼ å¯¹åˆ—è¡¨åŒ…å«äºŽèŠ±æ‹¬å·ä¹‹å†…æ¥åˆ›å»ºï¼Œä¾‹å¦‚: {&#39;jack&#39;: 4098, &#39;sjoerd&#39;: 4127} æˆ– {4098: &#39;jack&#39;, 4127: &#39;sjoerd&#39;}ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ dict æž„é€ å™¨æ¥åˆ›å»ºã€‚ 2.æž„é€ å‡½æ•°class dict(**kwarg) class dict(mapping, **kwarg) class dict(iterable, **kwarg) 3. å…¶ä»–å‡½æ•° å‡½æ•°å æè¿° list(d) è¿”å›žå­—å…¸ d ä¸­ä½¿ç”¨çš„æ‰€æœ‰é”®çš„åˆ—è¡¨ã€‚ len(d) è¿”å›žå­—å…¸ d ä¸­çš„é¡¹æ•°ã€‚ d[key] è¿”å›ž d ä¸­ä»¥ key ä¸ºé”®çš„é¡¹ã€‚ å¦‚æžœæ˜ å°„ä¸­ä¸å­˜åœ¨ key åˆ™ä¼šå¼•å‘ KeyErrorã€‚ [1] d[key] = value ç»™d[key]çš„å€¼è®¾ä¸ºvalue del d[key] å°† d[key] ä»Ž d ä¸­ç§»é™¤ã€‚ å¦‚æžœæ˜ å°„ä¸­ä¸å­˜åœ¨ key åˆ™ä¼šå¼•å‘ KeyErrorã€‚ key in d å¦‚æžœ d ä¸­å­˜åœ¨é”® key åˆ™è¿”å›ž Trueï¼Œå¦åˆ™è¿”å›ž Falseã€‚ key not in d ç­‰ä»·äºŽ not key in dã€‚ iter(d) è¿”å›žä»¥å­—å…¸çš„é”®ä¸ºå…ƒç´ çš„è¿­ä»£å™¨ clear() ç§»é™¤å­—å…¸ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ copy() è¿”å›žåŽŸå­—å…¸çš„æµ…æ‹·è´ã€‚ classmethod fromkeys(iterable[, value]) ä½¿ç”¨æ¥è‡ª iterable çš„é”®åˆ›å»ºä¸€ä¸ªæ–°å­—å…¸ï¼Œå¹¶å°†é”®å€¼è®¾ä¸º valueã€‚ get(key[, default]) å¦‚æžœ key å­˜åœ¨äºŽå­—å…¸ä¸­åˆ™è¿”å›ž key çš„å€¼ï¼Œå¦åˆ™è¿”å›ž defaultã€‚ å¦‚æžœ default æœªç»™å‡ºåˆ™é»˜è®¤ä¸º Noneï¼Œå› è€Œæ­¤æ–¹æ³•ç»ä¸ä¼šå¼•å‘ KeyErrorã€‚ items() è¿”å›žç”±å­—å…¸é¡¹ ((é”®, å€¼) å¯¹) ç»„æˆçš„ä¸€ä¸ªæ–°è§†å›¾ã€‚ keys() è¿”å›žç”±å­—å…¸é”®ç»„æˆçš„ä¸€ä¸ªæ–°è§†å›¾ pop(key[, default]) å¦‚æžœ key å­˜åœ¨äºŽå­—å…¸ä¸­åˆ™å°†å…¶ç§»é™¤å¹¶è¿”å›žå…¶å€¼ï¼Œå¦åˆ™è¿”å›ž defaultã€‚ å¦‚æžœ default æœªç»™å‡ºä¸” key ä¸å­˜åœ¨äºŽå­—å…¸ä¸­ï¼Œåˆ™ä¼šå¼•å‘ KeyErrorã€‚ popitem() ä»Žå­—å…¸ä¸­ç§»é™¤å¹¶è¿”å›žä¸€ä¸ª (é”®, å€¼) å¯¹ã€‚ é”®å€¼å¯¹ä¼šæŒ‰ LIFO çš„é¡ºåºè¢«è¿”å›žã€‚ reversed(d) è¿”å›žä¸€ä¸ªé€†åºèŽ·å–å­—å…¸é”®çš„è¿­ä»£å™¨ setdefault(key[, default]) å¦‚æžœå­—å…¸å­˜åœ¨é”® key ï¼Œè¿”å›žå®ƒçš„å€¼ã€‚å¦‚æžœä¸å­˜åœ¨ï¼Œæ’å…¥å€¼ä¸º default çš„é”® key ï¼Œå¹¶è¿”å›ž default ã€‚ default é»˜è®¤ä¸º Noneã€‚ update([other]) ä½¿ç”¨æ¥è‡ª other çš„é”®/å€¼å¯¹æ›´æ–°å­—å…¸ï¼Œè¦†ç›–åŽŸæœ‰çš„é”®ã€‚ values() è¿”å›žç”±å­—å…¸å€¼ç»„æˆçš„ä¸€ä¸ªæ–°è§†å›¾ [2] 1234567891011121314#[1] å¦‚æžœå­—å…¸çš„å­ç±»å®šä¹‰äº†æ–¹æ³• __missing__() å¹¶ä¸” key ä¸å­˜åœ¨ï¼Œåˆ™ d[key] æ“ä½œå°†è°ƒç”¨è¯¥æ–¹æ³•å¹¶é™„å¸¦é”® key ä½œä¸ºå‚æ•°ã€‚ d[key] éšåŽå°†è¿”å›žæˆ–å¼•å‘ __missing__(key) è°ƒç”¨æ‰€è¿”å›žæˆ–å¼•å‘çš„ä»»ä½•å¯¹è±¡æˆ–å¼‚å¸¸ã€‚ æ²¡æœ‰å…¶ä»–æ“ä½œæˆ–æ–¹æ³•ä¼šå‘èµ·è°ƒç”¨ __missing__()ã€‚ å¦‚æžœæœªå®šä¹‰ __missing__()ï¼Œåˆ™ä¼šå¼•å‘ KeyErrorã€‚ __missing__() å¿…é¡»æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼›å®ƒä¸èƒ½æ˜¯ä¸€ä¸ªå®žä¾‹å˜é‡:&gt;&gt;&gt; class Counter(dict):... def __missing__(self, key):... return 0&gt;&gt;&gt; c = Counter()&gt;&gt;&gt; c['red']0&gt;&gt;&gt; c['red'] += 1&gt;&gt;&gt; c['red']1#[2]ä¸¤ä¸ª dict.values() è§†å›¾ä¹‹é—´çš„ç›¸ç­‰æ€§æ¯”è¾ƒå°†æ€»æ˜¯è¿”å›ž Falseã€‚ è¿™åœ¨ dict.values() ä¸Žå…¶è‡ªèº«æ¯”è¾ƒæ—¶ä¹ŸåŒæ ·é€‚ç”¨: &gt;&gt;&gt; d = &#123;'a': 1&#125;&gt;&gt;&gt; d.values() == d.values()False å­—å…¸æ¯”è¾ƒ: ä¸¤ä¸ªå­—å…¸çš„æ¯”è¾ƒå½“ä¸”ä»…å½“å®ƒä»¬å…·æœ‰ç›¸åŒçš„ (é”®, å€¼) å¯¹æ—¶æ‰ä¼šç›¸ç­‰ï¼ˆä¸è€ƒè™‘é¡ºåºï¼‰ã€‚ æŽ’åºæ¯”è¾ƒ (â€˜&lt;â€™, â€˜&lt;=â€™, â€˜&gt;=â€™, â€˜&gt;â€™) ä¼šå¼•å‘ TypeErrorã€‚ å­—å…¸ä¼šä¿ç•™æ’å…¥æ—¶çš„é¡ºåºã€‚ è¯·æ³¨æ„å¯¹é”®çš„æ›´æ–°ä¸ä¼šå½±å“é¡ºåºã€‚ åˆ é™¤å¹¶å†æ¬¡æ·»åŠ çš„é”®å°†è¢«æ’å…¥åˆ°æœ«å°¾ã€‚ 1234567891011121314&gt;&gt;&gt; d = &#123;"one": 1, "two": 2, "three": 3, "four": 4&#125;&gt;&gt;&gt; d&#123;'one': 1, 'two': 2, 'three': 3, 'four': 4&#125;&gt;&gt;&gt; list(d)['one', 'two', 'three', 'four']&gt;&gt;&gt; list(d.values())[1, 2, 3, 4]&gt;&gt;&gt; d["one"] = 42&gt;&gt;&gt; d&#123;'one': 42, 'two': 2, 'three': 3, 'four': 4&#125;&gt;&gt;&gt; del d["two"]&gt;&gt;&gt; d["two"] = None&gt;&gt;&gt; d&#123;'one': 42, 'three': 3, 'four': 4, 'two': None&#125; 4.å­—å…¸è§†å›¾å¯¹è±¡ç”± dict.keys(), dict.values() å’Œ dict.items() æ‰€è¿”å›žçš„å¯¹è±¡æ˜¯ è§†å›¾å¯¹è±¡ã€‚ è¯¥å¯¹è±¡æä¾›å­—å…¸æ¡ç›®çš„ä¸€ä¸ªåŠ¨æ€è§†å›¾ï¼Œè¿™æ„å‘³ç€å½“å­—å…¸æ”¹å˜æ—¶ï¼Œè§†å›¾ä¹Ÿä¼šç›¸åº”æ”¹å˜ã€‚ å­—å…¸è§†å›¾å‡½æ•° æè¿° len(dictview) è¿”å›žå­—å…¸ä¸­çš„æ¡ç›®æ•° iter(dictview) è¿”å›žå­—å…¸ä¸­çš„é”®ã€å€¼æˆ–é¡¹ï¼ˆä»¥ (é”®, å€¼) ä¸ºå…ƒç´ çš„å…ƒç»„è¡¨ç¤ºï¼‰çš„è¿­ä»£å™¨ [1] x in dictview å¦‚æžœ x æ˜¯å¯¹åº”å­—å…¸ä¸­å­˜åœ¨çš„é”®ã€å€¼æˆ–é¡¹ï¼ˆåœ¨æœ€åŽä¸€ç§æƒ…å†µä¸‹ x åº”ä¸ºä¸€ä¸ª (é”®, å€¼) å…ƒç»„ï¼‰ åˆ™è¿”å›ž True reversed(dictview) è¿”å›žä¸€ä¸ªé€†åºèŽ·å–å­—å…¸é”®ã€å€¼æˆ–é¡¹çš„è¿­ä»£å™¨ã€‚ è§†å›¾å°†æŒ‰ä¸Žæ’å…¥æ—¶ç›¸åçš„é¡ºåºè¿›è¡Œè¿­ä»£ã€‚ [2] 1234567891011121314151617181920212223242526272829#é”®è§†å›¾ç±»ä¼¼äºŽé›†åˆï¼Œå› ä¸ºå…¶æ¡ç›®ä¸é‡å¤ä¸”å¯å“ˆå¸Œã€‚ å¦‚æžœæ‰€æœ‰å€¼éƒ½æ˜¯å¯å“ˆå¸Œçš„ï¼Œå³ (é”®, å€¼) å¯¹ä¹Ÿæ˜¯ä¸é‡å¤ä¸”å¯å“ˆå¸Œçš„ï¼Œé‚£ä¹ˆæ¡ç›®è§†å›¾ä¹Ÿä¼šç±»ä¼¼äºŽé›†åˆã€‚ ï¼ˆå€¼è§†å›¾åˆ™ä¸è¢«è§†ä¸ºç±»ä¼¼äºŽé›†åˆï¼Œå› å…¶æ¡ç›®é€šå¸¸éƒ½æ˜¯æœ‰é‡å¤çš„ã€‚ï¼‰ å¯¹äºŽç±»ä¼¼äºŽé›†åˆçš„è§†å›¾ï¼Œä¸ºæŠ½è±¡åŸºç±» collections.abc.Set æ‰€å®šä¹‰çš„å…¨éƒ¨æ“ä½œéƒ½æ˜¯æœ‰æ•ˆçš„ (ä¾‹å¦‚ ==, &lt; æˆ– ^)ã€‚&gt;&gt;&gt; dishes = &#123;'eggs': 2, 'sausage': 1, 'bacon': 1, 'spam': 500&#125;&gt;&gt;&gt; keys = dishes.keys()&gt;&gt;&gt; values = dishes.values()&gt;&gt;&gt; # iteration&gt;&gt;&gt; n = 0&gt;&gt;&gt; for val in values:... n += val&gt;&gt;&gt; print(n)504&gt;&gt;&gt; # keys and values are iterated over in the same order (insertion order)&gt;&gt;&gt; list(keys)['eggs', 'sausage', 'bacon', 'spam']&gt;&gt;&gt; list(values)[2, 1, 1, 500]&gt;&gt;&gt; # view objects are dynamic and reflect dict changes&gt;&gt;&gt; del dishes['eggs']&gt;&gt;&gt; del dishes['sausage']&gt;&gt;&gt; list(keys)['bacon', 'spam']&gt;&gt;&gt; # set operations&gt;&gt;&gt; keys &amp; &#123;'eggs', 'bacon', 'salad'&#125;&#123;'bacon'&#125;&gt;&gt;&gt; keys ^ &#123;'sausage', 'juice'&#125;&#123;'juice', 'sausage', 'bacon', 'spam'&#125; 2.0 å°ç»“ å­—å…¸æ˜¯å¯å˜ç±»åž‹,é”®åªèƒ½æ˜¯ç”±éžhashçš„æ•°æ®ç±»åž‹å……å½“ å­—å…¸å­ç±»çš„__missing__æ–¹æ³•ã€‚ å­—å…¸è§†å›¾çš„å…ƒç´ ä¸ºä¸é‡å¤ä¸”å¯å“ˆå¸Œã€‚ ä¸€å¼ å›¾æ€»ç»“å¦‚ä¸‹ åŽè®°è®°å¾—äº”å¹´å‰å¬è¿‡çš„ä¸€å¥è¯,èµ ç»™è‡ªå·±,ä¹Ÿèµ ç»™å‡‘å·§çœ‹åˆ°è¿™ç¯‡åšæ–‡çš„æœ‰ç¼˜äººã€‚ ç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åœ¨åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯çŽ°åœ¨ã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>dictionary</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python_standard_library_1_string]]></title>
    <url>%2F2019%2F12%2F20%2Fpython-standard-library-1-string%2F</url>
    <content type="text"><![CDATA[python æ ‡å‡†åº“å­¦ä¹ ç¬”è®° â€“ stringå‰è¨€ä»Šå¤©æ˜¯2019å¹´12æœˆ20æ—¥,åˆšåˆšæ™´æœ—çš„å¤© å…¥å†¬ä»¥æ¥çš„ç¬¬äºŒåœºé›ªå°±æ‚„ç„¶è€Œè‡³ ä»Žä»Šå¤©å¼€å§‹,åšæŒæ›´æ–°åšæ–‡100å¤©,ä¹Ÿç®—æ˜¯å¯¹pythonå­¦ä¹ çš„æ€»ç»“ã€‚é‚£ä¹ˆä»Žå“ªé‡Œå¼€å§‹å‘¢ï¼Ÿ é‚£å°±ä»Žpythonæ ‡å‡†åº“å¼€å§‹æ’¸å§ã€‚ æ“ä½œç³»ç»Ÿ win7 sp1 64ä½ æ ‡å‡†ç‰ˆ pythonç‰ˆæœ¬ 3.8 å·¥å…· vscode æ ‡å‡†åº“åŸºç¡€åœ¨ä¸åŒæ“ä½œç³»ç»Ÿ,æ ‡å‡†åº“çš„è·¯å¾„æœ‰æ‰€ä¸åŒ,ä»¥windowså¹³å°ä¸ºä¾‹,æˆ‘çš„pythonå®‰è£…åœ¨C:\Python38 æ ‡å‡†åº“æ–‡ä»¶å°±åœ¨C:\Python38\Lib æ–‡ä»¶å¤¹ä¸‹ æ ‡å‡†åº“åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†,å‚è€ƒæ ‡å‡†åº“ä»‹ç» å†…ç½®å‡½æ•°:ä¸éœ€è¦importå°±å¯ä»¥ä½¿ç”¨çš„å‡½æ•°,ä¾‹å¦‚ print å†…ç½®å¼‚å¸¸ å†…ç½®æ¨¡å— æ–‡æœ¬ äºŒè¿›åˆ¶æ•°æ® æ•°æ®ç±»åž‹ æ•°å­¦ å‡½æ•°å¼ç¼–ç¨‹æ¨¡å— æ–‡ä»¶å’Œç›®å½•è®¿é—® æ•°æ®æŒä¹…åŒ– æ–‡ä»¶æ ¼å¼ åŠ å¯†æœåŠ¡ å¹¶å‘æ‰§è¡Œ ç½‘ç»œå’Œè¿›ç¨‹é—´é€šä¿¡ äº’è”ç½‘æ•°æ®å¤„ç† äº’è”ç½‘åè®®å’Œæ”¯æŒ å¤šåª’ä½“æœåŠ¡ å›½é™…åŒ– ç¨‹åºæ¡†æž¶ Tkå›¾å½¢ç”¨æˆ·ç•Œé¢ å¼€å‘å·¥å…· è°ƒè¯•å’Œåˆ†æž è½¯ä»¶æ‰“åŒ…å’Œåˆ†å‘ pythonè¿è¡Œæ—¶æœåŠ¡ è‡ªå®šä¹‰pythonè§£é‡Šå™¨ å¯¼å…¥æ¨¡å— Pythonè¯­è¨€æœåŠ¡ æ‚é¡¹æœåŠ¡ Windowsç³»ç»Ÿç›¸å…³æ¨¡å— Unixä¸“æœ‰æœåŠ¡ è¢«å–ä»£çš„æ¨¡å— day1 æ ‡å‡†åº“ stringå‚è€ƒï¼šæ–‡æœ¬å¤„ç†æœåŠ¡ stringå¸¸è§å­—ç¬¦ä¸²æ“ä½œ å­—ç¬¦ä¸²å¸¸é‡123__all__ = ["ascii_letters", "ascii_lowercase", "ascii_uppercase", "capwords", "digits", "hexdigits", "octdigits", "printable", "punctuation", "whitespace", "Formatter", "Template"] æµ‹è¯•å¦‚ä¸‹ï¼š 123456789101112import stringprint(string.__all__)print(string.ascii_letters) #abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZprint(string.ascii_lowercase) #abcdefghijklmnopqrstuvwxyzprint(string.ascii_uppercase) #ABCDEFGHIJKLMNOPQRSTUVWXYZprint(string.digits)# åè¿›åˆ¶æ•°å­—å¸¸æ•° 0123456789print(string.hexdigits)#åå…­è¿›åˆ¶æ•°å­—å¸¸æ•° 0123456789abcdefABCDEFprint(string.octdigits)#å…«è¿›åˆ¶æ•°å­—å¸¸æ•° 01234567print(string.punctuation)print(string.printable)print(string.whitespace) å…¶ä¸­ï¼š string.whitespace ï¼šç”±è¢«è§†ä¸ºç©ºç™½ç¬¦å·çš„ ASCII å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ã€‚ å…¶ä¸­åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ã€æ¢è¡Œã€å›žè½¦ã€è¿›çº¸å’Œçºµå‘åˆ¶è¡¨ç¬¦ã€‚ è‡ªå®šä¹‰å­—ç¬¦ä¸²æ ¼å¼åŒ– ä¸»è¦å‡½æ•° åŠŸèƒ½ format(format_string, *args, **kwargs) å®ƒé‡‡ç”¨æ ¼å¼å­—ç¬¦ä¸²å’Œä¸€ç»„ä»»æ„ä½ç½®å’Œå…³é”®å­—å‚æ•°ã€‚å®ƒåªæ˜¯ä¸€ä¸ªè°ƒç”¨vformatï¼ˆï¼‰çš„åŒ…è£…å™¨ã€‚ vformat(format_string, args, kwargs) æ‰§è¡Œæ ¼å¼åŒ–çš„å®žé™…å·¥ä½œ parse(format_string) å¾ªçŽ¯éåŽ†format_stringå¹¶è¿”å›žä¸€ä¸ªå¯è¿­ä»£çš„å…ƒç»„ï¼ˆliteral_textï¼Œfield_nameï¼Œformat_specï¼Œconversionï¼‰ã€‚ 1234567891011121314151617181920212223242526data = ("Pi = ",3.1415926)strtmp = "This is a test:&#123;&#125;&#123;:.4f&#125;"formatter = string.Formatter()strtmp = formatter.vformat(strtmp,data,&#123;&#125;)print(strtmp) #This is a test:&#123;&#125;&#123;:.4f&#125;data =&#123;"key1":3.1415926,"key2":"Pi: ="&#125;strtmp = "This is a test:&#123;key2&#125;&#123;key1&#125;"formatter = string.Formatter()strtmp = formatter.vformat(strtmp,(),data)print(strtmp)import stringdata = ("Pi=",3.1415926)strtmp = "This is a test:&#123;&#125;&#123;:.4f&#125;"formatter = string.Formatter()formatter.vformat(strtmp,data,&#123;&#125;)print(strtmp) #This is a test:&#123;&#125;&#123;:.4f&#125;data =&#123;"key1":3.1415926,"key2":"Pi: ="&#125;strtmp = "This is a test:&#123;key2&#125;&#123;key1&#125;"formatter = string.Formatter()strtmp = formatter.vformat(strtmp,(),data)print(strtmp) 12345678910111213141516171819202122import stringstrtmp = "This is a test:&#123;&#125;&#123;:.4f&#125;"formatter = string.Formatter()strtuple = formatter.parse(strtmp)for i, v in enumerate(strtuple): print(i, v) ''' 0 ('This is a test:', '', '', None) 1 ('', '', '.4f', None) '''strtmp = "This is a test:&#123;Key2&#125;&#123;Key1&#125;"formatter = string.Formatter()strtuple = formatter.parse(strtmp)for i, v in enumerate(strtuple): print(i, v) ''' 0 ('This is a test:', 'Key2', '', None) 1 ('', 'Key1', '', None) '''# string.Formatter.parse(format_string) End æ ¼å¼åŒ–å­—ç¬¦ä¸²èŒƒä¾‹æŒ‰ä½ç½®è®¿é—®å‚æ•°123456789tupdata = ("This","is","a","test") # å…ƒç»„formatstr = '&#123;0&#125; &#123;1&#125; &#123;2&#125; &#123;3&#125;'.format("This","is","a","test") print(formatstr) # This is a testformatstr = '&#123;&#125; &#123;&#125; &#123;&#125; &#123;&#125;'.format(*tupdata) # *data è§£åŒ…å‚æ•°åºåˆ—print(formatstr) # This is a testformatstr = '&#123;3&#125; &#123;2&#125; &#123;1&#125; &#123;0&#125;'.format(*tupdata) # *data è§£åŒ…å‚æ•°åºåˆ—print(formatstr) # test a is Thisformatstr = '&#123;2&#125; &#123;3&#125; &#123;1&#125; &#123;2&#125; &#123;3&#125;'.format(*tupdata) # å‚æ•°å¯ä»¥é‡å¤print(formatstr) # a test is a test æŒ‰å…³é”®å­—è®¿é—®å‚æ•°12345dicdata = &#123;'Author':'leacoder','Time':'2019/04/17'&#125;formatstr = 'The author is &#123;Author&#125;ï¼ŒThe time is &#123;Time&#125;'.format(Author='leacoder',Time='2019/04/17')print(formatstr) # The author is leacoderï¼ŒThe time is 2019/04/17formatstr = 'The author is &#123;Author&#125;ï¼ŒThe time is &#123;Time&#125;'.format(**dicdata)print(formatstr) # The author is leacoderï¼ŒThe time is 2019/04/17 è®¿é—®å‚æ•°çš„å±žæ€§12345678class Point: def __init__(self,x,y): self.x ,self.y = x, ypoint = Point(4,2)formatstr = 'Thie point is (&#123;key.x&#125;,&#123;key.y&#125;)'.format(key = point) # key å¯ä¸ºå…¶ä»– print(formatstr) # Thie point is (4,2)formatstr = 'Thie point is (&#123;point.x&#125;,&#123;point.y&#125;)'.format(point = point) # point å¯ä¸ºå…¶ä»– print(formatstr) # Thie point is (4,2) è®¿é—®å‚æ•°çš„å„é¡¹12345tupdata = ("leacoder","2019/04/17") # å…ƒç»„formatstr = 'The author is &#123;0[0]&#125;,The time is &#123;0[1]&#125;'.format(tupdata)print(formatstr) # The author is leacoder,The time is 2019/04/17formatstr = 'The author is &#123;0[0]&#125;,The time is &#123;0[1]&#125;'.format(*tupdata) # æ³¨æ„åŒºåˆ«print(formatstr) # The author is l,The time is e å¯¹é½æ–‡æœ¬å¹¶æŒ‡å®šå®½åº¦12345678formatstr = '&#123;:&lt;30&#125;'.format('left aligned') # å·¦å¯¹é½ 30ä½print(formatstr) # â€˜left aligned â€™ ä¸ºäº†ä½“çŽ°ä½æ•°åŠ äº†â€˜â€™formatstr = '&#123;:&gt;30&#125;'.format('right aligned') # å³å¯¹é½ 30ä½print(formatstr) # â€˜ right alignedâ€™formatstr = '&#123;:^30&#125;'.format('centered') # ä¸­é—´å¯¹é½ 30ä½print(formatstr) # â€˜ centered â€™formatstr = '&#123;:*^30&#125;'.format('centered') # ä½¿ç”¨* ä½œä¸ºå¡«å……å­—ç¬¦print(formatstr) # â€˜***********centered***********â€™ Replacing %+f, %-f, and % f and specifying a sign: æ›¿æ¢ï¼…+ fï¼Œï¼… - få’Œï¼…få¹¶æŒ‡å®šç¬¦å·:123456formatstr = '&#123;:+f&#125;; &#123;:+f&#125;'.format(3.14, -3.14) # æ€»æ˜¯æ˜¾ç¤ºå®ƒç¬¦å·print(formatstr) # â€˜+3.140000; -3.140000â€™formatstr = '&#123;: f&#125;; &#123;: f&#125;'.format(3.14, -3.14) # æ­£æ•°å‰æ˜¾ç¤ºç©ºæ ¼print(formatstr) # â€˜ 3.140000; -3.140000â€™formatstr = '&#123;:-f&#125;; &#123;:-f&#125;'.format(3.14, -3.14) # åªæ˜¾ç¤ºè´Ÿå· åŒ '&#123;:f&#125;; &#123;:f&#125;'print(formatstr) # â€˜3.140000; -3.140000â€™ Replacing %x and %o and converting the value to different bases: æ›¿æ¢ï¼…xå’Œï¼…oå¹¶å°†å€¼è½¬æ¢ä¸ºä¸åŒçš„è¿›åˆ¶123456formatstr = "int: &#123;0:d&#125;; hex: &#123;0:x&#125;; oct: &#123;0:o&#125;; bin: &#123;0:b&#125;".format(64)print(formatstr) # int: 64; hex: 40; oct: 100; bin: 1000000formatstr = "int: &#123;0:d&#125;; hex: &#123;0:#x&#125;; oct: &#123;0:#o&#125;; bin: &#123;0:#b&#125;".format(64)print(formatstr) # int: 64; hex: 0x40; oct: 0o100; bin: 0b1000000formatstr = "int: &#123;0:d&#125;; hex: &#123;0:#x&#125;; oct: &#123;0:#o&#125;; bin: &#123;0:#b&#125;".format(0b1000001) # ä¹Ÿæ”¯æŒå…¶ä»–è¿›åˆ¶print(formatstr) # int: 65; hex: 0x41; oct: 0o101; bin: 0b100000 ä½¿ç”¨é€—å·ä½œä¸ºåƒä½åˆ†éš”ç¬¦1234points = 1total = 3formatstr = 'points / total = &#123;:.2%&#125;'.format(points/total)print(formatstr) # points / total = 33.33% ä½¿ç”¨ç‰¹å®šç±»åž‹çš„æ ¼å¼1234import datetimed = datetime.datetime(2019, 4, 17, 22, 49, 2) # 2019/04/17 22:49:02formatstr = '&#123;:%Y-%m-%d %H:%M:%S&#125;'.format(d)print(formatstr) # 2019-04-17 22:49:02 æ¨¡æ¿å­—ç¬¦ä¸²æ¨¡æ¿å­—ç¬¦ä¸²è§„åˆ™12345678910'''æ¨¡æ¿å­—ç¬¦ä¸²æä¾›æ›´ç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢ï¼Œå¦‚PEP 292ä¸­æ‰€è¿° https://www.python.org/dev/peps/pep-0292/æ¨¡æ¿å­—ç¬¦ä¸²æ”¯æŒåŸºäºŽ$çš„æ›¿æ¢ï¼Œä½¿ç”¨ä»¥ä¸‹è§„åˆ™ï¼š 1ã€$$æ˜¯è½¬ä¹‰; å®ƒè¢«æ›¿æ¢ä¸ºå•ä¸ª$ã€‚ 2ã€$identifier ä¸€ä¸ªæ›¿æ¢å ä½ç¬¦ï¼Œç”¨äºŽåŒ¹é…æ˜ å°„å…³é”®å­—â€œidentifierâ€é»˜è®¤æƒ…å†µä¸‹ï¼Œ â€œæ ‡è¯†ç¬¦â€ä»…é™äºŽä»¥ä¸‹åˆ’çº¿æˆ–ASCIIå­—æ¯å¼€å¤´çš„ä»»ä½•ä¸åŒºåˆ†å¤§å°å†™çš„ASCIIå­—æ¯æ•°å­—å­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬ä¸‹åˆ’çº¿ï¼‰ã€‚$å­—ç¬¦åŽé¢çš„ç¬¬ä¸€ä¸ªéžæ ‡è¯†ç¬¦å­—ç¬¦ç»“æŸæ­¤å ä½ç¬¦ã€‚ 3ã€$ &#123;identifier&#125;ç›¸å½“äºŽ$ identifierã€‚å½“æœ‰æ•ˆæ ‡è¯†ç¬¦å­—ç¬¦è·Ÿéšå ä½ç¬¦ä½†ä¸æ˜¯å ä½ç¬¦çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œä¾‹å¦‚â€œ$ &#123;noun&#125; ificationâ€ï¼Œåˆ™éœ€è¦å®ƒã€‚ 4ã€å­—ç¬¦ä¸²ä¸­$çš„ä»»ä½•å…¶ä»–å½¢å¼éƒ½å°†å¯¼è‡´å¼•å‘ValueErrorã€‚å­—ç¬¦ä¸²æ¨¡å—æä¾›å®žçŽ°è¿™äº›è§„åˆ™çš„Templateç±»ã€‚class string.Template(template)''' class string.`Template`(template)substitute(mapping,**kwargs)123456789101112131415161718'''æ‰§è¡Œæ¨¡æ¿æ›¿æ¢ï¼Œè¿”å›žä¸€ä¸ªæ–°å­—ç¬¦ä¸²ã€‚ mapping ä¸ºä»»æ„å­—å…¸ç±»å¯¹è±¡ï¼Œå…¶ä¸­çš„é”®å°†åŒ¹é…æ¨¡æ¿ä¸­çš„å ä½ç¬¦ã€‚ æˆ–è€…ä½ ä¹Ÿå¯ä»¥æä¾›ä¸€ç»„å…³é”®å­—å‚æ•°ï¼Œå…¶ä¸­çš„å…³é”®å­—å³å¯¹åº”å ä½ç¬¦ã€‚ å½“åŒæ—¶ç»™å‡º mapping å’Œ kwds å¹¶ä¸”å­˜åœ¨é‡å¤æ—¶ï¼Œåˆ™ä»¥ kwds ä¸­çš„å ä½ç¬¦ä¸ºä¼˜å…ˆ'''s = Template('The Author is $Author, The Time is $Time') # ä½¿ç”¨Templateç±»æž„é€ å‡½æ•°kewds = &#123;'Author':'leacoder', 'Time':'2019/04/18 00:01:38'&#125;templatestr = s.substitute(Author='leacoder', Time='2019/04/18 00:01:38') # **kewdsprint(templatestr) # The Author is leacoder, The Time is 2019/04/18 00:01:38templatestr = s.substitute(**kewds) # **kewdsprint(templatestr) # The Author is leacoder, The Time is 2019/04/18 00:01:38templatestr = s.substitute(kewds) # mappingprint(templatestr) # The Author is leacoder, The Time is 2019/04/18 00:01:38templatestr = s.substitute(kewds,Author='250',Time = 'No Time') # mapping **kewdsprint(templatestr) # The Author is 250, The Time is No Timekewds1 = &#123;'Author':'leacoder'&#125;templatestr = s.substitute(kewds1)print(templatestr) # KeyError: 'Time'# substitute(mapping, **kwds) End safe_substitute(mapping, **kwds)12345678'''ç±»ä¼¼äºŽ substitute()ï¼Œä¸åŒä¹‹å¤„æ˜¯å¦‚æžœæœ‰å ä½ç¬¦æœªåœ¨ mapping å’Œ kwds ä¸­æ‰¾åˆ°ï¼Œä¸æ˜¯å¼•å‘ KeyError å¼‚å¸¸ï¼Œè€Œæ˜¯å°†åŽŸå§‹å ä½ç¬¦ä¸åŠ ä¿®æ”¹åœ°æ˜¾ç¤ºåœ¨ç»“æžœå­—ç¬¦ä¸²ä¸­ã€‚ å¦ä¸€ä¸ªä¸Ž substitute() çš„å·®å¼‚æ˜¯ä»»ä½•åœ¨å…¶ä»–æƒ…å†µä¸‹å‡ºçŽ°çš„ $ å°†ç®€å•åœ°è¿”å›ž $ è€Œä¸æ˜¯å¼•å‘ ValueErrorã€‚'''# safe_substitute(mapping, **kwds)kewds1 = &#123;'Author':'leacoder'&#125;templatestr = s.safe_substitute(kewds1)print(templatestr) # The Author is leacoder, The Time is $Time# safe_substitute(mapping, **kwds) End è¾…åŠ©å‡½æ•°string.`capwords`(s, sep=Noneï¼‰123'''ä½¿ç”¨ str.split() å°†å‚æ•°æ‹†åˆ†ä¸ºå•è¯ï¼Œä½¿ç”¨ str.capitalize() å°†å•è¯è½¬ä¸ºå¤§å†™å½¢å¼ï¼Œä½¿ç”¨ str.join() å°†å¤§å†™çš„å•è¯è¿›è¡Œæ‹¼æŽ¥ã€‚ å¦‚æžœå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•° sep è¢«çœç•¥æˆ–ä¸º Noneï¼Œåˆ™è¿žç»­çš„ç©ºç™½å­—ç¬¦ä¼šè¢«æ›¿æ¢ä¸ºå•ä¸ªç©ºæ ¼ç¬¦å¹¶ä¸”å¼€å¤´å’Œæœ«å°¾çš„ç©ºç™½å­—ç¬¦ä¼šè¢«ç§»é™¤ï¼Œå¦åˆ™ sep ä¼šè¢«ç”¨æ¥æ‹†åˆ†å’Œæ‹¼æŽ¥å•è¯''']]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>standard_library</tag>
        <tag>string</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vscode Cannot edit in read-only editor]]></title>
    <url>%2F2019%2F12%2F12%2Fvscode-Cannot-edit-in-read-only-editor%2F</url>
    <content type="text"><![CDATA[vscode Cannot edit in read-only editor é”™è¯¯è§£å†³åŽŸå›  ä½¿ç”¨äº†Run Codeæ’ä»¶,outputæ˜¯åªè¯»çš„ è§£å†³æ–¹æ³•å°† run codeè®¾ç½®ä¸ºåœ¨Terminalä¸­è¿è¡Œ 1File -&gt; Preferences -&gt; Settings æ‰¾åˆ° run code in terminal æ‰“ä¸Š âˆš æˆ– åœ¨settings.jsonæ–‡ä»¶ä¸­,æ·»åŠ ä¸€è¡Œé…ç½®ä¿¡æ¯ 1"code-runner.runInTerminal": true]]></content>
      <categories>
        <category>python</category>
        <category>IDEs</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Install python3.8 on Centos6.5]]></title>
    <url>%2F2019%2F12%2F03%2FInstall-python3-8-on-Centos6-5%2F</url>
    <content type="text"><![CDATA[1. å®‰è£…å¿…è¦çš„å·¥å…·1sudo yum install yum-utils 2. ä½¿ç”¨ yum-builddep å‘½ä»¤ è®¾ç½® python ç¼–è¯‘çŽ¯å¢ƒï¼Œä¸‹è½½ç¼ºå°‘çš„ä¾èµ–1sudo yum-builddep python 3. ä¸‹è½½ python3 çš„æºä»£ç æºä»£ç å¯ä»¥åœ¨ https://www.python.org/ftp/python/ ä¸‹è½½ 1curl -O https://www.python.org/ftp/python/3.8.0/Python-3.8.0a1.tgz 4. å¯¹æºä»£ç è¿›è¡Œè§£åŽ‹å¹¶ç¼–è¯‘å®‰è£…1234tar xf Python-3.8.0a1.tgzcd Python-3.8.0a1./configuresudo make &amp;&amp; make install 5. çŽ°åœ¨ python3 å·²ç»å®Œæˆå®‰è£…ï¼Œä½¿ç”¨ python3 -version æŸ¥çœ‹ç‰ˆæœ¬å·æ˜¾ç¤º Python 3.8.0a1 è¡¨ç¤ºå·²ç»æˆåŠŸ 1python3 --version 6. å¦‚æžœä½ æƒ³æŠŠ python3 ä½œä¸ºé»˜è®¤python è§£æžå™¨ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹è®¾ç½®1alias python='/usr/local/bin/python3.8' 7. é…ç½®é˜¿é‡Œpipæº1234567891011[root@localhost ~]# cd [root@localhost ~]# mkdir .pip[root@localhost ~]# cd .pip[root@localhost .pip]# vim pip.conf#æ–‡ä»¶å†…å®¹å¦‚ä¸‹[global]index-url = http://mirrors.aliyun.com/pypi/simple [install]trusted-host=mirrors.aliyun.com]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>python3</tag>
        <tag>centos</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ios devices list]]></title>
    <url>%2F2019%2F12%2F02%2Fios-devices-list%2F</url>
    <content type="text"><![CDATA[ios è®¾å¤‡ä¸€è§ˆè¡¨iPhone è®¾å¤‡ æ—¶é—´ CPU åˆ†è¾¨çŽ‡ å¤§å° å¯†åº¦ @Nx iOSç³»ç»Ÿ iPhone 2007 armv6 320 x 480 3.5 165 @1x 1.0 - 3.1.3 iPhone 3G 2008 armv6 320 x 480 3.5 165 @1x 2.0 - 4.2.1 iPhone 3GS 2009 armv7 320 x 480 3.5 165 @1x 3.0 - 6.1.4 iPhone 4 (GSM) 2010 armv7 640 x 960 3.5 330 @2x 4.0 - 7.1.2 iPhone 4 (CDMA) 2011 armv7 640 x 960 3.5 330 @2x 4.2.4 - 7.1.2 iPhone 4S 2011 armv7 640 x 960 3.5 330 @2x 5.0 - 9.3.5 iPhone 5 2012 armv7s 640 x 1136 4 326 @2x 6.0 - 10.3.3 iPhone 5c 2013 armv7s 640 x 1136 4 326 @2x 7.0 - 10.3.3 iPhone 5s 2013 arm64 640 x 1136 4 326 @2x 7.0 - iPhone 6 2014 arm64 750 x 1334 4.7 326 @2x 8.0 - iPhone 6 Plus 2014 arm64 1242 x 2208 5.5 461 @3x 8.0 - iPhone 6s 2015 arm64 750 x 1334 4.7 326 @2x 9.0 - iPhone 6s Plus 2015 arm64 1242 x 2208 5.5 461 @3x 9.0 - iPhone SE 2016 arm64 640 x 1136 4 326 @2x 9.3 - iPhone 7 2016 arm64 750 x 1334 4.7 326 @2x 10.0 - iPhone 7 Plus 2016 arm64 1242 x 2208 5.5 461 @3x 10.0 - iPhone 8 2017 arm64 750 x 1334 4.7 326 @2x 11.0 - iPhone 8 Plus 2017 arm64 1242 x 2208 5.5 461 @3x 11.0 - iPhone X 2017 arm64 1125 x 2436 5.8 463 @3x 11.0 - iPhone XS 2018 arm64 1125 x 2436 5.8 463 @3x 12.0 - iPhone XS Max 2018 arm64 1242 x 2688 6.5 458 @3x 12.0 - iPhone XR 2018 arm64 828 x 1792 6.1 326 @2x 12.0 - iPhone 11 2019 arm64 828 x 1792 6.1 326 @2x 13.0 - iPhone 11 Pro 2019 arm64 1125 x 2436 5.8 458 @3x 13.0 - iPhone 11 Pro Max 2019 arm64 1242 x 2688 6.5 458 @3x 13.0 - æ³¨ï¼šå±å¹•åˆ†è¾¨çŽ‡å•ä½ä¸ºè‹±å¯¸(inch)ï¼Œåˆ†è¾¨çŽ‡å¯†åº¦å•ä½ä¸ºppi iPad è®¾å¤‡ å‘å¸ƒå¹´ä»½ CPUæž¶æž„ åˆ†è¾¨çŽ‡ @Nx iOSç³»ç»Ÿ iPad 2010 armv7 768 x 1024 @1x 3.2 - 5.1.1 iPad 2 2011 armv7 768 x 1024 @1x 4.3 - 9.3.5 iPad (3rd) 2012 armv7 1536 x 2048 @2x 5.1 - 9.3.5 iPad mini 2012 armv7s 768 x 1024 @1x 6.0 - 9.3.5 iPad (4rd) 2012 armv7s 1536 x 2048 @2x 6.0 - iPad Air 2013 arm64 1536 x 2048 @2x 7.0 - iPad mini Retina 2013 arm64 1536 x 2048 @2x 7.0 - iPad Air 2 2014 arm64 1536 x 2048 @2x 8.1 - iPad mini 3 2014 arm64 1536 x 2048 @2x 8.1 - iPad mini 4 2015 arm64 1536 x 2048 @2x 9.0 - iPad Pro (12.9) 2015 arm64 2048 x 2732 @2x 9.1 - iPad Pro (9.7) 2016 arm64 1536 x 2048 @2x 9.3 - iPad (5rd) 2017 arm64 1536 x 2048 @2x 10.2.1 - iPad Pro (10.5) 2017 arm64 1668 x 2224 @2x 10.3.2 - iPad Pro (12.9-2) 2017 arm64 2048 x 2732 @2x 10.3.2 - iPad (10.2) 2019 arm64 1620 x 2160 @2x iPadOS iPod touch è®¾å¤‡ å‘å¸ƒå¹´ä»½ CPUæž¶æž„ åˆ†è¾¨çŽ‡ @Nx iOSç³»ç»Ÿ iPod touch 2007 armv6 320 x 480 @1x 1.1 - 3.1.3 iPod touch (2nd) 2008 armv6 320 x 480 @1x 2.1.1 - 4.2.1 iPod touch (3rd) 2009 armv7 320 x 480 @1x 3.1 - 5.1.1 iPod touch (4th) 2010 armv7 640 x 960 @2x 4.1 - 6.1.4 iPod touch (5th) 2012 armv7 640 x 1136 @2x 6.0 - 9.3.5 iPod touch (6th) 2015 arm64 640 x 1136 @2x 8.4 - å‚è€ƒæ–‡æ¡£iOSè®¾å¤‡ä¸€è§ˆè¡¨]]></content>
      <categories>
        <category>ios</category>
      </categories>
      <tags>
        <tag>app</tag>
        <tag>ios</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git diff usage]]></title>
    <url>%2F2019%2F11%2F21%2Fgit-diff-usage%2F</url>
    <content type="text"><![CDATA[Git ä¸­ diff å‘½ä»¤ä½¿ç”¨æ•´ç†æ€»ç»“å·¥ä½œä¸­å¸¸ç”¨çš„git å‘½ä»¤, ä»Šå¤©æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„å‘½ä»¤ git diff ä¸»è¦ä½œç”¨æ˜¯ç”¨æ¥æ¯”è¾ƒå·®å¼‚ï¼ŒåŒ…æ‹¬ commitsä¹‹é—´,commit å’Œ å·¥ä½œåŒºé—´ å·®å¼‚ å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š 12345git diff [&lt;options&gt;] [&lt;commit&gt;] [--] [&lt;path&gt;â€¦â€‹]git diff [&lt;options&gt;] --cached [&lt;commit&gt;] [--] [&lt;path&gt;â€¦â€‹]git diff [&lt;options&gt;] &lt;commit&gt; &lt;commit&gt; [--] [&lt;path&gt;â€¦â€‹]git diff [&lt;options&gt;] &lt;blob&gt; &lt;blob&gt;git diff [&lt;options&gt;] --no-index [--] &lt;path&gt; &lt;path&gt; 1. æ¯”è¾ƒå·¥ä½œåŒºä¸Žæš‚å­˜åŒº1git diff ä¸åŠ å‚æ•° 2. æ¯”è¾ƒæš‚å­˜åŒºä¸Ž æœ¬åœ° æœ€æ–°ç‰ˆæœ¬ (æœ€åŽä¸€æ¬¡commit)1git diff --cached 3. æ¯”è¾ƒå·¥ä½œåŒºä¸Žæœ€æ–°æœ¬åœ°ç‰ˆæœ¬åº“1git diff HEAD 4. æ¯”è¾ƒå·¥ä½œåŒºä¸Žcommit-idçš„å·®å¼‚1git diff commit-id 5. æ¯”è¾ƒæš‚å­˜åŒºä¸ŽæŒ‡å®šcommit-idçš„å·®å¼‚1git diff --cached commit-id 6. æ¯”è¾ƒä¸¤ä¸ªcommit-idä¹‹é—´çš„å·®å¼‚1git diff commit-id commit-id 7. æ¯”è¾ƒä¸åŒæœ¬åœ°åˆ†æ”¯çš„å·®å¼‚1git diff dev # å½“å‰æ‰€å¤„åˆ†æ”¯ä¸ºmaster 8. æ¯”è¾ƒæœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯ä¹‹é—´çš„å·®å¼‚12git fetch origin mastergit diff master origin/master 9. æ¯”è¾ƒå·®å¼‚åªæ˜¾ç¤ºæ–‡ä»¶å1git diff --name-only 10 . æ¯”è¾ƒå·®å¼‚ æ˜¾ç¤ºæ›´æ”¹æ–‡ä»¶çŠ¶æ€1git diff --name-status]]></content>
      <categories>
        <category>ç‰ˆæœ¬ç®¡ç†</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript get checkbox checked value]]></title>
    <url>%2F2019%2F09%2F28%2Fjavascript-get-checkbox-checked-value%2F</url>
    <content type="text"><![CDATA[javascriptå¦‚ä½•èŽ·å–checkboxè¢«é€‰ä¸­çš„å€¼é¢„å¤‡çŸ¥è¯†javascript dom å¸¸ç”¨æ–¹æ³• æ–¹æ³•å æè¿° ä¾‹å­ document.getElementById è¿”å›žç»™å®šidå±žæ€§å€¼çš„å…ƒç´ èŠ‚ç‚¹ç›¸å¯¹åº”çš„å¯¹è±¡ document.getElementsByTagName è¿”å›žç»™å®šnameå±žæ€§çš„å…ƒç´ èŠ‚ç‚¹å¯¹åº”çš„å…ƒç´ é›†åˆ var hobbies = document.getElementsByName(â€œhobbiesâ€); element.nextSibling è¿”å›žè¯¥å…ƒç´ ç´§è·Ÿçš„ä¸€ä¸ªèŠ‚ç‚¹ nodeValue èŽ·å–èŠ‚ç‚¹ä¸­çš„æ–‡æœ¬å€¼ ,ä¾‹å¦‚ï¼šè·‘æ­¥ è·‘æ­¥ æ•°ç»„å¸¸ç”¨æ–¹æ³•ï¼š æ–¹æ³• æˆ–è€… å±žæ€§ è¯´æ˜Ž ä¾‹å­ arrayObject.length å±žæ€§ï¼šæ•°ç»„é•¿åº¦ arrayObject.push() å‘æ•°ç»„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´  var arr = new Array(3) arr[0] = â€œGeorgeâ€ arr[1] = â€œJohnâ€ arr[2] = â€œThomasâ€ é¡µé¢å¦‚ä¸‹ï¼š12345678910111213141516171819202122&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;javascriptèŽ·å–å¤é€‰æ¡†å€¼æ–¹æ³•&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt; &lt;input type="checkbox" name="hobbies" id="hobbies" class="hobbies" value="1"&gt;æ¸¸æ³³ &lt;input type="checkbox" name="hobbies" id="hobbies" class="hobbies" value="2"&gt;è·‘æ­¥ &lt;/p&gt; &lt;p&gt; &lt;button id="btn1"&gt;èŽ·å–å¤é€‰æ¡†å€¼&lt;/button&gt; &lt;/p&gt; &lt;/body&gt;&lt;/html&gt; æ–¹æ³•ä¸€ é€šè¿‡å¤é€‰æ¡†çš„nameå±žæ€§,éåŽ†åŽå°†è¢«é€‰ä¸­çš„å¤é€‰æ¡†çš„å€¼è¾“å‡º checkbox[index].nextSibling.nodeValue: èŽ·å–çš„æ˜¯checkboxä¸­æ ‡ç­¾åŒ…è£¹çš„æ–‡æœ¬å€¼ 123456789function get_checkbox_val() &#123; var hobbies = document.getElementsByName("hobbies"); for (let index = 0; index &lt; hobbies.length; index++) &#123; if (hobbies[index].checked) &#123; alert(hobbies[index].value + "," + hobbies[index].nextSibling.nodeValue); &#125; &#125; &#125; æ–¹æ³•äºŒ å»ºç«‹ä¸€ä¸ªæ•°ç»„,ä½¿ç”¨pushæ–¹æ³•å°†è¢«é€‰ä¸­çš„å…ƒç´ ä¿å­˜åˆ°æ•°ç»„ 123456789function get_checkbox_val_with_array() &#123; var arr = []; for (let index = 0; index &lt; hobbies.length; index++) &#123; if (hobbies[index].checked) &#123; arr.push(hobbies[index].value); &#125; &#125; alert(arr); &#125; æ–¹æ³•ä¸‰ é€šè¿‡classé€‰æ‹©å™¨ èŽ·å–è¢«é€‰ä¸­çš„å¤é€‰æ¡†çš„å€¼ 123456789function get_checkbox_val_with_selector() &#123; var hobbies = document.getElementsByClassName('hobbies'); for (let index = 0; index &lt; hobbies.length; index++) &#123; if (hobbies[index].checked) &#123; checkedValue = hobbies[index].value; alert(hobbies[index].value + "," + hobbies[index].nextSibling.nodeValue); &#125; &#125; &#125; ä½¿ç”¨jquery éœ€è¦å¼•å…¥jquery,è¿™é‡Œæˆ‘ä½¿ç”¨å›½å†…çš„cdn jqueryä¸­é€šè¿‡each() æ–¹æ³•éåŽ†æ‰€æœ‰è¢«é€‰ä¸­çš„å¤é€‰æ¡†çš„å€¼ 12345678910&lt;script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"&gt;&lt;/script&gt;&lt;script&gt; $('#btn1').click(function () &#123; $("input[name='hobbies']:checked").each(function () &#123; alert($(this).val()); &#125;); &#125;); &lt;/script&gt; &lt;/script&gt; ==tips== : $(â€œinput[name=â€™xxxxâ€™]:checkedâ€) è¢«é€‰ä¸­çš„å¤é€‰æ¡†å¯¹è±¡é›†åˆ]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>checkbox</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascriptä¸­Boolean_Objectä¸ŽBoolean_Primitives]]></title>
    <url>%2F2019%2F09%2F20%2Fjavascript%E4%B8%ADBoolean-Object%E4%B8%8EBoolean-Primitives%2F</url>
    <content type="text"><![CDATA[å…ˆçœ‹ä¸‹é¢çš„è„šæœ¬ï¼Œé¢„æµ‹ä¸‹ç»“æžœ 123456var flag = true;console.log(typeof(flag));//booleanvar fa = Boolean(true);console.log(typeof(fa));//booleanvar ff = new Boolean(true);console.log(typeof(ff)); //Object åœ¨ jslintä¸­æ˜Žç¡®æç¤º new Boolean(true)ï¼›do not use Boolean as a constructor. (W053)jshint(W053) æŽ¥ä¸‹æ¥çš„ä¾‹å­ 123456789if(flag)&#123; console.log("true is true");&#125;if(fa)&#123; console.log("Boolean is true");&#125;if(ff)&#123; console.log("Object Boolean is true");&#125; ç»“æžœå¦‚ä¸‹ 123true is trueBoolean is trueObject Boolean is true ä¿®æ”¹è„šæœ¬ï¼š 123456var flag = true;console.log(typeof(false));//booleanvar fa = Boolean(false);console.log(typeof(fa));//booleanvar ff = new Boolean(false);console.log(typeof(ff)); //Object ç»“æžœç«Ÿç„¶æ˜¾ç¤ºï¼š 1Object Boolean is true åŽæ¥æŸ¥é˜…èµ„æ–™å‘çŽ°, JavaScriptçš„å…¶ä»–æ•°æ®ç±»åž‹éƒ½å¯ä»¥è½¬æ¢æˆBooleanç±»åž‹ï¼Œæ³¨æ„ï¼ï¼ï¼åªæœ‰è¿™å‡ ç§ç±»åž‹ä¼šè½¬æ¢ä¸ºfalse 123456undefinednull0-0NaN"" (ç©ºå­—ç¬¦ä¸²) å…¶ä»–éƒ½è½¬åŒ–ä¸ºtrue,åŒ…æ‹¬ç©ºå¯¹è±¡{}ï¼Œç©ºæ•°ç»„[] ï¼Œ è´Ÿæ•° ï¼Œfalseçš„å¯¹è±¡åŒ…è£…ç­‰ã€‚ 123456789101112if(-1)&#123; console.log('-1è½¬æ¢ä¸ºtrue');&#125;if(&#123;&#125;)&#123; console.log('&#123;&#125;è½¬æ¢ä¸ºtrue');&#125;if([])&#123; console.log('[]è½¬æ¢ä¸ºtrue');&#125;if(new Boolean(false))&#123; console.log('new Boolean(false)è½¬æ¢ä¸ºtrue');&#125; new Boolean(false)æ˜¯å¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡ typeof (new Boolean(false)) // â€˜objectâ€™ ,æ‰€ä»¥ è½¬æ¢ä¸ºbooleanæ˜¯trueï¼Œè€Œä¸æ˜¯falseã€‚ ä»Žå¦ä¸€ä¸ªå±‚é¢ä¹Ÿè¯æ˜Žäº†ä¸ºå•¥jslint ç¦æ­¢åœ¨æž„é€ æ–¹æ³•é‡Œä½¿ç”¨Booleanç±»åž‹çš„æ•°æ®ã€‚ åŽè®°Boolean.valueOf() å¯ä»¥è¿”å›žBooleanå¯¹è±¡å¯¹åº”çš„å€¼ç±»åž‹ 1234/**/if(ff.valueOf())&#123; console.log("Object Boolean is true"); &#125; è¡¥å……å¯¹äºŽæ•°å­—0 è¿žç»­ä½¿ç”¨ä¸¤æ¬¡!! ä»æ—§è¿”å›žfalse. 123var fa = Boolean(0);console.log(fa); //falseconsole.log(!!0);//false å‚è€ƒæ–‡ç«  JavaScript Boolean( new Boolean(false) ) å…¶å®žæ˜¯true The Difference Between Boolean Objects and Boolean Primitives in JavaScript]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>Boolean</tag>
        <tag>å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how to add 163 music to hexo]]></title>
    <url>%2F2019%2F09%2F06%2Fhow-to-add-163-music-to-hexo%2F</url>
    <content type="text"><![CDATA[å¦‚ä½•ç»™hexoæ·»åŠ ç½‘æ˜“éŸ³ä¹å…ˆçœ‹çœ‹æ•ˆæžœ 1.è®¿é—®ç½‘æ˜“äº‘é¦–é¡µï¼Œé€‰æ‹©ä½ å–œæ¬¢çš„éŸ³ä¹ï¼Œç‚¹å‡»ç”Ÿæˆå¤–é“¾,æˆ‘ä¸å¸Œæœ›éŸ³ä¹ä¸€ç›´æ’­æ”¾,å¦‚æžœæ¥è®¿çš„æœ‹å‹æƒ³å¬,ç‚¹å‡»ä¸‹æ’­æ”¾å°±å¥½ã€‚ è¿™é‡Œæˆ‘é€‰æ‹©äºŒåå²çš„æŸä¸€å¤© 2. å¤åˆ¶iframeæ’ä»¶ä¸‹çš„srcé‡Œçš„åœ°å€ 3. ä¿®æ”¹themes/next/layout/sidebar.swigæ–‡ä»¶12345&#123;% if theme.background_music %&#125; &lt;div&gt; &lt;iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="210" height="110" src="&#123;&#123; theme.background_music &#125;&#125;"&gt;&lt;/iframe&gt; &lt;/div&gt;&#123;% endif %&#125; 4.æ·»åŠ éŸ³ä¹åœ°å€åˆ°ä¸»é¢˜1background_music : //music.163.com/outchain/player?type=2&amp;id=247172&amp;auto=1&amp;height=66]]></content>
      <categories>
        <category>æ­å»ºåšå®¢</category>
      </categories>
      <tags>
        <tag>åšå®¢</tag>
        <tag>ç½‘æ˜“éŸ³ä¹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how to Sort Python Dictionaries by Key or Value]]></title>
    <url>%2F2019%2F07%2F28%2Fhow-to-Sort-Python-Dictionaries-by-Key-or-Value%2F</url>
    <content type="text"><![CDATA[ä¼—æ‰€å‘¨çŸ¥,pythonä¸­å­—å…¸æ˜¯æ— åºçš„,é‚£ä¹ˆè¯¥å¦‚ä½•å¯¹å­—å…¸æŽ’åºå‘¢ï¼Ÿ ä¾‹å¦‚ä¸‹é¢çš„å­—å…¸ï¼š 1numbers = &#123;'second': 2,'first': 1, 'third': 3, 'Fourth': 4&#125; æˆ‘ä»¬å¯ä»¥é€šè¿‡list()å‡½æ•°æ‰“å°value,12&gt;&gt;&gt;list(numbers)['second', 'first', 'third', 'Fourth'] å¤‡æ³¨: python3.6.4 ä»¥ä¸Šçš„ç‰ˆæœ¬,å­—å…¸æ ¹æ®æ’å…¥çš„é¡ºåºè‡ªåŠ¨æŽ’åº å¦‚ä½•æ ¹æ®key å¯¹å­—å…¸æŽ’åºå¯ä»¥ä½¿ç”¨pythonçš„å†…ç½®å‡½æ•°sorted æ¥å¯¹å­—å…¸æŽ’åº,å¦‚ä¸‹é¢çš„ä»£ç  12&gt;&gt;&gt; sorted(numbers)['Fourth', 'first', 'second', 'third'] ç»“æžœæœ‰ç‚¹å·®å¼ºäººæ„,å› ä¸ºé»˜è®¤sortedå‡½æ•°æ˜¯æ ¹æ®å­—æ¯çš„é¡ºåºå‡åºæŽ’åˆ—çš„,è¿™é‡Œçš„å­—å…¸ä¸­ key æ°å¥½æ˜¯å­—æ¯ï¼Œæ‰€ä»¥æ‰ä¼šæ˜¾ç¤ºè¿™ä¸ªç»“æžœã€‚ æ ¹æ®valueå¯¹å­—å…¸æŽ’åºç”¨åŒæ ·çš„æ–¹æ³•,æˆ‘ä»¬å¯ä»¥æ ¹æ®valueæ¥æŽ’åº 12&gt;&gt;&gt; sorted(numbers.values())[1, 2, 3, 4] å¦‚ä½•æ ¹æ®è‡ªå®šä¹‰çš„è§„åˆ™å¯¹å­—å…¸æŽ’åºsortedå‡½æ•°è¿˜æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°å«key,æ³¨æ„è¿™é‡Œçš„keyå’Œå­—å…¸çš„keyæ²¡æœ‰å…³ç³»,æ ¹æ®æŒ‡å®šçš„key æ¥è¿›è¡ŒæŽ’åº,å®žçŽ°çš„æœºåˆ¶ç±»ä¼¼è¿­ä»£å™¨ã€‚æ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š 12&gt;&gt;&gt; sorted(numbers,key=numbers.__getitem__)['first', 'second', 'third', 'Fourth'] è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†å­—å…¸ç±»ä¸­å†…ç½®å‡½æ•°__getitem__ åœ¨éåŽ†å­—å…¸å€¼çš„è¿‡ç¨‹ä¸­,èŽ·å–å¯¹åº”çš„å€¼æ¥å¯¹å­—å…¸æŽ’åº å…³äºŽ__getitem__ å‡½æ•°çš„è¯¦ç»†è¯´æ˜Žï¼Œè¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚ å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ—è¡¨æŽ¨å¯¼çš„æ–¹å¼æ¥è¿›è¡ŒæŽ’åº(å®žè´¨ä¸Šæ˜¯è½¬åŒ–æˆäº†åˆ—è¡¨æ¥è¿›è¡ŒæŽ’åº) 1234&gt;&gt;&gt; sorted(numbers,key=numbers.__getitem__,reverse=True)['Fourth', 'third', 'second', 'first']&gt;&gt;&gt; [value for (key,value) in sorted(numbers.items(),reverse=True)][3, 2, 1, 4] å­—å…¸çš„keyæ˜¯æ•°å­—æˆ–è€…å­—æ¯çš„æƒ…å†µä¸‹å¯¹å­—å…¸æŽ’åº12&gt;&gt;&gt; sorted(numbers,key=str.lower)['first', 'Fourth', 'second', 'third'] æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°çš„å­—å…¸ 12345&gt;&gt;&gt; month = dict(one='January', two='February', three='March', four='April', five='May') é€šè¿‡__getitem__æ–¹æ³•æ¯”è¾ƒ æˆ‘ä»¬å®šä¹‰çš„å­—å…¸monthä¸­å¯¹åº”çš„å€¼ 123&gt;&gt;&gt; numbermap = &#123;'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5&#125;&gt;&gt;&gt; sorted(month, key=numbermap.__getitem__)['one', 'two', 'three', 'four', 'five'] åŒæ ·çš„åŽŸç†,å¯ä»¥ä½¿ç”¨åˆ—è¡¨æŽ¨å¯¼æ¥å®žçŽ°æŽ’åº 12&gt;&gt;&gt; [month[i] for i in sorted(month,key=numbermap.__getitem__)]['January', 'February', 'March', 'April', 'May'] å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ¥å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„æŽ’åºè§„åˆ™1234567891011def repeats(string): # Lower the case in the string string = string.lower() # Get a set of the unique letters uniques = set(string) # Count the max occurrences of each unique letter counts = [string.count(letter) for letter in uniques] return max(counts) æ ¹æ®å­—æ¯å°å†™æŽ’åº 12&gt;&gt;&gt; sorted(month.values(), key=repeats, reverse=True)['February', 'January', 'March', 'April', 'May'] ä½¿ç”¨lambdaè¡¨è¾¾å¼æŽ’åºä½¿ç”¨lambdaè¡¨è¾¾å¼ 12&gt;&gt;&gt; sorted(month.items(),key=lambda x:x[1])[('four', 'April'), ('two', 'February'), ('one', 'January'), ('three', 'March'), ('five', 'May')] 12&gt;&gt;&gt; sorted(month.items(),key=lambda x:x[0])[('five', 'May'), ('four', 'April'), ('one', 'January'), ('three', 'March'), ('two', 'February')] å…¶ä¸­ï¼š lambda x:x[1] è¡¨æ˜Žæ ¹æ®å€¼æŽ’åº lambda x:x[0] è¡¨æ˜Žæ ¹æ®é”®æŽ’åº ä»¥ä¸Šå°±æ˜¯pythonä¸­å¯¹å­—å…¸æŽ’åºçš„ä¸€ä¸ªæ€»ç»“,å¸Œæœ›èƒ½å¸®åˆ°å¤§å®¶ã€‚]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>dict</tag>
        <tag>sort</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript-undefined-description]]></title>
    <url>%2F2019%2F06%2F11%2Fjavascript-undefined-description%2F</url>
    <content type="text"><![CDATA[Javascript åŸºç¡€æ‹¾é—ä¹‹undefinedå…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š 123var a;console.log(a);//undefinedconsole.log(typeof(a)); //undefined javascriptä¸­çš„æ•°æ®ç±»åž‹åŒ…æ‹¬undefinedï¼Œnull,boolean,number,string,booleanå…­ç§ç±»åž‹(ECMAScript 2015) undefined å°ç»“undefined ç±»åž‹çš„æ„æ€æ˜¯å½“å‰å¯¹è±¡æœªå®šä¹‰,é€‚ç”¨äºŽä¸‹é¢å‡ ç§æƒ…å†µ å˜é‡å£°æ˜Ž,ä½†æœªèµ‹å€¼ å¯¹è±¡æ²¡æœ‰èµ‹å€¼çš„å±žæ€§,è¯¥å±žæ€§çš„å€¼ä¸ºundefined è°ƒç”¨å‡½æ•°å‚æ•°,ä½†æ˜¯æœªæä¾›å‚æ•°ï¼Œè¯¥å‚æ•°çš„å€¼ä¸ºundefined å‡½æ•°æ²¡æœ‰è¿”å›žå€¼æ—¶,é»˜è®¤è¿”å›žundefined å†çœ‹ä¸‹é¢çš„ä¾‹å­ 123456789101112131415161718//1.var i;console.log(i);//2.var o = new Object();console.log(o.p);//3.function test(a)&#123; console.log(typeof a); // undefined return a;&#125;test();//4.myfunc()function myfunc()&#123; //console.log("my function.");&#125;console.log(myfunc()); éœ€è¦åŒºåˆ«ä¸‹é¢è¿™ä¸ªæƒ…å†µ,ä¸åŒæµè§ˆå™¨æç¤ºä¿¡æ¯å¯èƒ½ä¼šä¸åŒ(Chromeå’ŒIEæµ‹è¯•) 12console.log(b);// Uncaught ReferenceError: b is not defined å¦‚ä½•åˆ¤æ–­ä¸ºç©ºä¸‹é¢ä¸‰ç§åˆ¤æ–­æ–¹æ³•ï¼š 123456// æ–¹å¼1if(typeof age === 'undefined')// æ–¹å¼2if(age === undefined)// æ–¹å¼3if(varName) //ä¸‡èƒ½åˆ¤æ–­,åŒ…æ‹¬boolean å‚è€ƒæ–‡æ¡£ç«ç‹JavaScriptæ•™ç¨‹ stackoverflowå¦‚ä½•æ£€æŸ¥undefined]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>javaweb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Build path entry is missing /src/test/java missingé—®é¢˜è§£å†³]]></title>
    <url>%2F2019%2F06%2F03%2FMaven-webapp-buildpath-missing-test-folder%2F</url>
    <content type="text"><![CDATA[[é—®é¢˜æè¿°]é€šè¿‡mavenæž„å»ºwebapp,å‘çŽ°ç¼ºå°‘javaå’Œtestç›®å½• [è§£å†³æ–¹æ¡ˆ] project â€“right click â€“build pathâ€“ config build path â€“ libraries â€“ double click â€œJRE System Libraryâ€â€“choose â€œworkspace default JREâ€ OK å¦‚ä¸‹å›¾æ‰€ç¤º]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
      <tags>
        <tag>maven</tag>
        <tag>javaweb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how-to-fix-cannot-change-version-of-project-dynamic-web-module-to-3.1-in-Eclipse]]></title>
    <url>%2F2019%2F06%2F03%2Fhow-to-fix-cannot-change-version-of-project-dynamic-web-module-to-3.1-in-Eclipse%2F</url>
    <content type="text"><![CDATA[1.é—®é¢˜æè¿° è¯•å›¾è½¬æ¢Dynamic Web Module å‘ç”Ÿå¦‚ä¸‹é”™è¯¯: 12Cannot change version of project facet Dynamic Web Module to 3.0 One or more constraints have not been satisfied æ“ä½œæ­¥éª¤ï¼š å³é”®ç‚¹å‡»é¡¹ç›® é€‰æ‹©Properties ç‚¹å‡»Project facet é€‰é¡¹ æ›´æ”¹Dynamic Web Module, 2.3 åˆ° 3.1 ,å¦‚ä¸‹å›¾ 2. è§£å†³æ­¥éª¤Step 1ï¼š é€‰æ‹©navigator è§†å›¾ Step 2: æ‰“å¼€org.eclipse.wst.common.project.facet.core.xml ä¿®æ”¹jst.web çš„å€¼2.3 ä¸º 3.1 12345678&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;faceted-project&gt; &lt;fixed facet="wst.jsdt.web"/&gt; &lt;installed facet="jst.jaxrs" version="2.0"/&gt; &lt;installed facet="wst.jsdt.web" version="1.0"/&gt; &lt;installed facet="java" version="1.8"/&gt; &lt;installed facet="jst.web" version="3.1"/&gt;&lt;/faceted-project&gt; æ³¨æ„ jst.webç‰ˆæœ¬3.1,é‚£ä¹ˆjavaç‰ˆæœ¬å¿…é¡»æ˜¯1.7ä»¥ä¸Šæ‰å¯ä»¥ Step 3: åˆ·æ–°é¡¹ç›® é¼ æ ‡å³é”®ç‚¹å‡»é¡¹ç›® F5åˆ·æ–°é¡¹ç›® æ¸…ç†é¡¹ç›® ç‚¹å‡»é¡¶éƒ¨èœå•æ  Project é€‰æ‹©Clean mavenæ›´æ–° é¼ æ ‡å³é”®ç‚¹å‡»é¡¹ç›®åç§° é€‰æ‹©Maven é€‰æ‹©Update project 3. é—®é¢˜æ€»ç»“æ²¡æœ‰æ¸…ç†é¡¹ç›®å°±ç›´æŽ¥æ›´æ–°,ç¼“å­˜é€ æˆæ›´æ–°å¤±è´¥ã€‚ å‚è€ƒé“¾æŽ¥ how-to-fix-cannot-change-version-of-project-dynamic-web-module-to-3.1-in-Eclipse]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>maven</tag>
        <tag>eclipse</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hexoå»ºç«™æ­å»ºæµç¨‹]]></title>
    <url>%2F2019%2F05%2F31%2Fhexo%E5%BB%BA%E7%AB%99%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[ä¸‹è½½å¹¶å®‰è£… Visual Studio Code, å®˜æ–¹ä¸‹è½½ ä¸‹è½½å¹¶å®‰è£… Nodejs, å®˜æ–¹ä¸‹è½½ 12node -vnpm -v npm é•œåƒæºä¿®æ”¹ä¸º æ·˜å®NPMé•œåƒ 1npm install -g cnpm --registry=https://registry.npm.taobao.org ä¸‹è½½å¹¶å®‰è£… Git, å®˜æ–¹ä¸‹è½½ 123#é…ç½®åå­—å’Œé‚®ç®±git config --global user.name &quot;test&quot;git config --global user.email &quot;test@.com&quot; å®‰è£… Hexo, å®˜æ–¹æ–‡æ¡£ 12cnpm install -g hexo-clihexo -v åˆå§‹åŒ–åšå®¢ç›®å½• 1234cd Dhexo init blogcd blogcnpm install å¯åŠ¨æœåŠ¡å™¨,æœ¬åœ°é¢„è§ˆ 1hexo server Hexo å¸¸ç”¨ç«™ç‚¹é…ç½®_config.yml 12345678910#ç½‘ç«™æ ‡é¢˜title: test#ä½œè€…æ˜µç§°author: test#ç«™ç‚¹æè¿°[ç­¾å]description: ç«™ç‚¹æè¿°#ç½‘ç«™åœ°å€url: http://www.test.com#æ–‡ç« çš„é“¾æŽ¥æ ¼å¼permalink: :title.html æ·»åŠ æ ‡ç­¾ 1234#ç”Ÿæˆæ–‡ä»¶è·¯å¾„ source/tags/index.mdhexo new page tags#ç¼–è¾‘index.md,æ·»åŠ typetype: &quot;tags&quot; æ·»åŠ åˆ†ç±» 1234#ç”Ÿæˆæ–‡ä»¶è·¯å¾„ source/categories/index.mdhexo new page categories#ç¼–è¾‘index.md,æ·»åŠ typetype: &quot;categories&quot; æ–‡ç« æ·»åŠ æ ‡ç­¾ä¸Žåˆ†ç±» 12345categories: - hexotags: - hexo - github è®¾ç½®é˜…è¯»å…¨æ–‡ 12#åœ¨æ–‡ç« ä¸­ä½¿ç”¨ &lt;!-- more --&gt; æ‰‹åŠ¨æˆªæ–­ &lt;!-- more --&gt; Hexo ä¸»é¢˜,è¿™é‡Œé€‰æ‹© Next, Githubåœ°å€ æ–‡æ¡£å®‰è£… Next ä¸»é¢˜ 1git clone https://github.com/iissnan/hexo-theme-next themes/next å¯ç”¨ä¸»é¢˜å¹¶è®¾ç½®è¯­è¨€,ç«™ç‚¹é…ç½® 12theme: nextlanguage: zh-CN ä¸»é¢˜å¸¸ç”¨é…ç½®,themes/next/_config.yml 12345678910111213141516171819#ä¸»é¢˜å¤–è§‚è®¾å®šscheme: Gemini#è®¾ç½®èœå•menu: home: / || home tags: /tags/ || tags categories: /categories/ || th archives: /archives/ || archive#è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜highlight_theme: night eighties#æ·»åŠ å‹æƒ…é“¾æŽ¥links: test: http://www.test.com#æ–‡ç« è‡ªåŠ¨æ·»åŠ ç‰ˆæƒå£°æ˜Žpost_copyright: enable: true#è¿”å›žé¡¶éƒ¨æŒ‰é’®æ˜¾ç¤ºç™¾åˆ†æ¯”sidebar: scrollpercent: true è®¾ç½®RSS,å®‰è£…hexo-generator-feed 1cnpm install hexo-generator-feed --save å®‰è£…hexo-generator-searchdb,æ·»åŠ ç™¾åº¦/è°·æ­Œ/æœ¬åœ° è‡ªå®šä¹‰ç«™ç‚¹å†…å®¹æœç´¢ 1cnpm install hexo-generator-searchdb --save å¯ç”¨æœç´¢,ä¸»é¢˜é…ç½® 12local_search: enable: true é…ç½®æœç´¢,ç«™ç‚¹é…ç½® 12345search: path: search.xml field: post format: html limit: 7777 è®¾ç½®favicon.ico,å°†favicon.icoä¸Šä¼ è‡³ç«™ç‚¹æ ¹ç›®å½•/source ç›®å½•ä¸‹,ä¸»é¢˜é…ç½® 123favicon: small: favicon.ico medium: favicon.ico éƒ¨ç½²Hexoè‡³Githubå®‰è£… hexo-deployer-git 1cnpm install hexo-deployer-git --save ç«™ç‚¹é…ç½® 123deploy: type: git repo: https://github.com/githubè´¦å·/githubè´¦å·.github.io.git ç”Ÿæˆå¹¶éƒ¨ç½² 1hexo d -g Github è‡ªå®šä¹‰åŸŸå,ç”±äºŽHexoæ¯æ¬¡éƒ¨ç½²åˆ°Githubéƒ½ä¼šè¦†ç›–Githubçš„åŸŸåé…ç½®,æ‰€ä»¥ç›´æŽ¥åœ¨Hexoé…ç½®,ç„¶åŽå†éƒ¨ç½²,åœ¨æ ¹ç›®å½•ä¸‹çš„sourceç›®å½•ä¸‹æ–°å»ºCNAMEæ–‡ä»¶,æ— åŽç¼€å 12#è‡ªå®šä¹‰åŸŸåxxx.com è§£æžåŸŸååˆ° github.io,è®°å½•ç±»åž‹ = CNAME, è®°å½•å€¼ = githubè´¦å·.github.io ç äº‘æ–°å»ºä¸€ä¸ªé¡¹ç›®, è·¯å¾„ https://gitee.com/test/test.git Hexo ç›®å½•è¯´æ˜Ž 12.deploy_git Hexoé»˜è®¤çš„.gité…ç½®æ–‡ä»¶å¤¹public æ ¹æ®sourceæ–‡ä»¶å¤¹å†…å®¹è‡ªåŠ¨ç”Ÿæˆ è¿›å…¥ Hexoæ ¹ç›®å½•,æ‰§è¡Œä»¥ä¸‹å‘½ä»¤,å…ˆåˆ é™¤ themes/next ç›®å½•ä¸‹çš„ .gitignore æ–‡ä»¶ 12345678910#åˆå§‹åŒ–ä»“åº“git init#æ·»åŠ è¿œç¨‹ä¸»æœºgit remote add origin https://gitee.com/test/test.git#æ·»åŠ ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶,ä¸åŒ…å« .gitignore å£°æ˜Žçš„æ–‡ä»¶git add .#æ·»åŠ æ›´æ–°è¯´æ˜Žgit commit -m &quot;hexo first commit&quot;#æŽ¨é€æ›´æ–°åˆ°äº‘ç«¯æœåŠ¡å™¨git push -u origin master åˆ›å»º test ç›®å½•,å°† Git çš„å†…å®¹åŒæ­¥åˆ°æœ¬åœ°å¹¶å®‰è£…Hexo 1234567mkdir testcd testgit initgit remote add origin https://gitee.com/test/test.gitgit fetch --allgit reset --hard origin/mastercnpm install blog ç›®å½•æ˜¯Aç”µè„‘, test ç›®å½•æ˜¯Bç”µè„‘, æ›´æ–°æ–‡ç« åŽçš„åŒæ­¥æ“ä½œï¼š 12345678#Aç”µè„‘ä¿®æ”¹äº† test.md,æ·»åŠ æ›´æ–°è¯´æ˜Žå¹¶æŽ¨é€åˆ°è¿œç¨‹ä»“åº“,ä½¿ç”¨git statusæŸ¥çœ‹çŠ¶æ€ä¼šæ˜¾ç¤ºåˆšåˆšæ›´æ”¹è¿‡çš„æ–‡ä»¶çŠ¶æ€git commit -m &quot;update test.md&quot;git push origin mastergit status#Bç”µè„‘åŒæ­¥æ›´æ–°git pull origin master#å¯ä»¥é€šè¿‡æŒ‡å®šå½“å‰ç›®å½•å·¥ä½œåˆ†æ”¯ä¸Žè¿œç¨‹ä»“åº“åˆ†æ”¯ä¹‹é—´çš„é“¾æŽ¥å…³ç³»git branch --set-upstream-to=origin/master master hexo æ•°æ®æ–‡ä»¶,é€šç”¨é…ç½®æ–‡ä»¶,æ–°å»º source/_data ç›®å½•, ä¸»é¢˜çš„é…ç½®å¯ä»¥åœ¨æ­¤ç›®å½•ä¸‹é…ç½®,ä»¥ Next ä¸»é¢˜ä¸ºä¾‹,åœ¨æ­¤ç›®å½•ä¸‹æ–°å»º next.yml, åˆ™ next.yml çš„é…ç½®ä¼šè¦†ç›– themes/next/_config.yml çš„ç›¸åŒé…ç½®]]></content>
      <categories>
        <category>æ­å»ºåšå®¢</category>
      </categories>
      <tags>
        <tag>æ­å»ºåšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonåˆ›å»ºå­—å…¸çš„å‡ ç§æ–¹æ³•]]></title>
    <url>%2F2019%2F05%2F28%2Fpython%E5%88%9B%E5%BB%BA%E5%AD%97%E5%85%B8%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[pythonåˆ›å»ºå­—å…¸çš„å‡ ç§æ–¹æ³•1. åˆ›å»ºç©ºå­—å…¸123&gt;&gt;&gt; dic = &#123;&#125;&gt;&gt;&gt; type(dic)&lt;type &apos;dict&apos;&gt; å¦ä¸€ç§å½¢å¼ï¼š12temp = dict()temp[&apos;name&apos;] = &apos;xiaoming&apos; 2. ç›´æŽ¥èµ‹å€¼åˆ›å»º123&gt;&gt;&gt; dic = &#123;&apos;spam&apos;:1, &apos;egg&apos;:2, &apos;bar&apos;:3&#125;&gt;&gt;&gt; dic&#123;&apos;bar&apos;: 3, &apos;egg&apos;: 2, &apos;spam&apos;: 1&#125; 3. é€šè¿‡å…³é”®å­—dictå’Œå…³é”®å­—å‚æ•°åˆ›å»º123&gt;&gt;&gt; dic = dict(spam = 1, egg = 2, bar =3)&gt;&gt;&gt; dic&#123;&apos;bar&apos;: 3, &apos;egg&apos;: 2, &apos;spam&apos;: 1&#125; 4. é€šè¿‡äºŒå…ƒç»„åˆ—è¡¨åˆ›å»º1234&gt;&gt;&gt; list = [(&apos;spam&apos;, 1), (&apos;egg&apos;, 2), (&apos;bar&apos;, 3)]&gt;&gt;&gt; dic = dict(list)&gt;&gt;&gt; dic&#123;&apos;bar&apos;: 3, &apos;egg&apos;: 2, &apos;spam&apos;: 1&#125; 5. dictå’Œzipç»“åˆåˆ›å»º123&gt;&gt;&gt; dic = dict(zip(&apos;abc&apos;, [1, 2, 3]))&gt;&gt;&gt; dic&#123;&apos;a&apos;: 1, &apos;c&apos;: 3, &apos;b&apos;: 2&#125; 6. é€šè¿‡å­—å…¸æŽ¨å¯¼å¼åˆ›å»º123&gt;&gt;&gt; dic = &#123;i:2*i for i in range(3)&#125;&gt;&gt;&gt; dic&#123;0: 0, 1: 2, 2: 4&#125; 7. é€šè¿‡dict.fromkeys()åˆ›å»º123&gt;&gt;&gt; dic = dict.fromkeys(range(3), &apos;x&apos;)&gt;&gt;&gt; dic&#123;0: &apos;x&apos;, 1: &apos;x&apos;, 2: &apos;x&apos;&#125; 8. å…¶ä»–1234&gt;&gt;&gt; list = [&apos;x&apos;, 1, &apos;y&apos;, 2, &apos;z&apos;, 3]&gt;&gt;&gt; dic = dict(zip(list[::2], list[1::2]))&gt;&gt;&gt; dic&#123;&apos;y&apos;: 2, &apos;x&apos;: 1, &apos;z&apos;: 3&#125;]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>å­—å…¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonæ“ä½œsqlite3]]></title>
    <url>%2F2019%2F05%2F28%2Fpython%E6%93%8D%E4%BD%9Csqlite3%2F</url>
    <content type="text"><![CDATA[sqlite3 ç®€ä»‹1234567891011121314151617181920212223242526272829303132SQLiteæ•°æ®åº“æ˜¯ä¸€æ¬¾éžå¸¸å°å·§çš„åµŒå…¥å¼å¼€æºæ•°æ®åº“è½¯ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰ç‹¬ç«‹çš„ç»´æŠ¤è¿›ç¨‹ï¼Œæ‰€æœ‰çš„ç»´æŠ¤éƒ½æ¥è‡ªäºŽç¨‹åºæœ¬èº«ã€‚åœ¨pythonä¸­ï¼Œä½¿ç”¨sqlite3åˆ›å»ºæ•°æ®åº“çš„è¿žæŽ¥ï¼Œå½“æˆ‘ä»¬æŒ‡å®šçš„æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨çš„æ—¶å€™è¿žæŽ¥å¯¹è±¡ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“æ–‡ä»¶ï¼›å¦‚æžœæ•°æ®åº“æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™è¿žæŽ¥å¯¹è±¡ä¸ä¼šå†åˆ›å»ºæ•°æ®åº“æ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æŽ¥æ‰“å¼€è¯¥æ•°æ®åº“æ–‡ä»¶ã€‚ è¿žæŽ¥å¯¹è±¡å¯ä»¥æ˜¯ç¡¬ç›˜ä¸Šé¢çš„æ•°æ®åº“æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å»ºç«‹åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨å†…å­˜ä¸­çš„æ•°æ®åº“ æ‰§è¡Œå®Œä»»ä½•æ“ä½œåŽï¼Œéƒ½ä¸éœ€è¦æäº¤äº‹åŠ¡çš„(commit) åˆ›å»ºåœ¨ç¡¬ç›˜ä¸Šé¢ï¼š conn = sqlite3.connect(&apos;c:\\test\\test.db&apos;) åˆ›å»ºåœ¨å†…å­˜ä¸Šé¢ï¼š conn = sqlite3.connect(&apos;&quot;memory:&apos;) ä¸‹é¢æˆ‘ä»¬ä¸€ç¡¬ç›˜ä¸Šé¢åˆ›å»ºæ•°æ®åº“æ–‡ä»¶ä¸ºä¾‹æ¥å…·ä½“è¯´æ˜Žï¼š conn = sqlite3.connect(&apos;c:\\test\\hongten.db&apos;) å…¶ä¸­connå¯¹è±¡æ˜¯æ•°æ®åº“é“¾æŽ¥å¯¹è±¡ï¼Œè€Œå¯¹äºŽæ•°æ®åº“é“¾æŽ¥å¯¹è±¡æ¥è¯´ï¼Œå…·æœ‰ä»¥ä¸‹æ“ä½œï¼š commit() --äº‹åŠ¡æäº¤ rollback() --äº‹åŠ¡å›žæ»š close() --å…³é—­ä¸€ä¸ªæ•°æ®åº“é“¾æŽ¥ cursor() --åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡ cu = conn.cursor() è¿™æ ·æˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡ï¼šcu åœ¨sqlite3ä¸­ï¼Œæ‰€æœ‰sqlè¯­å¥çš„æ‰§è¡Œéƒ½è¦åœ¨æ¸¸æ ‡å¯¹è±¡çš„å‚ä¸Žä¸‹å®Œæˆ å¯¹äºŽæ¸¸æ ‡å¯¹è±¡cuï¼Œå…·æœ‰ä»¥ä¸‹å…·ä½“æ“ä½œï¼š execute() --æ‰§è¡Œä¸€æ¡sqlè¯­å¥ executemany() --æ‰§è¡Œå¤šæ¡sqlè¯­å¥ close() --æ¸¸æ ‡å…³é—­ fetchone() --ä»Žç»“æžœä¸­å–å‡ºä¸€æ¡è®°å½• fetchmany() --ä»Žç»“æžœä¸­å–å‡ºå¤šæ¡è®°å½• fetchall() --ä»Žç»“æžœä¸­å–å‡ºæ‰€æœ‰è®°å½• scroll() --æ¸¸æ ‡æ»šåŠ¨ sqlite3å¸¸ç”¨æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197#!/usr/bin/env python# -*- coding: utf-8 -*-# @Date : 2019-03-14 16:10:24# @Author : Jeff.Sui (215687736@qq.com)# @Link : http://example.org# @Version : $Id$import sqlite3con = sqlite3.connect(&quot;:memory:&quot;)c = con.cursor()# Create tablec.execute(&apos;&apos;&apos;CREATE TABLE stocks (date text, trans text, symbol text, qty real, price real)&apos;&apos;&apos;)# Insert a row of datac.execute(&quot;INSERT INTO stocks VALUES (?,?,?,?,?)&quot;, (&apos;2006-03-27&apos;,&apos;BUY&apos;,&apos;RHAT&apos;,100,60.14))# Larger example that inserts many records at a timepurchases = [(&apos;2006-03-28&apos;, &apos;BUY&apos;, &apos;IBM&apos;, 1000, 45.00), (&apos;2006-04-05&apos;, &apos;BUY&apos;, &apos;MSFT&apos;, 1000, 72.00), (&apos;2006-04-06&apos;, &apos;SELL&apos;, &apos;IBM&apos;, 500, 53.00), (&apos;2006-04-07&apos;, &apos;SELL&apos;, &apos;MSFT&apos;, 500, 74.00), (&apos;2006-04-08&apos;, &apos;SELL&apos;, &apos;IBM&apos;, 500, 54.00), (&apos;2006-04-09&apos;, &apos;SELL&apos;, &apos;MSFT&apos;, 500, 73.00), (&apos;2006-04-10&apos;, &apos;SELL&apos;, &apos;MSFT&apos;, 500, 75.00), (&apos;2006-04-12&apos;, &apos;SELL&apos;, &apos;IBM&apos;, 500, 55.00), ]c.executemany(&apos;INSERT INTO stocks VALUES (?,?,?,?,?)&apos;, purchases)# Save (commit) the changescon.commit()# Do this insteadt = (&apos;RHAT&apos;,)c.execute(&apos;SELECT * FROM stocks WHERE symbol=?&apos;, t)#print(c.fetchone())#for row in c.execute(&apos;SELECT * FROM stocks ORDER BY price&apos;):# print(row) #for row in c.execute(&apos;SELECT * FROM stocks LIMIT 5 OFFSET 0&apos;):# print(row)for row in c.execute(&apos;SELECT * FROM stocks LIMIT 5 OFFSET 1&apos;): print(row)#Select Top N * From# ====================================================================================# SQLite æ—¥æœŸ &amp; æ—¶é—´# ====================================================================================print(&apos;=&apos;*30)print(&apos;SQLite æ—¥æœŸ &amp; æ—¶é—´&apos;)print(&apos;=&apos;*30)# è®¡ç®—å½“å‰æ—¥æœŸc.execute(&quot;SELECT date(&apos;now&apos;)&quot;)print(c.fetchone())# è®¡ç®—å½“å‰æœˆä»½çš„æœ€åŽä¸€å¤©ï¼šc.execute(&quot;SELECT date(&apos;now&apos;,&apos;start of month&apos;,&apos;+1 month&apos;,&apos;-1 day&apos;);&quot;)print(c.fetchone())# è®¡ç®—ç»™å®š UNIX æ—¶é—´æˆ³ 1092941466 çš„æ—¥æœŸå’Œæ—¶é—´ï¼šc.execute(&quot;SELECT datetime(1092941466, &apos;unixepoch&apos;);&quot;)print(c.fetchone())# è®¡ç®—ç»™å®š UNIX æ—¶é—´æˆ³ 1092941466 ç›¸å¯¹æœ¬åœ°æ—¶åŒºçš„æ—¥æœŸå’Œæ—¶é—´ï¼šc.execute(&quot;SELECT datetime(1092941466, &apos;unixepoch&apos;, &apos;localtime&apos;);&quot;)print(c.fetchone())# è®¡ç®—å½“å‰çš„ UNIX æ—¶é—´æˆ³ï¼šc.execute(&quot;SELECT datetime(1092941466, &apos;unixepoch&apos;, &apos;localtime&apos;);&quot;)print(c.fetchone())# è®¡ç®—ç¾Žå›½&quot;ç‹¬ç«‹å®£è¨€&quot;ç­¾ç½²ä»¥æ¥çš„å¤©æ•°ï¼šc.execute(&quot;SELECT julianday(&apos;now&apos;) - julianday(&apos;1776-07-04&apos;);&quot;)print(c.fetchone())# è®¡ç®—ä»Ž 2004 å¹´æŸä¸€ç‰¹å®šæ—¶åˆ»ä»¥æ¥çš„ç§’æ•°ï¼šc.execute(&quot;SELECT strftime(&apos;%s&apos;,&apos;now&apos;) - strftime(&apos;%s&apos;,&apos;2004-01-01 02:34:56&apos;);&quot;)print(c.fetchone())# è®¡ç®—å½“å¹´ 10 æœˆçš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸäºŒçš„æ—¥æœŸï¼šc.execute(&quot;SELECT date(&apos;now&apos;,&apos;start of year&apos;,&apos;+9 months&apos;,&apos;weekday 2&apos;);&quot;)print(c.fetchone())# è®¡ç®—ä»Ž UNIX çºªå…ƒç®—èµ·çš„ä»¥ç§’ä¸ºå•ä½çš„æ—¶é—´ï¼ˆç±»ä¼¼ strftime(&apos;%s&apos;,&apos;now&apos;) ï¼Œä¸åŒçš„æ˜¯è¿™é‡Œæœ‰åŒ…æ‹¬å°æ•°éƒ¨åˆ†ï¼‰ï¼šc.execute(&quot;SELECT (julianday(&apos;now&apos;) - 2440587.5)*86400.0;&quot;)print(c.fetchone())# åœ¨ UTC ä¸Žæœ¬åœ°æ—¶é—´å€¼ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œå½“æ ¼å¼åŒ–æ—¥æœŸæ—¶ï¼Œä½¿ç”¨ utc æˆ– localtime ä¿®é¥°ç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šc.execute(&quot;SELECT time(&apos;12:00&apos;, &apos;localtime&apos;);&quot;)print(c.fetchone())# c.execute(&quot;SELECT time(&apos;12:00&apos;, &apos;utc&apos;);&quot;)print(c.fetchone())con.close()# ====================================================================================# SQLite å¸¸ç”¨å‡½æ•°# ====================================================================================print(&apos;=&apos;*30)print(&apos;SQLite å¸¸ç”¨å‡½æ•°&apos;)print(&apos;=&apos;*30)con = sqlite3.connect(&quot;:memory:&quot;)c = con.cursor()# Create tablec.execute(&apos;&apos;&apos;CREATE TABLE COMPANY (ID integer, NAME text, AGE integer, ADDRESS text, SALARY real)&apos;&apos;&apos;)# Larger example that inserts many records at a timepurchases = [(1,&apos;Paul&apos;,32,&apos;California&apos;,20000.0), (2,&apos;Allen&apos;,25,&apos;Texas&apos;,15000.0), (3,&apos;Teddy&apos;,23,&apos;Norway&apos;,20000.0), (4,&apos;Mark&apos;,25,&apos;Rich-Mond&apos;,65000.0), (5,&apos;David&apos;,27,&apos;Texas&apos;,85000.0), (6,&apos;Kim&apos;,22,&apos;South-Hall&apos;,45000.0), (7,&apos;James&apos;,24,&apos;Houston&apos;,10000.0)]c.executemany(&apos;INSERT INTO COMPANY VALUES (?,?,?,?,?)&apos;, purchases)# Save (commit) the changescon.commit()# è¿”å›žæ•°æ®åº“è¡¨æœ€åŽ n è¡Œè®°å½•# å…ˆè®¡ç®—ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­çš„è¡Œæ•°c.execute(&quot;SELECT count(*) FROM COMPANY;&quot;)last = c.fetchone()[0]n = 5c.execute(&quot;SELECT * FROM COMPANY LIMIT ? OFFSET ?;&quot;, (n, last-n))for row in c: print(row)# è®¡ç®—ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­çš„è¡Œæ•°c.execute(&quot;SELECT count(*) FROM COMPANY;&quot;)print(c.fetchone())# é€‰æ‹©æŸåˆ—çš„æœ€å¤§å€¼c.execute(&quot;SELECT max(salary) FROM COMPANY;&quot;)print(c.fetchone())# é€‰æ‹©æŸåˆ—çš„æœ€å°å€¼c.execute(&quot;SELECT min(salary) FROM COMPANY;&quot;)print(c.fetchone())# è®¡ç®—æŸåˆ—çš„å¹³å‡å€¼c.execute(&quot;SELECT avg(salary) FROM COMPANY;&quot;)print(c.fetchone())# ä¸ºä¸€ä¸ªæ•°å€¼åˆ—è®¡ç®—æ€»å’Œc.execute(&quot;SELECT sum(salary) FROM COMPANY;&quot;)print(c.fetchone())# è¿”å›žä¸€ä¸ªä»‹äºŽ -9223372036854775808 å’Œ +9223372036854775807 ä¹‹é—´çš„ä¼ªéšæœºæ•´æ•°c.execute(&quot;SELECT random() AS Random;&quot;)print(c.fetchone())# è¿”å›žæ•°å€¼å‚æ•°çš„ç»å¯¹å€¼c.execute(&quot;SELECT abs(5), abs(-15), abs(NULL), abs(0), abs(&apos;ABC&apos;);&quot;)print(c.fetchone())# æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™å­—æ¯c.execute(&quot;SELECT upper(name) FROM COMPANY;&quot;)print(c.fetchone())# æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™å­—æ¯c.execute(&quot;SELECT lower(name) FROM COMPANY;&quot;)print(c.fetchone())# è¿”å›žå­—ç¬¦ä¸²çš„é•¿åº¦c.execute(&quot;SELECT name, length(name) FROM COMPANY;&quot;)print(c.fetchone())# è¿”å›ž SQLite åº“çš„ç‰ˆæœ¬c.execute(&quot;SELECT sqlite_version() AS &apos;SQLite Version&apos;;&quot;)print(c.fetchone())# c.execute(&quot;SELECT CURRENT_TIMESTAMP;&quot;)print(c.fetchone())]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>sqlite3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[seleniumå…ƒç´ æ“ä½œå°è£…]]></title>
    <url>%2F2019%2F05%2F28%2Fselenium%E5%85%83%E7%B4%A0%E6%93%8D%E4%BD%9C%E5%B0%81%E8%A3%85%2F</url>
    <content type="text"><![CDATA[selenium å¸¸ç”¨çš„å…ƒç´ å®šä½æ“ä½œSeleniumæä¾›äº†8ç§å®šä½æ–¹å¼ã€‚ id name class name tag name link text partial link text xpath css selector è¿™8ç§å®šä½æ–¹å¼åœ¨Python seleniumä¸­æ‰€å¯¹åº”çš„æ–¹æ³•ä¸ºï¼š find_element_by_id() find_element_by_name() find_element_by_class_name() find_element_by_tag_name() find_element_by_link_text() find_element_by_partial_link_text() find_element_by_xpath() find_element_by_css_selector() å¸¸ç”¨å…ƒç´ å®šä½å°è£…12345678910111213141516171819202122232425262728293031323334def _locate_element(self, selector): """ to locate element by selector :arg selector should be passed by an example with "i,xxx" "x,//*[@id='langs']/button" :returns DOM element """ if self.by_char not in selector: return self.base_driver.find_element_by_id(selector) selector_by = selector.split(self.by_char)[0].strip() selector_value = selector.split(self.by_char)[1].strip() if selector_by == "i" or selector_by == 'id': element = self.base_driver.find_element_by_id(selector_value) elif selector_by == "n" or selector_by == 'name': element = self.base_driver.find_element_by_name(selector_value) elif selector_by == "c" or selector_by == 'class_name': element = self.base_driver.find_element_by_class_name(selector_value) elif selector_by == "l" or selector_by == 'link_text': element = self.base_driver.find_element_by_link_text(selector_value) elif selector_by == "p" or selector_by == 'partial_link_text': element = self.base_driver.find_element_by_partial_link_text(selector_value) elif selector_by == "t" or selector_by == 'tag_name': element = self.base_driver.find_element_by_tag_name(selector_value) elif selector_by == "x" or selector_by == 'xpath': element = self.base_driver.find_element_by_xpath(selector_value) elif selector_by == "s" or selector_by == 'css_selector': element = self.base_driver.find_element_by_css_selector(selector_value) else: raise NameError("Please enter a valid type of targeting elements.") return element]]></content>
      <categories>
        <category>è‡ªåŠ¨åŒ–æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>selenium</tag>
        <tag>web test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨seleniumè®¿é—®çˆ±å¥‡è‰ºç½‘ç«™]]></title>
    <url>%2F2019%2F05%2F28%2Fusing-selenium-visit-iqiyi-website%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨seleniumè®¿é—®çˆ±å¥‡è‰ºç½‘ç«™ selenium æ˜¯ä¸€ç§å¸¸ç”¨çš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ã€‚å®ƒæ”¯æŒå„ç§æµè§ˆå™¨ï¼ŒåŒ…æ‹¬ Chromeï¼ŒSafariï¼ŒFirefox ç­‰ä¸»æµç•Œé¢å¼æµè§ˆå™¨ï¼Œå¦‚æžœä½ åœ¨è¿™äº›æµè§ˆå™¨é‡Œé¢å®‰è£…ä¸€ä¸ª Selenium çš„æ’ä»¶ï¼Œè¿˜å¯ä»¥é€šè¿‡å½•åˆ¶ï¼Œå¿«é€Ÿç”Ÿæˆè„šæœ¬ã€‚ selenium æ”¯æŒå¤šç§ä¸»æµçš„å¼€å‘è¯­è¨€ï¼Œæ¯”å¦‚Rubyï¼Œjavaï¼Œpythonï¼Œjavascriptã€‚ çŽ¯å¢ƒæ­å»ºpython3.7.3 è¿è¡Œ pip install selenium å°±å¯ä»¥ç›´æŽ¥ä¸‹è½½æœ€æ–°çš„seleniumç‰ˆæœ¬ å‡†å¤‡æµè§ˆå™¨:chrome 70.0.3538.77 æ“ä½œç³»ç»Ÿï¼šwin7 seleniumç‰ˆæœ¬: 3.14.1 chromedriver: https://npm.taobao.org/mirrors/chromedriver/70.0.3538.97/ ä½¿ç”¨selenium æ‰“å¼€å’Œå…³é—­æµè§ˆå™¨1234from selenium import webdriverdriver = webdriver.Chrome()driver.get("http://www.iqiyi.com/")driver.quit() å®šä½æœç´¢æ¡†12search_xpath=r"//*[@id='nav_searchboxIn']/input"driver.find_element_by_xpath(search_xpath).send_keys("å¤ä»‡è€…è”ç›Ÿ") ç‚¹å‡»æœç´¢å›¾ç‰‡12search_button=r"//*[@id='nav_searchboxOut']/span"driver.find_element_by_xpath(search_button).click() åˆ‡æ¢tabé¡µ123456789101112131415#å¯¼å…¥é”®ç›˜æ“ä½œ--20190528æ›´æ–°from selenium.webdriver.common.keys import Keys#æ­¤å¤„é€šè¿‡é”®ç›˜æ“ä½œåˆ‡æ¢tabé¡µdriver.find_element_by_tag_name("body").send_keys(Keys.CONTROL + "t")#all_handles ä¿å­˜æ‰€æœ‰å·²ç»æ‰“å¼€çš„tabçª—ä½“all_handles = driver.window_handlesprint(driver.window_handles)index_handle=driver.current_window_handleprint(index_handle)#ç”¨switch_toæ–¹æ³•åˆ‡æ¢åˆ°tabçª—ä½“for handle in all_handles: if handle!=index_handle: print('now is search window') search_handle = handledriver.switch_to.window(search_handle) æ‰“å°é¡µé¢çš„titleï¼Œå¹¶æˆªå›¾12print(driver.title)driver.get_screenshot_as_file("aqiyi.png") æ€»ç»“æœ¬æ–‡ä¸»è¦ä»‹ç»äº†è‡ªåŠ¨åŒ–å·¥å…·seleniumçš„åŸºæœ¬ä½¿ç”¨ï¼Œå¦‚ä½•å¯¹é¡µé¢å…ƒç´ è¿›è¡ŒåŸºæœ¬æ“ä½œï¼Œå®žçŽ°è‡ªåŠ¨æŠ“å–å…³é”®å­—å›¾ç‰‡åŠŸèƒ½ã€‚]]></content>
      <categories>
        <category>è‡ªåŠ¨åŒ–æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>selenium</tag>
        <tag>web test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F05%2F28%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
  <entry>
    <title><![CDATA[copy maven dependencies to a folder]]></title>
    <url>%2F2016%2F09%2F30%2Fcopy-maven-dependencies-to-a-folder%2F</url>
    <content type="text"><![CDATA[copy maven dependencies to a folderbackgroundä¸€ä¸ªç®€å•çš„éœ€æ±‚,å½“ä½ çš„åŒäº‹éœ€è¦è°ƒè¯•ä»£ç çš„æ—¶å€™,ä»–å¹¶ä¸æƒ³å»ºç«‹mavençŽ¯å¢ƒ,è¿™æ—¶å€™ä¾èµ–çš„jaråŒ… è¯¥å¦‚ä½•å¯¼å‡ºå‘¢? no code say nothingè¿™æ—¶å€™ä½ éœ€è¦çš„æ˜¯maven-dependency-pluginã€‚ æ·»åŠ ä¾èµ–é…ç½®123456789101112131415161718192021222324252627282930313233&lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.eclipse.m2e&lt;/groupId&gt; &lt;artifactId&gt;lifecycle-mapping&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;configuration&gt; &lt;lifecycleMappingMetadata&gt; &lt;pluginExecutions&gt; &lt;!-- copy-dependency plugin --&gt; &lt;pluginExecution&gt; &lt;pluginExecutionFilter&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt; &lt;versionRange&gt;[1.0.0,)&lt;/versionRange&gt; &lt;goals&gt; &lt;goal&gt;copy-dependencies&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;outputDirectory&gt;$&#123;project.build.directory&#125;/alternateLocation&lt;/outputDirectory&gt; &lt;overWriteReleases&gt;false&lt;/overWriteReleases&gt; &lt;overWriteSnapshots&gt;false&lt;/overWriteSnapshots&gt; &lt;overWriteIfNewer&gt;true&lt;/overWriteIfNewer&gt; &lt;/configuration&gt; &lt;/pluginExecutionFilter&gt; &lt;action&gt; &lt;ignore /&gt; &lt;/action&gt; &lt;/pluginExecution&gt; &lt;/pluginExecutions&gt; &lt;/lifecycleMappingMetadata&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; æ­¤å¤„çš„&lt;outputDirectory&gt; æŒ‡å®šäº†ä½ å¯¼å‡ºjaråŒ…çš„è·¯å¾„. æ‰§è¡Œå‘½ä»¤ mvn dependency:copy-dependenciesæŸ¥çœ‹é¡¹ç›®å¤šäº†ä¸€ä¸ª/alternateLocationç›®å½•,å¹¶ä¸”ä¾èµ–çš„jaråŒ…éƒ½ä¸‹è½½åˆ°è¿™ä¸ªç›®å½•ä¸‹äº†ã€‚]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how to use nginx on windows]]></title>
    <url>%2F2016%2F09%2F27%2Fhow-to-use-nginx-on-windows%2F</url>
    <content type="text"><![CDATA[how to use nginx on windows1. Download nginx lastest release from here.2. unzip to your local driver. eg: c:/apps/nginx3. start nginx12cd c:/apps/nginxstart nginx 4. monitoring nginx process12345tasklist /fi &quot;imagename eq nginx.exe&quot;Image Name PID Session Name Session# Mem Usage========================= ======== ================ =========== ============nginx.exe 11700 Console 1 10,696 Knginx.exe 1160 Console 1 11,180 K noticeä¸€ä¸ªæ˜¯ä¸»è¿›ç¨‹(main process),å¦ä¸€ä¸ªæ˜¯å·¥ä½œè¿›ç¨‹(work process).å¦‚æžœå¯åŠ¨å¤±è´¥,è¯·æŸ¥çœ‹é”™è¯¯æ—¥å¿—logs\error.log 5. visit http://localhost:80806. configuration file nginx.confreference config123456789101112131415161718error_log logs/error.log;http &#123; include mime.types; default_type application/octet-stream; server &#123; listen 8080; server_name localhost; location / &#123; root html; index index.html index.htm; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root html; &#125; &#125; ...&#125; 7. the command list of nginxï¼š1234nginx -s stop å¿«é€Ÿé€€å‡ºnginx -s quit ä¼˜é›…é€€å‡ºnginx -s reload æ›´æ¢é…ç½®ï¼Œå¯åŠ¨æ–°çš„å·¥ä½œè¿›ç¨‹ï¼Œä¼˜é›…çš„å…³é—­ä»¥å¾€çš„å·¥ä½œè¿›ç¨‹nginx -s reopen é‡æ–°æ‰“å¼€æ—¥å¿—æ–‡ä»¶]]></content>
      <categories>
        <category>nginx</category>
      </categories>
      <tags>
        <tag>nginx</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how git changing author info]]></title>
    <url>%2F2016%2F09%2F22%2Fhow-git-changing-author-info%2F</url>
    <content type="text"><![CDATA[how git changing author infoèƒŒæ™¯ gitlabä¸­çš„ç»Ÿè®¡è§†å›¾æ˜¯æ ¹æ®ç”¨æˆ·çš„ä¿¡æ¯ç»Ÿè®¡å·¥ä½œé‡ è¿ç§»git repoä¸­ç»å¸¸ä¼šé‡åˆ°ç”¨æˆ·å’Œé‚®ç®±ä¸ä¸€è‡´çš„æƒ…å†µ è§£å†³æ€è·¯é‚£ä¹ˆå¦‚ä½•ä¿®æ”¹å·²ç»æŽ¨é€åˆ°è¿œç¨‹çš„authorä¿¡æ¯å‘¢? github å®˜æ–¹æä¾›çš„å»ºè®®å¦‚ä½•å˜æ›´ç”¨æˆ·ä¿¡æ¯ åŒæ—¶ä¹Ÿæœ‰ç±»ä¼¼çš„é¡¹æ‰˜ç®¡åœ¨githubä¸Šï¼Œgit-tips-blame-someone-else æ€è·¯åŸºæœ¬ä¸€è‡´,å°±æ˜¯æ›¿æ¢æäº¤è®°å½•ã€åˆ†æ”¯ã€æ ‡ç­¾é‡Œçš„authorä¿¡æ¯ã€‚ æ–¹æ¡ˆ1.æ‰“å¼€ç»ˆç«¯æˆ–å‘½ä»¤è¡Œ(git bash)2.åˆ›å»ºä¸€ä¸ªä½ é¡¹ç›®çš„å…¨æ–°è£¸åº“12git clone --bare https://github.com/user/repo.gitcd repo.git 3.å¤åˆ¶ç²˜è´´è„šæœ¬,å¹¶æ ¹æ®ä½ çš„ä¿¡æ¯ä¿®æ”¹ä¸‹é¢çš„å˜é‡:123OLD_EMAILCORRECT_NAMECORRECT_EMAIL è„šæœ¬replace.sh12345678910111213141516171819#!/bin/shgit filter-branch --env-filter &apos;OLD_EMAIL=&quot;your-old-email@example.com&quot;CORRECT_NAME=&quot;Your Correct Name&quot;CORRECT_EMAIL=&quot;your-correct-email@example.com&quot;if [ &quot;$GIT_COMMITTER_EMAIL&quot; = &quot;$OLD_EMAIL&quot; ]then export GIT_COMMITTER_NAME=&quot;$CORRECT_NAME&quot; export GIT_COMMITTER_EMAIL=&quot;$CORRECT_EMAIL&quot;fiif [ &quot;$GIT_AUTHOR_EMAIL&quot; = &quot;$OLD_EMAIL&quot; ]then export GIT_AUTHOR_NAME=&quot;$CORRECT_NAME&quot; export GIT_AUTHOR_EMAIL=&quot;$CORRECT_EMAIL&quot;fi&apos; --tag-name-filter cat -- --branches --tags 4.æ‰§è¡Œè¿™ä¸ªè„šæœ¬sh replace.sh 5.å¯Ÿçœ‹GitåŽ†å²æœ‰æ²¡æœ‰é”™è¯¯git log 6.å¼ºåˆ¶æŽ¨é€åˆ°è¿œç¨‹git push --force --tags origin &#39;refs/heads/*&#39; 7.æ¸…é™¤repo.gitä»“åº“12cd ..rm -rf repo.git]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how to understand git detached HEAD]]></title>
    <url>%2F2016%2F08%2F08%2Fhow-to-understand-git-detached-HEAD%2F</url>
    <content type="text"><![CDATA[åœºæ™¯è¿œç¨‹æœ‰ä¸€ä¸ªdevelopåˆ†æ”¯ï¼Œæˆ‘æƒ³èŽ·å–åˆ°æœ¬åœ°,ä½†æ˜¯cloneè¯¥é¡¹ç›®çš„æ—¶å€™è¿™ä¸ªè¿œç¨‹åˆ†æ”¯è¿˜æ²¡æœ‰åˆ›å»º,äºŽæ˜¯æ‰§è¡Œ git checkout commit_id(develop) æç¤ºå¦‚ä¸‹ 1234567891011121314$ git checkout f7c774bChecking out files: 100% (357/357), done.Note: checking out &apos;f7c774b&apos;.You are in &apos;detached HEAD&apos; state. You can look around, make experimentalchanges and commit them, and you can discard any commits you make in thisstate without impacting any branches by performing another checkout.If you want to create a new branch to retain commits you create, you maydo so (now or later) by using -b with the checkout command again. Example: git checkout -b new_branch_nameHEAD is now at f7c774b... update jeffsui.github.io å‡ºçŽ° detached from ...æ­¤æ—¶ç”¨git branch -avå¯Ÿçœ‹åˆ†æ”¯1234567$ git branch -av* (detached from f7c774b) f7c774b update jeffsui.github.io master 6ce1857 Site updated: 2016-08-07 22:09:10 remotes/origin/HEAD -&gt; origin/master remotes/origin/develop f7c774b update jeffsui.github.io remotes/origin/gh-pages 1eee93f Site updated: 2016-02-13 21:03:46 remotes/origin/master 6ce1857 Site updated: 2016-08-07 22:09:10 æ‰€è°“çš„ detached HEAD å…¶å®žå°±æ˜¯HEADæŒ‡å‘çš„æ˜¯ä¸€ä¸ªcommitè€Œä¸æŒ‡å‘ä»»ä½•ä¸€ä¸ªbranchçš„ä¸´æ—¶åˆ†æ”¯,ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ¸¸ç¦». ä¼—æ‰€å‘¨çŸ¥,æ¯ä¸€ä¸ªåˆ†æ”¯éƒ½å¯¹åº”äº†ä¸€ä¸ªcommit,git checkoutå…¶å®žå°±æ˜¯ä¿®æ”¹HEADæ–‡ä»¶å†…å®¹,è®©å®ƒæŒ‡å‘ä¸åŒçš„åˆ†æ”¯. å¦‚ä½•è®©detached HEADæ‰€å¤„åˆ†æ”¯æŒ‡å‘è¿œç¨‹åˆ†æ”¯æ­¤æ—¶çš„åˆ†æ”¯ä½ å¯ä»¥æ‰§è¡Œcommitæ“ä½œ,ä½†æ˜¯æ— æ³•pushåˆ°è¿œç¨‹åˆ†æ”¯ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æŠŠæ¸¸ç¦»çŠ¶æ€çš„åˆ†æ”¯æŒ‡å‘æˆ‘ä»¬æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å‘¢ã€‚123$ git fetch origin develop:developFrom https://github.com/jeffsui/jeffsui.github.io * [new branch] develop -&gt; develop ç»§ç»­æ‰§è¡Œgit branch -av å‘½ä»¤æŸ¥çœ‹åˆ†æ”¯ 12345678$ git branch -av* (detached from f7c774b) f7c774b update jeffsui.github.io develop f7c774b update jeffsui.github.io master 6ce1857 Site updated: 2016-08-07 22:09:10 remotes/origin/HEAD -&gt; origin/master remotes/origin/develop f7c774b update jeffsui.github.io remotes/origin/gh-pages 1eee93f Site updated: 2016-02-13 21:03:46 remotes/origin/master 6ce1857 Site updated: 2016-08-07 22:09:10 æ­¤æ—¶æˆ‘ä»¬å‘çŽ°å¤šäº†ä¸€ä¸ªdevelopåˆ†æ”¯æŒ‡å‘äº†è¿œç¨‹develop åˆ†æ”¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å‘½ä»¤git push origin develop:developåˆ°è¿œç¨‹åˆ†æ”¯äº†ã€‚ æ›´ç®€æ´çš„æ–¹æ³•git fetch origin develop:develop or git checkount -b origin develop:develop è¿™æ ·å¯ä»¥ç›´æŽ¥èŽ·å–è¿œç¨‹åˆ†æ”¯å¹¶åˆ›å»ºä¸€ä¸ªæœ¬åœ°åˆ†æ”¯ã€‚]]></content>
      <tags>
        <tag>git</tag>
        <tag>ç‰ˆæœ¬ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[my-angle]]></title>
    <url>%2F2016%2F02%2F15%2Fmy-angle%2F</url>
    <content type="text"><![CDATA[]]></content>
      <tags>
        <tag>photo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[windows-mongodb-install]]></title>
    <url>%2F2016%2F02%2F13%2Fwindows-mongodb-install%2F</url>
    <content type="text"><![CDATA[#windowsä¸‹mongodbå®‰è£… ##ä¸‹è½½mongodb http://www.mongodb.org/downloads ##é€‰æ‹©è‡ªå®šä¹‰å®‰è£… æœ¬æœºè·¯å¾„ä¸º:d:\tools\mongodb ##å»ºç«‹å¦‚ä¸‹æ–‡ä»¶ç›®å½•æ•°æ®åº“è·¯å¾„:d:\tools\mongodb\dbæ—¥å¿—è·¯å¾„:d:\tools\mongodb\logé…ç½®æ–‡ä»¶ç›®å½•d:\tools\mongodb\etcå»ºç«‹é…ç½®æ–‡ä»¶d:\tools\mongodb\etc\mongodb.conf 123456dbpath=d:\tools\mongodb\db #æ•°æ®åº“è·¯å¾„logpath=d:\tools\mongodb\log\mongodb.log #æ—¥å¿—è¾“å‡ºæ–‡ä»¶è·¯å¾„logappend=true #é”™è¯¯æ—¥å¿—é‡‡ç”¨è¿½åŠ æ¨¡å¼ï¼Œé…ç½®è¿™ä¸ªé€‰é¡¹åŽmongodbçš„æ—¥å¿—ä¼šè¿½åŠ åˆ°çŽ°æœ‰çš„æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä»Žæ–°åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶journal=true #å¯ç”¨æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤å¯ç”¨quiet=true #è¿™ä¸ªé€‰é¡¹å¯ä»¥è¿‡æ»¤æŽ‰ä¸€äº›æ— ç”¨çš„æ—¥å¿—ä¿¡æ¯ï¼Œè‹¥éœ€è¦è°ƒè¯•ä½¿ç”¨è¯·è®¾ç½®ä¸ºfalseport=27017 #ç«¯å£å· é»˜è®¤ä¸º27017 ##å¯åŠ¨æœåŠ¡ åˆ‡æ¢åˆ°d:\tools\mongodb\bin ç›®å½•ä¸‹: æ™®é€šå¯åŠ¨ mongod --config d:\tools\mongodb\etc\mongodb.conf æ³¨å†Œä¸ºwindowsæœåŠ¡ mongod --config d:\tools\mongodb\etc\mongodb.conf --install è¡¥å…… windowsæœåŠ¡å¸è½½ mongod --remove --serviceName &quot;MongoDB&quot; å¯åŠ¨æœåŠ¡net start mongodb å¯åŠ¨æˆåŠŸåŽ,é€šè¿‡æµè§ˆå™¨è®¿é—® http://localhost:27017 ,çœ‹åˆ°ä¸‹é¢çš„æ–‡å­—,è¯æ˜Žå¯åŠ¨æœåŠ¡æˆåŠŸï¼ It looks like you are trying to access MongoDB over HTTP on the native driver port. å…³é—­æœåŠ¡net stop mongodb #å›¾å½¢åŒ–å·¥å…· å®˜æ–¹æä¾›çš„å¾ˆå…¨:https://docs.mongodb.org/ecosystem/tools/administration-interfaces/ mongo express â€“Nodejs MongoBooster UMongo MongoHub MongoVUE â€“.NET]]></content>
      <categories>
        <category>db</category>
      </categories>
      <tags>
        <tag>windows</tag>
        <tag>mongodb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[maven3-jdk1.7-problem-fixed]]></title>
    <url>%2F2016%2F02%2F13%2Fmaven3-jdk1-7-problem-fixed%2F</url>
    <content type="text"><![CDATA[#maven3ä¸‹jdk1.7ç¼–è¯‘é”™è¯¯è§£å†³ #çŽ¯å¢ƒ12345678Apache Maven 3.3.3 (7994120775791599e205a5524ec3e0dfe41d4a06; 2015-04-22T19:57:37+08:00)Maven home: d:\tools\apache-maven-3.3.3Java version: 1.7.0_45, vendor: Oracle CorporationJava home: c:\Program Files\Java\jdk1.7.0_45\jreDefault locale: zh_CN, platform encoding: GBKOS name: &quot;windows 7&quot;, version: &quot;6.1&quot;, arch: &quot;amd64&quot;, family: &quot;windows&quot; #ä½¿ç”¨mavenå‘½ä»¤è¡Œåˆ›å»ºjavaé¡¹ç›®1mvn archetype:generate -DgroupId=org.linfeng -DartifactId=mavendemo -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false åˆ›å»ºæˆåŠŸ 12$ cd mavendemo &amp;&amp; lspom.xml src pom.xml 123456789101112131415161718&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.linfeng&lt;/groupId&gt; &lt;artifactId&gt;mavendemo&lt;/artifactId&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;name&gt;mavendemo&lt;/name&gt; &lt;url&gt;http://maven.apache.org&lt;/url&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; æ‰§è¡Œmavenå‘½ä»¤ mvn test é”™è¯¯ä¿¡æ¯ 12[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.1:compile (default-compile) on project mavendemo: Compilation failure[ERROR] No compiler is provided in this environment. Perhaps you are running on a JRE rather than a JDK? #è§£å†³æ–¹æ¡ˆ ä¿®æ”¹settings.xml,æ·»åŠ jdk1.7ç›¸å…³å†…å®¹ 123456789101112&lt;profile&gt; &lt;id&gt;jdk-1.7&lt;/id&gt; &lt;activation&gt; &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;jdk&gt;1.7&lt;/jdk&gt; &lt;/activation&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;1.7&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.7&lt;/maven.compiler.target&gt; &lt;maven.compiler.compilerVersion&gt;1.7&lt;/maven.compiler.compilerVersion&gt; &lt;/properties&gt;&lt;/profile&gt; ç¼ºç‚¹:ä¿®æ”¹æ‰€æœ‰é¡¹ç›®çš„jreçŽ¯å¢ƒ ä¿®æ”¹å½“å‰é¡¹ç›®çš„pom.xml 12345678910111213&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.1&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.7&lt;/source&gt; &lt;target&gt;1.7&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; é‡æ–°æ‰§è¡Œmvn build æˆåŠŸï¼ #é—®é¢˜åˆ†æžMavenå®˜æ–¹æ–‡æ¡£æœ‰å¦‚ä¸‹æè¿°ï¼š ç¼–è¯‘å™¨æ’ä»¶ç”¨æ¥ç¼–è¯‘é¡¹ç›®çš„æºæ–‡ä»¶.ä»Ž3.0ç‰ˆæœ¬å¼€å§‹, ç”¨æ¥ç¼–è¯‘Javaæºæ–‡ä»¶çš„é»˜è®¤ç¼–è¯‘å™¨æ˜¯javax.tools.JavaCompiler (å¦‚æžœä½ æ˜¯ç”¨çš„æ˜¯java 1.6) . å¦‚æžœä½ æƒ³å¼ºåˆ¶æ€§çš„è®©æ’ä»¶ä½¿ç”¨javac,ä½ å¿…é¡»é…ç½®æ’ä»¶é€‰é¡¹ forceJavacCompilerUse.åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ç›®å‰sourceé€‰é¡¹å’Œtarget é€‰é¡¹çš„é»˜è®¤è®¾ç½®éƒ½æ˜¯1.5, ä¸Žè¿è¡ŒMavenæ—¶çš„JDKç‰ˆæœ¬æ— å…³.å¦‚æžœä½ æƒ³è¦æ”¹å˜è¿™äº›é»˜è®¤è®¾ç½®, å¯ä»¥å‚è€ƒ Setting the -source and -target of the Java Compilerä¸­çš„æè¿°æ¥è®¾ç½® source å’Œtarget é€‰é¡¹. #å‚è€ƒèµ„æ–™ http://stackoverflow.com/questions/15220392/maven-package-compilation-error http://www.cnblogs.com/leo100w/p/4017647.html]]></content>
      <categories>
        <category>ci</category>
      </categories>
      <tags>
        <tag>maven</tag>
        <tag>jdk</tag>
        <tag>æŒç»­é›†æˆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how make cygwin multi-color]]></title>
    <url>%2F2015%2F08%2F12%2Fhow-make-cygwin-multi-color%2F</url>
    <content type="text"><![CDATA[æ‰“å¼€.bashrc 123456789101112131415161718# Default to human readable figures# alias df=&apos;df -h&apos;# alias du=&apos;du -h&apos;## Misc # alias less=&apos;less -r&apos; # raw control characters# alias whence=&apos;type -a&apos; # where, of a sort# alias grep=&apos;grep --color&apos; # show differences in colour# alias egrep=&apos;egrep --color=auto&apos; # show differences in colour# alias fgrep=&apos;fgrep --color=auto&apos; # show differences in colour## Some shortcuts for different directory listings# alias ls=&apos;ls -hF --color=tty&apos; # classify files in colour# alias dir=&apos;ls --color=auto --format=vertical&apos;# alias vdir=&apos;ls --color=auto --format=long&apos;# alias ll=&apos;ls -l&apos; # long list# alias la=&apos;ls -A&apos; # all but . and ..# alias l=&apos;ls -CF&apos; # è€Œæˆ‘ä»¬è¦åšçš„åªæ˜¯åŽ»æŽ‰#ï¼Œå¯åŠ¨å³å¯ï¼š 123456789101112131415161718# Default to human readable figuresalias df=&apos;df -h&apos;alias du=&apos;du -h&apos;## Misc alias less=&apos;less -r&apos; # raw control charactersalias whence=&apos;type -a&apos; # where, of a sortalias grep=&apos;grep --color&apos; # show differences in colouralias egrep=&apos;egrep --color=auto&apos; # show differences in colouralias fgrep=&apos;fgrep --color=auto&apos; # show differences in colour## Some shortcuts for different directory listingsalias ls=&apos;ls -hF --color=tty&apos; # classify files in colouralias dir=&apos;ls --color=auto --format=vertical&apos;alias vdir=&apos;ls --color=auto --format=long&apos;alias ll=&apos;ls -l&apos; # long listalias la=&apos;ls -A&apos; # all but . and ..alias l=&apos;ls -CF&apos; # ç„¶åŽä¿å­˜ä¸€ä¸‹ï¼Œå†é‡å¯cygwinï¼ˆæˆ–è€…ç›´æŽ¥ç”¨ï¼šsource ~/.bashrc]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>cygwin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how to build a private docker registry]]></title>
    <url>%2F2015%2F07%2F21%2Fhow-to-build-a-private-docker-registry%2F</url>
    <content type="text"><![CDATA[å¦‚ä½•æ­å»ºdockerç§æœ##çŽ¯å¢ƒå‡†å¤‡ è½¯ä»¶åŒ…ï¼š centos6.5_x86_64 docker-engine-1.7.0-1.el6.x86_64.rpm dockerçŽ¯å¢ƒæ­å»º,è¯·å‚ç…§å®˜æ–¹è¯´æ˜Žï¼Œæœ¬æ–‡é‡‡ç”¨çš„æ˜¯å®˜æ–¹çš„rpmåŒ… ##ä½•è°“ç§æœ å®˜æ–¹çš„imageé•œåƒç«™ä½dockerhub,å› ä¸ºä¼Ÿå¤§çš„å¢™çš„ç¼˜æ•…,æ‰€ä»¥ä¸‹è½½é•œåƒæ˜¯å¾ˆç—›è‹¦çš„ä¸€ä»¶äº‹ã€‚å½“ç„¶ä½ å¯ä»¥é‡‡ç”¨å…¶ä»–ç§‘å­¦ä¸Šç½‘æˆ–è€…é•œåƒåŠ é€Ÿçš„æ–¹æ³•æ¥èŽ·å–imageã€‚dockerå®˜æ–¹ä¹Ÿæä¾›äº†ä¸€ä¸ªç§æœé•œåƒ,å¤§å®¶å¯ä»¥é€šè¿‡docker search registryæ¥æŸ¥æ‰¾è¯¥é•œåƒã€‚ 12345NAME DESCRIPTION STARS OFFICIAL AUTOMATEDregistry Containerized docker registry 320 [OK] atcol/docker-registry-ui A web UI for easy private/local Docker Reg... 55 [OK]konradkleine/docker-registry-frontend Browse and modify your Docker registry in ... 40 [OK]samalba/docker-registry 35 ##ä¸‹è½½å®˜æ–¹registryé•œåƒ ä¸‹è½½é•œåƒ ä½¿ç”¨å‘½ä»¤docker pull registryæ‰§è¡Œä¸‹è½½é•œåƒã€‚ æŸ¥çœ‹é•œåƒ ä¸‹è½½å®Œæ¯•åŽ,é€šè¿‡docker images æŸ¥çœ‹è¯¥é•œåƒã€‚ ç»™é•œåƒæ‰“æ ‡ç­¾ æ‰§è¡Œè¿™ä¸ªå‘½ä»¤docker tag registry:latest localhost:5000/registry:latest ##å¯åŠ¨é•œåƒ docker run -d -e SETTINGS_FLAVOR=dev -e STORAGE_PATH=/tmp/registry -v /opt/data/registry:/tmp/registry -p 5000:5000 registry è¿™é‡Œæœ‰å‡ ä¸ªå‚æ•°è¯´æ˜Žä¸‹: 1.-e STORAGE_PATH=/tmp/registry :å¼ºåˆ¶ä½¿ç”¨å­˜å‚¨è·¯å¾„ 2.-v /opt/data/registry:/tmp/registry :ç»‘å®šæœ¬åœ°é•œåƒå­˜å‚¨è·¯å¾„ 3.-p 5000:5000:æ˜ å°„å®¹å™¨5000ç«¯å£åˆ°æœ¬åœ°5000ç«¯å£ ##æŸ¥çœ‹é•œåƒçŠ¶æ€ docker ps ##æŸ¥çœ‹ç§æœçŠ¶æ€ curl http://localhost:5000 æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯,è¯æ˜Žregistryå¯åŠ¨æˆåŠŸ: &quot;\&quot;docker-registry server\&quot;&quot; ##æŽ¨é€æœ¬åœ°é•œåƒåº“åˆ°registryç§æœ ###1. ç¬¬ä¸€æ­¥ ç»™æœ¬åœ°é•œåƒ æ‰“tagä¾‹å¦‚ç»™å®˜æ–¹çš„nginxé•œåƒæ‰“tag,æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤è¡Œdocker pull nginxdocker tag nginx:latest localhost:5000/nginx:latestæŸ¥çœ‹é•œåƒåº“,å‘çŽ°localhost:5000/nginxçš„é•œåƒå·²ç»æœ‰äº†ã€‚ ###2. ç¬¬äºŒæ­¥ æŽ¨é€tagåˆ°registryç§æœ docker push localhost:5000/nginx:latest ###3. ç¬¬ä¸‰æ­¥ æŸ¥çœ‹ç§æœé•œåƒåˆ—è¡¨ curl http://localhostï¼š5000/V1/search çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„ä¿¡æ¯ 12&#123;&quot;num_results&quot;: 5, &quot;query&quot;: &quot;&quot;, &quot;results&quot;: [&#123;&quot;description&quot;: null, &quot;name&quot;: &quot;correl/erlang&quot;&#125;, &#123;&quot;description&quot;: null, &quot;name&quot;: &quot;linfeng/cmd&quot;&#125;, &#123;&quot;description&quot;: null, &quot;name&quot;: &quot;library/my_nodejs_image&quot;&#125;, &#123;&quot;description&quot;: null, &quot;name&quot;: &quot;library/centos&quot;&#125;, &#123;&quot;description&quot;: &quot;&quot;, &quot;name&quot;: &quot;library/nginx&quot;&#125;]&#125; ##æ‹‰å–ç§æœé•œåƒ docker pull 192.168.20.85:5000/library/centos:7 ##ç»“è®º è¿™åªæ˜¯æ¼”ç¤ºå¦‚ä½•æ­å»ºä¸€ä¸ªç®€å•çš„registryç§æœã€‚å› ä¸ºåªæœ‰é€šè¿‡å‘½ä»¤è¡Œæ–¹å¼æ‰èƒ½æŸ¥çœ‹ç§æœä¿¡æ¯,æ‰€ä»¥ä¸æ˜¯å¾ˆä¾¿äºŽæ“ä½œã€‚ä¸‹é¢çš„åšæ–‡å°†æ¼”ç¤ºå¦‚ä½•ç»™registryæ·»åŠ webç•Œé¢ã€‚]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>registry</tag>
        <tag>registry-ui</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how git version rollback]]></title>
    <url>%2F2015%2F05%2F16%2Fhow-git-version-rollback%2F</url>
    <content type="text"><![CDATA[å¦‚ä½•è¿›è¡Œè¿œç¨‹ç‰ˆæœ¬å›žé€€â€¦â€¦ #å¼•è¨€ ä¸€åˆ‡éƒ½è¦ä»Žä¸€ä¸ªè›‹ç–¼çš„éœ€æ±‚å¼€å§‹,è€æ¿è¯´,èƒ½ç»™è¿œç¨‹ä»“åº“çš„ç‰ˆæœ¬å›žé€€å—ï¼Ÿæˆ‘è¯´ä¸ºæ¯›ï¼Ÿä»–è¯´æˆ‘å°±æ˜¯è¯•è¯•çœ‹gitå¥½ä½¿ä¸,æˆ‘â€¦â€¦ #å’‹æž èƒŒæ™¯ gitcafe å›½å†…çŸ¥åçš„æºç æ‰˜ç®¡å¹³å° åˆ†æž 12345678910111213141ã€git checkout the_branch2ã€git pull3ã€git branch the_branch_backup //å¤‡ä»½ä¸€ä¸‹è¿™ä¸ªåˆ†æ”¯å½“å‰çš„æƒ…å†µ4ã€git reset --hard the_commit_id //æŠŠthe_branchæœ¬åœ°å›žæ»šåˆ°the_commit_id5ã€git push origin :the_branch //åˆ é™¤è¿œç¨‹ the_branch6ã€git push origin the_branch //ç”¨å›žæ»šåŽçš„æœ¬åœ°åˆ†æ”¯é‡æ–°å»ºç«‹è¿œç¨‹åˆ†æ”¯7ã€git push origin :the_branch_backup //å¦‚æžœå‰é¢éƒ½æˆåŠŸäº†ï¼Œåˆ é™¤è¿™ä¸ªå¤‡ä»½åˆ†æ”¯ åˆ é™¤è¿œç¨‹åˆ†æ”¯ é¦–å…ˆ,ä»»ä½•ä¸€ä¸ªgitæºç æ‰˜ç®¡å¹³å°éƒ½ä¼šå‘Šè¯‰ä½ ,åˆ«åˆ é™¤è¿œç¨‹masteråˆ†æ”¯,å› ä¸ºå®ƒæ˜¯é»˜è®¤çš„åˆ†æ”¯â€¦â€¦,è¯·ç§»æ­¥è¿™é‡Œ æ“ä½œæ­¥éª¤ å¦‚æžœè¿œç¨‹åªæœ‰ä¸€ä¸ªmasteråˆ†æ”¯,è¯·ä½ åˆ›å»ºä¸€ä¸ªéžmasteråˆ†æ”¯,ç„¶åŽæŽ¨é€åˆ°è¿œç¨‹ã€‚æœ‰äººä¼šé—®æˆ‘ä¸ºä»€ä¹ˆï¼Ÿæ‰“ä¸ªæ¯”æ–¹,ä½ è§è¿‡ä¸Šæ—±åŽ•çš„æ—¶å€™,ç»™è‡ªå·±è„šä¸‹ç«™ç€çš„æ¿å­æŠ½èµ°å—ï¼Ÿ è„šæœ¬ç±»ä¼¼ä¸‹é¢è¿™æ · 1234git branch the_master_backupgit push origin the_master_backup æ­¤æ—¶ä½ æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯åº”è¯¥æœ‰ä¸¤ä¸ª:masterå’Œthe_master_backup è®¾ç½®é»˜è®¤çš„åˆ†æ”¯ä¸º the_master_backup 1234git branch -D branch_name //åˆ é™¤æœ¬åœ°masteråˆ†æ”¯git push :master //æŽ¨é€ä¸€ä¸ªç©ºåˆ†æ”¯,ç›¸å½“äºŽåˆ é™¤è¿œç¨‹masteråˆ†æ”¯ ç„¶åŽä½ åœ¨the_master_backupåˆ†æ”¯ä¸Š å›žæ»šåˆ°ä½ è¦å›žæ»šçš„commit_id,ç„¶åŽé‡å»ºmasteråˆ†æ”¯å¹¶æŽ¨é€åˆ°è¿œç¨‹,é¡ºä¾¿åˆ é™¤the_master_backupåˆ†æ”¯(åŒ…æ‹¬è¿œç¨‹the_master_backupåˆ†æ”¯)ã€‚ 123456789101112git checkout the_master_backupgit reset --hard commit_idgit branch master //é‡æ–°åˆ›å»ºmasteråˆ†æ”¯git push origin master //é‡æ–°æŽ¨é€masteråˆ†æ”¯git branch -D the_master_backup //åˆ é™¤æœ¬åœ°the_master_backupåˆ†æ”¯git push origin :the_master_backup//åˆ é™¤è¿œç¨‹the_master_backupåˆ†æ”¯ #é‡åˆ°çš„é—®é¢˜ å¿˜è®°è®¾ç½®é»˜è®¤åˆ†æ”¯ä¸ºéžmasteråˆ†æ”¯ 1234567891011121314remote: error: By default, deleting the current branch is denied, because the nextremote: error: &apos;git clone&apos; won&apos;t result in any file checked out, causing confusion.remote: error:remote: error: You can set &apos;receive.denyDeleteCurrent&apos; configuration variable toremote: error: &apos;warn&apos; or &apos;ignore&apos; in the remote repository to allow deleting theremote: error: current branch, with or without a warning message.remote: error:remote: error: To squelch this message, you can set it to &apos;refuse&apos;.... #æ€»ç»“ å¦‚æžœä½ é‡åˆ°çš„æ˜¯æ‰€æœ‰æäº¤åªæœ‰masteråˆ†æ”¯,é‚£ä¹ˆå¸Œæœ›æˆ‘è¿™ä¸ªåšæ–‡èƒ½å¸®åˆ°ä½ ã€‚å½“ç„¶gitå¼ºå¤§çš„åˆ†æ”¯åŠŸèƒ½ä½ åŸºæœ¬ä¹Ÿç”¨ä¸åˆ°äº†ã€‚]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>gitcafe</tag>
        <tag>ç‰ˆæœ¬ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript oop 15 min programming]]></title>
    <url>%2F2015%2F04%2F23%2Fjavascript-oop-15-min-programming%2F</url>
    <content type="text"><![CDATA[#javascriptçš„é¢å‘å¯¹è±¡15åˆ†é’Ÿæ•™ç¨‹ ç¬¬ä¸€ç§é¢å‘å¯¹è±¡çš„å†™æ³•##åˆ›å»ºç©ºå¯¹è±¡ 12var bill =&#123;&#125;;//åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ ##ç»™å¯¹è±¡æ·»åŠ å±žæ€§å’Œæ–¹æ³• 12345bill.name = &quot;Bill Goat&quot;;bill.work = function ()&#123; console.log(&quot;programming....&quot;);&#125;; ##ä¸€æ­¥å®Œæˆä¸Šé¢çš„ä¸¤ä»¶äº‹ 1234567var bill =&#123; name : &quot;Bill Goat&quot;; work : function()&#123; console.log(&quot;programming....&quot;);&#125;&#125;; ##è®¿é—®å¯¹è±¡å’Œå±žæ€§ 123console.log(bill.name);bill.work(); ##æ–¹æ³•é‡å†™ 12345bill.name = &quot;Bill Goat&quot;;bill.work =function(who)&#123; console.log(&quot;programming for &quot;+who);&#125;; ##é€šè¿‡thiså…³é”®å­—è®¿é—®å†…éƒ¨å±žæ€§ 1234bill.say = function ()&#123; console.log(&quot;bill&apos;s name is&quot;+this.name);&#125;; ##å¯¹è±¡å¼•ç”¨123456var silly = bill;console.log(silly.name);sally.name = &quot;Silly&quot;;console.log(silly.name);console.log(bill.name); ##å¦ä¸€ä¸ªæ–¹å¼å¼•ç”¨1234567bill.name = &quot;Bill Goat&quot;;bill.say();var sayName = bill.say();sayName;sayName(); ##æœ‰æ„æ€çš„åœ°æ–¹ ï¼šå…¨å±€å±žæ€§123var name = &quot;Global&quot;;bill.say(); å‘çŽ°æ­¤æ—¶è¾“å‡ºçš„æ˜¯bill&#39;s name is Global å¦ä¸€ç§é¢å‘å¯¹è±¡çš„å†™æ³•##å®šä¹‰å¯¹è±¡åŠå±žæ€§ 12function Game()&#123;&#125;; ##åˆ›å»ºå¯¹è±¡ 1var DF = new Game(); ##å¯¹è±¡å±žæ€§ 1DF.title = &quot;æ˜Ÿé™…äº‰éœ¸2&quot;; ##æž„é€ æ–¹æ³• 12345678function Game (title)&#123; this.title = typeof title !== &apos;undifined&apos; ? title :&quot;&quot;;&#125;;var d3 = new Game(&quot;d3&quot;);d3.title;d3.title =&quot;starcraft2&quot;; this.title = typeof title !== &#39;undifined&#39; ? title :&quot;&quot;;ç›¸å½“äºŽ 123456if(typeof title !== &quot;undifined&quot;ï¼‰&#123; this.title = title;&#125;else&#123; this.title = &quot;&quot;;&#125; ##åˆ›å»ºä¸€ä¸ªæ–¹æ³•æ¥è®¿é—®è¿™ä¸ªå±žæ€§1234d3.loveTitle = function ()&#123; console.log(&quot;I love &quot;+this.title);&#125; ##æ›´å¥½çš„å†™æ³• 12345Game.prototype.heartIt = function ()&#123; console.log(&quot;I love &quot;+this.title);&#125;d3.heartIt(); ä¸‹æ¬¡è¯¦è§£javascriptçš„åŽŸç”Ÿå¯¹è±¡æ¨¡åž‹ to be continued~~~~]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>oop</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[talk about software engineering]]></title>
    <url>%2F2015%2F04%2F22%2Ftalk-about-software-engineering%2F</url>
    <content type="text"><![CDATA[#å…³äºŽè½¯ä»¶å·¥ç¨‹çš„è®¨è®ºâ€“è´¨é‡ç¯‡ é‚£ä¸ºä»€ä¹ˆè½¯ä»¶ç³»ç»Ÿçš„è´¨é‡ä¸å®¹æ˜“é«˜å‘¢ï¼Ÿæˆ‘è§‰å¾—ä¸»è¦åŽŸå› æ˜¯æµç¨‹ä¸å®Œå–„ã€‚é‚£ä¸ºä»€ä¹ˆä¸å®Œå–„ï¼Ÿéœ€æ±‚å®¹æ˜“å˜ã€‚ä¸ºä»€ä¹ˆå®¹æ˜“å˜ï¼Ÿæ˜¯å› ä¸ºä¸è®ºç¨‹åºå‘˜è‡ªå·±ï¼Œè¿˜æ˜¯éœ€æ±‚æ–¹ï¼Œå…¶å®žæ½œæ„è¯†éƒ½è®¤ä¸ºè‡ªå·±åšçš„ä¸œè¥¿æ˜¯å˜æ›´æˆæœ¬è¾ƒä½Žçš„ã€‚ è¯•æƒ³ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆæ²¡äººåœ¨ç›–é«˜æ¥¼ç›–ä¸€åŠå˜æ›´éœ€æ±‚ï¼Ÿä¸ºä»€ä¹ˆæ²¡äººä¿®å¤§æ¡¥ä¿®ä¸€åŠå˜æ›´éœ€æ±‚ï¼Ÿç”šè‡³åšè¡£æœåšä¸€åŠçš„æ—¶å€™å˜æ›´éœ€æ±‚ï¼Œç†å‘åˆ°ä¸€åŠå˜æ›´éœ€æ±‚ï¼Œéƒ½ä¼šè¢«äººè®¤ä¸ºæ˜¯ä¸è®²ç†ã€‚ä½†æ˜¯åœ¨è½¯ä»¶é¢†åŸŸï¼Œå¥½åƒè¿™å€’æˆäº†æ™®éçŽ°è±¡ã€‚ å› ä¸ºæ•´ä¸ªè½¯ä»¶ç³»ç»Ÿçš„å®žçŽ°ï¼Œéƒ½æ˜¯è™šæ‹Ÿçš„ï¼Œçœ‹ä¸è§æ‘¸ä¸ç€ï¼Œå¹¶ä¸æ¶ˆè€—ä»€ä¹ˆç‰©æ–™ï¼Œæ‰€ä»¥ä»Žè¿™ä¸ªè§’åº¦æƒ³ï¼Œå˜èµ·æ¥å½“ç„¶æ˜¯å®¹æ˜“çš„ã€‚ä½†è½¯ä»¶ç³»ç»Ÿçš„æž¶æž„ï¼Œå…¶å®žä¹Ÿè·Ÿå®žä½“çš„æ²¡æœ¬è´¨åŒºåˆ«ï¼Œå˜æ›´æ—¶å€™è¦è€ƒè™‘å¾ˆå¤šå…³è”å› ç´ ï¼Œå¹¶ä¸æ˜¯å°±é‚£ä¹ˆå­¤ç«‹çš„çœ‹ä¸€å°å—åœ°æ–¹ï¼Œå½“ç„¶ï¼Œä¹Ÿä¼šæœ‰ä¸€äº›ä¸å½±å“å…¨å±€çš„å˜æ›´ã€‚æ‰“ä¸ªæ¯”æ–¹è¯´ï¼Œå¦‚æžœä½ åœ¨ç›–æˆ¿å­ç›–åˆ°ä¸€åŠï¼Œé‚£å˜æ›´å¤–å¢™é¢œè‰²è‚¯å®šæ˜¯è¦æ¯”å˜æ›´çª—æˆ·å¤§å°å®¹æ˜“çš„ã€‚è¦æ˜¯æƒ³å˜å¾—å¤ªå¤šï¼Œä¼°è®¡åªå¥½æ‹†äº†é‡æ¥ã€‚ ä¸‹é¢çš„è®¨è®ºæ›´åŠ ç²¾å½©: A:å…¶å®žä¸æ˜¯æµç¨‹é—®é¢˜ï¼Œè€æ¿å’Œç”²æ–¹é—®é¢˜ A:ç”²æ–¹å°¤å…¶å…³é”® A:å°¼çŽ›ï¼Œè¦8å±‚æ¥¼æˆ¿ï¼Œä»˜2å±‚è´¹ç”¨ â€¦â€¦]]></content>
      <categories>
        <category>è½¯ä»¶å·¥ç¨‹</category>
      </categories>
      <tags>
        <tag>è½¯ä»¶å·¥ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascript asynchronous programming learning :event]]></title>
    <url>%2F2015%2F04%2F20%2Fjavascript-asynchronous-programming-learning-event%2F</url>
    <content type="text"><![CDATA[#javascriptå¼‚æ­¥ç¼–ç¨‹è¯»ä¹¦ç¬”è®°ä¹‹äº‹ä»¶æœºåˆ¶ ##äº‹ä»¶çš„è°ƒåº¦ å¼‚æ­¥æ‰§è¡Œ setTimeoutå‡½æ•°çš„è§£é‡Š:ç»™å®šä¸€ä¸ªå›žè°ƒåŠnæ¯«ç§’çš„å»¶è¿Ÿ,setTimeoutä¼šåœ¨næ¯«ç§’åŽè¿è¡Œè¯¥å›žè°ƒã€‚ ä»£ç æ¸…å•1:12345for (var i = 1; i &lt;= 3; i++) &#123; setTimeout(function()&#123; console.log(i); &#125;, 0);&#125;; è¾“å‡ºç»“æžœ: 123444 çº¿ç¨‹é˜»å¡žä»£ç æ¸…å•2: 123456var start = new Date;setTimeout(function()&#123;var end = new Date;console.log(&apos;Time elapsed:&apos;, end - start, &apos;ms&apos;);&#125;, 500);while (new Date - start &lt; 1000) &#123;&#125;; é˜Ÿåˆ— javascriptä½¿ç”¨é˜Ÿåˆ—çš„æ–¹å¼æ¥å¾ªçŽ¯å¤„ç†è¯·æ±‚,è¿™ç§æœºåˆ¶è¢«ç§°ä¸ºäº‹ä»¶å¾ªçŽ¯ã€‚]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>å¼‚æ­¥</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[use-shorturl and two-dimensional-barcodes to beautify blog]]></title>
    <url>%2F2015%2F04%2F20%2Fuse-shorturl-and-two-dimensional-barcodes-to-beautify-blog%2F</url>
    <content type="text"><![CDATA[#å¦‚ä½•ä½¿ç”¨çŸ­ç½‘å€å’ŒäºŒç»´ç ç®€åŒ–ç½‘ç«™è®¿é—® çŸ­ç½‘å€(shorturl) web2.0æ—¶ä»£çš„æ½®æµ,å€ŸåŠ©çŸ­ç½‘å€æ‚¨å¯ä»¥ç”¨ç®€çŸ­çš„ç½‘å€æ›¿ä»£åŽŸæ¥å†—é•¿çš„ç½‘å€ï¼Œè®©ä½¿ç”¨è€…å¯ä»¥æ›´å®¹æ˜“çš„åˆ†äº«é“¾æŽ¥ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ç™¾åº¦çš„çŸ­ç½‘å€æœåŠ¡:http://dwz.cn/ è®¿é—®http://dwz.cn/ä¸»é¡µ è¾“å…¥ä½ çš„åšå®¢åœ°å€æˆ‘è¾“å…¥http://jeffsui.github.io/pinghailinfeng_blog/ å¤åˆ¶çŸ­ç½‘å€ äºŒç»´ç (two-dimensional-barcodes)å¾®ä¿¡æ—¶ä»£,ä¸çŸ¥é“äºŒç»´ç çš„åŸºæœ¬éƒ½å±žäºŽå¤–æ˜Ÿçƒäººäº†ã€‚è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯è‰æ–™äºŒç»´ç :http://cli.im/ è¾“å…¥äºŒç»´ç åœ°å€ è¿›è¡Œä¸€äº›åŸºæœ¬è®¾ç½®åŒ…æ‹¬å‰æ™¯è‰²ã€èƒŒæ™¯è‰²ã€æ¸å˜è‰²ç­‰ç­‰ã€‚ åµŒå…¥å›¾ç‰‡ é€‰ç”¨ä½ å–œæ¬¢çš„æ¨¡æ¿ ä¿å­˜äºŒç»´ç  åœ¨çº¿å­˜å‚¨è¿™é‡Œæˆ‘é€‰æ‹©å›½å†…çŸ¥åçš„ä¸ƒç‰›äº‘å­˜å‚¨ã€‚ 4.åœ¨åšå®¢ä¸­å¼•ç”¨å›¾ç‰‡åœ°å€å°±å¯ä»¥äº†]]></content>
      <categories>
        <category>æ­å»ºåšå®¢</category>
      </categories>
      <tags>
        <tag>åšå®¢</tag>
        <tag>ç¾ŽåŒ–</tag>
        <tag>çŸ­ç½‘å€</tag>
        <tag>äºŒç»´ç </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æˆ‘çš„æ–°æ–‡ç« ]]></title>
    <url>%2F2015%2F04%2F17%2Fmy-new-post%2F</url>
    <content type="text"><![CDATA[#æˆ‘çš„æ–°æ–‡ç«  è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åœ¨githubä¸Šçš„åšå®¢ã€‚è®°å½•ä¸‹æˆ‘çš„å·¥ä½œå’Œç”Ÿæ´»,æ…¢æ…¢ç»™å…¶ä»–çš„æ–‡ç« éƒ½æ›´æ–°åˆ°è¿™é‡Œã€‚å¬‰ç¬‘æ€’éª‚ä¹Ÿå¥½,å–œæ€’å“€ä¹ä¹Ÿç½¢,æˆ‘å°±æ˜¯ä¸€ä¸ªä¿—äººç½¢äº†ã€‚]]></content>
      <tags>
        <tag>æ‚è®°</tag>
        <tag>åšå®¢</tag>
        <tag>æ–‡ç« </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[push-hexo-to-github]]></title>
    <url>%2F2015%2F04%2F17%2Fpush-hexo-to-github%2F</url>
    <content type="text"><![CDATA[#å¦‚ä½•ä½¿ç”¨hexoåœ¨githubä¸Šå»ºç«‹é™æ€åšå®¢ ##çŽ¯å¢ƒæ­å»º hexoçŽ¯å¢ƒæ­å»º è¯·å‚è€ƒ hexo.io å®˜æ–¹ç«™ç‚¹, å¼ºçƒˆå»ºè®®ç»™åŸºæœ¬æ“ä½œä¸‹çš„å†…å®¹å¿«é€Ÿæµè§ˆä¸€é,ä¸‹é¢çš„æ“ä½œæ˜¯æˆ‘ä¸€ä¸ªä¸€ä¸ªå‘½ä»¤æ•²å‡ºæ¥çš„,é‡åˆ°çš„å‘ä¹Ÿä¼šè®°å½•ä¸‹æ¥,å¸Œæœ›å¤§å®¶èƒ½å°‘èµ°å¼¯è·¯ã€‚ githubä¸Šå»ºç«‹é™æ€åšå®¢ githubè´¦å·ç”³è¯·ï¼ˆç•¥ï¼‰ å»ºç«‹ä¸€ä¸ªgithubé¡¹ç›® git clone é¡¹ç›®åœ°å€ åˆ°æœ¬åœ° é¡¹ç›®åˆå§‹åŒ–cd é¡¹ç›®åecho # hexo å®žä¾‹ç«™ç‚¹ &gt;&gt; README.mdgit initgit add README.mdgit commit -m â€œfirst bloodâ€git remote add origin é¡¹ç›®åœ°å€git push -u origin master githubå…è´¹ç«™ç‚¹å»ºç«‹è§„åˆ™,è¯·ä»”ç»†é˜…è¯»è¿™ä¸ªè§„åˆ™https://help.github.com/articles/user-organization-and-project-pages/ é»˜è®¤githubåŸŸå é»˜è®¤github åˆ†é…äº† ä¸€ä¸ªname.github.ioçš„åŸŸå,è¿˜æœ‰ä¸€ä¸ªname.github.io/project_nameçš„äºŒçº§åŸŸå,è¯·å‚ç…§githubçš„æç¤ºè®¾ç½®URLã€‚ åŽä¸½çš„åˆ†å‰²çº¿ ç«™ç‚¹é…ç½®æµç¨‹ å»ºç«‹ç«™ç‚¹æ–‡ä»¶å¤¹,å¹¶ç«™ç‚¹åˆå§‹åŒ– å®‰è£…hexoä¾èµ– ä¿®æ”¹node_module/hexo-server/index.js,ç”¨äºŽæœ¬åœ°è°ƒè¯• å®‰è£…hexo-git-deployeræ’ä»¶ ä¿®æ”¹å…¨å±€é…ç½®æ–‡ä»¶_config.yml,é…ç½®deploy# Site ç«™ç‚¹é…ç½®title: å‡­æµ·ä¸´é£Žçš„æµ‹è¯•æ±Ÿæ¹–subtitle:description: å‡­æµ·ä¸´é£Žçš„åšå®¢author: Jeff Suilanguage: zh-CNtimezone # URL ç«™ç‚¹é“¾æŽ¥## If your site is put in a subdirectory, set url as â€˜http://yoursite.com/child&#39; and root as â€˜/child/â€˜url: http://jeffsui.github.ioroot: /pinghailinfeng_blog/permalink: :year/:month/:day/:title/permalink_defaults: # Deployment## Docs: http://hexo.io/docs/deployment.htmldeploy:type: gitrepo: https://github.com/jeffsui/pinghailinfeng_blog.gitbranch : mastermessage : ä»¥ä¸Šé…ç½®ä»…ä¾›å‚è€ƒ åˆ›å»ºæ–‡ç«  æ‰§è¡Œhexo new å‘½ä»¤ ä¾‹å¦‚:hexo new post my-first-blog å°†ä¼šè‡ªåŠ¨åœ¨source/_postsä¸‹åˆ›å»ºä¸€ä¸ªmy-first-blog.mdçš„æ–‡ä»¶,ä½¿ç”¨çš„æ˜¯scaffoldsä¸‹çš„post.mdæ¨¡æ¿ ä¿®æ”¹å¹¶ä¿å­˜my-first-blog.mdæ–‡ä»¶ ç«™ç‚¹ç”Ÿæˆhexo g ç«™ç‚¹éƒ¨ç½² hexo d å¦‚æžœæ²¡æœ‰æŠ¥é”™,æ­å–œä½ å·²ç»æˆåŠŸæŽ¨é€åˆ° é¡¹ç›®çš„masteråˆ†æ”¯ã€‚ åˆ›å»ºgh-pagesåˆ†æ”¯å¹¶æŽ¨é€åˆ°è¿œç¨‹ git fetch origin master git checkout gh-pages git merge master git push origin gh-pages è®¿é—®http://jeffsui.github.io/pinghailinfeng_blog/ ##é‡åˆ°çš„é—®é¢˜ githubç«™ç‚¹çš„è§„åˆ™ä¸ç†Ÿæ‚‰,urlé…ç½®æµªè´¹æˆ‘2ä¸ªå°æ—¶ã€‚é¡¹ç›®å»ºç«‹çš„æ˜¯äºŒçº§åŸŸå,æ‰€ä»¥å¿…é¡»è¦æŒ‰ç…§æˆ‘è¯´çš„é‚£æ ·é…ç½®ã€‚ æœ¬åœ°é¢„è§ˆæœ‰å¯èƒ½ä¸åŠ è½½æ ·å¼,é‡æ–°åˆ é™¤node_moduleä¸‹æ‰€æœ‰,æ‰§è¡Œnpm install,å†hexo g,hexo server -i 127.0.0.1 -s -oå³å¯ã€‚ hexo3.0ç‰ˆæœ¬çš„gitæ’ä»¶å¿…é¡»è¦ç‹¬ç«‹å®‰è£…ã€‚ å…¶ä»–å‘,è‡ªå·±å¡«å§ã€‚ ##æ€»ç»“ å¤§å‘å„ç§æœ‰,githubç‰¹åˆ«å¤š,è¿˜æœ‰ä¼Ÿå¤§çš„å¢™,å…„å¼Ÿä»¬,githubå¥½ä¸Š,å¡«å‘éœ€è°¨æ…Žï¼]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>æ­å»º</tag>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sublime run slow problem]]></title>
    <url>%2F2015%2F04%2F17%2Fsublime-run-slow-problem%2F</url>
    <content type="text"><![CDATA[#è§£å†³sublime Text2è¿è¡Œç¼“æ…¢çš„æ–¹æ³• ä»Šå¤©æ‰“å¼€sublimeæƒ³å†™åšå®¢å‘çŽ°æ•´ä¸ªé¡µé¢æ‰“å¼€å¾ˆæ…¢,åˆ‡æ¢tabè¦ç­‰å¥½å‡ ç§’ã€‚å‘çŽ°äº†ä¸€ä¸ªå¸–å­,è¯´GitGutterè¿™ä¸ªæ’ä»¶åœ¨st2ä¸‹ä¼šå½±å“åˆ‡æ¢tabé€Ÿåº¦ã€‚ äºŽæ˜¯ ctrl+shift+pè°ƒå‡ºå‘½ä»¤,remove package,é€‰æ‹©GitGutter,å›žè½¦ã€‚é‡å¯sublime,ä¸–ç•Œéƒ½å˜å¾—æ¸…é™äº†ã€‚]]></content>
      <categories>
        <category>å·¥å…·ç¯‡</category>
      </categories>
      <tags>
        <tag>sublime</tag>
        <tag>GitGutter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[first-blog]]></title>
    <url>%2F2015%2F04%2F17%2Ffirst-blog%2F</url>
    <content type="text"><![CDATA[#ç¬¬ä¸€ä¸ªåšå®¢ ##è®°å½•ä½¿ç”¨hexoçš„å„ç§å¡«å‘ã€‚]]></content>
      <categories>
        <category>æ­å»ºåšå®¢</category>
      </categories>
      <tags>
        <tag>æ‚è®°</tag>
      </tags>
  </entry>
</search>
